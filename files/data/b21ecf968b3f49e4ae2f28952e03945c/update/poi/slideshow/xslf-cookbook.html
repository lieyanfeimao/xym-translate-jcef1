<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>XSLF Cookbook</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>XSLF Cookbook
     <div name="tsUpdate" data-id="t_5608702c25a14b938b22341ccdf850d8" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="XSLF+Cookbook"></a>
    <h2 class="boxed">XSLF Cookbook
     <div name="tsUpdate" data-id="t_b8dcee1e9fcb44d2b8061191f70f4f7b" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>This page offers a short introduction into the XSLF API. More examples can be found in the <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xslf/"> XSLF Examples</a> in the POI SVN repository.
      <div name="tsUpdate" data-id="t_506035b81f5c4b8788854ee32c9aaa68" data-tpl="0" data-txt-color="green"></div></p>
     <div class="note">
      <div class="label">
       Note
       <div name="tsUpdate" data-id="t_93b48baa6eb341e7bb911aa213996559" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       Please note that XSLF is still in early development and is a subject to incompatible changes in a future release.
       <div name="tsUpdate" data-id="t_e16a6b4650b446aebd1e3e6ea2386bc9" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
     <a name="Index+of+Features"></a>
     <h3 class="boxed">Index of Features
      <div name="tsUpdate" data-id="t_517ecdcc50214d1d95034d9ff396034a" data-tpl="0" data-txt-color="orange"></div></h3>
     <ul>
      <li><a href="#NewPresentation">Create a new presentation</a>
       <div name="tsUpdate" data-id="t_1b334f960a474582ad2ebf45783d91db" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#ReadPresentation">Read an existing presentation</a>
       <div name="tsUpdate" data-id="t_34cb4289ecc742c3b0b835fd4e55b3c0" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#SlideLayout">Create a slide with a predefined layout</a>
       <div name="tsUpdate" data-id="t_0f8d22e02c484d71b2a025d18de99db2" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#DeleteSlide">Delete slide</a>
       <div name="tsUpdate" data-id="t_8e569bc5bb144727b2a26ae646774fb1" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#MoveSlide">Re-order slides</a>
       <div name="tsUpdate" data-id="t_0463656e6c3840c0b228e8af266f9775" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#SlideSize">Change slide size</a>
       <div name="tsUpdate" data-id="t_9cffd73a37274e15942b640e912214e7" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#GetShapes">Read shapes</a>
       <div name="tsUpdate" data-id="t_a3383f291ab4429a8e489084e64b64fc" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#AddImage">Add image</a>
       <div name="tsUpdate" data-id="t_266eea8209304a20a85a7ada8435f764" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#ReadImages">Read images contained in a presentation</a>
       <div name="tsUpdate" data-id="t_84ec866151a1451381b75a8d17a11915" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Text">Format text</a>
       <div name="tsUpdate" data-id="t_2ec1321ca91b444eae5a0673afb58882" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Hyperlinks">Hyperlinks</a>
       <div name="tsUpdate" data-id="t_84b747f0c96a4d37bff07d98e4a704a2" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#PPTX2PNG">Convert .pptx slides into images</a>
       <div name="tsUpdate" data-id="t_75b2f6375a194446b89daa7185aced92" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Merge">Merge multiple presentations together</a>
       <div name="tsUpdate" data-id="t_1997c18610ed415cbeb22b01bb8f6172" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <a name="Cookbook"></a>
     <h3 class="boxed">Cookbook
      <div name="tsUpdate" data-id="t_4e68dc414d4d4fcc99ff6639f9842a3f" data-tpl="0" data-txt-color="orange"></div></h3>
     <a name="NewPresentation" id="NewPresentation"></a><a name="New+Presentation"></a>
     <h4>New Presentation
      <div name="tsUpdate" data-id="t_962413681622477fbfe2c4275495bd83" data-tpl="0" data-txt-color="green"></div></h4>
     <p>The following code creates a new .pptx slide show and adds a blank slide to it:
      <div name="tsUpdate" data-id="t_1617007c455a4d43a778fca0fe5ffa4e" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create a new empty slide show</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_84416ff2e83d41869df3bebd135c46a2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//add first slide</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1a4ef0ab89814a99a5090733b13e6852" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide blankSlide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ReadPresentation" id="ReadPresentation"></a><a name="Read+an+existing+presentation+and+append+a+slide+to+it"></a>
     <h4>Read an existing presentation and append a slide to it
      <div name="tsUpdate" data-id="t_58d4ffebc0824b288570d7bcac99ebc1" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//append a new slide to the end</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_67a1043258b146139ec138cd43554a72" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide blankSlide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="SlideLayout" id="SlideLayout"></a><a name="Create+a+new+slide+from+a+predefined+slide+layout"></a>
     <h4>Create a new slide from a predefined slide layout
      <div name="tsUpdate" data-id="t_8f810cde93074276b6100d2aa8e79af3" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// first see what slide layouts are available :</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_8ff1ed056b904867b85113e8554657ad" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">System.out.println("Available slide layouts:");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(XSLFSlideMaster master : ppt.getSlideMasters()){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(XSLFSlideLayout layout : master.getSlideLayouts()){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(layout.getType());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// blank slide</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b239e6e13d7e40999e6576b96415475a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide blankSlide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// there can be multiple masters each referencing a number of layouts</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// for demonstration purposes we use the first (default) slide master</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5005418fe20f4114a5083e7631848a19" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlideMaster defaultMaster = ppt.getSlideMasters().get(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// title slide</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ae697e3ce9524a46a51ad469400aa79a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlideLayout titleLayout = defaultMaster.getLayout(SlideLayout.TITLE);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// fill the placeholders</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_481ead802d0445dd89891d5938aa823f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide slide1 = ppt.createSlide(titleLayout);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextShape title1 = slide1.getPlaceholder(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">title1.setText("First Title");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// title and content</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_642794af486d4c4bab396da4ce5e2e10" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlideLayout titleBodyLayout = defaultMaster.getLayout(SlideLayout.TITLE_AND_CONTENT);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide slide2 = ppt.createSlide(titleBodyLayout);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextShape title2 = slide2.getPlaceholder(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">title2.setText("Second Title");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextShape body2 = slide2.getPlaceholder(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">body2.clearText(); //<span> unset any existing text
         <div name="tsUpdate" data-id="t_faa97b70cf364322bbf04730d0bb7b3a" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">body2.addNewTextParagraph().addNewTextRun().setText("First paragraph");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">body2.addNewTextParagraph().addNewTextRun().setText("Second paragraph");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">body2.addNewTextParagraph().addNewTextRun().setText("Third paragraph");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="DeleteSlide" id="DeleteSlide"></a><a name="Delete+slide"></a>
     <h4>Delete slide
      <div name="tsUpdate" data-id="t_c21118eab8254caf85ba57a4108fa7fa" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ppt.removeSlide(0); //<span> 0-based index of a slide to be removed
         <div name="tsUpdate" data-id="t_22d33e5c68ff494eaec953473af14e18" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="MoveSlide" id="MoveSlide"></a><a name="Re-order+slides"></a>
     <h4>Re-order slides
      <div name="tsUpdate" data-id="t_9e5db5a870f8481ba8153a3198dd3f51" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">List&lt;XSLFSlide&gt; slides = ppt.getSlides();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide thirdSlide = slides.get(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ppt.setSlideOrder(thirdSlide, 0); //<span> move the third slide to the beginning
         <div name="tsUpdate" data-id="t_e2e7e0f582734e33ac942b97d7733bc7" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="SlideSize" id="SlideSize"></a><a name="How+to+retrieve+or+change+slide+size"></a>
     <h4>How to retrieve or change slide size
      <div name="tsUpdate" data-id="t_f64bc0cdc264407ca76e1e70a8953278" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//retrieve page size. Coordinates are expressed in points (72 dpi)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1c487f4c737a422cb68fca5275749932" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">java.awt.Dimension pgsize = ppt.getPageSize();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int pgx = pgsize.width; //<span>slide width in points
         <div name="tsUpdate" data-id="t_e88a552f614d4a5a87dc8e1493995cc4" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int pgy = pgsize.height; //<span>slide height in points
         <div name="tsUpdate" data-id="t_db46b709e08c433e9307d959b7ba2040" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set new page size</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_49e930d5b99d4913a734b1196489bbb7" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ppt.setPageSize(new java.awt.Dimension(1024, 768));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="GetShapes" id="GetShapes"></a><a name="How+to+read+shapes+contained+in+a+particular+slide"></a>
     <h4>How to read shapes contained in a particular slide
      <div name="tsUpdate" data-id="t_6e00efcd3cf6438db1957cb1a9becebd" data-tpl="0" data-txt-color="green"></div></h4>
     <p>The following code demonstrates how to iterate over shapes for each slide.
      <div name="tsUpdate" data-id="t_a80ed8def79b4e89a02a501eebab6428" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// get slides</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ad7aec3ba25b4033a5c01b19bb2ae1e7" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (XSLFSlide slide : ppt.getSlides()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (XSLFShape sh : slide.getShapes()) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // name of the shape</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_eff7982c6806496ab32a5ea72e0319a6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String name = sh.getShapeName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // shapes's anchor which defines the position of this shape in the slide</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3eea50aaf85a4ad298372e56708262a6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (sh instanceof PlaceableShape) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> java.awt.geom.Rectangle2D anchor = ((PlaceableShape)sh).getAnchor();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (sh instanceof XSLFConnectorShape) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSLFConnectorShape line = (XSLFConnectorShape) sh;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // work with Line</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_47e1b33617cb4e76b8c0404ae665c731" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (sh instanceof XSLFTextShape) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSLFTextShape shape = (XSLFTextShape) sh;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // work with a shape that can hold text</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_433000195ee341d2a5ef0d0d5b290547" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (sh instanceof XSLFPictureShape) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSLFPictureShape shape = (XSLFPictureShape) sh;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // work with Picture</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_49ae98c16d1447faa56f5a812e4160ca" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="AddImage" id="AddImage"></a><a name="Add+Image+to+Slide"></a>
     <h4>Add Image to Slide
      <div name="tsUpdate" data-id="t_c394769655194ff0992df3b147fd82aa" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide slide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">byte[] pictureData = IOUtils.toByteArray(new FileInputStream("image.png"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFPictureData pd = ppt.addPicture(pictureData, PictureData.PictureType.PNG);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFPictureShape pic = slide.createPicture(pd);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ReadImages" id="ReadImages"></a><a name="Read+Images+contained+within+a+presentation"></a>
     <h4>Read Images contained within a presentation
      <div name="tsUpdate" data-id="t_401e300255c24fe3bd387ed05a9a6b60" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow(new FileInputStream("slideshow.pptx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(XSLFPictureData data : ppt.getAllPictures()){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> byte[] bytes = data.getData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String fileName = data.getFileName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Text" id="Text"></a><a name="Basic+text+formatting"></a>
     <h4>Basic text formatting
      <div name="tsUpdate" data-id="t_c78c874c99b54b7d82b95f53e9d47155" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide slide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextBox shape = slide.createTextBox();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextParagraph p = shape.addNewTextParagraph();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextRun r1 = p.addNewTextRun();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r1.setText("The");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r1.setFontColor(Color.blue);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r1.setFontSize(24.);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextRun r2 = p.addNewTextRun();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r2.setText(" quick");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r2.setFontColor(Color.red);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r2.setBold(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextRun r3 = p.addNewTextRun();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r3.setText(" brown");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r3.setFontSize(12.);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r3.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r3.setStrikethrough(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextRun r4 = p.addNewTextRun();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r4.setText(" fox");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r4.setUnderline(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Hyperlinks" id="Hyperlinks"></a><a name="How+to+create+a+hyperlink"></a>
     <h4>How to create a hyperlink
      <div name="tsUpdate" data-id="t_96b0f5fa98ff4797b5ff9851cadc35c3" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFSlide slide = ppt.createSlide();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// assign a hyperlink to a text run</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f20bf4557f6648cc88b2f5afd9987e68" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextBox shape = slide.createTextBox();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFTextRun r = shape.addNewTextParagraph().addNewTextRun();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r.setText("Apache POI");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSLFHyperlink link = r.createHyperlink();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("https://<span>poi.apache.org");
         <div name="tsUpdate" data-id="t_c924be73a8fd4a12b4cfa8589c3464a7" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="PPTX2PNG" id="PPTX2PNG"></a><a name="PPTX2PNG+is+an+application+that+converts+each+slide+of+a+.pptx+slideshow+into+a+PNG+image"></a>
     <h4>PPTX2PNG is an application that converts each slide of a .pptx slideshow into a PNG image
      <div name="tsUpdate" data-id="t_738c1498383a46af823777526da42606" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Usage: PPTX2PNG [options] &lt;pptx file&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Options:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> -scale &lt;float&gt; scale factor (default is 1.0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> -slide &lt;integer&gt; 1-based index of a slide to render. Default is to render all slides.</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>How it works:
      <div name="tsUpdate" data-id="t_3db3bf84dbf74ef5a46a54d8718d3068" data-tpl="0" data-txt-color="green"></div></p>
     <p>The XSLFSlide object implements a draw(Graphics2D graphics) method that recursively paints all shapes in the slide into the supplied graphics canvas:
      <div name="tsUpdate" data-id="t_01320c74fe184285aad8ae5ea9a8379c" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">slide.draw(graphics);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>where graphics is a class implementing java.awt.Graphics2D. In PPTX2PNG the graphic canvas is derived from java.awt.image.BufferedImage, i.e. the destination is an image in memory, but in general case you can pass any compliant implementation of java.awt.Graphics2D. The <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xslf/PPTX2SVG.txt">PPTX2SVG</a> example demonstrates how to use Apache Batik to convert .pptx slides into SVG format.
      <div name="tsUpdate" data-id="t_d59faf42f98442b1a363de7b3733d215" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Merge" id="Merge"></a><a name="Merge+multiple+presentations+together"></a>
     <h4>Merge multiple presentations together
      <div name="tsUpdate" data-id="t_9abb870869fe4a2ca2cbc5d16439ba4c" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XMLSlideShow ppt = new XMLSlideShow();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String[] inputs = {"presentations1.pptx", "presentation2.pptx"};</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(String arg : inputs){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileInputStream is = new FileInputStream(arg);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XMLSlideShow src = new XMLSlideShow(is);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> is.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(XSLFSlide srcSlide : src.getSlides()){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ppt.createSlide().importContent(srcSlide);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FileOutputStream out = new FileOutputStream("merged.pptx");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ppt.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <p align="right"><font size="-2">by&nbsp;Yegor Kozlov</font>
     <div name="tsUpdate" data-id="t_0653efe98de944329fb99d9b53c95a0d" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/slideshow/xslf-cookbook.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='60b5eb8f95a341d5bda1b842fe0e1ec1';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>