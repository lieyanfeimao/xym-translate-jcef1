<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-HSLF - A Quick Guide</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>POI-HSLF - A Quick Guide
     <div name="tsUpdate" data-id="t_69f8ab9354f0462c921de62c1bad1fad" data-tpl="0" data-txt-color="green"></div></h1>
    <h3>Overview
     <div name="tsUpdate" data-id="t_b150620ce2a34358aa1f591f5f3e7460" data-tpl="0" data-txt-color="orange"></div></h3>
    <div id="front-matter"></div>
    <a name="Basic+Text+Extraction"></a>
    <h2 class="boxed">Basic Text Extraction
     <div name="tsUpdate" data-id="t_bd1addda12c84320918c0b0166338b11" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>For basic text extraction, make use of <span class="codefrag">org.apache.poi.sl.extractor.SlideShowExtractor</span>. It accepts a slideshow which can be created from a file or stream via <span class="codefrag">org.apache.poi.sl.usermodel.SlideShowFactory</span>. The <span class="codefrag">getText()</span> method can be used to get the text from the slides.
      <div name="tsUpdate" data-id="t_e34705099ad343479b42e3a7f7460f77" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Specific+Text+Extraction"></a>
    <h2 class="boxed">Specific Text Extraction
     <div name="tsUpdate" data-id="t_15127a3ed1674f528503ed25e854727e" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>To get specific bits of text, first create a <span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShow</span> (from a <span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShowImpl</span>, which accepts a file or an input stream). Use <span class="codefrag">getSlides()</span> and <span class="codefrag">getNotes()</span> to get the slides and notes. These can be queried to get their page ID (though they should be returned in the right order).
      <div name="tsUpdate" data-id="t_0491b1fad51145bcb6723ea37f8ce28a" data-tpl="0" data-txt-color="green"></div></p>
     <p>You can then call <span class="codefrag">getTextParagraphs()</span> on these, to get their blocks of text. (A list of <span class="codefrag">HSLFTextParagraph</span> normally holds all the text in a given area of the page, eg in the title bar, or in a box). From the <span class="codefrag">HSLFTextParagraph</span>, you can extract the text, and check what type of text it is (eg Body, Title). You can also call <span class="codefrag">getTextRuns()</span>, which will return the <span class="codefrag">HSLFTextRun</span>s that make up the <span class="codefrag">TextParagraph</span>. A <span class="codefrag">HSLFTextRun</span> is a text fragment, having the same character formatting. The paragraph formatting is defined in the parent <span class="codefrag">HSLFTextParagraph</span>.
      <div name="tsUpdate" data-id="t_01db8ae98830459d8523252ea68cc321" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Poor+Quality+Text+Extraction"></a>
    <h2 class="boxed">Poor Quality Text Extraction
     <div name="tsUpdate" data-id="t_83ea6e20f16f4e5f8e0e0130ae20a5bd" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>If speed is the most important thing for you, you don't care about getting duplicate blocks of text, you don't care about getting text from master sheets, and you don't care about getting old text, then <span class="codefrag">org.apache.poi.hslf.extractor.QuickButCruddyTextExtractor</span> might be of use.
      <div name="tsUpdate" data-id="t_727d6b15d633404e9457a3011d92ec5a" data-tpl="0" data-txt-color="green"></div></p>
     <p>QuickButCruddyTextExtractor doesn't use the normal record parsing code, instead it uses a tree structure blind search method to get all text holding records. You will get all the text, including lots of text you normally wouldn't ever want. However, you will get it back very very fast!
      <div name="tsUpdate" data-id="t_0418a29c558d4f0e981f67279db93006" data-tpl="0" data-txt-color="green"></div></p>
     <p>There are two ways of getting the text back. <span class="codefrag">getTextAsString()</span> will return a single string with all the text in it. <span class="codefrag">getTextAsVector()</span> will return a vector of strings, one for each text record found in the file.
      <div name="tsUpdate" data-id="t_b1d8bf3fbcd94d15ba2d60413f107453" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Changing+Text"></a>
    <h2 class="boxed">Changing Text
     <div name="tsUpdate" data-id="t_dbaf35344cdf40aab70872ed54366b64" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>It is possible to change the text via <span class="codefrag">HSLFTextParagraph.setText(List&lt;HSLFTextParagraph&gt;,String)</span> or <span class="codefrag">HSLFTextRun.setText(String)</span>. It is possible to add additional TextRuns with <span class="codefrag">HSLFTextParagraph.appendText(List&lt;HSLFTextParagraph&gt;,String,boolean)</span> or <span class="codefrag">HSLFTextParagraph.addTextRun(HSLFTextRun)</span>
      <div name="tsUpdate" data-id="t_78a0130c3cdc4bb6bd5fac565e5ecb84" data-tpl="0" data-txt-color="green"></div></p>
     <p>When calling <span class="codefrag">HSLFTextParagraph.setText(List&lt;HSLFTextParagraph&gt;,String)</span>, all the text will end up with the same formatting. When calling <span class="codefrag">HSLFTextRun.setText(String)</span>, the text will retain the old formatting of that <span class="codefrag">HSLFTextRun</span>.
      <div name="tsUpdate" data-id="t_5aa061e3d39d4d2e962e6d691f3d82c0" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Adding+Slides"></a>
    <h2 class="boxed">Adding Slides
     <div name="tsUpdate" data-id="t_43a0a82816c648378c4bda9cc561710b" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>You may add new slides by calling <span class="codefrag">HSLFSlideShow.createSlide()</span>, which will add a new slide to the end of the SlideShow. It is possible to re-order slides with <span class="codefrag">HSLFSlideShow.reorderSlide(...)</span>.
      <div name="tsUpdate" data-id="t_1f398b56e7f04f8daba746baf481e2d9" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Guide+to+key+classes"></a>
    <h2 class="boxed">Guide to key classes
     <div name="tsUpdate" data-id="t_e771322c98364964bb035a2f87e50047" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <ul>
      <li><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShowImpl</span> Handles reading in and writing out files. Calls <span class="codefrag">org.apache.poi.hslf.record.record</span> to build a tree of all the records in the file, which it allows access to.
       <div name="tsUpdate" data-id="t_12d12a6decf44acca224ff11b84e8014" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.record.Record</span> Base class of all records. Also provides the main record generation code, which will build up a tree of records for a file.
       <div name="tsUpdate" data-id="t_4182c8f3c7c54853ac2542a870ae8776" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShow</span> Builds up model entries from the records, and presents a user facing view of the file
       <div name="tsUpdate" data-id="t_eec71de171b447d6b63745d0041985a5" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlide</span> A user facing view of a Slide in a slideshow. Allows you to get at the Text of the slide, and at any drawing objects on it.
       <div name="tsUpdate" data-id="t_01af82dbe0b844628eb6575686957f76" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFTextParagraph</span> A list of <span class="codefrag">HSLFTextParagraph</span>s holds all the text in a given area of the Slide, and will contain one or more <span class="codefrag">HSLFTextRun</span>s.
       <div name="tsUpdate" data-id="t_5b92473e70574dfd914a099d4f9489fc" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFTextRun</span> Holds a run of text, all having the same character stylings. It is possible to modify text, and/or text stylings.
       <div name="tsUpdate" data-id="t_b8ed421ef1d3403d976b888fcaaa492f" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.sl.extractor.SlideShowExtractor</span> Uses the model code to allow extraction of text from files
       <div name="tsUpdate" data-id="t_e44ff4f348b94805944352ff06bd0e43" data-tpl="0" data-txt-color="green"></div></li>
      <li><span class="codefrag">org.apache.poi.hslf.extractor.QuickButCruddyTextExtractor</span> Uses the record code to extract all the text from files very fast, but including deleted text (and other bits of Crud).
       <div name="tsUpdate" data-id="t_cb2fa6ff8910497a911e0b0e5765ae54" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
    </div>
    <p align="right"><font size="-2">by&nbsp;Nick Burch</font>
     <div name="tsUpdate" data-id="t_2f7cfd2ef5de40b18f38c09e50a9a126" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/slideshow/quick-guide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='5988fe85e9074b2aa07b880a00f49cd7';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>