<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - POIFS - Design Document</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Apache POI - POIFS - Design Document
     <div name="tsUpdate" data-id="t_61e470ae598843f58ee753e12f57600a" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="POIFS+Design+Document"></a>
    <h2 class="boxed">POIFS Design Document
     <div name="tsUpdate" data-id="t_6a146b5a76a34f5f87f3db65b8fcc261" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>This document describes the design of the POIFS system. It is organized as follows:
      <div name="tsUpdate" data-id="t_f6254cc732e04c7ab24a178bfe51c4f7" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li><a href="#Scope">Scope:</a> A description of the limitations of this document.
       <div name="tsUpdate" data-id="t_0c943f07b6464669b802591bc5386a85" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Assumptions">Assumptions:</a> The assumptions on which this design is based.
       <div name="tsUpdate" data-id="t_35493498163c48a486cfdb9b02ebf45d" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Considerations">Design Considerations:</a> The constraints and goals applied to the design.
       <div name="tsUpdate" data-id="t_a01d012bdafa4726815203cc529cd443" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Design">Design:</a> The design of the POIFS system.
       <div name="tsUpdate" data-id="t_ff70755690c24086afed011b50a174d3" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
    </div>
    <a name="Scope"></a>
    <h2 class="boxed">Scope
     <div name="tsUpdate" data-id="t_f1449e95dbee4fc38f53173b6a98e32c" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>This document is written as part of an iterative process. As that process is not yet complete, neither is this document.
      <div name="tsUpdate" data-id="t_662def6c70244862ad7f6c1d8d4346e9" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Assumptions"></a>
    <h2 class="boxed">Assumptions
     <div name="tsUpdate" data-id="t_305226187f314b9faf756dabc35afe33" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>The design of POIFS is not dependent on the code written for the proof-of-concept prototype POIFS package.
      <div name="tsUpdate" data-id="t_db28703695824ad4a3da8a5e4ed8e7ad" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Considerations"></a>
    <h2 class="boxed">Design Considerations
     <div name="tsUpdate" data-id="t_e79e953b7c4e43448d9f0d987886a0e3" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>As usual, the primary considerations in the design of the POIFS assumption involve the classic space-time tradeoff. In this case, the main consideration has to involve minimizing the memory footprint of POIFS. POIFS may be called upon to create relatively large documents, and in web application server, it may be called upon to create several documents simultaneously, and it will likely co-exist with other Serializer systems, competing with those other systems for space on the server.
      <div name="tsUpdate" data-id="t_813af7250ca44547b88531affea9dbf0" data-tpl="0" data-txt-color="green"></div></p>
     <p>We've addressed the risk of being too slow through a proof-of-concept prototype. This prototype for POIFS involved reading an existing file, decomposing it into its constituent documents, composing a new POIFS from the constituent documents, and writing the POIFS file back to disk and verifying that the output file, while not necessarily a byte-for-byte image of the input file, could be read by the application that generated the input file. This prototype proved to be quite fast, reading, decomposing, and re-generating a large (300K) file in 2 to 2.5 seconds.
      <div name="tsUpdate" data-id="t_e83a03cf51044865b141672117ba97c5" data-tpl="0" data-txt-color="green"></div></p>
     <p>While the POIFS format allows great flexibility in laying out the documents and the other internal data structures, the layout of the filesystem will be kept as simple as possible.
      <div name="tsUpdate" data-id="t_064eb524a28e45be9a08288b4d0acb7f" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Design"></a>
    <h2 class="boxed">Design
     <div name="tsUpdate" data-id="t_ba2f83d48f44436e935f51fc30118df9" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>The design of the POIFS is broken down into two parts: <a href="#Classes">discussion of the classes and interfaces</a>, and <a href="#Scenarios">discussion of how these classes and interfaces will be used to convert an appropriate Java InputStream (such as an XML stream) to a POIFS output stream containing an HSSF document</a>.
      <div name="tsUpdate" data-id="t_cfcf02180be34a8897419392fecc9744" data-tpl="0" data-txt-color="green"></div></p>
     <p><a name="Classes"></a><strong id="Classes">Classes and Interfaces</strong>
      <div name="tsUpdate" data-id="t_cb834601a2e54ad0b7d943a4c80c4edc" data-tpl="0" data-txt-color="green"></div></p>
     <p>The classes and interfaces used in the POIFS are broken down as follows:
      <div name="tsUpdate" data-id="t_96006ee21dea45cdbaef85f1e9fca872" data-tpl="0" data-txt-color="green"></div></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Package
         <div name="tsUpdate" data-id="t_66a66b7b543947699633ff3c7e9713b8" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Contents
         <div name="tsUpdate" data-id="t_278b88f1fac54aefbd553f82cf00bf54" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><a href="#BlockClasses">net.sourceforge.poi.poifs.storage</a>
         <div name="tsUpdate" data-id="t_588dcf5eebf249d3bc9349070399a803" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Block classes and interfaces
         <div name="tsUpdate" data-id="t_3c253cf40e7947c48c796e88d01b08ba" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><a href="#PropertyClasses">net.sourceforge.poi.poifs.property</a>
         <div name="tsUpdate" data-id="t_21ea6c77c0ee4a12b5d0c1ae89bedd51" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Property classes and interfaces
         <div name="tsUpdate" data-id="t_5bae4afd38df4ec6989560cf34f8121b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><a href="#FilesystemClasses">net.sourceforge.poi.poifs.filesystem</a>
         <div name="tsUpdate" data-id="t_869b4fb02e894e4b9f34a35815af7007" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Filesystem classes and interfaces
         <div name="tsUpdate" data-id="t_608e8a39febc45ed8dff5b0e8b77b739" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><a href="#UtilityClasses">net.sourceforge.poi.util</a>
         <div name="tsUpdate" data-id="t_dfcb5949181e4167bde636abfbc8c8e1" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Utility classes and interfaces
         <div name="tsUpdate" data-id="t_0660f2b6e4c64f6facef217e41d89dca" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="BlockClasses"></a>
     <h3 class="boxed">Block Classes and Interfaces
      <div name="tsUpdate" data-id="t_896beaa5dd71415cad2682dc9ea5e86c" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The block classes and interfaces are shownin the following class diagram.
      <div name="tsUpdate" data-id="t_606e4b4a6c184cd4b32e81b5c3cc936e" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Block Classes and Interfaces" src="images/BlockClassDiagram.gif"></p>
     <a name="BATBlock"></a><a name="BigBlock"></a><a name="BlockWritable"></a><a name="DocumentBlock"></a><a name="HeaderBlock"></a><a name="PropertyBlock"></a>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Class/Interface
         <div name="tsUpdate" data-id="t_90b5bf6630504cb59486728777ca0d33" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_b8f2a6de00e44b62ac31829620ea989d" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BATBlock">BATBlock
         <div name="tsUpdate" data-id="t_09b1714efa5f4200bc5ddeef5a540635" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BATBlock</strong> class represents a single big block containing 128 <a href="fileformat.html#BAT">BAT entries</a>.
         <br>
         Its <span class="codefrag">_fields</span> array is used to read and write the BAT entries into the <span class="codefrag">_data</span> array.
         <br>
         Its <span class="codefrag">createBATBlocks</span> method is used to create an array of BATBlock instances from an array of int BAT entries.
         <br>
         Its <span class="codefrag">calculateStorageRequirements</span> method calculates the number of BAT blocks necessary to hold the specified number of BAT entries.
         <div name="tsUpdate" data-id="t_d7093ebba0344549bd957b1aed9ea7d8" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BigBlock">BigBlock
         <div name="tsUpdate" data-id="t_98e40db807824db68451606901489004" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BigBlock</strong> class is an abstract class representing the common big block of 512 bytes. It implements <a href="#BlockWritable">BlockWritable</a>, trivially delegating the <span class="codefrag">writeBlocks</span> method of BlockWritable to its own abstract <span class="codefrag">writeData </span> method.
         <div name="tsUpdate" data-id="t_86d32ec880404d54bd3064d38d8064b8" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BlockWritable">BlockWritable
         <div name="tsUpdate" data-id="t_9722c037dd0648bbb8e247a34bfa958b" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BlockWritable</strong> interface defines a single method, <span class="codefrag">writeBlocks</span>, that is used to write an implementation's block data to an <span class="codefrag"> OutputStream</span>.
         <div name="tsUpdate" data-id="t_2fe1f87df8ea4c7799bf666affb3c872" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="DocumentBlock">DocumentBlock
         <div name="tsUpdate" data-id="t_f870e6b79e3b4fd98ed6a5895fc1a395" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>DocumentBlock</strong> class is used by a <a href="#Document"> Document </a> to holds its raw data. It also retains the number of bytes read, as this is used by the Document class to determine the total size of the data, and is also used internally to determine whether the block was filled by the <span class="codefrag">InputStream</span> or not.
         <br>
         The <span class="codefrag">DocumentBlock</span> constructor is passed an <span class="codefrag">InputStream</span> from which to fill its <span class="codefrag">_data</span> array.
         <br>
         The <span class="codefrag">size</span> method returns the number of bytes read (<span class="codefrag">_bytes_read</span>) when the instance was constructed.
         <br>
         The <span class="codefrag">partiallyRead</span> method returns true if the <span class="codefrag">_data</span> array was not completely filled, which may be interpreted by the Document as having reached the end of file point.
         <br>
         Typical use of the DocumentBlock class is like this:
         <br>
         <div class="code">
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"></span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">while (true) {</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> DocumentBlock block = new DocumentBlock(stream);</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> blocks.add(block);</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> size += block.size();</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> if (block.partiallyRead()) {</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> break;</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> }</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">}</span>
          </div>
         </div>
         <div name="tsUpdate" data-id="t_d91d0c96df7942b8a014cb40bb2459cb" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="HeaderBlock">HeaderBlock
         <div name="tsUpdate" data-id="t_d58023cf36cd4cb9a9a1a1e9667c8ff3" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>HeaderBlock</strong> class is used to contain the data found in a POIFS header.
         <br>
         Its <a href="#IntegerField">IntegerField</a> members are used to read and write the appropriate entries into the <span class="codefrag">_data</span> array.
         <br>
         Its <span class="codefrag">setBATBlocks</span> , <span class="codefrag">setPropertyStart</span> , and <span class="codefrag">setXBATStart</span> methods are used to set the appropriate fields in the <span class="codefrag">_data</span> array.
         <br>
         The <span class="codefrag">calculateXBATStorageRequirements</span> method is used to determine how many XBAT blocks are necessary to accommodate the specified number of BAT blocks.
         <div name="tsUpdate" data-id="t_89f726e691aa4475b9e20171dad7e027" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="PropertyBlock">PropertyBlock
         <div name="tsUpdate" data-id="t_3a7731502d8143de9f3eedab4f656d70" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>PropertyBlock</strong> class is used to contain <a href="#Property">Property</a> instances for the <a href="#PropertyTable">PropertyTable</a> class.
         <br>
         It contains an array, <span class="codefrag">_properties</span> of 4 Property instances, which together comprise the 512 bytes of a <a href="#BigBlock">BigBlock</a>.
         <br>
         The <span class="codefrag">createPropertyBlockArray</span> method is used to convert a <span class="codefrag">List</span> of Property instances into an array of PropertyBlock instances. The number of Property instances is rounded up to a multiple of 4 by creating empty anonymous inner class extensions of Property.
         <div name="tsUpdate" data-id="t_1d0a8ccc8b884d77924240624be6d6b9" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="PropertyClasses"></a>
     <h3 class="boxed">Property Classes and Interfaces
      <div name="tsUpdate" data-id="t_1d2d0afee34f418bb8c8fc294689f5ee" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The property classes and interfaces are shown in the following class diagram.
      <div name="tsUpdate" data-id="t_e2b8bfcc6d6246b891690850f6039cdf" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Property Classes and Interfaces" src="images/PropertyTableClassDiagram.gif"></p>
     <a name="Directory"></a><a name="DocumentProperty"></a><a name="File"></a><a name="Property"></a><a name="PropertyTable"></a><a name="RootProperty"></a>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Class/Interface
         <div name="tsUpdate" data-id="t_2e6113909621480e8262ca003d86cc9b" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_7b61fff0091a4c65ab1d4565ea1b2777" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="Directory">Directory
         <div name="tsUpdate" data-id="t_7125da3eda5e477d8357d63fb620c1e3" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>Directory</strong> interface is implemented by the <a href="#RootProperty">RootProperty</a> class. It is not strictly necessary for the initial POIFS implementation, but when the POIFS supports <a href="fileformat.html#directoryEntry">directory elements</a>, this interface will be more widely implemented, and so is included in the design at this point to ease the eventual support of directory elements.
         <br>
         Its methods are a getter/setter pair, <span class="codefrag">getChildren</span> , returning an <span class="codefrag">Iterator</span> of <a href="#Property">Property</a> instances; and <span class="codefrag">addChild</span> , which will allow the caller to add another Property instance to the Directory's children.
         <div name="tsUpdate" data-id="t_d70d900834d04aeb8d13ba25bae9fa2f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="DocumentProperty">DocumentProperty
         <div name="tsUpdate" data-id="t_5f249c2a0fea4f9aa21a3fdfbebdcbde" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>DocumentProperty</strong> class is a trivial extension of <a href="#Property"> Property </a> and is used by <a href="#Document">Document</a> to keep track of its associated entry in the <a href="#PropertyTable">PropertyTable</a>.
         <br>
         Its constructor takes a name and the document size, on the assumption that the Document will not create a DocumentProperty until after it has created the storage for the document data and therefore knows how much data there is.
         <div name="tsUpdate" data-id="t_4f838e944abd457a939e6e4ea5ea6353" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="File">File
         <div name="tsUpdate" data-id="t_4888a5e88b4e4911b961c2e8dddfebeb" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>File</strong> interface specifies the behavior of reading and writing the next and previous child fields of a <a href="#Property">Property</a>.
         <div name="tsUpdate" data-id="t_a036a58280a240d0bc5cf53266f6b1d5" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="Property">Property
         <div name="tsUpdate" data-id="t_308d1edcf9ad4b67a27d3e39d81a8677" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>Property</strong> class is an abstract class that defines the basic data structure of an element of the <a href="fileformat.html#PropertyTable"> Property Table</a>.
         <br>
         Its <a href="#ByteField">ByteField</a>, <a href="#ShortField"> ShortField</a>, and <a href="#IntegerField">IntegerField</a> members are used to read and write data into the appropriate locations in the <span class="codefrag">_raw_data</span> array.
         <br>
         The <span class="codefrag">_index</span> member is used to hold a Propery instance's index in the <span class="codefrag">List</span> of Property instances maintained by <a href="#PropertyTable">PropertyTable</a>, which is used to populate the child property of parent <a href="#Directory">Directory</a> properties and the next property and previous property of sibling <a href="#File">File</a> properties.
         <br>
         The <span class="codefrag">_name</span> , <span class="codefrag">_next_file</span> , and <span class="codefrag">_previous_file</span> members are used to help fill the appropriate fields of the _raw_data array.
         <br>
         Setters are provided for some of the fields (name, property type, node color, child property, size, index, start block), as well as a few getters (index, child property).
         <br>
         The <span class="codefrag">preWrite</span> method is abstract and is used by the owning PropertyTable to iterate through its Property instances and prepare each for writing.
         <br>
         The <span class="codefrag">shouldUseSmallBlocks</span> method returns true if the Property's size is sufficiently small - how small is none of the caller's business.
         <div name="tsUpdate" data-id="t_3211e6d2c7074ee790f3b25634a9ffba" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">PropertyBlock
         <div name="tsUpdate" data-id="t_ad2dd3a156d44f19a0fc8df2e1c61fa1" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#PropertyBlock">PropertyBlock</a>.
         <div name="tsUpdate" data-id="t_361b299897c443a788b4a37a006cf122" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="PropertyTable">PropertyTable
         <div name="tsUpdate" data-id="t_ac3c6441c1f14895aa6f402f8429129f" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>PropertyTable</strong> class holds all of the <a href="#DocumentProperty">DocumentProperty</a> instances and the <a href="#RootProperty">RootProperty</a> instance for a <a href="#Filesystem">Filesystem</a> instance.
         <br>
         It maintains a <span class="codefrag">List</span> of its <a href="#Property">Property</a> instances ( <span class="codefrag">_properties</span> ), and when prepared to write its data by a call to <span class="codefrag">preWrite</span> , it gets and holds an array of <a href="#PropertyBlock">PropertyBlock</a> instances ( <span class="codefrag">_blocks</span>) .
         <br>
         It also maintains its start block in its <span class="codefrag">_start_block</span> member.
         <br>
         It has a method, <span class="codefrag">getRoot</span> , to get the RootProperty, returning it as an implementation of <a href="#Directory"> Directory</a>, and a method to add a Property, <span class="codefrag">addProperty</span> , and a method to get its start block, <span class="codefrag">getStartBlock</span> .
         <div name="tsUpdate" data-id="t_8e24fbd3511c405580821dc160098cb5" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="RootProperty">RootProperty
         <div name="tsUpdate" data-id="t_97e59cf7cd7f4d09bae95009758c26d3" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>RootProperty</strong> class acts as the <a href="#Directory">Directory</a> for all of the <a href="#DocumentProperty">DocumentProperty</a> instance. As such, it is more of a pure <a href="fileformat.html#directoryEntry">directory entry </a> than a proper <a href="fileformat.html#RootEntry">root entry </a> in the <a href="fileformat.html#PropertyTable">Property Table</a>, but the initial POIFS implementation does not warrant the additional complexity of a full-blown root entry, and so it is not modeled in this design.
         <br>
         It maintains a <span class="codefrag">List</span> of its children, <span class="codefrag">_children</span> , in order to perform its directory-oriented duties.
         <div name="tsUpdate" data-id="t_fda2601ad5a2479cb677b1688cd42148" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="FilesystemClasses"></a>
     <h3 class="boxed">Filesystem Classes and Interfaces
      <div name="tsUpdate" data-id="t_80c46d1982d64bceb5b6af32055e1344" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The property classes and interfaces are shown in the following class diagram.
      <div name="tsUpdate" data-id="t_602a835eb666482ab53bbe1391bfe41d" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Filesystem Classes and Interfaces" src="images/POIFSClassDiagram.gif"></p>
     <a name="Filesystem"></a><a name="BATManaged"></a><a name="BlockAllocationTable"></a><a name="Document"></a>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Class/Interface
         <div name="tsUpdate" data-id="t_151eed6a2c584989817cef497c16d1cc" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_0a797cd686a64817ae6892ba1947bc26" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="Filesystem">Filesystem
         <div name="tsUpdate" data-id="t_d253ac9534b348da9b5d5785eb192a02" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>Filesystem</strong> class is the top-level class that manages the creation of a POIFS document.
         <br>
         It maintains a <a href="#PropertyTable">PropertyTable</a> instance in its <span class="codefrag">_property_table</span> member, a <a href="#HeaderBlock">HeaderBlock</a> instance in its <span class="codefrag">_header_block</span> member, and a <span class="codefrag">List</span> of its <a href="#Document">Document</a> instances in its <span class="codefrag">_documents</span> member.
         <br>
         It provides methods for a client to create a document ( <span class="codefrag">createDocument</span> ), and a method to write the Filesystem to an <span class="codefrag">OutputStream</span> ( <span class="codefrag">writeFilesystem</span> ).
         <div name="tsUpdate" data-id="t_9bd8e924692a42f6bc9e6511c32c987a" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">BATBlock
         <div name="tsUpdate" data-id="t_99ae1d7b44fa4603bcd69029620919ab" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#BATBlock">BATBlock</a>
         <div name="tsUpdate" data-id="t_ca47a4b33cf54f889ec2dcdd2a9eae2a" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BATManaged">BATManaged
         <div name="tsUpdate" data-id="t_0d9fd656d6074a24b05880c5b2195aa9" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BATManaged</strong> interface defines common behavior for objects whose location in the written file is managed by the <a href="fileformat.html#BAT">Block Allocation Table</a>.
         <br>
         It defines methods to get a count of the implementation's <a href="#BigBlock">BigBlock</a> instances ( <span class="codefrag">countBlocks</span> ), and to set an implementation's start block ( <span class="codefrag">setStartBlock</span> ).
         <div name="tsUpdate" data-id="t_5bd3ac60689a42aebd84f99bc89d3f70" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BlockAllocationTable">BlockAllocationTable
         <div name="tsUpdate" data-id="t_a1613f8bb6d64bfe87eb2dd5998079d5" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BlockAllocationTable</strong> is an implementation of the POIFS <a href="fileformat.html#BAT">Block Allocation Table</a>. It is only created when the <a href="#Filesystem"> Filesystem </a> is about to be written to an <span class="codefrag">OutputStream</span>.
         <br>
         It contains an <a href="#IntList">IntList</a> of block numbers for all of the <a href="#BATManaged">BATManaged</a> implementations owned by the Filesystem, <span class="codefrag">_entries</span> , which is filled by calls to <span class="codefrag">allocateSpace</span> .
         <br>
         It fills its array, <span class="codefrag">_blocks</span> , of <a href="#BATBlock">BATBlock</a> instances when its <span class="codefrag">createBATBlocks</span> method is called. This method has to take into account its own storage requirements, as well as those of the XBAT blocks, and so calls <span class="codefrag">BATBlock.calculateStorageRequirements</span> and <span class="codefrag">HeaderBlock.calculateXBATStorageRequirements</span> repeatedly until the counts returned by those methods stabilize.
         <br>
         The <span class="codefrag">countBlocks</span> method returns the number of BATBlock instances created by the preceding call to createBlocks.
         <div name="tsUpdate" data-id="t_34df9c7a6cb14d109e6673e8f78bd57e" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">BlockWritable
         <div name="tsUpdate" data-id="t_1a96a41409d1442ead3e8e1ba9ee48dd" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#BlockWritable">BlockWritable</a>
         <div name="tsUpdate" data-id="t_5fde6d8a4aa744a08a3658a04e513a6f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="Document">Document
         <div name="tsUpdate" data-id="t_c0bca8f72d4747a2a17d2b030086dbaa" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>Document</strong> class is used to contain a document, such as an HSSF workbook.
         <br>
         It has its own <a href="#DocumentProperty">DocumentProperty</a> ( <span class="codefrag">_property</span> ) and stores its data in a collection of <a href="#DocumentBlock">DocumentBlock</a> instances ( <span class="codefrag">_blocks</span> ).
         <br>
         It has a method, <span class="codefrag">getDocumentProperty</span> , to get its DocumentProperty.
         <div name="tsUpdate" data-id="t_af3e7efab94843f186029227bbe28cb2" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">DocumentBlock
         <div name="tsUpdate" data-id="t_5f702157a122447f9d4d1de3e401570a" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#DocumentBlock">DocumentBlock</a>
         <div name="tsUpdate" data-id="t_5d4d8c97338c4f2eb52cca9ae6079fef" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">DocumentProperty
         <div name="tsUpdate" data-id="t_a7a862012ced46dfbd9ecdd6cd93b244" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#DocumentProperty">DocumentProperty</a>
         <div name="tsUpdate" data-id="t_c885238163554e38b2de55e8a374b90d" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">HeaderBlock
         <div name="tsUpdate" data-id="t_bfe9bad5d39e44ca8208e0a1398b5c28" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#HeaderBlock">HeaderBlock</a>
         <div name="tsUpdate" data-id="t_1d838a6c86d94e3c869f0840b62e43c3" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">PropertyTable
         <div name="tsUpdate" data-id="t_2dfdafd7289640c5a32faf228df518a2" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">See the description in <a href="#PropertyTable">PropertyTable</a>
         <div name="tsUpdate" data-id="t_3d81c9d5e6704510a04a3315a8a5ef8b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="UtilityClasses"></a>
     <h3 class="boxed">Utility Classes and Interfaces
      <div name="tsUpdate" data-id="t_476aff8975774ae08d4fac6bd3392515" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The utility classes and interfaces are shown in the following class diagram.
      <div name="tsUpdate" data-id="t_e07ece6d65da421fbf8326416b2e5e13" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Utility Classes and Interfaces" src="images/utilClasses.gif"></p>
     <a name="BitField"></a><a name="ByteField"></a><a name="FixedField"></a><a name="HexDump"></a><a name="IntegerField"></a><a name="IntList"></a><a name="LittleEndian"></a><a name="LittleEndianConsts"></a><a name="LongField"></a><a name="ShortField"></a><a name="ShortList"></a><a name="StringUtil"></a>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Class/Interface
         <div name="tsUpdate" data-id="t_3d85f12f5d404ca2b927038ae07272ca" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_382b994594c04abc999bc5ae7da20f09" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="BitField">BitField
         <div name="tsUpdate" data-id="t_a897f739c48841e78cee9699b90a7eb7" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>BitField</strong> class is used primarily by HSSF code to manage bit-mapped fields of HSSF records. It is not likely to be used in the POIFS code itself and is only included here for the sake of complete documentation of the POI utility classes.
         <div name="tsUpdate" data-id="t_e807d9e865f947e9b668830c4d3ecb6f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="ByteField">ByteField
         <div name="tsUpdate" data-id="t_fd7fbb1aa7a244418b404c78792d374f" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>ByteField</strong> class is an implementation of <a href="#FixedField"> FixedField </a> for the purpose of managing reading and writing to a byte-wide field in an array of <span class="codefrag"> bytes</span>.
         <div name="tsUpdate" data-id="t_7396f883a51747f88d1dd328724a34ba" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="FixedField">FixedField
         <div name="tsUpdate" data-id="t_37b2af8766fe4330a82d02202e7b7771" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>FixedField</strong> interface defines a set of methods for reading a field from an array of <span class="codefrag">bytes</span> or from an <span class="codefrag">InputStream</span>, and for writing a field to an array of <span class="codefrag">bytes</span>. Implementations typically require an offset in their constructors that, for the purposes of reading and writing to an array of <span class="codefrag">bytes</span>, makes sure that the correct <span class="codefrag">bytes</span> in the array are read or written.
         <div name="tsUpdate" data-id="t_652b2ffec37d46e780b247bf95b56fcd" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="HexDump">HexDump
         <div name="tsUpdate" data-id="t_f516e33afad347968d1a7ec173d303c1" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>HexDump</strong> class is a debugging class that can be used to dump an array of <span class="codefrag"> bytes </span> to an <span class="codefrag">OutputStream</span>. The static method <span class="codefrag">dump</span> takes an array of <span class="codefrag">bytes</span>, a <span class="codefrag">long</span> offset that is used to label the output, an open <span class="codefrag">OutputStream</span>, and an <span class="codefrag">int</span> index that specifies the starting index within the array of <span class="codefrag">bytes</span>.
         <br>
         The data is displayed 16 bytes per line, with each byte displayed in hexadecimal format and again in printable form, if possible (a byte is considered printable if its value is in the range of 32 ... 126).
         <br>
         Here is an example of a small array of <span class="codefrag">bytes</span> with an offset of 0x110:
         <br>
         <div class="code">
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"></span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">00000110 C8 00 00 00 FF 7F 90 01 00 00 00 00 00 00 05 01 ................</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">00000120 41 00 72 00 69 00 61 00 6C 00 A.r.i.a.l.</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"> </span>
          </div>
         </div>
         <div name="tsUpdate" data-id="t_7c3f2ee5bf8a4cc283198a82cf2aaf89" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="IntegerField">IntegerField
         <div name="tsUpdate" data-id="t_018d2d22c9fa48149e0dee0e69e2477c" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>IntegerField</strong> class is an implementation of <a href="#FixedField"> FixedField </a> for the purpose of managing reading and writing to an integer-wide field in an array of <span class="codefrag">bytes</span>.
         <div name="tsUpdate" data-id="t_1dedc56376ce478ab342cc945f97e4d4" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="IntList">IntList
         <div name="tsUpdate" data-id="t_41aa91b06e6d4f379be7a88f277cdb9a" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>IntList</strong> class is a work-around for functionality missing in Java (see <a href="http://developer.java.sun.com/developer/bugParade/bugs/4487555.html"> http://developer.java.sun.com/developer/bugParade/bugs/4487555.html </a> for details); it is a simple growable array of <span class="codefrag">ints</span> that gets around the requirement of wrapping and unwrapping <span class="codefrag">ints</span> in <span class="codefrag">Integer</span> instances in order to use the <span class="codefrag">java.util.List</span> interface.
         <br>
         <strong>IntList</strong> mimics the functionality of the <span class="codefrag">java.util.List</span> interface as much as possible.
         <div name="tsUpdate" data-id="t_01b6245a9a42498e828b99599eb3f1d6" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="LittleEndian">LittleEndian
         <div name="tsUpdate" data-id="t_2a44f07c4afe4215a5e36fecbe923f73" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>LittleEndian</strong> class provides a set of static methods for reading and writing <span class="codefrag">shorts</span>, <span class="codefrag">ints</span>, <span class="codefrag">longs</span>, and <span class="codefrag">doubles</span> in and out of <span class="codefrag">byte</span> arrays, and out of <span class="codefrag">InputStreams</span>, preserving the Intel byte ordering and encoding of these values.
         <div name="tsUpdate" data-id="t_f53d3351397a4cbb9c98b188e11ce45b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="LittleEndianConsts">LittleEndianConsts
         <div name="tsUpdate" data-id="t_a3ec843547904d4da8a6e853fa5ede7b" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>LittleEndianConsts</strong> interface defines the width of a <span class="codefrag">short</span>, <span class="codefrag">int</span>, <span class="codefrag">long</span>, and <span class="codefrag">double</span> as stored by Intel processors.
         <div name="tsUpdate" data-id="t_e02d3cab6c7e4226beea4fc6edb5a83d" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="LongField">LongField
         <div name="tsUpdate" data-id="t_9d4bccee55884de68d9bea14d40d068d" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>LongField</strong> class is an implementation of <a href="#FixedField"> FixedField </a> for the purpose of managing reading and writing to a long-wide field in an array of <span class="codefrag"> bytes</span>.
         <div name="tsUpdate" data-id="t_65dfa608708b498ab6e3e0f3670f0e33" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="ShortField">ShortField
         <div name="tsUpdate" data-id="t_d3db46ff8c1c4fbabd84fa0684aab070" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>ShortField</strong> class is an implementation of <a href="#FixedField"> FixedField </a> for the purpose of managing reading and writing to a short-wide field in an array of <span class="codefrag"> bytes</span>.
         <div name="tsUpdate" data-id="t_cc9c01861dc147c09cfffc7acc359a64" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="ShortList">ShortList
         <div name="tsUpdate" data-id="t_263e9b1db4c747b49c087d20a3f6fb06" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>ShortList</strong> class is a work-around for functionality missing in Java (see <a href="http://developer.java.sun.com/developer/bugParade/bugs/4487555.html"> http://developer.java.sun.com/developer/bugParade/bugs/4487555.html </a> for details); it is a simple growable array of <span class="codefrag">shorts</span> that gets around the requirement of wrapping and unwrapping <span class="codefrag">shorts</span> in <span class="codefrag">Short</span> instances in order to use the <span class="codefrag">java.util.List</span> interface.
         <br>
         <strong>ShortList</strong> mimics the functionality of the <span class="codefrag">java.util.List</span> interface as much as possible.
         <div name="tsUpdate" data-id="t_d739f2141c0e471d947d12fe854f0f4e" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1" id="StringUtil">StringUtil
         <div name="tsUpdate" data-id="t_269031193910496a8d2f07a27b43cd40" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <strong>StringUtil</strong> class manages the processing of Unicode strings.
         <div name="tsUpdate" data-id="t_3ad970d878384e1e9bc2bf77eaf2affd" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
    </div>
    <a name="Scenarios"></a>
    <h2 class="boxed">Scenarios
     <div name="tsUpdate" data-id="t_c68dc018e8814adb832730dffee70ad7" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>This section describes the scenarios of how the POIFS classes and interfaces will be used to convert an appropriate XML stream to a POIFS output stream containing an HSSF document.
      <div name="tsUpdate" data-id="t_025ef5265778488d9c8fe775e81a11c7" data-tpl="0" data-txt-color="green"></div></p>
     <p>It is broken down as suggested by the following scenario diagram:
      <div name="tsUpdate" data-id="t_59548d56fdb1434da1581461d0ba2593" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="POIFS LifeCycle" src="images/POIFSLifeCycle.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_a673b01cb5214fe8af0d9fcd042c3e53" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_30e71c3fc7fe4a44af156331743ace88" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_2bd1fa5fa566428e95a2ce87758cab7f" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1"><a href="#Initialization">The Filesystem is created by the client application. </a>
         <div name="tsUpdate" data-id="t_e31a967d616348daabd9c9d2eb444224" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_553707282ada4063baf1fa4b6ea89157" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1"><a href="#CreateDocument">The client application tells the Filesystem to create a document</a>, providing an <span class="codefrag">InputStream</span> and the name of the document. This may be repeated several times.
         <div name="tsUpdate" data-id="t_5b78b5abdaf44c0c90e31b6efb48c9ee" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_e0bb58ae6baa4194aa880d28ae2c9833" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1"><a href="#Initialization">The client application asks the Filesystem to write its data to an <span class="codefrag">OutputStream</span>. </a>
         <div name="tsUpdate" data-id="t_fd0daeb269c0473f9198f6226ce65a82" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="Initialization"></a>
     <h3 class="boxed">Initialization
      <div name="tsUpdate" data-id="t_dd824d97fa514783907aec6854d8e4e2" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Initialization of the POIFS system is shown in the following scenario diagram:
      <div name="tsUpdate" data-id="t_2ef1b086d670413897adc9692e503e26" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Initialization" src="images/POIFSInitialization.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_9b8c49c46b7942e0aa769268ff8454eb" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_7dce8278fde14fe2b62a0f1e827899a9" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_228faa89f0dd45889cdbbfddb2ef07de" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> object, which is created for each request to convert an appropriate XML stream to a POIFS output stream containing an HSSF document, creates its <a href="#PropertyTable"> PropertyTable</a>.
         <div name="tsUpdate" data-id="t_657a9ebbe7cb4b1f99a6dcc48094cd1b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_abab1c7681f741bf8348822b6b8552f4" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyTable">PropertyTable</a> creates its <a href="#RootProperty">RootProperty</a> instance, making the RootProperty the first <a href="#Property">Property</a> in its <span class="codefrag">List</span> of Property instances.
         <div name="tsUpdate" data-id="t_a483c191719a4ba3889ef8b8193885d5" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_cea55b10e47349bf88b466b8fc3abef8" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> creates its <a href="#HeaderBlock">HeaderBlock</a> instance. It should be noted that the decision to create the HeaderBlock at Filesystem initialization is arbitrary; creation of the HeaderBlock could easily and harmlessly be postponed to the appropriate moment in <a href="#WriteFilesystem">writing the filesystem</a>.
         <div name="tsUpdate" data-id="t_2eb168ade66b493f9d09bbc46ceb651f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="CreateDocument"></a>
     <h3 class="boxed">Creating a Document
      <div name="tsUpdate" data-id="t_66f1c6bc869641a9a9b492d72dcc4f34" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Creating and adding a document to a POIFS system is shown in the following scenario diagram:
      <div name="tsUpdate" data-id="t_a8c0d27d077f48a9b650780ae678767f" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Add Document" src="images/POIFSAddDocument.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_b915b7669f0943cc8c46a683bdb9d7d4" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_916b30c6a6404be7abaf4662cd1a0f8c" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_a6df170ae19946fc9697d6dda084c2a2" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> instance creates a new <a href="#Document">Document</a> instance. It will store the newly created Document in a <span class="codefrag">List</span> of <a href="#BATManaged">BATManaged</a> instances.
         <div name="tsUpdate" data-id="t_82a513d565e7462cb553dd48adb0723d" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_63609e39cd044d04819b77596ce1faa2" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Document">Document</a> reads data from the provided <span class="codefrag">InputStream</span>, storing the data in <a href="#DocumentBlock">DocumentBlock</a> instances. It keeps track of the byte count as it reads the data.
         <div name="tsUpdate" data-id="t_a49e1ead88e4489da84dc706f2c030e9" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_c935373697134ac3aa2b56dccaf0ee09" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Document">Document</a> creates a <a href="#DocumentProperty">DocumentProperty</a> to keep track of its property data. The byte count is stored in the newly created DocumentProperty instance.
         <div name="tsUpdate" data-id="t_dfde676fdd754b8a8dce5513dd4cae41" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">4
         <div name="tsUpdate" data-id="t_43c944bbfb704c3c8c5e656e99de1a7b" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> requests the newly created <a href="#DocumentProperty">DocumentProperty</a> from the newly created <a href="#Document">Document</a> instance.
         <div name="tsUpdate" data-id="t_6b2e6f596eac446fb2e6c42e68ae316d" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">5
         <div name="tsUpdate" data-id="t_ef3b2fa322e44676b1c10c3ea2682ff4" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> sends the newly created <a href="#DocumentProperty">DocumentProperty</a> to the Filesystem's <a href="#PropertyTable">PropertyTable</a> so that the PropertyTable can add the DocumentProperty to its <span class="codefrag">List</span> of <a href="#Property">Property</a> instances.
         <div name="tsUpdate" data-id="t_f1cd5ad506b740729428dade63cd313b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">6
         <div name="tsUpdate" data-id="t_e8cedfbf58e54a669c05553340518167" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> gets the <a href="#RootProperty">RootProperty</a> from its <a href="#PropertyTable">PropertyTable</a>.
         <div name="tsUpdate" data-id="t_55bccd0a2c944d3b8fe3199462dc92d6" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">7
         <div name="tsUpdate" data-id="t_fec927f60c6547f3acacfa3e6d46db07" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> adds the newly created <a href="#DocumentProperty">DocumentProperty</a> to the <a href="#RootProperty">RootProperty</a>.
         <div name="tsUpdate" data-id="t_87609ca56a8041a18763f606b0393832" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <p>Although typical deployment of the POIFS system will only entail adding a single <a href="#Document"> Document </a> (the workbook) to the <a href="#Filesystem">Filesystem</a>, there is nothing in the design to prevent multiple Documents from being added to the Filesystem. This flexibility can be employed to write summary information document(s) in addition to the workbook.
      <div name="tsUpdate" data-id="t_3ed5dce93efb4d5b80c0508dbab1173e" data-tpl="0" data-txt-color="green"></div></p>
     <a name="WriteFilesystem"></a>
     <h3 class="boxed">Writing the Filesystem
      <div name="tsUpdate" data-id="t_3642bbcbb1d5480cba0c56ed1090d340" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Writing the filesystem is shown in the following scenario diagram:
      <div name="tsUpdate" data-id="t_1eb18cfc27e449359b2b067a37c9e6ee" data-tpl="0" data-txt-color="green"></div></p>
     <p><img alt="Writing the Filesystem" src="images/POIFSWriteFilesystem.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_36d7df4f21c74e679e81ae1bc78e1bb4" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="2" rowspan="1">Description
         <div name="tsUpdate" data-id="t_12d5e9ee94ec465194f752d3bf490d89" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_b74fb58299c5439cb38d64efd4f11b01" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> adds the <a href="#PropertyTable">PropertyTable</a> to its <span class="codefrag">List</span> of <a href="#BATManaged">BATManaged</a> instances and calls the PropertyTable's <span class="codefrag">preWrite</span> method. The action taken by the PropertyTable is shown in the <a href="#PropertyTablePreWrite">PropertyTable preWrite scenario diagram</a>.
         <div name="tsUpdate" data-id="t_716a5f066af346dba6a9b23f9b850a47" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_fbed144e98b04c83bc554a3a7ed516a9" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> creates the <a href="#BlockAllocationTable">BlockAllocationTable</a>.
         <div name="tsUpdate" data-id="t_24d767e7a58d48269bfe3fe63f97a7a8" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_5bfa2f01098d40679148cb2eb1a28791" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> gets the block count from the <a href="#BATManaged">BATManaged</a> instance.
         <div name="tsUpdate" data-id="t_0df1fd4ca62940c5a70d9e541d452f7f" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="3">These three steps are repeated for each <a href="#BATManaged">BATManaged</a> instance in the <a href="#Filesystem">Filesystem</a>'s <span class="codefrag">List</span> of BATManaged instances (i.e., the <a href="#Document">Documents</a>, in order of their addition to the Filesystem, followed by the <a href="#PropertyTable">PropertyTable</a>).
         <div name="tsUpdate" data-id="t_df3dc9b878c042d99beded69569111f6" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">4
         <div name="tsUpdate" data-id="t_5491550cd26644e1be738799347d0b75" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> sends the block count to the <a href="#BlockAllocationTable"> BlockAllocationTable</a>, which adds the appropriate entries to is <a href="#IntList"> IntList </a> of entries, returning the starting block for the newly added entries.
         <div name="tsUpdate" data-id="t_8a440205b7a44a52bf963cf49db090a9" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">5
         <div name="tsUpdate" data-id="t_b7b16926763d40f5acbb3a0fbddcd9dc" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#Filesystem">Filesystem</a> gives the start block number to the <a href="#BATManaged">BATManaged</a> instance. If the BATManaged instance is a <a href="#Document">Document</a>, it sets the start block field in its <a href="#DocumentProperty">DocumentProperty</a>.
         <div name="tsUpdate" data-id="t_5e6f9a5a70cc472dab9c1990bc839570" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">6
         <div name="tsUpdate" data-id="t_5cdb20db8cda4304ac1f6dfa7f003d17" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> tells the <a href="#BlockAllocationTable">BlockAllocationTable</a> to create its <a href="#BATBlock">BatBlocks</a>.
         <div name="tsUpdate" data-id="t_2d385910e1ac4f5685c9696f3a6ed5ed" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">7
         <div name="tsUpdate" data-id="t_e05f6bc70100447fa5b5ce8318c8cd2b" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> gives the BAT information to the <a href="#HeaderBlock">HeaderBlock</a> so that it can set its BAT fields and, if necessary, create XBAT blocks.
         <div name="tsUpdate" data-id="t_65a44cbccfbd424386d6c736bc6780b4" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">8
         <div name="tsUpdate" data-id="t_3e31714b31364ae39a9e5a03187d68a1" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">If the filesystem is unusually large (over <strong>7MB</strong>), the <a href="#HeaderBlock">HeaderBlock</a> will create XBAT blocks to contain the BAT data that it cannot hold directly. In this case, the <a href="#Filesystem">Filesystem</a> tells the HeaderBlock where those additional blocks will be stored.
         <div name="tsUpdate" data-id="t_98c4a2cacbe940d2baa8130803bc5a0e" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">9
         <div name="tsUpdate" data-id="t_8e8586055a5743e1a8d1175e96f85a27" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> gives the <a href="#PropertyTable">PropertyTable</a> start block to the <a href="#HeaderBlock">HeaderBlock</a>.
         <div name="tsUpdate" data-id="t_9f3c0daff65a4a06928d3b33084d438f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">10
         <div name="tsUpdate" data-id="t_3dc5dda630ff46d99bff9686a300c448" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#Filesystem">Filesystem</a> tells the <a href="#BlockWritable">BlockWritable</a> instance to write its blocks to the provided <span class="codefrag">OutputStream</span>.
         <br>
         This step is repeated for each BlockWritable instance, in this order:
         <br>
         <ol>
          <li>The <a href="#HeaderBlock">HeaderBlock</a>.
           <div name="tsUpdate" data-id="t_abf6e2bfe77640389715b36a3cb70f74" data-tpl="0" data-txt-color="green"></div></li>
          <li>Each <a href="#Document">Document</a>, in the order in which it was added to the <a href="#Filesystem">Filesystem</a>.
           <div name="tsUpdate" data-id="t_b429f2f414724ab3beda27fd24967f18" data-tpl="0" data-txt-color="green"></div></li>
          <li>The <a href="#PropertyTable">PropertyTable</a>.
           <div name="tsUpdate" data-id="t_b4ba28ec78f846d38a5acc35f93305b2" data-tpl="0" data-txt-color="green"></div></li>
          <li>The <a href="#BlockAllocationTable">BlockAllocationTable</a>
           <div name="tsUpdate" data-id="t_a824ebb2d5f94e9284b66ab899ca5494" data-tpl="0" data-txt-color="green"></div></li>
          <li>The XBAT blocks created by the <a href="#HeaderBlock">HeaderBlock</a>, if any.
           <div name="tsUpdate" data-id="t_fec55bfe9591481092f96b1ede6d399f" data-tpl="0" data-txt-color="green"></div></li>
         </ol>
         <div name="tsUpdate" data-id="t_e1d542986a6c4596b65a8e1d69de32c5" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="PropertyTablePreWrite"></a>
     <h3 class="boxed">PropertyTable preWrite scenario diagram
      <div name="tsUpdate" data-id="t_1c1d94aa8b6f4d2dab576e9c1573c1e9" data-tpl="0" data-txt-color="orange"></div></h3>
     <p><img alt="PropertyTable preWrite scenario diagram" src="images/POIFSPropertyTablePreWrite.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_e66824b09b7441b58c6dbed25559f78a" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Description
         <div name="tsUpdate" data-id="t_b505fb926c4844f9ad20a206477ce597" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_09467a03391e40468dc59889e46d78f9" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyTable">PropertyTable</a> calls <span class="codefrag">setIndex</span> for each of its <a href="#Property">Property</a> instances, so that each Property now knows its index within the PropertyTable's <span class="codefrag">List </span> of Property instances.
         <div name="tsUpdate" data-id="t_8722b9a832f44580894e390f0ffdcc98" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_6995c4b41d9d4420a8259de0fdc886c5" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyTable">PropertyTable</a> requests the <a href="#PropertyBlock">PropertyBlock</a> class to create an array of <a href="#PropertyBlock">PropertyBlock</a> instances.
         <div name="tsUpdate" data-id="t_0e6b9c42600b4196b553a321c21fac4a" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_fcfe14b3e1ff482f8faf2991c4ccf2ab" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyBlock">PropertyBlock</a> calculates the number of empty <a href="#Property">Property</a> instances it needs to create and creates them. The algorithm for the number to create is:
         <br>
         <div class="code">
          <div class="codeline">
           <span class="lineno"></span><span class="codebody"></span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">block_count = (properties.size() + 3) / 4;</span>
          </div>
          <div class="codeline">
           <span class="lineno"></span><span class="codebody">emptyPropertiesNeeded = (block_count * 4) - properties.size();</span>
          </div>
         </div>
         <div name="tsUpdate" data-id="t_8888c8c8cbab4bab9ff3586a8e22665f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">4
         <div name="tsUpdate" data-id="t_cb16179a14ec4385afc51104998d0a7f" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyBlock">PropertyBlock</a> creates the required number of <a href="#PropertyBlock">PropertyBlock</a> instances from the <span class="codefrag">List</span> of <a href="#Property">Property</a> instances, including the newly created empty <a href="#Property">Property</a> instances.
         <div name="tsUpdate" data-id="t_83138487cd2449e4a17971967b6bd33a" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">5
         <div name="tsUpdate" data-id="t_37091f3947664803852d8508704cfb4d" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#PropertyTable">PropertyTable</a> calls <span class="codefrag">preWrite</span> on each of its <a href="#Property">Property</a> instances. For <a href="#DocumentProperty">DocumentProperty</a> instances, this call is a no-op. For the <a href="#RootProperty">RootProperty</a>, the action taken is shown in the <a href="#RootPropertyPreWrite">RootProperty preWrite scenario diagram</a>.
         <div name="tsUpdate" data-id="t_c3975a3e5eea4ff9a571609f99d45897" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <a name="RootPropertyPreWrite"></a>
     <h3 class="boxed">RootProperty preWrite scenario diagram
      <div name="tsUpdate" data-id="t_5db4d84ae0744c8a93f0fdde338c91f9" data-tpl="0" data-txt-color="orange"></div></h3>
     <p><img alt="RootProperty preWrite scenario diagram" src="images/POIFSRootPropertyPreWrite.gif"></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Step
         <div name="tsUpdate" data-id="t_367caef376bd4b63b9b9524de6fbe590" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="2" rowspan="1">Description
         <div name="tsUpdate" data-id="t_28fa4e154b524869a066f2b44cbc8c95" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_addac81a278946609d2d4b9b0245e7af" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="2" rowspan="1">The <a href="#RootProperty">RootProperty</a> sets its child property with the index of the child <a href="#Property">Property</a> that is first in its <span class="codefrag">List</span> of children.
         <div name="tsUpdate" data-id="t_5233e6d3cf1447e4b7a74ec749af7da5" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_1e551f3e061e4e90b2c1d0f3d8fd10e3" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#RootProperty">RootProperty</a> sets its child's next property field with the index of the child's next sibling in the RootProperty's <span class="codefrag">List</span> of children. If the child is the last in the <span class="codefrag">List</span>, its next property field is set to <span class="codefrag">-1</span>.
         <div name="tsUpdate" data-id="t_a689ba687f634bd582acb45999f21113" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="2">These two steps are repeated for each <a href="#File">File</a> in the <a href="#RootProperty"> RootProperty</a>'s <span class="codefrag">List</span> of children.
         <div name="tsUpdate" data-id="t_ee284abdc5f6436ca6511964810f3361" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <th colspan="1" rowspan="1">3
         <div name="tsUpdate" data-id="t_3a3a954a9b0d4a278f9d971ec5c54a47" data-tpl="0" data-txt-color="green"></div></th>
        <td colspan="1" rowspan="1">The <a href="#RootProperty">RootProperty</a> sets its child's previous property field with a value of <span class="codefrag">-1</span>.
         <div name="tsUpdate" data-id="t_bfed156c1dbe476a91cefdd445eb41dc" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright  2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/poifs/design.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='56a6a8d022d84511bdd8ed67e55fe59f';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>