<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - Logging Framework</title>
  <link type="text/css" href="../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../skin/profile.css" rel="stylesheet">
  <script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../layui/css/layui.css" rel="stylesheet">
  <script src="../js/jquery.min.js"></script>
  <script src="../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Apache POI - Logging Framework
     <div name="tsUpdate" data-id="t_07be8fc4277947f9abe76af194ece76b" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="Introduction"></a>
    <h2 class="boxed">Introduction
     <div name="tsUpdate" data-id="t_7fa53ffa912346bcb16b150ec7c6a41e" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>POI uses a custom logging framework which allows to configure where logs are sent to.
      <div name="tsUpdate" data-id="t_0f5b623f59ff4455a03bad2a82e3e425" data-tpl="0" data-txt-color="green"></div></p>
     <p>Logging in POI is used only as a debugging mechanism, not a normal runtime logging system. Logging on level debug/info is ONLY for autopsie type debugging, and should NEVER be enabled on a production system.
      <div name="tsUpdate" data-id="t_9db22f2d0dc54ecd87dfd811f5531c38" data-tpl="0" data-txt-color="green"></div></p>
     <p>The framework is extensible so that you can send log messages to any logging framework that your application uses.
      <div name="tsUpdate" data-id="t_40b05e92e6534701b958494f2411ecb1" data-tpl="0" data-txt-color="green"></div></p>
     <p>A number of default logging implementations are supported by POI out-of-the-box and can be selected via a system property.
      <div name="tsUpdate" data-id="t_634c1fc3e95940ab850e119426dbd84b" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Enable+logging"></a>
    <h2 class="boxed">Enable logging
     <div name="tsUpdate" data-id="t_6fddca94413d4da6b0ed8584a898d9bf" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>By default, logging is disabled in POI. Sometimes it might be useful to enable logging to see some debug messages printed out which can help in analyzing problems.
      <div name="tsUpdate" data-id="t_4e81bd45b5754fc8ac5246006951be8f" data-tpl="0" data-txt-color="green"></div></p>
     <p>You can select the logging framework by setting the system property <em>org.apache.poi.util.POILogger</em> during application startup or by calling System.setProperty():
      <div name="tsUpdate" data-id="t_16993e15c3214ef4b98e1fee05b37e9a" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">System.setProperty("org.apache.poi.util.POILogger", "org.apache.poi.util.CommonsLogger" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p>Note: You need to call <em>setProperty()</em> before any POI functionality is invoked as the logger is only initialized during startup.
      <div name="tsUpdate" data-id="t_347c33ce30e647dd99abeebad5c400eb" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Available+logger+implementations"></a>
    <h2 class="boxed">Available logger implementations
     <div name="tsUpdate" data-id="t_56dc81e93710411bb449fcc917470715" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>The following logger implementations are provided by POI:
      <div name="tsUpdate" data-id="t_ac607451b0834590a0f775fc7180e0a0" data-tpl="0" data-txt-color="green"></div></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Class
         <div name="tsUpdate" data-id="t_66d5446cc93c42749c46700871103785" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Type
         <div name="tsUpdate" data-id="t_01d5929a94004180ad97db1da7d14ed3" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">org.apache.poi.util.SystemOutLogger
         <div name="tsUpdate" data-id="t_5210747dff2740028641061203178bb7" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Sends log output to the system console
         <div name="tsUpdate" data-id="t_8a3d7a5fdc2544dfb4fb395dd76204cc" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">org.apache.poi.util.NullLogger
         <div name="tsUpdate" data-id="t_80819253e3234af6a0c134b9e61d1eb5" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Default logger, does not log anything
         <div name="tsUpdate" data-id="t_50e3842a1cc84cb3aa5740f9fd790f2a" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">org.apache.poi.util.CommonsLogger
         <div name="tsUpdate" data-id="t_e07fa89c5f0f40c2a160d1819fdec507" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Allows to use <a href="https://commons.apache.org/proper/commons-logging/">Apache Commons Logging</a> for logging. This can use JDK1.4 logging, log4j, logkit, etc. The log4j dependency was removed in POI 5.0.0, so you will need to include this dependency yourself if you need it.
         <div name="tsUpdate" data-id="t_b5ff0ca066504eb79003863d1ca26caa" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">org.apache.poi.util.DummyPOILogger
         <div name="tsUpdate" data-id="t_3d1d6c24e89949109e98e3f5f8e030bb" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">Simple logger which will keep all log-lines in memory for later analysis (this class is not in the jar, just in the test source). Used primarily for testing. Note: this may cause a memory leak if used in production application!
         <div name="tsUpdate" data-id="t_d517f9b2cc8a4cabb3676cef6b2adc3f" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
    </div>
    <a name="Sending+logs+to+a+different+log+framework"></a>
    <h2 class="boxed">Sending logs to a different log framework
     <div name="tsUpdate" data-id="t_01e6ff0f054b4ed1b43a65cd5812c0e4" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>You can send logs to other logging frameworks by implementing the interface <em>org.apache.poi.util.POILogger</em>.
      <div name="tsUpdate" data-id="t_9b7c334be2d545e58d2184e6356da6ed" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Implementation+details"></a>
    <h2 class="boxed">Implementation details
     <div name="tsUpdate" data-id="t_2f4bf3da74284c13b256d5ccd1ecaf79" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Every class uses a <span class="codefrag">POILogger</span> to log, and gets it using a static method of the <span class="codefrag">POILogFactory</span> .
      <div name="tsUpdate" data-id="t_89a230d2ced6476bb55ebd3b147c4345" data-tpl="0" data-txt-color="green"></div></p>
     <p>Each class in POI can log using a <span class="codefrag">POILogger</span>, which is an abstract class. We decided to make our own logging facade because:
      <div name="tsUpdate" data-id="t_e51ab9d045114aa9bd2db3a611fc92a3" data-tpl="0" data-txt-color="green"></div></p>
     <ol>
      <li>we need to log many values and we put many methods in this class to facilitate the programmer, without having him write string concatenations;
       <div name="tsUpdate" data-id="t_39c375a4e9c5401696f9e08f13f19127" data-tpl="0" data-txt-color="green"></div></li>
      <li>we need to be able to use POI without any logger package present.
       <div name="tsUpdate" data-id="t_9707dbca1cd0401691d3cba5b55894a9" data-tpl="0" data-txt-color="green"></div></li>
     </ol>
    </div>
    <p align="right"><font size="-2">by&nbsp;Dominik Stadler</font>
     <div name="tsUpdate" data-id="t_c436b62e6e574113ba76013d789fdb92" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/logging.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='4298d8ef14aa4b1488e7c14bf55adf60';</script>
  <script src="../js/xst-update.js"></script>
 </body>
</html>