<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Upgrading to POI 3.5, including converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Upgrading to POI 3.5, including converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)
     <div name="tsUpdate" data-id="t_bc464e5f71424580b8c5f9a52b4ca875" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="Things+that+have+to+be+changed+when+upgrading+to+POI+3.5"></a>
    <h2 class="boxed">Things that have to be changed when upgrading to POI 3.5
     <div name="tsUpdate" data-id="t_f9201cb1fc684fca90ea3f59a05ce428" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Wherever possible, we have tried to ensure that you can use your existing POI code with POI 3.5 without requiring any changes. However, Java doesn't always make that easy, and unfortunately there are a few changes that may be required for some users.
      <div name="tsUpdate" data-id="t_d901aaeaf9d646ee87b673199155d981" data-tpl="0" data-txt-color="green"></div></p>
     <a name="org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue"></a>
     <h3 class="boxed">org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue
      <div name="tsUpdate" data-id="t_ee8bed696d0045bcb88c67861d4280e0" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Annoyingly, java will not let you access a static inner class via a child of the parent one. So, all references to <em>org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue</em> will need to be changed to <em>org.apache.poi.ss.usermodel.FormulaEvaluator.CellValue</em>
      <div name="tsUpdate" data-id="t_467384ac633249ea9ed05595074a6e26" data-tpl="0" data-txt-color="green"></div></p>
     <a name="org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy"></a>
     <h3 class="boxed">org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy
      <div name="tsUpdate" data-id="t_ef990f37cf5d418cad4d1539fe9db105" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Annoyingly, java will not let you access a static inner class via a child of the parent one. So, all references to <em>org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy</em> will need to be changed to <em>org.apache.poi.ss.usermodel.Row.MissingCellPolicy</em>
      <div name="tsUpdate" data-id="t_20b3cadb3fd34523868e590bfde27111" data-tpl="0" data-txt-color="green"></div></p>
     <a name="DDF+and+org.apache.poi.hssf.record.RecordFormatException"></a>
     <h3 class="boxed">DDF and org.apache.poi.hssf.record.RecordFormatException
      <div name="tsUpdate" data-id="t_48add1437ca84af39e57d13e9c954e77" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Previously, record level errors within DDF would throw an exception from the hssf class hierarchy. Now, record level errors within DDF will throw a more general RecordFormatException, <em>org.apache.poi.util.RecordFormatException</em>
      <div name="tsUpdate" data-id="t_1d0448677caf445eb74b27b84cf54399" data-tpl="0" data-txt-color="green"></div></p>
     <p>In addition, org.apache.poi.hssf.record.RecordFormatException has been changed to inherit from the new <em>org.apache.poi.util.RecordFormatException</em>, so you may wish to change catches of the hssf version to the new util version.
      <div name="tsUpdate" data-id="t_456f8f78eac24dc29238256d06e7e153" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Converting+existing+HSSF+Usermodel+code+to+SS+Usermodel+%28for+XSSF+and+HSSF%29"></a>
    <h2 class="boxed">Converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)
     <div name="tsUpdate" data-id="t_c84b9dde21de4e7bb0045d17c34936e4" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <a name="Why+change%3F"></a>
     <h3 class="boxed">Why change?
      <div name="tsUpdate" data-id="t_6a380a4b9dfe4e4c951887f8a2107a4f" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>If you have existing HSSF usermodel code that works just fine, and you don't want to use the new OOXML XSSF support, then you probably don't need to. Your existing HSSF only code will continue to work just fine.
      <div name="tsUpdate" data-id="t_060b54d207c04840b3167165df3c9723" data-tpl="0" data-txt-color="green"></div></p>
     <p>However, if you want to be able to work with both HSSF for your .xls files, and also XSSF for .xslx files, then you will need to make some slight tweaks to your code.
      <div name="tsUpdate" data-id="t_172d866be8d949f69529026640207b0a" data-tpl="0" data-txt-color="green"></div></p>
     <a name="org.apache.poi.ss.usermodel"></a>
     <h3 class="boxed">org.apache.poi.ss.usermodel
      <div name="tsUpdate" data-id="t_faccfbee246440e28c572f9c468afbbb" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The new SS usermodel (org.apache.poi.ss.usermodel) is very heavily based on the old HSSF usermodel (org.apache.poi.hssf.usermodel). The main difference is that the package name and class names have been tweaked to remove HSSF from them. Otherwise, the new SS Usermodel interfaces should provide the same functionality.
      <div name="tsUpdate" data-id="t_85541e59619c4c70adba062a14104ec2" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Constructors"></a>
     <h3 class="boxed">Constructors
      <div name="tsUpdate" data-id="t_5865371b5ee24ffd95e6f25dd5286458" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Calling the empty HSSFWorkbook remains as the way to create a new, empty Workbook object. To open an existing Workbook, you should now call WorkbookFactory.create(inp).
      <div name="tsUpdate" data-id="t_20f34178ea944ede9597afca154be7c2" data-tpl="0" data-txt-color="green"></div></p>
     <p>For all other cases when you would have called a Usermodel constructor, such as 'new HSSFRichTextString()' or 'new HSSFDataFormat', you should instead use a CreationHelper. There's a method on the Workbook to get a CreationHelper, and the CreationHelper will then handle constructing new objects for you.
      <div name="tsUpdate" data-id="t_92e78fadff4d4c63a3801779e6bff194" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Other+Code"></a>
     <h3 class="boxed">Other Code
      <div name="tsUpdate" data-id="t_b35586007c4741ff87f70d7e5b4b2810" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>For all other code, generally change a reference from org.apache.poi.hssf.usermodel.HSSFFoo to a reference to org.apache.poi.ss.usermodel.Foo. Method signatures should otherwise remain the same, and it should all then work for both XSSF and HSSF.
      <div name="tsUpdate" data-id="t_40c060c9648b4ebab35d8094e9fb8e60" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Worked+Examples"></a>
    <h2 class="boxed">Worked Examples
     <div name="tsUpdate" data-id="t_bfa12b22ded848a6ba3a5a8c1c777870" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <a name="Old+HSSF+Code"></a>
     <h3 class="boxed">Old HSSF Code
      <div name="tsUpdate" data-id="t_a6aa8f63754942e5a92bc8e230a388f2" data-tpl="0" data-txt-color="orange"></div></h3>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.hssf.usermodel.*;</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f25b7b2eec794e769dd286fa30125363" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5ea3ddd9cbfa4cf8ab8a58c5ca76edde" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet s = wb.createSheet();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a row object reference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_78a3534098624d7895a0451775374c10" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRow r = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a cell object reference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4d501a36c3f94ba6a9bd1e0470e296a3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell c = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 2 cell styles</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4868f033e88f48009a604e85032e27a0" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle cs2 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFDataFormat df = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 2 fonts objects</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_53b1986a87db44f381b7d744e296dd72" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont f = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont f2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set font 1 to 12 point type, blue and bold</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_a9ecef345b0a4f5f97292bae3cb734cd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setFontHeightInPoints((short) 12);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setColor( HSSFColor.RED.index );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set font 2 to 10 point type, red and bold</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7907a0315560440594002bb619b1e18b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setFontHeightInPoints((short) 10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setColor( HSSFFont.RED.index );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set cell style and formatting</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2658aada698f49b4b29a9994e8c21c99" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setFont(f);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setDataFormat(df.getFormat("#,##0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the other cell style and formatting</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_75c1e062d5144f3299232e15d3332fde" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setBorderBottom(cs2.BORDER_THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setDataFormat(HSSFDataFormat.getBuiltinFormat("text"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setFont(f2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Define a few rows</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ba5536842063416ebfc81dfb6e0eab73" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(short rownum = (short)0; rownum &lt; 30; rownum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFRow r = s.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(short cellnum = (short)0; cellnum &lt; 10; cellnum += 2) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFCell c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFCell c2 = r.createCell(cellnum+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue((double)rownum + (cellnum/10));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c2.setCellValue(new HSSFRichTextString("Hello! " + cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Save</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_726d18ba2e48423e8077b06fc27ed020" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FileOutputStream out = new FileOutputStream("workbook.xls");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="New%2C+generic+SS+Usermodel+Code"></a>
     <h3 class="boxed">New, generic SS Usermodel Code
      <div name="tsUpdate" data-id="t_a4002e392ac348b1a701195076cf8203" data-tpl="0" data-txt-color="orange"></div></h3>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.ss.usermodel.*;</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e5cbcb3785284ca3b46cab928cf34ee8" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook[] wbs = new Workbook[] { new HSSFWorkbook(), new XSSFWorkbook() };</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(int i=0; i&lt;wbs.length; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Workbook wb = wbs[i];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a new sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3a7e071be6204966bf4e554846e65fcd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.createSheet();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // declare a row object reference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_03818648bced4cc6b16156d32bc04195" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // declare a cell object reference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1e6cf3327f904ed589133e7871edabb8" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create 2 cell styles</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f6db35e8ac994c409b80da7d2d5e5d69" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cs2 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DataFormat df = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create 2 fonts objects</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_22805066dcf14cebb97985e60f5d45f0" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font f = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font f2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set font 1 to 12 point type, blue and bold</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_8d43b253c5c641c99490f02414847ed7" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setFontHeightInPoints((short) 12);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setColor( IndexedColors.RED.getIndex() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set font 2 to 10 point type, red and bold</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9a7238ee0d2c4cfdac8e1071623a0e4a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setFontHeightInPoints((short) 10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setColor( IndexedColors.RED.getIndex() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set cell style and formatting</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4ee51c75d7fa45b4983948dc0352a03b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs.setFont(f);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs.setDataFormat(df.getFormat("#,##0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set the other cell style and formatting</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_39c060acb6ed45d99004c8219fc8169f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setBorderBottom(cs2.BORDER_THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setDataFormat(df.getFormat("text"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setFont(f2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Define a few rows</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3d8073ee69b442668bf88502dbab796c" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 0; rownum &lt; 30; rownum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = s.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int cellnum = 0; cellnum &lt; 10; cellnum += 2) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c2 = r.createCell(cellnum+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue((double)rownum + (cellnum/10));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c2.setCellValue(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createRichTextString("Hello! " + cellnum)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Save</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_faec01e2fb944ce7b7e6c57830d6332d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String filename = "workbook.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(wb instanceof XSSFWorkbook) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> filename = filename + "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileOutputStream out = new FileOutputStream(filename);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <p align="right"><font size="-2">by&nbsp;Nick Burch</font>
     <div name="tsUpdate" data-id="t_1ed81750cb0a43809b4963515a5b2525" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/converting.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='98083f70cf1d48e5b7e9aaa443db0fbe';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>