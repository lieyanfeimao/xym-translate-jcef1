<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Record Generator HOWTO</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Record Generator HOWTO
     <div name="tsUpdate" data-id="t_dcafa3c01c3a4c9fac2ee545f9557566" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="How+to+Use+the+Record+Generator"></a>
    <h2 class="boxed">How to Use the Record Generator
     <div name="tsUpdate" data-id="t_72118ba0e9b84dc8bd2362e0a96fe49b" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <a name="History"></a>
     <h3 class="boxed">History
      <div name="tsUpdate" data-id="t_23d87a60b5f3456da4d94127e1423b72" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The record generator was born from frustration with translating the Excel records to Java classes. Doing this manually is a time consuming process. It's also very easy to make mistakes.
      <div name="tsUpdate" data-id="t_f6c30423f1f54c64a3ee8c82d06ec65e" data-tpl="0" data-txt-color="green"></div></p>
     <p>A utility was needed to take the definition of what a record looked like and do all the boring and repetitive work.
      <div name="tsUpdate" data-id="t_aa4ce49228ae404cbb51d317a487152c" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Capabilities"></a>
     <h3 class="boxed">Capabilities
      <div name="tsUpdate" data-id="t_7fff282a8f604742b324f1fa77100538" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The record generator takes XML as input and produces the following output:
      <div name="tsUpdate" data-id="t_962cba1c7d55497e99a5a8691ca5305d" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li>A Java file capable of decoding and encoding the record.
       <div name="tsUpdate" data-id="t_e141e85f66bf4f1fbd7248f06a8718f8" data-tpl="0" data-txt-color="green"></div></li>
      <li>A test class that provides a fill-in-the-blanks implementation of a test case for ensuring the record operates as designed.
       <div name="tsUpdate" data-id="t_feaa0809d0da486baad7d4298915ccd3" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <a name="Usage"></a>
     <h3 class="boxed">Usage
      <div name="tsUpdate" data-id="t_204acd0d8ba54a358846a283e630b953" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The record generator is invoked as an Ant target (generate-records). It goes through looking for all files in <span class="codefrag">src/records/definitions</span> ending with _record.xml. It then creates two files; the Java record definition and the Java test case template.
      <div name="tsUpdate" data-id="t_518f8ee66fcc4745ae4784ed2ccebbab" data-tpl="0" data-txt-color="green"></div></p>
     <p>The records themselves have the following general layout:
      <div name="tsUpdate" data-id="t_a318d52569ef493e9ae29c2b47e4eb56" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">record id="0x1032" name="Frame" package="org.apache.poi.hssf.record"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> excel-record-id="FRAME"&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;description&gt;The frame record indicates whether there is a border</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> around the displayed text of a chart.&lt;/description&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;author&gt;Glen Stampoultzis (glens at apache.org)&lt;/author&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;fields&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;field type="int" size="2" name="border type"&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;const name="regular" value="0" description="regular rectangle or no border"/&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;const name="shadow" value="1" description="rectangle with shadow"/&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;/field&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;field type="int" size="2" name="options"&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;bit number="0" name="auto size"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> description="excel calculates the size automatically if true"/&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;bit number="1" name="auto position"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> description="excel calculates the position automatically"/&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;/field&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> &lt;/fields&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/record&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>The following table details the allowable types and sizes for the fields.
      <div name="tsUpdate" data-id="t_bf1dd56eb5ca4973bce854c6bccc8f8b" data-tpl="0" data-txt-color="green"></div></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1">Type
         <div name="tsUpdate" data-id="t_36cd00be2cb1499891aeb4a38aed03fb" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Size
         <div name="tsUpdate" data-id="t_f438101919814d02941d8103dcdb4823" data-tpl="0" data-txt-color="green"></div></th>
        <th colspan="1" rowspan="1">Java Type
         <div name="tsUpdate" data-id="t_a03a43c8852149169fd06a56822164ff" data-tpl="0" data-txt-color="green"></div></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_12b4065d8e2540389d6049bf4a0213ca" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_25c2643b4f404e9982efa6f8e18cf870" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">byte
         <div name="tsUpdate" data-id="t_921afdfeda734eafb8d6a33b9f4d02a9" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_e42366dbb70241269766f09bcd197661" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_12bcfbcd9cf24f2da44ed27d7d7835c1" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">short
         <div name="tsUpdate" data-id="t_fc862aec0ed84bdc9d82575e0128101b" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_cad108441b484fb48be7aaf4253dab7e" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">4
         <div name="tsUpdate" data-id="t_7a23f085add443de8dd0613353917586" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_d79016c4c25e43c0a086cee359156845" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_d4a64f3940424b17abed5c98dc33ec2e" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">8
         <div name="tsUpdate" data-id="t_42154b552ed34885b2cf79a156027008" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">long
         <div name="tsUpdate" data-id="t_0705aef5cd0947fcb0d66938baaa15ab" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">int
         <div name="tsUpdate" data-id="t_7bc5319319544f99ae7918a621c7edf7" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">varword
         <div name="tsUpdate" data-id="t_736b389d715b4960a2491aef45754f0f" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">array of shorts
         <div name="tsUpdate" data-id="t_da1aebe5f9cd493f9b0c85509cad9072" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">bits
         <div name="tsUpdate" data-id="t_a44d566f76104437b42e6ab2b5fb3733" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">1
         <div name="tsUpdate" data-id="t_fc2f6d67659e4ec68e85a219423dbff2" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">A byte comprising of a bits (defined by the bit element)
         <div name="tsUpdate" data-id="t_76f7dd1fd3b7460c81b89dbf18687533" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">bits
         <div name="tsUpdate" data-id="t_392f8a2a7acd4137ac54c38392296183" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">2
         <div name="tsUpdate" data-id="t_9244073627734614a5d4cb7f9ea0740a" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">An short comprising of a bits
         <div name="tsUpdate" data-id="t_99fca861491a4f4d92ff2c4c801ae72d" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">bits
         <div name="tsUpdate" data-id="t_b33b6ac8baeb4ba5b49f0ce6776907fe" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">4
         <div name="tsUpdate" data-id="t_2488d92e7f814fdcad005ab217f3155b" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">A int comprising of a bits
         <div name="tsUpdate" data-id="t_8c2dcc15d0c647c2999c7036c81bbbb6" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">float
         <div name="tsUpdate" data-id="t_a3e99f6f99e946c6b647ec28bbe6ef33" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">8
         <div name="tsUpdate" data-id="t_c7b62b0ee2d04634ae65e71ec3b132a9" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">double
         <div name="tsUpdate" data-id="t_7423fd14489f4d978aaf1fbd0437a920" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1">hbstring
         <div name="tsUpdate" data-id="t_43d236d0efb04fa3a61981703ba6f364" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">java expression
         <div name="tsUpdate" data-id="t_814a14358a6d42048ae97696e2cc1e07" data-tpl="0" data-txt-color="green"></div></td>
        <td colspan="1" rowspan="1">String
         <div name="tsUpdate" data-id="t_be2e2b011c7848919ff8a176c81954ce" data-tpl="0" data-txt-color="green"></div></td>
       </tr>
      </tbody>
     </table>
     <p>The Java records are regenerated each time the record generator is run, however the test stubs are only created if the test stub does not already exist. What this means is that you may change test stubs but not the generated records.
      <div name="tsUpdate" data-id="t_a946d425dfcb4b23b7578f5f1d38be63" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Custom+Field+Types"></a>
     <h3 class="boxed">Custom Field Types
      <div name="tsUpdate" data-id="t_7512d0b118ec4d3586e0bb01bdef6138" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Occasionally the builtin types are not enough. More control over the encoding and decoding of the streams is required. This can be achieved using a custom type.
      <div name="tsUpdate" data-id="t_481c30c2733f4da594edae6a9b9ff9a6" data-tpl="0" data-txt-color="green"></div></p>
     <p>A custom type lets you escape to java to define the way in which the field encodes and decodes. To code a custom type you declare your field like this:
      <div name="tsUpdate" data-id="t_c3b6b277c83d45339c368dfe4a310211" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">field type="custom:org.apache.poi.hssf.record.LinkedDataFormulaField"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> size="var" name="formula of link" description="formula"/&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Where the class name specified after <span class="codefrag">custom:</span> is a class implementing the interface <span class="codefrag">CustomField</span>.
      <div name="tsUpdate" data-id="t_47b71bc86acf48bb8c88ee81c12546b0" data-tpl="0" data-txt-color="green"></div></p>
     <p>You can then implement the encoding yourself.
      <div name="tsUpdate" data-id="t_448d952a0dbc43548484ebdfa56d82f6" data-tpl="0" data-txt-color="green"></div></p>
     <a name="How+it+Works"></a>
     <h3 class="boxed">How it Works
      <div name="tsUpdate" data-id="t_6d6d495b492941b7a644f6aaa50816d9" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The record generation works by taking an XML file and styling it using XSLT. Given that XSLT is a little limited in some ways it was necessary to add a little Java code to the mix.
      <div name="tsUpdate" data-id="t_839ddd25b30c4615835d7dedf8f664da" data-tpl="0" data-txt-color="green"></div></p>
     <p>See record.xsl, record_test.xsl, FieldIterator.java, RecordUtil.java, RecordGenerator.java
      <div name="tsUpdate" data-id="t_8761df77366d4b1cbc6b5f7891631a52" data-tpl="0" data-txt-color="green"></div></p>
     <p>There is a corresponding "type" generator for HWPF. See the HWPF documentation for details.
      <div name="tsUpdate" data-id="t_25f39e7aa54b4a87b495e03c89fb776f" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Limitations"></a>
     <h3 class="boxed">Limitations
      <div name="tsUpdate" data-id="t_fa74db08784646bbac4604d1d3d16829" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The record generator does not handle all possible record types and goes not intend to perform this function. When dealing with a non-standard record sometimes the cost-benefit of coding the record by hand will be greater than attempting modify the generator. The main point of the record generator is to save time, so keep that in mind.
      <div name="tsUpdate" data-id="t_cfa6551257dd4cd5803eb65419ec2c4e" data-tpl="0" data-txt-color="green"></div></p>
     <p>Currently the the XSL file that generates the record calls out to Java objects. The Java code for the record generation is currently quite messy with minimal comments.
      <div name="tsUpdate" data-id="t_a9bbdce9ee3643e39ffd110e11bebcba" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <p align="right"><font size="-2">by&nbsp;Glen Stampoultzis,&nbsp;Andrew C. Oliver</font>
     <div name="tsUpdate" data-id="t_a221500f5fb24c148acd4c817442282a" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/record-generator.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='f619810ce2504a61890541861f932171';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>