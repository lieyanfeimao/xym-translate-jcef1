<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Developing Formula Evaluation</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Developing Formula Evaluation
     <div name="tsUpdate" data-id="t_57c114fb048b436e8b101d5076ec6a9d" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="Introduction"></a>
    <h2 class="boxed">Introduction
     <div name="tsUpdate" data-id="t_b4e0f4a7e9ed44c48f819a2144557833" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>This document is for developers wishing to contribute to the FormulaEvaluator API functionality.
      <div name="tsUpdate" data-id="t_da8dbac6652a402aaf0abbdbcd4e71d1" data-tpl="0" data-txt-color="green"></div></p>
     <p>When evaluating workbooks you may encounter a org.apache.poi.ss.formula.eval.NotImplementedException which indicates that a function is not (yet) supported by POI. Is there a workaround? Yes, the POI framework makes it easy to add implementation of new functions. Prior to POI-3.8 you had to checkout the source code from svn and make a custom build with your function implementation. Since POI-3.8 you can register new functions in run-time.
      <div name="tsUpdate" data-id="t_e01e6dbeef304f46bfbdbe1bb92f2f04" data-tpl="0" data-txt-color="green"></div></p>
     <p>Currently, contribution is desired for implementing the standard MS excel functions. Place holder classes for these have been created, contributors only need to insert implementation for the individual "evaluate()" methods that do the actual evaluation.
      <div name="tsUpdate" data-id="t_9039705885e6477cbb001928ca54db14" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Overview+of+FormulaEvaluator"></a>
    <h2 class="boxed">Overview of FormulaEvaluator
     <div name="tsUpdate" data-id="t_a5a68e9c57a04a5a8508d3d7e569294e" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Briefly, a formula string (along with the sheet and workbook that form the context in which the formula is evaluated) is first parsed into RPN tokens using the FormulaParser class . (If you don't know what RPN tokens are, now is a good time to read <a href="http://www-stone.ch.cam.ac.uk/documentation/rrf/rpn.html"> this</a>.)
      <div name="tsUpdate" data-id="t_64b91300ec084fc49fc60ef99389ccce" data-tpl="0" data-txt-color="green"></div></p>
     <a name="The+big+picture"></a>
     <h3 class="boxed">The big picture
      <div name="tsUpdate" data-id="t_1b15c98022f442c1806d51ffa88ecb50" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>RPN tokens are mapped to Eval classes. (Class hierarchy for the Evals is best understood if you view the class diagram in a class diagram viewer.) Depending on the type of RPN token (also called as Ptgs henceforth since that is what the FormulaParser calls the classes) a specific type of Eval wrapper is constructed to wrap the RPN token and is pushed on the stack.... UNLESS the Ptg is an OperationPtg. If it is an OperationPtg, an OperationEval instance is created for the specific type of OperationPtg. And depending on how many operands it takes, that many Evals are popped of the stack and passed in an array to the OperationEval instance's evaluate method which returns an Eval of subtype ValueEval.Thus an operation in the formula is evaluated.
      <div name="tsUpdate" data-id="t_752bdd22865a432681419ddb55a1501f" data-tpl="0" data-txt-color="green"></div></p>
     <div class="note">
      <div class="label">
       Note
       <div name="tsUpdate" data-id="t_25d3a61ae9fc431e9b19c75c999c93ce" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       An Eval is of subinterface ValueEval or OperationEval. Operands are always ValueEvals, Operations are always OperationEvals.
       <div name="tsUpdate" data-id="t_b4c540d7b9d74114992456d4312780b7" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
     <p><span class="codefrag">OperationEval.evaluate(Eval[])</span> returns an Eval which is supposed to be of type ValueEval (actually since ValueEval is an interface, the return value is instance of one of the implementations of ValueEval). The valueEval resulting from evaluate() is pushed on the stack and the next RPN token is evaluated.... this continues till eventually there are no more RPN tokens at which point, if the formula string was correctly parsed, there should be just one Eval on the stack - which contains the result of evaluating the formula.
      <div name="tsUpdate" data-id="t_53f1a8388aa9490cabdadfef62e7244d" data-tpl="0" data-txt-color="green"></div></p>
     <p>Of course I glossed over the details of how AreaPtg and ReferencePtg are handled a little differently, but the code should be self explanatory for that. Very briefly, the cells included in AreaPtg and RefPtg are examined and their values are populated in individual ValueEval objects which are set into the AreaEval and RefEval (ok, since AreaEval and RefEval are interfaces, the implementations of AreaEval and RefEval - but you'll figure all that out from the code)
      <div name="tsUpdate" data-id="t_aa7cca1e151a44ad82d9130b21922e3c" data-tpl="0" data-txt-color="green"></div></p>
     <p>OperationEvals for the standard operators have been implemented and tested.
      <div name="tsUpdate" data-id="t_ec5e5b14cabc4b188dc9119b1b4a923c" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="What+functions+are+supported%3F"></a>
    <h2 class="boxed">What functions are supported?
     <div name="tsUpdate" data-id="t_631e8292fcb248c5871d262bc1965c31" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>As of September 2017, POI supports about 176 built-in functions, see <a href="#appendixA">Appendix A</a> for the full list. You can programmatically list supported / unsupported functions using the following helper methods:
      <div name="tsUpdate" data-id="t_986fcedd7a9f4e33bc64250ce7255761" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// list of functions that POI can evaluate</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_18af6150db6e47ee8d38db7a08b55b8a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Collection&lt;String&gt; supportedFuncs = WorkbookEvaluator.getSupportedFunctionNames();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// list of functions that are not supported by POI</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_97ca3a2065694aab8061cb09e58f532b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Collection&lt;String&gt; unsupportedFuncs = WorkbookEvaluator.getNotSupportedFunctionNames();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Two+base+interfaces+to+start+your+implementation"></a>
    <h2 class="boxed">Two base interfaces to start your implementation
     <div name="tsUpdate" data-id="t_1e9443bbae9541a7b0bd5197644aa052" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>All Excel formula function classes implement either org.apache.poi.hssf.record.formula.functions.Function or org.apache.poi.hssf.record.formula.functions.FreeRefFunction interface. Function is a common interface for the functions defined in the binary Excel format (BIFF8): these are "classic" Excel functions like SUM, COUNT, LOOKUP, etc. FreeRefFunction is a common interface for the functions from the Excel Analysis Toolpack and for User-Defined Functions. In the future these two interfaces are expected be unified into one, but for now you have to start your implementation from two slightly different roots.
      <div name="tsUpdate" data-id="t_4c106fe399ff46c4b66e123509b90bc8" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Which+interface+to+start+from%3F"></a>
    <h2 class="boxed">Which interface to start from?
     <div name="tsUpdate" data-id="t_d9bec27565d4404eabeb77b49d0b961c" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>You are about to implement a function XXX and don't know which interface to start from: Function or FreeRefFunction. Use the following code to check whether your function is from the excel Analysis Toolpack:
      <div name="tsUpdate" data-id="t_1395b3d85755437884be0ad3c4d86f22" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(AnalysisToolPack.isATPFunction(functionName)){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // the function implements org.apache.poi.hssf.record.formula.functions.Function</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3056ae0c3a1746119e5c55b9a7c1a747" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">} else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // the function implements org.apache.poi.hssf.record.formula.functions.FreeRefFunction</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9d7603a425de48318294386630107e91" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Walkthrough+of+an+%22evaluate%28%29%22+implementation."></a>
    <h2 class="boxed">Walkthrough of an "evaluate()" implementation.
     <div name="tsUpdate" data-id="t_4e3f13207897476e89ef3fdb65ce1966" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Here is the fun part: lets walk through the implementation of the excel function <strong>SQRT()</strong>
      <div name="tsUpdate" data-id="t_3e40ac8830c94ed3b0a09e462ffed822" data-tpl="0" data-txt-color="green"></div></p>
     <p>AnalysisToolPack.isATPFunction("SQRTPI") returns false so the base interface is Function. There are sub-interfaces that make life easier when implementing numeric functions or functions with fixed number of arguments, 1-arg, 2-arg and 3-arg function:
      <div name="tsUpdate" data-id="t_255441c0be054dbbbb9f406fa6ea630e" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li>org.apache.poi.hssf.record.formula.functions.NumericFunction
       <div name="tsUpdate" data-id="t_f9d7f48dd4fb497eaf7d880f8d86acec" data-tpl="0" data-txt-color="green"></div></li>
      <li>org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction
       <div name="tsUpdate" data-id="t_8c1c203d6d0145ee81296219a70a63b9" data-tpl="0" data-txt-color="green"></div></li>
      <li>org.apache.poi.hssf.record.formula.functions.Fixed2ArgFunction
       <div name="tsUpdate" data-id="t_8709f195032044c28c98e9c7033d3690" data-tpl="0" data-txt-color="green"></div></li>
      <li>org.apache.poi.hssf.record.formula.functions.Fixed3ArgFunction
       <div name="tsUpdate" data-id="t_8783e04cd2c24f05b2c64221bb0df3fd" data-tpl="0" data-txt-color="green"></div></li>
      <li>org.apache.poi.hssf.record.formula.functions.Fixed4ArgFunction
       <div name="tsUpdate" data-id="t_7fd35793054e4b33aee034da21cffb56" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <p>Since SQRTPI takes exactly one argument we start our implementation from org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction:
      <div name="tsUpdate" data-id="t_0e65c70020504d54a29d367ccb1ec2ae" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Function SQRTPI = new Fixed1ArgFunction() {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public ValueEval evaluate(int srcRowIndex, int srcColumnIndex, ValueEval arg0) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Retrieves a single value from a variety of different argument types according to standard</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel rules. Does not perform any type conversion.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d6bb2d6a64484d8e8820874b080aee53" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ValueEval ve = OperandResolver.getSingleValue(arg0, srcRowIndex, srcColumnIndex);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Applies some conversion rules if the supplied value is not already a number.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Throws EvaluationException(#VALUE!) if the supplied parameter is not a number</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d1da8254b00841339bd74803fbbf81af" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> double arg = OperandResolver.coerceValueToDouble(ve);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // this where all the heavy-lifting happens</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7b7f55d1299d4eb89bd39bafb7db3e12" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> double result = Math.sqrt(arg*Math.PI);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel uses the error code #NUM! instead of IEEE </span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ab10778180904718b9bb8efca76d2e54" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">nity</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // so when a numeric function evaluates to Double.NaN or Double.Infinity,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // be sure to translate the result to the appropriate error code</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3b052ee07e7e4504b47415cf4ff931ff" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (Double.isNaN(result) || Double.isInfinite(result)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throw new EvaluationException(ErrorEval.NUM_ERROR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return new NumberEval(result);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } catch (EvaluationException e){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return e.getErrorEval();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Now when the implementation is ready we need to register it in the formula evaluator:
      <div name="tsUpdate" data-id="t_8630686f625c4da3aa56dcf2472633e1" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WorkbookEvaluator.registerFunction("SQRTPI", SQRTPI);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Voila! The formula evaluator now recognizes SQRTPI!
      <div name="tsUpdate" data-id="t_dcdd558f5a304238bfe4c057e0ba7fa1" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Floating-point+Arithmetic+in+Excel"></a>
    <h2 class="boxed">Floating-point Arithmetic in Excel
     <div name="tsUpdate" data-id="t_5d9e1264d1f143ae9723181df9ca9834" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Excel uses the IEEE Standard for Double Precision Floating Point numbers except two cases where it does not adhere to IEEE 754:
      <div name="tsUpdate" data-id="t_996d905a82304166964f996aa03b454b" data-tpl="0" data-txt-color="green"></div></p>
     <ol>
      <li>Positive/Negative Infinities: Infinities occur when you divide by 0. Excel does not support infinities, rather, it gives a #DIV/0! error in these cases.
       <div name="tsUpdate" data-id="t_099749cd507c4a888d8897974a41e962" data-tpl="0" data-txt-color="green"></div></li>
      <li>Not-a-Number (NaN): NaN is used to represent invalid operations (such as infinity/infinity, infinity-infinity, or the square root of -1). NaNs allow a program to continue past an invalid operation. Excel instead immediately generates an error such as #NUM! or #DIV/0!.
       <div name="tsUpdate" data-id="t_2e42a139b0044dc1a8008d448aa5dcf7" data-tpl="0" data-txt-color="green"></div></li>
     </ol>
     <p>Be aware of these two cases when saving results of your scientific calculations in Excel: “where are my Infinities and NaNs? They are gone!”
      <div name="tsUpdate" data-id="t_fa9d7ff25ba34f89a0c6425c21e727f4" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Testing+Framework"></a>
    <h2 class="boxed">Testing Framework
     <div name="tsUpdate" data-id="t_c67ea0d468ab45afba415fe2d2ed4ca9" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Automated testing of the implemented Function is easy. The source code for this is in the file: o.a.p.h.record.formula.GenericFormulaTestCase.java This class has a reference to the test xls file (not /a/ test xls, /the/ test xls :) which may need to be changed for your environment. Once you do that, in the test xls, locate the entry for the function that you have implemented and enter different tests in a cell in the FORMULA row. Then copy the "value of" the formula that you entered in the cell just below it (this is easily done in excel as: [copy the formula cell] &gt; [go to cell below] &gt; Edit &gt; Paste Special &gt; Values &gt; "ok"). You can enter multiple such formulas and paste their values in the cell below and the test framework will automatically test if the formula evaluation matches the expected value (Again, hard to put in words, so if you will, please take time to quickly look at the code and the currently entered tests in the patch attachment "FormulaEvalTestData.xls" file).
      <div name="tsUpdate" data-id="t_a50ff20c7ea34a3b8aab741a14bf08e3" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="appendixA" id="appendixA"></a> <a name="Appendix+A"></a>
    <h2 class="boxed">Appendix A
     <div name="tsUpdate" data-id="t_1a717eda64544952831f67bb2969b85d" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Functions supported by POI (as of September 2017)
      <div name="tsUpdate" data-id="t_82bcd160b0894102bc5524b3a90f8a18" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ABS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ACOS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ACOSH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ADDRESS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ASIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ASINH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATAN2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATANH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AVEDEV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AVERAGE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BIN2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CEILING</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CHAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CHOOSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CLEAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CODE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COLUMN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COLUMNS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COMBIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COMPLEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CONCATENATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COSH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTBLANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTIF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTIFS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DAYS360</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEC2BIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEC2HEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEGREES</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DELTA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEVSQ</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DGET</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DMIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DOLLAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EDATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EOMONTH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ERROR.TYPE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EVEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EXACT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EXP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FACT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FACTDOUBLE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FALSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FIND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FIXED</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FLOOR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HEX2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HLOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HOUR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HYPERLINK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IFERROR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IMAGINARY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IMREAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INDEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INDIRECT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INTERCEPT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IPMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IRR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISBLANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISERR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISERROR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISEVEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISLOGICAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNONTEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNUMBER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISODD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISREF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISTEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LARGE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LEFT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOG</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOG10</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOWER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MATCH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MAX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MAXA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MDETERM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MEDIAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MID</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINUTE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINVERSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MIRR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MMULT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MOD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MODE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MONTH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MROUND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NETWORKDAYS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NOT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NOW</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NPV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OCT2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ODD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OFFSET</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PERCENTILE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PI</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POISSON</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POWER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PPMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PRODUCT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PROPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">QUOTIENT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RADIANS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RAND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RANDBETWEEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">REPLACE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">REPT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RIGHT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROMAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUNDDOWN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUNDUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROW</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROWS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SEARCH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SECOND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SIGN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SINH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SLOPE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SMALL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SQRT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STDEV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUBSTITUTE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUBTOTAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMIF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMIFS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMPRODUCT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMSQ</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMX2MY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMX2PY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMXMY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">T</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TANH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TIME</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TODAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRANSPOSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRIM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRUE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRUNC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">UPPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VALUE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VARP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VLOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WEEKDAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WEEKNUM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WORKDAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">YEAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">YEARFRAC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <p align="right"><font size="-2">by&nbsp;Amol Deshmukh,&nbsp;Yegor Kozlov</font>
     <div name="tsUpdate" data-id="t_a83059f9e39045f390980cb9722b3214" data-tpl="0" data-txt-color="green"></div></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/eval-devguide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='86f2d47410a947f6afd1d38865ed0bde';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>