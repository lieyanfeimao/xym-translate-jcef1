<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Busy Developers' Guide to HSSF and XSSF Features</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <link href="../../layui/css/layui.css" rel="stylesheet">
  <script src="../../js/jquery.min.js"></script>
  <script src="../../layui/layui.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1>Busy Developers' Guide to HSSF and XSSF Features
     <div name="tsUpdate" data-id="t_242a0fdae48546d5880f0d484a151c33" data-tpl="0" data-txt-color="green"></div></h1>
    <div id="front-matter"></div>
    <a name="Busy+Developers%27+Guide+to+Features"></a>
    <h2 class="boxed">Busy Developers' Guide to Features
     <div name="tsUpdate" data-id="t_62233788c88f46f49546162d6ea5767d" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Want to use HSSF and XSSF read and write spreadsheets in a hurry? This guide is for you. If you're after more in-depth coverage of the HSSF and XSSF user-APIs, please consult the <a href="how-to.html">HOWTO</a> guide as it contains actual descriptions of how to use this stuff.
      <div name="tsUpdate" data-id="t_081e01465031486188e799cbb1cfd462" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Index+of+Features"></a>
     <h3 class="boxed">Index of Features
      <div name="tsUpdate" data-id="t_8c33887641db4bf8892c72155232e15a" data-tpl="0" data-txt-color="orange"></div></h3>
     <ul>
      <li><a href="#NewWorkbook">How to create a new workbook</a>
       <div name="tsUpdate" data-id="t_e8e02a8b4b6d43d8ace2b60ab508a054" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#NewSheet">How to create a sheet</a>
       <div name="tsUpdate" data-id="t_c3311b89aebf4007bc8e27e9b5d2ee7e" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CreateCells">How to create cells</a>
       <div name="tsUpdate" data-id="t_18e5583b80ec4941ae941bc1bb21eef8" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CreateDateCells">How to create date cells</a>
       <div name="tsUpdate" data-id="t_717700a732cd4b9eaaba02ec2754540e" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CellTypes">Working with different types of cells</a>
       <div name="tsUpdate" data-id="t_a084697c444b42669154adafb630c6cc" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Iterator">Iterate over rows and cells</a>
       <div name="tsUpdate" data-id="t_d7b54d0a74fa4de0845c3655df38d1d9" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CellContents">Getting the cell contents</a>
       <div name="tsUpdate" data-id="t_03dc211bcc4d450892d32ef1255e3b34" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#TextExtraction">Text Extraction</a>
       <div name="tsUpdate" data-id="t_80a63339de194a1a9a0e19c084186f75" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#FileInputStream">Files vs InputStreams</a>
       <div name="tsUpdate" data-id="t_d9a15d4501ae4920904cc030f47a8042" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Alignment">Aligning cells</a>
       <div name="tsUpdate" data-id="t_d1fc46a34fda4239842532b5f65f0d81" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Borders">Working with borders</a>
       <div name="tsUpdate" data-id="t_ce82697547794426a553109b4da25b57" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#FillsAndFrills">Fills and color</a>
       <div name="tsUpdate" data-id="t_c2b8dd559ef44997b8638f78cd53dfa6" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#MergedCells">Merging cells</a>
       <div name="tsUpdate" data-id="t_deebd3988c5648eab5cf55ad8911a596" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#WorkingWithFonts">Working with fonts</a>
       <div name="tsUpdate" data-id="t_a3a1bfa8a4814a4f8625bc55a5e9530a" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CustomColors">Custom colors</a>
       <div name="tsUpdate" data-id="t_96dc099431b645fb991624fbcfb7df00" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#ReadWriteWorkbook">Reading and writing</a>
       <div name="tsUpdate" data-id="t_138236c44b474ff9b44b73f190f94d05" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#NewLinesInCells">Use newlines in cells.</a>
       <div name="tsUpdate" data-id="t_868dfcddba4a4685b91bfe94990bc499" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#DataFormats">Create user defined data formats</a>
       <div name="tsUpdate" data-id="t_fc34d73d4b4f4211aaaabb15a489401e" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#FitTo">Fit Sheet to One Page</a>
       <div name="tsUpdate" data-id="t_d6ec7540400b464f9935b6c6db68c013" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#PrintArea2">Set print area for a sheet</a>
       <div name="tsUpdate" data-id="t_147c3f6b2f8e480e977fc038efd0a14d" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#FooterPageNumbers">Set page numbers on the footer of a sheet</a>
       <div name="tsUpdate" data-id="t_c082f7e91cf049b0b4441a7746d1dd5a" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#ShiftRows">Shift rows</a>
       <div name="tsUpdate" data-id="t_b7b5fc78c3b54c92aafe22e9df1ea849" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#SelectSheet">Set a sheet as selected</a>
       <div name="tsUpdate" data-id="t_7a61db10a03e4838a37d647c40774cdf" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Zoom">Set the zoom magnification for a sheet</a>
       <div name="tsUpdate" data-id="t_727982c4e22b4ea18e5f0078dca98e7d" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Splits">Create split and freeze panes</a>
       <div name="tsUpdate" data-id="t_e789a51805f141588b9e628c36bd0d5a" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Repeating">Repeating rows and columns</a>
       <div name="tsUpdate" data-id="t_a4a8a786b9de40cca4e9bb3331170cfa" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#HeaderFooter">Headers and Footers</a>
       <div name="tsUpdate" data-id="t_14ea5d2d27a147d28ebecbcd1b746433" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#XSSFHeaderFooter">XSSF enhancement for Headers and Footers</a>
       <div name="tsUpdate" data-id="t_a199ffd05a984d3bb5981f4e25ff4a74" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#DrawingShapes">Drawing Shapes</a>
       <div name="tsUpdate" data-id="t_8f7bb19b0bb84d77bbc16c84b9937ff7" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#StylingShapes">Styling Shapes</a>
       <div name="tsUpdate" data-id="t_72522bfe2c9a49d5a4c323f16ae54007" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Graphics2d">Shapes and Graphics2d</a>
       <div name="tsUpdate" data-id="t_1f51342d03ab404f9fbdaee7e60dee32" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Outlining">Outlining</a>
       <div name="tsUpdate" data-id="t_8f85a16d9a274b4686172b0040e1bde9" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Images">Images</a>
       <div name="tsUpdate" data-id="t_f6fdbd05e0a24e5f8d634769bd7995ef" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#NamedRanges">Named Ranges and Named Cells</a>
       <div name="tsUpdate" data-id="t_e211d38b3c5b41be91cd0785c87901e3" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CellComments">How to set cell comments</a>
       <div name="tsUpdate" data-id="t_922630ba635e4ddf8efcafc86baafb6c" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Autofit">How to adjust column width to fit the contents</a>
       <div name="tsUpdate" data-id="t_72001d39a5ad4c95875785029237d78c" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Hyperlinks">Hyperlinks</a>
       <div name="tsUpdate" data-id="t_339b37e89c5a42e498d9f4d7c004114b" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Validation">Data Validations</a>
       <div name="tsUpdate" data-id="t_854727287d994c44be22d9dab90e8bd5" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Embedded">Embedded Objects</a>
       <div name="tsUpdate" data-id="t_ec4d511c91ae49d79893d30785403dd7" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Autofilter">Autofilters</a>
       <div name="tsUpdate" data-id="t_f82c6fdda7ff4ae6bfb9b3693c4679b4" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#ConditionalFormatting">Conditional Formatting</a>
       <div name="tsUpdate" data-id="t_d100d3cec9c9456689834c84607e18c2" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#Hiding">Hiding and Un-Hiding Rows</a>
       <div name="tsUpdate" data-id="t_9ebb9fbc532a406cb5af37fa74a6166a" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#CellProperties">Setting Cell Properties</a>
       <div name="tsUpdate" data-id="t_1f3283b83efb43828bcccc456f254549" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#DrawingBorders">Drawing Borders</a>
       <div name="tsUpdate" data-id="t_11f0ef956f2d40c89dace7863f71edca" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#PivotTable">Create a Pivot Table</a>
       <div name="tsUpdate" data-id="t_0b0504c45d9a43f68cad4d58165b8259" data-tpl="0" data-txt-color="green"></div></li>
      <li><a href="#RichText">Cells with multiple styles</a>
       <div name="tsUpdate" data-id="t_22d887bf3c5b4c4d80a90cb40193178a" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <a name="Features"></a>
     <h3 class="boxed">Features
      <div name="tsUpdate" data-id="t_5a1a533ba26843f29b5c42255bc8244e" data-tpl="0" data-txt-color="orange"></div></h3>
     <a name="NewWorkbook" id="NewWorkbook"></a><a name="New+Workbook"></a>
     <h4>New Workbook
      <div name="tsUpdate" data-id="t_29283b9eb79444a4b86c369cb15b36bb" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="NewSheet" id="NewSheet"></a><a name="New+Sheet"></a>
     <h4>New Sheet
      <div name="tsUpdate" data-id="t_1b39d037708f4770ad0e57cbc3968651" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span> or new XSSFWorkbook();
         <div name="tsUpdate" data-id="t_1e64cd35e08740959bd7f69fac61c59f" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("second sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note that sheet name is Excel must not exceed 31 characters</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// and must not contain any of the any of the following characters:</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 0x0000</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 0x0003</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// colon (:)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// backslash (\)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// asterisk (*)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// question mark (?)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// forward slash (/)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// opening square bracket ([)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// closing square bracket (])</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5477a6aeadc6472a9ac9822242e0aabf" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// You can use org.apache.poi.ss.util.WorkbookUtil#createSafeSheetName(String nameProposal)}</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// for a safe way to create valid names, this utility replaces invalid characters with a space (' ')</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_0c53e4d15a5544669548c45c4f631bce" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String safeName = WorkbookUtil.createSafeSheetName("[O'Brien's sales*?]"); //<span> returns " O'Brien's sales "
         <div name="tsUpdate" data-id="t_e7c26643cca541b7aae7fb0a69c7304b" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet3 = wb.createSheet(safeName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CreateCells" id="CreateCells"></a><a name="Creating+Cells"></a>
     <h4>Creating Cells
      <div name="tsUpdate" data-id="t_bdb89f3e22b84025bfd29d0ed27b9436" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9d22272bd2414a3b901e9b687ddbfc22" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1f561bec6101407f81ea4c90efdecd91" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(0);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_cf566613fbee4503a65ec9342370a9cc" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Or do it on one line.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_44ec31e27aa9457fbfc9156848a47f28" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(1).setCellValue(1.2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(2).setCellValue(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createRichTextString("This is a string"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(3).setCellValue(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_6e83fb500cff4880b72d0a879bce9a42" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CreateDateCells" id="CreateDateCells"></a><a name="Creating+Date+Cells"></a>
     <h4>Creating Date Cells
      <div name="tsUpdate" data-id="t_47878dcc2454438895cfa8852b297c35" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b4219b57e2a24866be99f5cfa84044a2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_530127825f31405c94a1d6ee2d7400f6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a date value in it. The first cell is not styled</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// as a date.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_01cb4a8e4b764e54a237ca620fd477e9" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// we style the second cell as a date (and time). It is important to</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new cell style from the workbook otherwise you can end up</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// modifying the built in style and effecting not only this cell but other cells.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b21dc5cc0c9f47daa3253ef6c868cc91" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cellStyle = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cellStyle.setDataFormat(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createDataFormat().getFormat("m/d/yy h:mm"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//you can also set date as java.util.Calendar</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b08430b080584f8a9a2eba5dfd629ba3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(Calendar.getInstance());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_689392d8ec45455db78f07350265fed6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CellTypes" id="CellTypes"></a><a name="Working+with+different+types+of+cells"></a>
     <h4>Working with different types of cells
      <div name="tsUpdate" data-id="t_fd16d3be0fdc45d29798d98802644aac" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(0).setCellValue(1.1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(1).setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(2).setCellValue(Calendar.getInstance());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(3).setCellValue("a string");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(4).setCellValue(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(5).setCellType(CellType.ERROR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_dffa2681c19a4d52a0e47e50c6d34700" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FileInputStream" id="FileInputStream"></a><a name="Files+vs+InputStreams"></a>
     <h4>Files vs InputStreams
      <div name="tsUpdate" data-id="t_1186962294e74489930557470698cc45" data-tpl="0" data-txt-color="green"></div></h4>
     <p>When opening a workbook, either a .xls HSSFWorkbook, or a .xlsx XSSFWorkbook, the Workbook can be loaded from either a <em>File</em> or an <em>InputStream</em>. Using a <em>File</em> object allows for lower memory consumption, while an <em>InputStream</em> requires more memory as it has to buffer the whole file.
      <div name="tsUpdate" data-id="t_9835b2653edc41c2b0f54aaa24ab5f76" data-tpl="0" data-txt-color="green"></div></p>
     <p>If using <em>WorkbookFactory</em>, it's very easy to use one or the other:
      <div name="tsUpdate" data-id="t_e257ed9da39047fba9a06a80478f025f" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Use a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_09f6d10608fc4cce82736a0746a16965" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = WorkbookFactory.create(new File("MyExcel.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Use an InputStream, needs more memory</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_54b293309a5d41d4a0a342d9f0bb83e1" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = WorkbookFactory.create(new FileInputStream("MyExcel.xlsx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>If using <em>HSSFWorkbook</em> or <em>XSSFWorkbook</em> directly, you should generally go through <em>POIFSFileSystem</em> or <em>OPCPackage</em>, to have full control of the lifecycle (including closing the file when done):
      <div name="tsUpdate" data-id="t_c1d65cfe25e84e84947b2bbf551df7f5" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSFWorkbook, File</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7b4061948d3a43d1a23b4c0afbff8c0a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(new File("file.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook(fs.getRoot(), true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fs.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSFWorkbook, InputStream, needs more memory</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_219bb3fb207d446a805e9c951e7bb1d7" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(myInputStream);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook(fs.getRoot(), true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSFWorkbook, File</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ab9688e324564a8790aade3d9fb0cd7e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OPCPackage pkg = OPCPackage.open(new File("file.xlsx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook(pkg);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pkg.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSFWorkbook, InputStream, needs more memory</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_cd94b18e9e9749b3ad29f715657f3044" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OPCPackage pkg = OPCPackage.open(myInputStream);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook(pkg);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pkg.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Alignment" id="Alignment"></a><a name="Demonstrates+various+alignment+options"></a>
     <h4>Demonstrates various alignment options
      <div name="tsUpdate" data-id="t_f010317b63294c48b2205478d251b6eb" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public static void main(String[] args) throws Exception {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span>or new HSSFWorkbook();
         <div name="tsUpdate" data-id="t_69a13a2eab02494bbaf98da0a656bbbc" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row.setHeightInPoints(30);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 0, HorizontalAlignment.CENTER, VerticalAlignment.BOTTOM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 1, HorizontalAlignment.CENTER_SELECTION, VerticalAlignment.BOTTOM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 2, HorizontalAlignment.FILL, VerticalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 3, HorizontalAlignment.GENERAL, VerticalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 4, HorizontalAlignment.JUSTIFY, VerticalAlignment.JUSTIFY);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 5, HorizontalAlignment.LEFT, VerticalAlignment.TOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 6, HorizontalAlignment.RIGHT, VerticalAlignment.TOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_85ad5215eba0411983c7164b054f2a74" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream fileOut = new FileOutputStream("xssf-align.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">/**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * Creates a cell and aligns it a certain way.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> *</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param wb the workbook</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param row the row to create the cell in</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param column the column number to create the cell in</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param halign the horizontal alignment for the cell.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param valign the vertical alignment for the cell.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_26d599dd901b43bbab963f725f8853c3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">private static void createCell(Workbook wb, Row row, int column, HorizontalAlignment halign, VerticalAlignment valign) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(column);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("Align It");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cellStyle = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cellStyle.setAlignment(halign);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cellStyle.setVerticalAlignment(valign);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Borders" id="Borders"></a><a name="Working+with+borders"></a>
     <h4>Working with borders
      <div name="tsUpdate" data-id="t_cd3dcbad4f424061b32b7902d02ffd7e" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5fc0ec66bc5b499f91a42aef75f724b1" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_22923f0de06b4490b98ebf98fa479757" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(4);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Style the cell with borders all around.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_97ffdd73494c458ead6b72baba71a22a" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderBottom(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBottomBorderColor(IndexedColors.BLACK.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderLeft(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setLeftBorderColor(IndexedColors.GREEN.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderRight(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setRightBorderColor(IndexedColors.BLUE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderTop(BorderStyle.MEDIUM_DASHED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setTopBorderColor(IndexedColors.BLACK.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ddcb409efcf649dbb209e49cff80f805" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Iterator" id="Iterator"></a><a name="Iterate+over+rows+and+cells"></a>
     <h4>Iterate over rows and cells
      <div name="tsUpdate" data-id="t_bc948794a5fe4ebe814ea88eaf24335d" data-tpl="0" data-txt-color="green"></div></h4>
     <p>Sometimes, you'd like to just iterate over all the sheets in a workbook, all the rows in a sheet, or all the cells in a row. This is possible with a simple for loop.
      <div name="tsUpdate" data-id="t_8adfa585ef544b60a15ab735e0dcca55" data-tpl="0" data-txt-color="green"></div></p>
     <p>These iterators are available by calling <em>workbook.sheetIterator()</em>, <em>sheet.rowIterator()</em>, and <em>row.cellIterator()</em>, or implicitly using a for-each loop. Note that a rowIterator and cellIterator iterate over rows or cells that have been created, skipping empty rows and cells.
      <div name="tsUpdate" data-id="t_57f9d3218e8a431d8bb1ff44c04beba8" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Sheet sheet : wb ) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Row row : sheet) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Cell cell : row) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something here</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f448edb3fd5d4a0186e8f93ca77cfb92" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="Iterate+over+cells%2C+with+control+of+missing+%2F+blank+cells"></a>
     <h4>Iterate over cells, with control of missing / blank cells
      <div name="tsUpdate" data-id="t_b4abc7b4286e4fa09b4ff99dc2686ee2" data-tpl="0" data-txt-color="green"></div></h4>
     <p>In some cases, when iterating, you need full control over how missing or blank rows and cells are treated, and you need to ensure you visit every cell and not just those defined in the file. (The CellIterator will only return the cells defined in the file, which is largely those with values or stylings, but it depends on Excel).
      <div name="tsUpdate" data-id="t_f298b0cc6a874488b489ef90c1d4afc3" data-tpl="0" data-txt-color="green"></div></p>
     <p>In cases such as these, you should fetch the first and last column information for a row, then call <em>getCell(int, MissingCellPolicy)</em> to fetch the cell. Use a <a href="../../apidocs/dev/org/apache/poi/ss/usermodel/Row.MissingCellPolicy.html">MissingCellPolicy</a> to control how blank or null cells are handled.
      <div name="tsUpdate" data-id="t_4c2c1724ca8d41608c702c0d25ed2529" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Decide which rows to process</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_24a95faf914d401194dd0a460294385b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowStart = Math.min(15, sheet.getFirstRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowEnd = Math.max(1400, sheet.getLastRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int rowNum = rowStart; rowNum &lt; rowEnd; rowNum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = sheet.getRow(rowNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (r == null) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // This whole row is empty</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Handle it as needed</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_58a8ed154338458c9b9eeddb9817bf9b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> continue;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> int lastColumn = Math.max(r.getLastCellNum(), MY_MINIMUM_COLUMN_COUNT);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int cn = 0; cn &lt; lastColumn; cn++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(cn, Row.RETURN_BLANK_AS_NULL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (c == null) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // The spreadsheet is empty in this cell</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4c27312c15894610afedf18a59c7214d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something useful with the cell's contents</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3432214dc8994f07962b44dcc44b3f98" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="CellContents" id="CellContents"></a><a name="Getting+the+cell+contents"></a>
     <h4>Getting the cell contents
      <div name="tsUpdate" data-id="t_751ce994362b492eadf9bfe353f449a8" data-tpl="0" data-txt-color="green"></div></h4>
     <p>To get the contents of a cell, you first need to know what kind of cell it is (asking a string cell for its numeric contents will get you a NumberFormatException for example). So, you will want to switch on the cell's type, and then call the appropriate getter for that cell.
      <div name="tsUpdate" data-id="t_82352701030143f08f0af277e7418cb1" data-tpl="0" data-txt-color="green"></div></p>
     <p>In the code below, we loop over every cell in one sheet, print out the cell's reference (eg A3), and then the cell's contents.
      <div name="tsUpdate" data-id="t_a8562fa6fb184ac6abc8d685ed8ed9d9" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.ss.usermodel.*;</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d7712335651e42019f50d4a3b89a5168" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataFormatter formatter = new DataFormatter();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Row row : sheet1) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Cell cell : row) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellReference cellRef = new CellReference(row.getRowNum(), cell.getColumnIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.print(cellRef.formatAsString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.print(" - ");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // get the text that appears in the cell by getting the cell value and applying any data formats (Date, 0.00, 1.23e9, $1.23, etc)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_70c2a9994dad4ff2a1829a3b7d9e1e69" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String text = formatter.formatCellValue(cell);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(text);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Alternatively, get the value and format it yourself</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_61e6fbcc16814ec19903eb9dee8b8b73" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> switch (cell.getCellType()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.STRING:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getRichStringCellValue().getString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.NUMERIC:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (DateUtil.isCellDateFormatted(cell)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getDateCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getNumericCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.BOOLEAN:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getBooleanCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.FORMULA:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getCellFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.BLANK:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> default:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="TextExtraction" id="TextExtraction"></a><a name="Text+Extraction"></a>
     <h4>Text Extraction
      <div name="tsUpdate" data-id="t_2568a1627ac74b3f87395dcd23eb89e1" data-tpl="0" data-txt-color="green"></div></h4>
     <p>For most text extraction requirements, the standard ExcelExtractor class should provide all you need.
      <div name="tsUpdate" data-id="t_7f6fe4848da547f291511b2e6bf66746" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (InputStream inp = new FileInputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook wb = new HSSFWorkbook(new POIFSFileSystem(inp));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ExcelExtractor extractor = new ExcelExtractor(wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> extractor.setFormulasNotResults(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> extractor.setIncludeSheetNames(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String text = extractor.getText();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>For very fancy text extraction, XLS to CSV etc, take a look at <em>/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java</em>
      <div name="tsUpdate" data-id="t_b27ab018e5d044f6b28ad3dc2be1673b" data-tpl="0" data-txt-color="green"></div></p>
     <a name="FillsAndFrills" id="FillsAndFrills"></a><a name="Fills+and+colors"></a>
     <h4>Fills and colors
      <div name="tsUpdate" data-id="t_3f31c95cb4c44f96be7560a796d4262f" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_92c2af35f2a24c43af37bc2c94357241" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Aqua background</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_bc315792f8af458ba5964eff76c0f234" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillBackgroundColor(IndexedColors.AQUA.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.BIG_SPOTS);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("X");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Orange "foreground", foreground being the fill foreground not the font color.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_65b11970bfcd4d3aa890a0123acc888b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillForegroundColor(IndexedColors.ORANGE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("X");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_cfb45adf0e544cefbc9d94ee0aa05abe" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="MergedCells" id="MergedCells"></a><a name="Merging+cells"></a>
     <h4>Merging cells
      <div name="tsUpdate" data-id="t_c270a5e55bc7475d8aa88c502e249003" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("This is a test of merging");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addMergedRegion(new CellRangeAddress(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span>first row (0-based)
         <div name="tsUpdate" data-id="t_a8d673c23ac94dccb971fdef732451c6" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span>last row (0-based)
         <div name="tsUpdate" data-id="t_c7da2e0829494d3ea2f9b84e3c6ad476" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span>first column (0-based)
         <div name="tsUpdate" data-id="t_a40a49c6bc524e68af049c6c58742abe" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">2 //<span>last column (0-based)
         <div name="tsUpdate" data-id="t_f60e4321cc1a4bc1ba19e9fbcb83e780" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_006d93f3e8b640988cd19d4f0abdb0f3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="WorkingWithFonts" id="WorkingWithFonts"></a><a name="Working+with+fonts"></a>
     <h4>Working with fonts
      <div name="tsUpdate" data-id="t_9a3251b37edd48388dcf6aa77629849d" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_c09dccce818647f4a9e8cb8f76f2d6f5" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a new font and alter it.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_30c13584412d42ba9b93b77898c9888d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setFontHeightInPoints((short)24);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setFontName("Courier New");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setStrikeout(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Fonts are set into a style so create a new one to use.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2089a3bdd16a47de8b3b40226ad9787e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2664ddf2ed9745dc8dc8699db03bf552" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("This is a test of fonts");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1efaa2a849b04efb88573ae304421f25" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p>Note, the maximum number of unique fonts in a workbook is limited to 32767. You should re-use fonts in your applications instead of creating a font for each cell. Examples:
      <div name="tsUpdate" data-id="t_5d99ccc676354ad7b36606c7e495510f" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Wrong:</strong>
      <div name="tsUpdate" data-id="t_39cf0134e3264273b788d0f61bc771f7" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i = 0; i &lt; 10000; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(i);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle style = workbook.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font font = workbook.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> font.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><strong>Correct:</strong>
      <div name="tsUpdate" data-id="t_82f8d1a8535a45ab9307115bf7257aa0" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = workbook.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font font = workbook.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i = 0; i &lt; 10000; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(i);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <a name="CustomColors" id="CustomColors"></a><a name="Custom+colors"></a>
     <h4>Custom colors
      <div name="tsUpdate" data-id="t_676a2b0d4caa49e5b7c465d04828dd53" data-tpl="0" data-txt-color="green"></div></h4>
     <p><strong>HSSF:</strong>
      <div name="tsUpdate" data-id="t_46b93f7aacce4109873ac5a20719278b" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRow row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Default Palette");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//apply some colors from the standard palette,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// as in the previous examples.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//we'll use red text on a lime background</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_57ce515650074303ab19a9933d3c64ef" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillForegroundColor(HSSFColor.LIME.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setColor(HSSFColor.RED.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save with the default palette</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ebf69d3cbc084255aa329f27d7825d5f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream("default_palette.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//now, let's replace RED and LIME in the palette</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// with a more attractive combination</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// (lovingly borrowed from freebsd.org)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9a07fae4d55242008e22bdf9d9aa2dcb" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Modified Palette");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//creating a custom palette for the workbook</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1a274e2d9e424c3c9cc98bb615dc60ac" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFPalette palette = wb.getCustomPalette();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//replacing the standard red with freebsd.org red</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_c9f24a58a82e423184e08ae7b4fdf099" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">palette.setColorAtIndex(HSSFColor.RED.index,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 153, //<span>RGB red (0-255)
         <div name="tsUpdate" data-id="t_5e837169fb30468096766deabc4662f4" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 0, //<span>RGB green
         <div name="tsUpdate" data-id="t_54dfc152ae314685b58449019e638e1c" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 0 //<span>RGB blue
         <div name="tsUpdate" data-id="t_92f977b059ae4fc7917b0b8d60ecfa9c" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//replacing lime with freebsd.org gold</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f51ebd7933a54d74b4ae2f1338297d2b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">palette.setColorAtIndex(HSSFColor.LIME.index, (byte) 255, (byte) 204, (byte) 102);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save with the modified palette</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// note that wherever we have previously used RED or LIME, the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// new colors magically appear</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_38ef4e8cb7014f54969f36003a704daf" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (out = new FileOutputStream("modified_palette.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><strong>XSSF:</strong>
      <div name="tsUpdate" data-id="t_3bc89ee43e6c41e88252c02337fe6279" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFRow row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCell cell = row.createCell( 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("custom XSSF colors");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCellStyle style1 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style1.setFillForegroundColor(new XSSFColor(new java.awt.Color(128, 0, 128), new DefaultIndexedColorMap()));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style1.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ReadWriteWorkbook" id="ReadWriteWorkbook"></a><a name="Reading+and+Rewriting+Workbooks"></a>
     <h4>Reading and Rewriting Workbooks
      <div name="tsUpdate" data-id="t_d122139834a64aeca552af502d35b9bf" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (InputStream inp = new FileInputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//InputStream inp = new FileInputStream("workbook.xlsx");</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_74eed0c8ca7445339ab2f4dd7e250730" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Workbook wb = WorkbookFactory.create(inp);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sheet = wb.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.getRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.getCell(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (cell == null)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell = row.createCell(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellType(CellType.STRING);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("a test");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Write the output to a file</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_6bce7821a7f44e3ea00c702474396822" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="NewLinesInCells" id="NewLinesInCells"></a><a name="Using+newlines+in+cells"></a>
     <h4>Using newlines in cells
      <div name="tsUpdate" data-id="t_9abe02d073cf4c6ca89df0d72ff4fcbb" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span>or new HSSFWorkbook();
         <div name="tsUpdate" data-id="t_58fe779fca2844b0a421086318f401a6" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Use \n with word wrap on to create a new line");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//to enable newlines you need set a cell styles with wrap=true</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_fd50fcfe9adf4bb5830aafd45bbfbf47" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setWrapText(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cs);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//increase row height to accommodate two lines of text</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_12e03d7217b0419d8398e946077412c3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.setHeightInPoints((2*sheet.getDefaultRowHeightInPoints()));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//adjust column width to fit the content</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_051187ed5c3b444baa51c91f4bd9ced1" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("ooxml-newlines.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="DataFormats" id="DataFormats"></a><a name="Data+Formats"></a>
     <h4>Data Formats
      <div name="tsUpdate" data-id="t_84b3c88f5fea472cab616665aac67579" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataFormat format = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowNum = 0;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int colNum = 0;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row = sheet.createRow(rowNum++);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(colNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(11111.25);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setDataFormat(format.getFormat("0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row = sheet.createRow(rowNum++);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(colNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(11111.25);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setDataFormat(format.getFormat("#,##0.0000"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FitTo" id="FitTo"></a><a name="Fit+Sheet+to+One+Page"></a>
     <h4>Fit Sheet to One Page
      <div name="tsUpdate" data-id="t_6fa05d4cbdf34b228e486e42909c839c" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PrintSetup ps = sheet.getPrintSetup();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setAutobreaks(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ps.setFitHeight((short)1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ps.setFitWidth((short)1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3ee17f80e7a540daa60e3081a3967cb1" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="PrintArea2" id="PrintArea2"></a><a name="Set+Print+Area"></a>
     <h4>Set Print Area
      <div name="tsUpdate" data-id="t_605564e7c4484cc1a5f19865a371cf67" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//sets the print area for the first sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_cb7ff736760348d0b545060331257d49" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setPrintArea(0, "$A$1:$C$2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Alternatively:</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_8179d1387acc457f8bc5d7cabdbed798" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setPrintArea(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span>sheet index
         <div name="tsUpdate" data-id="t_c54764f248174dad884c44ca28c6d1df" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span>start column
         <div name="tsUpdate" data-id="t_82758636af1c4e1db9700b14f0a9ebc6" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span>end column
         <div name="tsUpdate" data-id="t_a9b130c39474419385e98b7f4088a9e9" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span>start row
         <div name="tsUpdate" data-id="t_5d899fa7efb5449dbddd27eefc225613" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0 //<span>end row
         <div name="tsUpdate" data-id="t_de32070ba53d4ffa8db65ca4711bf37a" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FooterPageNumbers" id="FooterPageNumbers"></a><a name="Set+Page+Numbers+on+Footer"></a>
     <h4>Set Page Numbers on Footer
      <div name="tsUpdate" data-id="t_baef387ebebf4a77972e77344ba1ae47" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span> or new XSSFWorkbook();
         <div name="tsUpdate" data-id="t_57d8d8a79b5245208e879cacd0eee6d7" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Footer footer = sheet.getFooter();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">footer.setRight( "Page " + HeaderFooter.page() + " of " + HeaderFooter.numPages() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_cf642f9bb43546388e40a5a06584bb0e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ConvenienceFunctions" id="ConvenienceFunctions"></a><a name="Using+the+Convenience+Functions"></a>
     <h4>Using the Convenience Functions
      <div name="tsUpdate" data-id="t_89a12d713d6247e7ac377cabe68aec33" data-tpl="0" data-txt-color="green"></div></h4>
     <p>The convenience functions provide utility features such as setting borders around merged regions and changing style attributes without explicitly creating new styles.
      <div name="tsUpdate" data-id="t_2a3791f572204557a00064c2a9126e5f" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span> or new XSSFWorkbook()
         <div name="tsUpdate" data-id="t_a6b837a6a0234c1e85e549c3c846e7b0" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet( "new sheet" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a merged region</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_c257b37f72c1469d8651033f72603c96" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet1.createRow( 1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row2 = sheet1.createRow( 2 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell( 1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue( "This is a test of merging" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddress region = CellRangeAddress.valueOf("B2:E5");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.addMergedRegion( region );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the border and border colors.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2ba02ef737974172be7c3d0059cd9b19" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderBottom( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderTop( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderLeft( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderRight( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBottomBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setTopBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setLeftBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setRightBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Shows some usages of HSSFCellUtil</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d5ee3894c36043a29d7f84ce31f01cd6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setIndention((short)4);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.createCell(row, 8, "This is the value of the cell", style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell2 = CellUtil.createCell( row2, 8, "This is the value of the cell");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.setAlignment(cell2, HorizontalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write out the workbook</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1bcc93ea74e144fea27c075c757c2463" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream( "workbook.xls" )) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write( fileOut );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ShiftRows" id="ShiftRows"></a><a name="Shift+rows+up+or+down+on+a+sheet"></a>
     <h4>Shift rows up or down on a sheet
      <div name="tsUpdate" data-id="t_021d6d4c8b5743e2944516a5197c38b0" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("row sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_aceecb62c73e4462ad4abe1a9893fb21" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Shift rows 6 - 11 on the spreadsheet to the top (rows 0 - 5)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f5703308f19d4073bee542bd2b71a88e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.shiftRows(5, 10, -5);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="SelectSheet" id="SelectSheet"></a><a name="Set+a+sheet+as+selected"></a>
     <h4>Set a sheet as selected
      <div name="tsUpdate" data-id="t_c852be4847ed49c4ad21640267cae8fc" data-tpl="0" data-txt-color="green"></div></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("row sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setSelected(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Zoom" id="Zoom"></a><a name="Set+the+zoom+magnification"></a>
     <h4>Set the zoom magnification
      <div name="tsUpdate" data-id="t_68094816a55c4e1a86e3dfaed780cfd0" data-tpl="0" data-txt-color="green"></div></h4>
     <p>The zoom is expressed as a fraction. For example to express a zoom of 75% use 3 for the numerator and 4 for the denominator.
      <div name="tsUpdate" data-id="t_59e1bc47b7ee4ecdbf91d4b7c652b6af" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setZoom(75); //<span> 75 percent magnification
         <div name="tsUpdate" data-id="t_c44f2997ba1b45e193e3f9d7fc530d8f" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Splits" id="Splits"></a><a name="Splits+and+freeze+panes"></a>
     <h4>Splits and freeze panes
      <div name="tsUpdate" data-id="t_d7cf132ab66749eea90fcf1b57d90269" data-tpl="0" data-txt-color="green"></div></h4>
     <p>There are two types of panes you can create; freeze panes and split panes.
      <div name="tsUpdate" data-id="t_b976543210a04a9d89e4ab95eb479c0e" data-tpl="0" data-txt-color="green"></div></p>
     <p>A freeze pane is split by columns and rows. You create a freeze pane using the following mechanism:
      <div name="tsUpdate" data-id="t_13525ffdcb1e44adafc393c0f3f2d2ff" data-tpl="0" data-txt-color="green"></div></p>
     <p>sheet1.createFreezePane( 3, 2, 3, 2 );
      <div name="tsUpdate" data-id="t_e275f2242ec445b7b7a17ac84bd6652c" data-tpl="0" data-txt-color="green"></div></p>
     <p>The first two parameters are the columns and rows you wish to split by. The second two parameters indicate the cells that are visible in the bottom right quadrant.
      <div name="tsUpdate" data-id="t_9cffec8ba5304f82b8bdf9b494ff9b10" data-tpl="0" data-txt-color="green"></div></p>
     <p>Split panes appear differently. The split area is divided into four separate work area's. The split occurs at the pixel level and the user is able to adjust the split by dragging it to a new position.
      <div name="tsUpdate" data-id="t_907750d0c8d347fb97bbc9c27fce8bd6" data-tpl="0" data-txt-color="green"></div></p>
     <p>Split panes are created with the following call:
      <div name="tsUpdate" data-id="t_2db0671502244030a1d4eb44835d3c4b" data-tpl="0" data-txt-color="green"></div></p>
     <p>sheet2.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT );
      <div name="tsUpdate" data-id="t_8f9ed7acbc50427b81e9813226440e26" data-tpl="0" data-txt-color="green"></div></p>
     <p>The first parameter is the x position of the split. This is in 1/20th of a point. A point in this case seems to equate to a pixel. The second parameter is the y position of the split. Again in 1/20th of a point.
      <div name="tsUpdate" data-id="t_0e6f56eb981148afaf7b87ef91955b9f" data-tpl="0" data-txt-color="green"></div></p>
     <p>The last parameter indicates which pane currently has the focus. This will be one of Sheet.PANE_LOWER_LEFT, PANE_LOWER_RIGHT, PANE_UPPER_RIGHT or PANE_UPPER_LEFT.
      <div name="tsUpdate" data-id="t_1f28a67553cc4e41aaf5d86d41215b6e" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("second sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet3 = wb.createSheet("third sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet4 = wb.createSheet("fourth sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze just one row</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_17d2be30a31d421a9c672b0a30f8d86f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.createFreezePane( 0, 1, 0, 1 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze just one column</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b4563032dcc94cfe8883247e58995eb2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.createFreezePane( 1, 0, 1, 0 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze the columns and rows (forget about scrolling position of the lower right quadrant).</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e7531ca660fe4b73832f5fa8452f4b30" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet3.createFreezePane( 2, 2 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a split with the lower left side being the active quadrant</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2a3d8a288d0046de9f1f90946435121f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet4.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Repeating" id="Repeating"></a><a name="Repeating+rows+and+columns"></a>
     <h4>Repeating rows and columns
      <div name="tsUpdate" data-id="t_21c45b8ff35e40ebb3f5a646a09c35b9" data-tpl="0" data-txt-color="green"></div></h4>
     <p>It's possible to set up repeating rows and columns in your printouts by using the setRepeatingRows() and setRepeatingColumns() methods in the Sheet class.
      <div name="tsUpdate" data-id="t_7c52630498244b4187538ae7430daf25" data-tpl="0" data-txt-color="green"></div></p>
     <p>These methods expect a CellRangeAddress parameter which specifies the range for the rows or columns to repeat. For setRepeatingRows(), it should specify a range of rows to repeat, with the column part spanning all columns. For setRepeatingColums(), it should specify a range of columns to repeat, with the row part spanning all rows. If the parameter is null, the repeating rows or columns will be removed.
      <div name="tsUpdate" data-id="t_99c4a5807f8342a7aa260f606334f5bc" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span> or new XSSFWorkbook();
         <div name="tsUpdate" data-id="t_d0f1bacf5ec24200b3246de23e181fc7" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("Sheet2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the rows to repeat from row 4 to 5 on the first sheet.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_a7631dac34c24546b2ebf6952372b118" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setRepeatingRows(CellRangeAddress.valueOf("4:5"));</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the columns to repeat from column A to C on the second sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_aeaaff7bf9cc46089e424ec974411718" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.setRepeatingColumns(CellRangeAddress.valueOf("A:C"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="HeaderFooter" id="HeaderFooter"></a><a name="Headers+and+Footers"></a>
     <h4>Headers and Footers
      <div name="tsUpdate" data-id="t_7acdbd815edb479aba4f44ca8f25aca0" data-tpl="0" data-txt-color="green"></div></h4>
     <p>Example is for headers but applies directly to footers.
      <div name="tsUpdate" data-id="t_f2874e68b26f47b0aeea6a4fc19ca4b8" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header = sheet.getHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setCenter("Center Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setLeft("Left Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setRight(HSSFHeader.font("Stencil-Normal", "Italic") +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFHeader.fontSize((short) 16) + "Right w/ Stencil-Normal Italic font and size 16");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="XSSFHeaderFooter" id="XSSFHeaderFooter"></a><a name="XSSF+Enhancement+for+Headers+and+Footers"></a>
     <h4>XSSF Enhancement for Headers and Footers
      <div name="tsUpdate" data-id="t_eeba066cd27e4cafa8495489bc5c9fb3" data-tpl="0" data-txt-color="green"></div></h4>
     <p>Example is for headers but applies directly to footers. Note, the above example for basic headers and footers applies to XSSF Workbooks as well as HSSF Workbooks. The HSSFHeader stuff does not work for XSSF Workbooks.
      <div name="tsUpdate" data-id="t_3587899c735043b7a99e2d77b0c149e8" data-tpl="0" data-txt-color="green"></div></p>
     <p>XSSF has the ability to handle First page headers and footers, as well as Even/Odd headers and footers. All Header/Footer Property flags can be handled in XSSF as well. The odd header and footer is the default header and footer. It is displayed on all pages that do not display either a first page header or an even page header. That is, if the Even header/footer does not exist, then the odd header/footer is displayed on even pages. If the first page header/footer does not exist, then the odd header/footer is displayed on the first page. If the even/odd property is not set, that is the same as the even header/footer not existing. If the first page property does not exist, that is the same as the first page header/footer not existing.
      <div name="tsUpdate" data-id="t_fa2c6ab2ef714e999bbb2474ec6dc25d" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = (XSSFSheet) wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a first page header</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b17c833016a44b7c96ca054f5deb81e0" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header = sheet.getFirstHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setCenter("Center First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setLeft("Left First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setRight("Right First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create an even page header</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f5eed6ac9e314b328480c056314cf7cd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header2 = sheet.getEvenHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">der2.setCenter("Center Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header2.setLeft("Left Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header2.setRight("Right Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create an odd page header</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b713d5f14eef4b7382bc634c9fc1dab2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header3 = sheet.getOddHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">der3.setCenter("Center Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header3.setLeft("Left Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header3.setRight("Right Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set/Remove Header properties</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3d5e8826a9094d6eafaaacf6d44c9f8b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFHeaderProperties prop = sheet.getHeaderFooterProperties();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.setAlignWithMargins();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.scaleWithDoc();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.removeDifferentFirstPage(); //<span> This does not remove first page headers or footers
         <div name="tsUpdate" data-id="t_187e8019cfd1408a84701b81bd7d1564" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.removeDifferentEvenOdd(); //<span> This does not remove even headers or footers
         <div name="tsUpdate" data-id="t_6e58737fdf8746f28e33a18472febd19" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="DrawingShapes" id="DrawingShapes"></a><a name="Drawing+Shapes"></a>
     <h4>Drawing Shapes
      <div name="tsUpdate" data-id="t_5d4273a28b614ab1bdcb110d8809a45f" data-tpl="0" data-txt-color="green"></div></h4>
     <p>POI supports drawing shapes using the Microsoft Office drawing tools. Shapes on a sheet are organized in a hierarchy of groups and and shapes. The top-most shape is the patriarch. This is not visible on the sheet at all. To start drawing you need to call <span class="codefrag">createPatriarch</span> on the <span class="codefrag">HSSFSheet</span> class. This has the effect erasing any other shape information stored in that sheet. By default POI will leave shape records alone in the sheet unless you make a call to this method.
      <div name="tsUpdate" data-id="t_47cbceae98254277af08f45488f8a51e" data-tpl="0" data-txt-color="green"></div></p>
     <p>To create a shape you have to go through the following steps:
      <div name="tsUpdate" data-id="t_c84e382324dc4911bb7a31d797d6e95f" data-tpl="0" data-txt-color="green"></div></p>
     <ol>
      <li>Create the patriarch.
       <div name="tsUpdate" data-id="t_6bc48c212c464a6c821890e62d81d35e" data-tpl="0" data-txt-color="green"></div></li>
      <li>Create an anchor to position the shape on the sheet.
       <div name="tsUpdate" data-id="t_69188ee74bfc468ea595424726cf7ad2" data-tpl="0" data-txt-color="green"></div></li>
      <li>Ask the patriarch to create the shape.
       <div name="tsUpdate" data-id="t_356d3300cdf14cc2b0ef2502b25b1874" data-tpl="0" data-txt-color="green"></div></li>
      <li>Set the shape type (line, oval, rectangle etc...)
       <div name="tsUpdate" data-id="t_67f9585d27dc4eb0afda6c98f677f258" data-tpl="0" data-txt-color="green"></div></li>
      <li>Set any other style details concerning the shape. (eg: line thickness, etc...)
       <div name="tsUpdate" data-id="t_2d865052943749988a6d9efef27be08b" data-tpl="0" data-txt-color="green"></div></li>
     </ol>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFPatriarch patriarch = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape1 = patriarch.createSimpleShape(a1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Text boxes are created using a different call:
      <div name="tsUpdate" data-id="t_244c31633dc3450da373e78f325cb116" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFTextbox textbox1 = patriarch.createTextbox(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new HSSFClientAnchor(0,0,0,0,(short)1,1,(short)2,2));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">textbox1.setString(new HSSFRichTextString("This is a test") );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>It's possible to use different fonts to style parts of the text in the textbox. Here's how:
      <div name="tsUpdate" data-id="t_7f55547be0484ad5bb454337553a3045" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setUnderline(HSSFFont.U_DOUBLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRichTextString string = new HSSFRichTextString("Woo!!!");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">string.applyFont(2,5,font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">textbox.setString(string );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Just as can be done manually using Excel, it is possible to group shapes together. This is done by calling <span class="codefrag">createGroup()</span> and then creating the shapes using those groups.
      <div name="tsUpdate" data-id="t_e7bbac3db6214da6818e065d6933a5a1" data-tpl="0" data-txt-color="green"></div></p>
     <p>It's also possible to create groups within groups.
      <div name="tsUpdate" data-id="t_7144d9f64d584bbab559b990b27d9e0f" data-tpl="0" data-txt-color="green"></div></p>
     <div class="warning">
      <div class="label">
       Warning
       <div name="tsUpdate" data-id="t_5cd455259f5948108961b437111c2963" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       Any group you create should contain at least two other shapes or subgroups.
       <div name="tsUpdate" data-id="t_783617373aad499da63d4ed0d1b840f4" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
     <p>Here's how to create a shape group:
      <div name="tsUpdate" data-id="t_ef7607625c744d33a73c7f4d95de6a78" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a shape group.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_34c310c4c81c428db0b911d25c30bbb3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFShapeGroup group = patriarch.createGroup(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new HSSFClientAnchor(0,0,900,200,(short)2,2,(short)2,2));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a couple of lines in the group.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_61f2dc975d2243c494233b029629877d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape1 = group.createShape(new HSSFChildAnchor(3,3,500,500));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">( (HSSFChildAnchor) shape1.getAnchor() ).setAnchor(3,3,500,500);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape2 = group.createShape(new HSSFChildAnchor(1,200,400,600));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape2.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>If you're being observant you'll noticed that the shapes that are added to the group use a new type of anchor: the <span class="codefrag">HSSFChildAnchor</span>. What happens is that the created group has it's own coordinate space for shapes that are placed into it. POI defaults this to (0,0,1023,255) but you are able to change it as desired. Here's how:
      <div name="tsUpdate" data-id="t_137823f9a699445f913792ad244c7cad" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">myGroup.setCoordinates(10,10,20,20); //<span> top-left, bottom-right
         <div name="tsUpdate" data-id="t_779d01a86e1a4be3ae1c0e428f6e1170" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>If you create a group within a group it's also going to have it's own coordinate space.
      <div name="tsUpdate" data-id="t_fd6d35edbab0425a9ba00497c9aff552" data-tpl="0" data-txt-color="green"></div></p>
     <a name="StylingShapes" id="StylingShapes"></a><a name="Styling+Shapes"></a>
     <h4>Styling Shapes
      <div name="tsUpdate" data-id="t_2806568de7c34faa88730df48bb4b96e" data-tpl="0" data-txt-color="green"></div></h4>
     <p>By default shapes can look a little plain. It's possible to apply different styles to the shapes however. The sorts of things that can currently be done are:
      <div name="tsUpdate" data-id="t_b4f95dff2cf149f6a82c6d7e57b0088f" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li>Change the fill color.
       <div name="tsUpdate" data-id="t_c9fa4d53bd4140798703fbe257cdc763" data-tpl="0" data-txt-color="green"></div></li>
      <li>Make a shape with no fill color.
       <div name="tsUpdate" data-id="t_b554d5d49e6c49f69ae0f48f57715c65" data-tpl="0" data-txt-color="green"></div></li>
      <li>Change the thickness of the lines.
       <div name="tsUpdate" data-id="t_f324309403df45d98d49c6b0dc727c1e" data-tpl="0" data-txt-color="green"></div></li>
      <li>Change the style of the lines. Eg: dashed, dotted.
       <div name="tsUpdate" data-id="t_428f63e4962d489a890431f7bc534090" data-tpl="0" data-txt-color="green"></div></li>
      <li>Change the line color.
       <div name="tsUpdate" data-id="t_e8103c2ddb0447dc9affc3f625d4ce1c" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <p>Here's an examples of how this is done:
      <div name="tsUpdate" data-id="t_8fd12884c04d4c3495daf2f73d2c592c" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape s = patriarch.createSimpleShape(a);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setShapeType(HSSFSimpleShape.OBJECT_TYPE_OVAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineStyleColor(10,10,10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setFillColor(90,10,200);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineWidth(HSSFShape.LINEWIDTH_ONE_PT * 3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineStyle(HSSFShape.LINESTYLE_DOTSYS);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Graphics2d" id="Graphics2d"></a><a name="Shapes+and+Graphics2d"></a>
     <h4>Shapes and Graphics2d
      <div name="tsUpdate" data-id="t_86e58fec6c71419fa245ce988b6caa29" data-tpl="0" data-txt-color="green"></div></h4>
     <p>While the native POI shape drawing commands are the recommended way to draw shapes in a shape it's sometimes desirable to use a standard API for compatibility with external libraries. With this in mind we created some wrappers for <span class="codefrag">Graphics</span> and <span class="codefrag">Graphics2d</span>.
      <div name="tsUpdate" data-id="t_b118c84457b14ff2941e6262cf81f028" data-tpl="0" data-txt-color="green"></div></p>
     <div class="warning">
      <div class="label">
       Warning
       <div name="tsUpdate" data-id="t_f355d3b6fb9244d5bb9b6b5c3f169594" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       It's important to not however before continuing that <span class="codefrag">Graphics2d</span> is a poor match to the capabilities of the Microsoft Office drawing commands. The older <span class="codefrag">Graphics</span> class offers a closer match but is still a square peg in a round hole.
       <div name="tsUpdate" data-id="t_830c27fc32c04b11af863d5d4235a271" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
     <p>All Graphics commands are issued into an <span class="codefrag">HSSFShapeGroup</span>. Here's how it's done:
      <div name="tsUpdate" data-id="t_abd94badd22440479fae69330b3c9957" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">group = patriarch.createGroup( a );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">group.setCoordinates( 0, 0, 80 * 4 , 12 * 23 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">float verticalPointsPerPixel = a.getAnchorHeightInPoints(sheet) / (float)Math.abs(group.getY2() - group.getY1());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">g = new EscherGraphics( group, wb, Color.black, verticalPointsPerPixel );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">g2d = new EscherGraphics2d( g );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">drawChemicalStructure( g2d );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>The first thing we do is create the group and set it's coordinates to match what we plan to draw. Next we calculate a reasonable fontSizeMultiplier then create the EscherGraphics object. Since what we really want is a <span class="codefrag">Graphics2d</span> object we create an EscherGraphics2d object and pass in the graphics object we created. Finally we call a routine that draws into the EscherGraphics2d object.
      <div name="tsUpdate" data-id="t_c11a7cccb5b841a1bdf085da04d9051a" data-tpl="0" data-txt-color="green"></div></p>
     <p>The vertical points per pixel deserves some more explanation. One of the difficulties in converting Graphics calls into escher drawing calls is that Excel does not have the concept of absolute pixel positions. It measures it's cell widths in 'characters' and the cell heights in points. Unfortunately it's not defined exactly what type of character it's measuring. Presumably this is due to the fact that the Excel will be using different fonts on different platforms or even within the same platform.
      <div name="tsUpdate" data-id="t_2fb322f9df4c4bc5a74b784c64d40251" data-tpl="0" data-txt-color="green"></div></p>
     <p>Because of this constraint we've had to implement the concept of a verticalPointsPerPixel. This the amount the font should be scaled by when you issue commands such as drawString(). To calculate this value use the follow formula:
      <div name="tsUpdate" data-id="t_0a2897d0805f4e6d83a9b738287a2193" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">multipler = groupHeightInPoints / heightOfGroup</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>The height of the group is calculated fairly simply by calculating the difference between the y coordinates of the bounding box of the shape. The height of the group can be calculated by using a convenience called <span class="codefrag">HSSFClientAnchor.getAnchorHeightInPoints()</span>.
      <div name="tsUpdate" data-id="t_75a3100c1d314fc8a17eb4ca1bdf393f" data-tpl="0" data-txt-color="green"></div></p>
     <p>Many of the functions supported by the graphics classes are not complete. Here's some of the functions that are known to work.
      <div name="tsUpdate" data-id="t_8653b0f70dde433ba0cd5fdd6aae3fd8" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li>fillRect()
       <div name="tsUpdate" data-id="t_f44b0e80d8014f17ad2493902a6aa393" data-tpl="0" data-txt-color="green"></div></li>
      <li>fillOval()
       <div name="tsUpdate" data-id="t_1f32e5ecf3e64f36b0f9ead0209f7fc7" data-tpl="0" data-txt-color="green"></div></li>
      <li>drawString()
       <div name="tsUpdate" data-id="t_fe5197a55f2e4a2fb047504e7a7e0c93" data-tpl="0" data-txt-color="green"></div></li>
      <li>drawOval()
       <div name="tsUpdate" data-id="t_b8ca263f5f824ff8a38328677bc4a835" data-tpl="0" data-txt-color="green"></div></li>
      <li>drawLine()
       <div name="tsUpdate" data-id="t_e5914437625848acb32c99901176effa" data-tpl="0" data-txt-color="green"></div></li>
      <li>clearRect()
       <div name="tsUpdate" data-id="t_40199c6eff2b48aeaf781a2eed655fab" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <p>Functions that are not supported will return and log a message using the POI logging infrastructure (disabled by default).
      <div name="tsUpdate" data-id="t_1fe3bc8b06da49f5b8c4ac2a89a4ae23" data-tpl="0" data-txt-color="green"></div></p>
     <a name="Outlining" id="Outlining"></a><a name="Outlining-N118D8"></a>
     <h4>Outlining
      <div name="tsUpdate" data-id="t_e92355ffd97d4123ba5fc6478672dec8" data-tpl="0" data-txt-color="green"></div></h4>
     <p>Outlines are great for grouping sections of information together and can be added easily to columns and rows using the POI API. Here's how:
      <div name="tsUpdate" data-id="t_a609c422ff54418db2d644e306ae3891" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 5, 14 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 7, 14 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 16, 19 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 4, 7 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 9, 12 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 10, 11 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream(filename)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>To collapse (or expand) an outline use the following calls:
      <div name="tsUpdate" data-id="t_a9451e2034c54fb499b863ed8adb4efe" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setRowGroupCollapsed( 7, true );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setColumnGroupCollapsed( 4, true );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>The row/column you choose should contain an already created group. It can be anywhere within the group.
      <div name="tsUpdate" data-id="t_82052acba8cc41bd864613385752d805" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Images" id="Images"></a> <a name="Images-N1197A"></a>
    <h2 class="boxed">Images
     <div name="tsUpdate" data-id="t_037879b4f1984d089d5d91718b25f72e" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Images are part of the drawing support. To add an image just call <span class="codefrag">createPicture()</span> on the drawing patriarch. At the time of writing the following types are supported:
      <div name="tsUpdate" data-id="t_3d7029b3b35442b99c996d32c537f097" data-tpl="0" data-txt-color="green"></div></p>
     <ul>
      <li>PNG
       <div name="tsUpdate" data-id="t_e297813f4ecd48e28281660546101113" data-tpl="0" data-txt-color="green"></div></li>
      <li>JPG
       <div name="tsUpdate" data-id="t_33f48c8c45a44b05bb8752f7ed1afbcb" data-tpl="0" data-txt-color="green"></div></li>
      <li>DIB
       <div name="tsUpdate" data-id="t_62760c2c5cc6491ca349a4ef7fc0ca78" data-tpl="0" data-txt-color="green"></div></li>
     </ul>
     <p>It should be noted that any existing drawings may be erased once you add a image to a sheet.
      <div name="tsUpdate" data-id="t_f1a43eb28be54afeb141215075b6714c" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create a new workbook</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d6cf1e36736449b1bc9aa1eaad84870b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span>or new HSSFWorkbook();
         <div name="tsUpdate" data-id="t_ec639c0ab4b243b0ba01092681e8e25c" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//add picture data to this workbook.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_112f1665a1024c0c9d2b2bb2cb496219" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">InputStream is = new FileInputStream("image1.jpeg");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">byte[] bytes = IOUtils.toByteArray(is);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int pictureIdx = wb.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">is.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper helper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4c6e76a414514a22b6e100b69824d365" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create the drawing patriarch. This is the top level container for all shapes.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9d2588d104804fcb9e6c48257e66f416" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Drawing drawing = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//add a picture shape</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5addc51b7256428e955f1207d88d1fce" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ClientAnchor anchor = helper.createClientAnchor();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set top-left corner of the picture,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//subsequent call of Picture#resize() will operate relative to it</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_8a36002c28eb4852adeca1eb82523eea" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol1(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow1(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Picture pict = drawing.createPicture(anchor, pictureIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//auto-size picture relative to its top-left corner</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_91161fe0161646c9891b177b56199696" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pict.resize();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save workbook</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_095d41b9b939480da19c74000f4dad08" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String file = "picture.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(wb instanceof XSSFWorkbook) file += "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream(file)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <div class="warning">
      <div class="label">
       Warning
       <div name="tsUpdate" data-id="t_9e108f27eed3474abc97d7a6891dc162" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       Picture.resize() works only for JPEG and PNG. Other formats are not yet supported.
       <div name="tsUpdate" data-id="t_870d667ac5974e239639786eb7ecd6dc" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
     <p>Reading images from a workbook:
      <div name="tsUpdate" data-id="t_b4fc0575c6a048a3850eeb0e089d3fc8" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ist lst = workbook.getAllPictures();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">or (Iterator it = lst.iterator(); it.hasNext(); ) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PictureData pict = (PictureData)it.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String ext = pict.suggestFileExtension();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> byte[] data = pict.getData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (ext.equals("jpeg")){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream out = new FileOutputStream("pict.jpg")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.write(data);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="NamedRanges" id="NamedRanges"></a> <a name="Named+Ranges+and+Named+Cells"></a>
    <h2 class="boxed">Named Ranges and Named Cells
     <div name="tsUpdate" data-id="t_4e7b968f168249c9b4953b5370bfef65" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Named Range is a way to refer to a group of cells by a name. Named Cell is a degenerate case of Named Range in that the 'group of cells' contains exactly one cell. You can create as well as refer to cells in a workbook by their named range. When working with Named Ranges, the classes <span class="codefrag">org.apache.poi.ss.util.CellReference</span> and <span class="codefrag">org.apache.poi.ss.util.AreaReference</span> are used.
      <div name="tsUpdate" data-id="t_1622924064b549968f5666ac5157bd5d" data-tpl="0" data-txt-color="green"></div></p>
     <p>Note: Using relative values like 'A1:B1' can lead to unexpected moving of the cell that the name points to when working with the workbook in Microsoft Excel, usually using absolute references like '$A$1:$B$1' avoids this, see also <a href="https://superuser.com/a/1031047/126954">this discussion</a>.
      <div name="tsUpdate" data-id="t_59522845aa2140d7b5020acea4e0b7a3" data-tpl="0" data-txt-color="green"></div></p>
     <p>Creating Named Range / Named Cell
      <div name="tsUpdate" data-id="t_d5964790138d4486ab1305f83326a3ee" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// setup code</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_454db840daf140d3b8704acac8ecb3eb" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String sname = "TestSheet", cname = "TestName", cvalue = "TestVal";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet(sname);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.createRow(0).createCell(0).setCellValue(cvalue);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 1. create named range for a single cell using areareference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_6c0da446ffb240b4b8c8cee2ac51b919" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCell = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCell.setNameName(cname + "1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String reference = sname+"!$A$1:$A$1"; //<span> area reference
         <div name="tsUpdate" data-id="t_8bc7c6b6d99c416099d6a00d74f4f951" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCell.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 2. create named range for a single cell using cellreference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4b71b8143e7a4196a804b28dd5713a5c" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel2 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel2.setNameName(cname + "2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">reference = sname+"!$A$1"; //<span> cell reference
         <div name="tsUpdate" data-id="t_efb4a1f118ef49439a129b73ab244899" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel2.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 3. create named range for an area using AreaReference</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_94b6ea9683f449508b5f7db12d9c10dd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel3 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel3.setNameName(cname + "3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">reference = sname+"!$A$1:$C$5"; //<span> area reference
         <div name="tsUpdate" data-id="t_9a29dfd8e69f4354886088ddf1e62d50" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel3.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 4. create named formula</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2c101efa09bd4694940f49b253c755a1" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel4 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel4.setNameName("my_sum");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel4.setRefersToFormula("SUM(" + sname + "!$I$2:$I$6)");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Reading from Named Range / Named Cell
      <div name="tsUpdate" data-id="t_ed3997e4eb0b4224bd35056525e93105" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// setup code</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_5b35f1c69af34199b5881c83d3688216" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String cname = "TestName";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = getMyWorkbook(); //<span> retrieve workbook
         <div name="tsUpdate" data-id="t_dfaba7af758c440884382bf375b77351" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// retrieve the named range</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1ee7e50db2184d18a8a4196ac780f704" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int namedCellIdx = wb.getNameIndex(cellName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name aNamedCell = wb.getNameAt(namedCellIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// retrieve the cell at the named range and test its contents</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e3160789a4374a52b0dc10235a596762" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AreaReference aref = new AreaReference(aNamedCell.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellReference[] crefs = aref.getAllReferencedCells();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i=0; i&lt;crefs.length; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.getSheet(crefs[i].getSheetName());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = sheet.getRow(crefs[i].getRow());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(crefs[i].getCol());</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // extract the cell contents based on cell type etc.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_93c680cebda04dbaa956dbe57784e307" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Reading from non-contiguous Named Ranges
      <div name="tsUpdate" data-id="t_6f23e1050b1c4b888e9376d694b38e14" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Setup code</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b48bcd672e0b4ac99e31c54048b0211b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String cname = "TestName";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = getMyWorkbook(); //<span> retrieve workbook
         <div name="tsUpdate" data-id="t_2ef2513c4149472d80faef59c72485c5" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Retrieve the named range</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Will be something like "$C$10,$D$12:$D$14";</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_452ff8566d694174985d2b32d9be50df" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int namedCellIdx = wb.getNameIndex(cellName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name aNamedCell = wb.getNameAt(namedCellIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Retrieve the cell at the named range and test its contents</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Will get back one AreaReference for C10, and</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// another for D12 to D14</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ff6bebecbbad4f2b8ee20bf68dafa499" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AreaReference[] arefs = AreaReference.generateContiguous(aNamedCell.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i=0; i&lt;arefs.length; i++) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Only get the corners of the Area</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // (use arefs[i].getAllReferencedCells() to get all cells)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3d682130e710407aa9bcad428eb60fdd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellReference[] crefs = arefs[i].getCells();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int j=0; j&lt;crefs.length; j++) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Check it turns into real stuff</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2fc38ff58f784c9cba4ea876a2bbfec3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.getSheet(crefs[j].getSheetName());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = s.getRow(crefs[j].getRow());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(crefs[j].getCol());</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something with this corner cell</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e453e792e02f4a71884695385713fa0e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Note, when a cell is deleted, Excel does not delete the attached named range. As result, workbook can contain named ranges that point to cells that no longer exist. You should check the validity of a reference before constructing AreaReference
      <div name="tsUpdate" data-id="t_91cbfd912b16436096795976bbbccbd8" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(name.isDeleted()){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //named range points to a deleted cell.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_99e33a16ddbf41bc91b7caec6f3bb780" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">} else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> AreaReference ref = new AreaReference(name.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="CellComments" id="CellComments"></a> <a name="Cell+Comments+-+HSSF+and+XSSF"></a>
    <h2 class="boxed">Cell Comments - HSSF and XSSF
     <div name="tsUpdate" data-id="t_99db04d052d94acebfe69b657a626e5b" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>A comment is a rich text note that is attached to &amp; associated with a cell, separate from other cell content. Comment content is stored separate from the cell, and is displayed in a drawing object (like a text box) that is separate from, but associated with, a cell
      <div name="tsUpdate" data-id="t_7576e395700a4dc894ab99976ffecbab" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span>or new HSSFWorkbook();
         <div name="tsUpdate" data-id="t_89dfadc25cc64d08a4eed0cb756908e5" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper factory = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(5);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("F4");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Drawing drawing = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// When the comment box is visible, have it show in a 1x3 space</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d581d5e9d03d42528292186d9df8f29e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ClientAnchor anchor = factory.createClientAnchor();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol1(cell.getColumnIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol2(cell.getColumnIndex()+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow1(row.getRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow2(row.getRowNum()+3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create the comment and set the text+author</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ce91c9fdba794b4096ff5786dafbb6ed" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment comment = drawing.createCellComment(anchor);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RichTextString str = factory.createRichTextString("Hello, World!");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment.setString(str);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment.setAuthor("Apache POI");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Assign the comment to the cell</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1fbb7e4a479e4561999273354aafda72" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellComment(comment);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String fname = "comment-xssf.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(wb instanceof XSSFWorkbook) fname += "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream(fname)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Reading cell comments
      <div name="tsUpdate" data-id="t_54661e5038954682a0cd6efe750d4d2f" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = sheet.get(3).getColumn(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment comment = cell.getCellComment();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if (comment != null) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> RichTextString str = comment.getString();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String author = comment.getAuthor();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// alternatively you can retrieve cell comments by (row, column)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_44c43da9e2d64107bc567f91dd680a53" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment = sheet.getCellComment(3, 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p>To get all the comments on a sheet:
      <div name="tsUpdate" data-id="t_1e50e4af77ec4d608398722540835cf1" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Map&lt;CellAddress, Comment&gt; comments = sheet.getCellComments();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment commentA1 = comments.get(new CellAddress(0, 0));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment commentB1 = comments.get(new CellAddress(0, 1));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Entry&lt;CellAddress, ? extends Comment&gt; e : comments.entrySet()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellAddress loc = e.getKey();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Comment comment = e.getValue();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Comment at " + loc + ": " +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "[" + comment.getAuthor() + "] " + comment.getString().getString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
    </div>
    <a name="Autofit" id="Autofit"></a> <a name="Adjust+column+width+to+fit+the+contents"></a>
    <h2 class="boxed">Adjust column width to fit the contents
     <div name="tsUpdate" data-id="t_2f1d4b19827e41b3b825e3e3d973a41c" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(0); //<span>adjust width of the first column
         <div name="tsUpdate" data-id="t_b365da57911447488b6b48f0f66b9e16" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(1); //<span>adjust width of the second column
         <div name="tsUpdate" data-id="t_2664d27443974170a84f53ae60dfa3ed" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>For SXSSFWorkbooks only, because the random access window is likely to exclude most of the rows in the worksheet, which are needed for computing the best-fit width of a column, the columns must be tracked for auto-sizing prior to flushing any rows.
      <div name="tsUpdate" data-id="t_fe42e0eb130b49809e70121cffc857f6" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFWorkbook workbook = new SXSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFSheet sheet = workbook.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.trackColumnForAutoSizing(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.trackColumnForAutoSizing(1);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If you have a Collection of column indices, see SXSSFSheet#trackColumnForAutoSizing(Collection&lt;Integer&gt;)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// or roll your own for-loop.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Alternatively, use SXSSFSheet#trackAllColumnsForAutoSizing() if the columns that will be auto-sized aren't</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// known in advance or you are upgrading existing code and are trying to minimize changes. Keep in mind</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// that tracking all columns will require more memory and CPU cycles, as the best-fit width is calculated</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// on all tracked columns on every row that is flushed.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f0ef48754e904cf39383b6a30f2f2ca5" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create some cells</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_64f5a7e0ed654fe6bf63961665f37be2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int r=0; r &lt; 10; r++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(r);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int c; c &lt; 10; c++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(c);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("Cell " + c.getAddress().formatAsString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Auto-size the columns.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_3eadf7021465433796454c6cae991b02" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p>Note, that Sheet#autoSizeColumn() does not evaluate formula cells, the width of formula cells is calculated based on the cached formula result. If your workbook has many formulas then it is a good idea to evaluate them before auto-sizing.
      <div name="tsUpdate" data-id="t_661e9bc831bf4984940fe89b593fc26e" data-tpl="0" data-txt-color="green"></div></p>
     <div class="warning">
      <div class="label">
       Warning
       <div name="tsUpdate" data-id="t_4f37fa410a8a4875a07ee0c39448a94a" data-tpl="0" data-txt-color="orange"></div>
      </div>
      <div class="content">
       To calculate column width Sheet.autoSizeColumn uses Java2D classes that throw exception if graphical environment is not available. In case if graphical environment is not available, you must tell Java that you are running in headless mode and set the following system property: <span class="codefrag"> java.awt.headless=true </span>. You should also ensure that the fonts you use in your workbook are available to Java.
       <div name="tsUpdate" data-id="t_078bb1ad5cb4498a8c3fa24d112c5389" data-tpl="0" data-txt-color="green"></div>
      </div>
     </div>
    </div>
    <a name="Hyperlinks" id="Hyperlinks"></a> <a name="How+to+read+hyperlinks"></a>
    <h2 class="boxed">How to read hyperlinks
     <div name="tsUpdate" data-id="t_e2a0bbbfe632408eb804e33d3b93269a" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = sheet.getRow(0).getCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link = cell.getHyperlink();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(link != null){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(link.getAddress());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="How+to+create+hyperlinks"></a>
    <h2 class="boxed">How to create hyperlinks
     <div name="tsUpdate" data-id="t_7423561b7d314d43bcf6f9ec513d6105" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span>or new HSSFWorkbook();
         <div name="tsUpdate" data-id="t_eb1ca22ef8ba432d8afa56848dd37bd5" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//cell style for hyperlinks</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//by default hyperlinks are blue and underlined</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9da1758457974c328caa7c97310ef993" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle hlink_style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font hlink_font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_font.setUnderline(Font.U_SINGLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_font.setColor(IndexedColors.BLUE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_style.setFont(hlink_font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("Hyperlinks");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//URL</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_af26495288904d4a9ccf49a5c0521605" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(0).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("URL Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link = createHelper.createHyperlink(Hyperlink.LINK_URL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("https://<span>poi.apache.org/");
         <div name="tsUpdate" data-id="t_d648c385b4c94f96bd9c9c8d4a099a12" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//link to a file in the current directory</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_20ed2fe7edea49e980566060079c3028" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(1).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("File Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link = createHelper.createHyperlink(Hyperlink.LINK_FILE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("link1.xls");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//e-mail link</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_81ddb3c07e7341e18fee8300eaade611" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(2).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Email Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link = createHelper.createHyperlink(Hyperlink.LINK_EMAIL);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//note, if subject contains white spaces, make sure they are url-encoded</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_a0fb70af5d4d43b094155421b8147fa5" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("mailto:poi@apache.org?subject=Hyperlinks");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//link to a place in this workbook</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_0332469406b241a3abaa3733f35c2247" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create a target sheet and cell</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d304f92f737d42f8a8955b2b027db0d2" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("Target Sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.createRow(0).createCell(0).setCellValue("Target Cell");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(3).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Worksheet Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link2 = createHelper.createHyperlink(Hyperlink.LINK_DOCUMENT);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link2.setAddress("'Target Sheet'!A1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream("hyperinks.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Validation" id="Validation"></a> <a name="Data+Validations"></a>
    <h2 class="boxed">Data Validations
     <div name="tsUpdate" data-id="t_88591fd349b4485881be518a4e0de738" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>As of version 3.8, POI has slightly different syntax to work with data validations with .xls and .xlsx formats.
      <div name="tsUpdate" data-id="t_6c54cf0c213745eebc7d7d144f94878b" data-tpl="0" data-txt-color="green"></div></p>
     <a name="hssf.usermodel+%28binary+.xls+format%29"></a>
     <h3 class="boxed">hssf.usermodel (binary .xls format)
      <div name="tsUpdate" data-id="t_c3ee0b830ff04f4e8209e12267146522" data-tpl="0" data-txt-color="orange"></div></h3>
     <p><strong>Check the value a user enters into a cell against one or more predefined value(s).</strong>
      <div name="tsUpdate" data-id="t_a2a80dc30f814e5e8a9c6ad48e578b03" data-tpl="0" data-txt-color="green"></div></p>
     <p>The following code will limit the value the user can enter into cell A1 to one of three integer values, 10, 20 or 30.
      <div name="tsUpdate" data-id="t_9d78daa6dbd64ffabf5cb73aee182bfc" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"10", "20", "30"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation dataValidation = new HSSFDataValidation</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (addressList, dvConstraint);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(dataValidation);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><strong> Drop Down Lists:</strong>
      <div name="tsUpdate" data-id="t_1a8d54b2f15d442d936a6315e28622c1" data-tpl="0" data-txt-color="green"></div></p>
     <p>This code will do the same but offer the user a drop down list to select a value from.
      <div name="tsUpdate" data-id="t_a4769689712b4e49b8297529e7d9dce3" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"10", "20", "30"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation dataValidation = new HSSFDataValidation</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (addressList, dvConstraint);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(dataValidation);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><strong>Messages On Error:</strong>
      <div name="tsUpdate" data-id="t_19848b0eb34e41a0b74247be4ec10cf8" data-tpl="0" data-txt-color="green"></div></p>
     <p>To create a message box that will be shown to the user if the value they enter is invalid.
      <div name="tsUpdate" data-id="t_17ee633c5b684378a20391acc8cc3e03" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setErrorStyle(DataValidation.ErrorStyle.STOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.createErrorBox("Box Title", "Message Text");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Replace 'Box Title' with the text you wish to display in the message box's title bar and 'Message Text' with the text of your error message.
      <div name="tsUpdate" data-id="t_6babf0a377ac459ba3eed5f535bc6d5d" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Prompts:</strong>
      <div name="tsUpdate" data-id="t_ebae036fb1754cf1810ab34ba30351ee" data-tpl="0" data-txt-color="green"></div></p>
     <p>To create a prompt that the user will see when the cell containing the data validation receives focus
      <div name="tsUpdate" data-id="t_f2d9669432ef48589183cadefc31ecb7" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.createPromptBox("Title", "Message Text");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setShowPromptBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>The text encapsulated in the first parameter passed to the createPromptBox() method will appear emboldened and as a title to the prompt whilst the second will be displayed as the text of the message. The createExplicitListConstraint() method can be passed and array of String(s) containing interger, floating point, dates or text values.
      <div name="tsUpdate" data-id="t_1899954171f849e189343391023cbb92" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Further Data Validations:</strong>
      <div name="tsUpdate" data-id="t_d67b2a6edd664c359507101cce6e9632" data-tpl="0" data-txt-color="green"></div></p>
     <p>To obtain a validation that would check the value entered was, for example, an integer between 10 and 100, use the DVConstraint.createNumericConstraint(int, int, String, String) factory method.
      <div name="tsUpdate" data-id="t_ae5831582ae84f5fa5e006d5fe59ce58" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.OperatorType.BETWEEN, "10", "100");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>Look at the javadoc for the other validation and operator types; also note that not all validation types are supported for this method. The values passed to the two String parameters can be formulas; the '=' symbol is used to denote a formula
      <div name="tsUpdate" data-id="t_1fb81c55f2a1417e930606e4279ad51d" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.OperatorType.BETWEEN, "=SUM(A1:A3)", "100");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>It is not possible to create a drop down list if the createNumericConstraint() method is called, the setSuppressDropDownArrow(false) method call will simply be ignored.
      <div name="tsUpdate" data-id="t_58af5fbbbea146139baddbcfe8d3e28b" data-tpl="0" data-txt-color="green"></div></p>
     <p>Date and time constraints can be created by calling the createDateConstraint(int, String, String, String) or the createTimeConstraint(int, String, String). Both are very similar to the above and are explained in the javadoc.
      <div name="tsUpdate" data-id="t_1d21d5e6481a45bc8a29579418836f84" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Creating Data Validations From Spreadsheet Cells.</strong>
      <div name="tsUpdate" data-id="t_f97de06306c347cfb9b7ed6435445b28" data-tpl="0" data-txt-color="green"></div></p>
     <p>The contents of specific cells can be used to provide the values for the data validation and the DVConstraint.createFormulaListConstraint(String) method supports this. To specify that the values come from a contiguous range of cells do either of the following:
      <div name="tsUpdate" data-id="t_107816f19f114f9dbae00b9676913902" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>or
      <div name="tsUpdate" data-id="t_efe808d6874140af8c27c0ee198a6021" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>and in both cases the user will be able to select from a drop down list containing the values from cells A1, A2 and A3.
      <div name="tsUpdate" data-id="t_294e9c20d6c7439c89251bfcde9a3894" data-tpl="0" data-txt-color="green"></div></p>
     <p>The data does not have to be as the data validation. To select the data from a different sheet however, the sheet must be given a name when created and that name should be used in the formula. So assuming the existence of a sheet named 'Data Sheet' this will work:
      <div name="tsUpdate" data-id="t_5b269e3c4bcd4d519a6efd8ffd39aba0" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("'Data Sheet'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>as will this:
      <div name="tsUpdate" data-id="t_c79194b5d6924059a9f0990666bb59aa" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("'Data Sheet'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>whilst this will not:
      <div name="tsUpdate" data-id="t_6299675d990549969ffb97dc20c7b11b" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("'Sheet1'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>and nor will this:
      <div name="tsUpdate" data-id="t_cafe9a874413462dada9af5719189182" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("'Sheet1'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="xssf.usermodel+%28.xlsx+format%29"></a>
     <h3 class="boxed">xssf.usermodel (.xlsx format)
      <div name="tsUpdate" data-id="t_318d9a27a5bc454c8e0844b00fd55c52" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>Data validations work similarly when you are creating an xml based, SpreadsheetML, workbook file; but there are differences. Explicit casts are required, for example, in a few places as much of the support for data validations in the xssf stream was built into the unifying ss stream, of which more later. Other differences are noted with comments in the code.
      <div name="tsUpdate" data-id="t_d372edf5085a424380f7944372792b4f" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Check the value the user enters into a cell against one or more predefined value(s).</strong>
      <div name="tsUpdate" data-id="t_6ef42ea89efa4d399dd2d626741c571b" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createExplicitListConstraint(new String[]{"11", "21", "31"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation =(XSSFDataValidation)dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Here the boolean value false is passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method. In the hssf.usermodel examples above, the value passed to this</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method is true.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e6c7a8cd24e34db39f42279cbf1a9e00" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note this extra method call. If this method call is omitted, or if the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value false is passed, then Excel will not validate the value the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// user enters into the cell.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_851a55a8a53d45ba9691091f6bc8a868" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><strong>Drop Down Lists:</strong>
      <div name="tsUpdate" data-id="t_24888ec25c30439baafb72b3c90dd07b" data-tpl="0" data-txt-color="green"></div></p>
     <p>This code will do the same but offer the user a drop down list to select a value from.
      <div name="tsUpdate" data-id="t_61116dffc0f34e52afd86c2bfa4a8ab6" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createExplicitListConstraint(new String[]{"11", "21", "31"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation = (XSSFDataValidation)dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p>Note that the call to the setSuppressDropDowmArrow() method can either be simply excluded or replaced with:
      <div name="tsUpdate" data-id="t_bfd161696aae49ab93e3366222e53af7" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(true);</span>
      </div>
     </div>
     <p><strong>Prompts and Error Messages:</strong>
      <div name="tsUpdate" data-id="t_0b28b3d423ab4923b85032c7a8458242" data-tpl="0" data-txt-color="green"></div></p>
     <p>These both exactly mirror the hssf.usermodel so please refer to the 'Messages On Error:' and 'Prompts:' sections above.
      <div name="tsUpdate" data-id="t_76450dd2201c46bab458a1f17369bf9c" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Further Data Validations:</strong>
      <div name="tsUpdate" data-id="t_d35b7926eaca496b807498e7a0965c80" data-tpl="0" data-txt-color="green"></div></p>
     <p>To obtain a validation that would check the value entered was, for example, an integer between 10 and 100, use the XSSFDataValidationHelper(s) createNumericConstraint(int, int, String, String) factory method.
      <div name="tsUpdate" data-id="t_cd5b9938391b4b578eb90dbab10df510" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.OperatorType.BETWEEN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "10", "100");</span>
      </div>
     </div>
     <p>The values passed to the final two String parameters can be formulas; the '=' symbol is used to denote a formula. Thus, the following would create a validation the allows values only if they fall between the results of summing two cell ranges
      <div name="tsUpdate" data-id="t_c6a4c0b74c88467689f16569eafcb42d" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.OperatorType.BETWEEN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "=SUM(A1:A10)", "=SUM(B24:B27)");</span>
      </div>
     </div>
     <p>It is not possible to create a drop down list if the createNumericConstraint() method is called, the setSuppressDropDownArrow(true) method call will simply be ignored.
      <div name="tsUpdate" data-id="t_c8c06227a6324f65b80fd5a7b0def33e" data-tpl="0" data-txt-color="green"></div></p>
     <p>Please check the javadoc for other constraint types as examples for those will not be included here. There are, for example, methods defined on the XSSFDataValidationHelper class allowing you to create the following types of constraint; date, time, decimal, integer, numeric, formula, text length and custom constraints.
      <div name="tsUpdate" data-id="t_50ca4f116dee4eff8cbc7b5f3f2a0cbf" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Creating Data Validations From Spread Sheet Cells:</strong>
      <div name="tsUpdate" data-id="t_7ac97c11face47caa7c2e54d547faf20" data-tpl="0" data-txt-color="green"></div></p>
     <p>One other type of constraint not mentioned above is the formula list constraint. It allows you to create a validation that takes it value(s) from a range of cells. This code
      <div name="tsUpdate" data-id="t_68f5aba44e5945949727e704fcf1f35b" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createFormulaListConstraint("$A$1:$F$1");</span>
      </div>
     </div>
     <p>would create a validation that took it's values from cells in the range A1 to F1.
      <div name="tsUpdate" data-id="t_5cd22fad4ba841ecae06af5671c8b157" data-tpl="0" data-txt-color="green"></div></p>
     <p>The usefulness of this technique can be extended if you use named ranges like this;
      <div name="tsUpdate" data-id="t_d864633535ce4669b83f45e055e1ee15" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFName name = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setNameName("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setRefersToFormula("$B$1:$F$1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createFormulaListConstraint("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation = (XSSFDataValidation)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createValidation(dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p>OpenOffice Calc has slightly different rules with regard to the scope of names. Excel supports both Workbook and Sheet scope for a name but Calc does not, it seems only to support Sheet scope for a name. Thus it is often best to fully qualify the name for the region or area something like this;
      <div name="tsUpdate" data-id="t_fcd1f06445ed4a199b2a6d9b486bcbf4" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFName name = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setNameName("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setRefersToFormula("'Data Validation'!$B$1:$F$1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
     </div>
     <p>This does open a further, interesting opportunity however and that is to place all of the data for the validation(s) into named ranges of cells on a hidden sheet within the workbook. These ranges can then be explicitly identified in the setRefersToFormula() method argument.
      <div name="tsUpdate" data-id="t_c098101fade747e5b86257649c78dc16" data-tpl="0" data-txt-color="green"></div></p>
     <a name="ss.usermodel"></a>
     <h3 class="boxed">ss.usermodel
      <div name="tsUpdate" data-id="t_124099d4a81e4797843a6d781c0644e2" data-tpl="0" data-txt-color="orange"></div></h3>
     <p>The classes within the ss.usermodel package allow developers to create code that can be used to generate both binary (.xls) and SpreadsheetML (.xlsx) workbooks.
      <div name="tsUpdate" data-id="t_654a653141ca4a07ae799a6970e5310c" data-tpl="0" data-txt-color="green"></div></p>
     <p>The techniques used to create data validations share much in common with the xssf.usermodel examples above. As a result just one or two examples will be presented here.
      <div name="tsUpdate" data-id="t_a225e111976849d0a9fef056fa632504" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Check the value the user enters into a cell against one or more predefined value(s).</strong>
      <div name="tsUpdate" data-id="t_329992d38083496d9019de6d38924a24" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span> or new HSSFWorkbook
         <div name="tsUpdate" data-id="t_754e47d1d61c45678a0acd6eb2b70c02" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"13", "23", "33"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note the check on the actual type of the DataValidation object.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If it is an instance of the XSSFDataValidation class then the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value 'false' must be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method and an explicit call made to the setShowErrorBox() method.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_78ce6d8cb7874f9aae7ebf40ecf69d3d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(validation instanceof XSSFDataValidation) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // If the Datavalidation contains an instance of the HSSFDataValidation</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // class then 'true' should be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // method and the call to setShowErrorBox() is not necessary.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_1e8513ea4da14e25a8656f2dc3f0c113" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><strong>Drop Down Lists:</strong>
      <div name="tsUpdate" data-id="t_9e8e82841b374132acf10ba53704b878" data-tpl="0" data-txt-color="green"></div></p>
     <p>This code will do the same but offer the user a drop down list to select a value from.
      <div name="tsUpdate" data-id="t_ff9584a95b2a4257926f8a983f753dca" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span> or new HSSFWorkbook
         <div name="tsUpdate" data-id="t_be93f3c923024447b90ba96732a70721" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"13", "23", "33"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note the check on the actual type of the DataValidation object.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If it is an instance of the XSSFDataValidation class then the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value 'false' must be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method and an explicit call made to the setShowErrorBox() method.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d09e319ff4484518917756fd6a9a90ad" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(validation instanceof XSSFDataValidation) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // If the Datavalidation contains an instance of the HSSFDataValidation</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // class then 'true' should be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // method and the call to setShowErrorBox() is not necessary.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7c478b9da9834fa899e1b7ee8e10ec1f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><strong>Prompts and Error Messages:</strong>
      <div name="tsUpdate" data-id="t_d4237fd59aea4f10ba77a3d416149886" data-tpl="0" data-txt-color="green"></div></p>
     <p>These both exactly mirror the hssf.usermodel so please refer to the 'Messages On Error:' and 'Prompts:' sections above.
      <div name="tsUpdate" data-id="t_27245f2b36ea4b62a47464e2789cb697" data-tpl="0" data-txt-color="green"></div></p>
     <p>As the differences between the ss.usermodel and xssf.usermodel examples are small - restricted largely to the way the DataValidationHelper is obtained, the lack of any need to explicitly cast data types and the small difference in behaviour between the hssf and xssf interpretation of the setSuppressDropDowmArrow() method, no further examples will be included in this section.
      <div name="tsUpdate" data-id="t_c9b4635ad8a745c59a6ec2099f642a5f" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Advanced Data Validations.</strong>
      <div name="tsUpdate" data-id="t_2ec39cae26d9474092225b15d11bc7b7" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>Dependent Drop Down Lists.</strong>
      <div name="tsUpdate" data-id="t_0a1839a7175043f4bd0c8c61749d30f8" data-tpl="0" data-txt-color="green"></div></p>
     <p>In some cases, it may be necessary to present to the user a sheet which contains more than one drop down list. Further, the choice the user makes in one drop down list may affect the options that are presented to them in the second or subsequent drop down lists. One technique that may be used to implement this behaviour will now be explained.
      <div name="tsUpdate" data-id="t_64c82575a7b2431ba0c43d70a5ac18f5" data-tpl="0" data-txt-color="green"></div></p>
     <p>There are two keys to the technique; one is to use named areas or regions of cells to hold the data for the drop down lists, the second is to use the INDIRECT() function to convert between the name and the actual addresses of the cells. In the example section there is a complete working example- called LinkedDropDownLists.java - that demonstrates how to create linked or dependent drop down lists. Only the more relevant points are explained here.
      <div name="tsUpdate" data-id="t_7fbf572402b84b84b575b3c96b5c59df" data-tpl="0" data-txt-color="green"></div></p>
     <p>To create two drop down lists where the options shown in the second depend upon the selection made in the first, begin by creating a named region of cells to hold all of the data for populating the first drop down list. Next, create a data validation that will look to this named area for its data, something like this;
      <div name="tsUpdate" data-id="t_4e9b69653d6f487a9636151a1bfebaf1" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createFormulaListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "CHOICES");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p>Note that the name of the area - in the example above it is 'CHOICES' - is simply passed to the createFormulaListConstraint() method. This is sufficient to cause Excel to populate the drop down list with data from that named region.
      <div name="tsUpdate" data-id="t_c6b2558790e74f5eace8445d0697e1df" data-tpl="0" data-txt-color="green"></div></p>
     <p>Next, for each of the options the user could select in the first drop down list, create a matching named region of cells. The name of that region should match the text the user could select in the first drop down list. Note, in the example, all upper case letters are used in the names of the regions of cells.
      <div name="tsUpdate" data-id="t_28b47ea0eac74bf1acd284edf76be1a6" data-tpl="0" data-txt-color="green"></div></p>
     <p>Now, very similar code can be used to create a second, linked, drop down list;
      <div name="tsUpdate" data-id="t_a195550a80604f38b8b5b1fc44910855" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 1, 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createFormulaListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "INDIRECT(UPPER($A$1))");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p>The key here is in the following Excel function - INDIRECT(UPPER($A$1)) - which is used to populate the second, linked, drop down list. Working from the inner-most pair of brackets, it instructs Excel to look at the contents of cell A1, to convert what it reads there into upper case  as upper case letters are used in the names of each region - and then convert this name into the addresses of those cells that contain the data to populate another drop down list.
      <div name="tsUpdate" data-id="t_c9df6e52a405461f91bb1ae298417194" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Embedded" id="Embedded"></a> <a name="Embedded+Objects"></a>
    <h2 class="boxed">Embedded Objects
     <div name="tsUpdate" data-id="t_0443af253f89498cb60f890286375432" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>It is possible to perform more detailed processing of an embedded Excel, Word or PowerPoint document, or to work with any other type of embedded object.
      <div name="tsUpdate" data-id="t_ca47750fc01d4a09a3025e96cd02ea76" data-tpl="0" data-txt-color="green"></div></p>
     <p><strong>HSSF:</strong>
      <div name="tsUpdate" data-id="t_4858a8bfdec1431ab1e53f881b7e67ef" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(new File("excel_with_embeded.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook(fs);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (HSSFObjectData obj : workbook.getAllEmbeddedObjects()) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //the OLE2 Class Name of the object</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_313c381fa5904c7b8f4ffe2cc325e420" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String oleName = obj.getOLE2ClassName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (oleName.equals("Worksheet")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(dn, false);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedWorkbook.getNumberOfSheets());</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e4595f398ddb4b96bc64c5504fc0f92c" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (oleName.equals("Document")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HWPFDocument embeddedWordDocument = new HWPFDocument(dn);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedWordDocument.getRange().text());</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_94d6916493444b47bd0c8178031aaeb0" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (oleName.equals("Presentation")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SlideShow&lt;?,?&gt; embeddedPowerPointDocument = new HSLFSlideShow(dn);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedPowerPointDocument.getSlides().length);</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_539b2109649a4b398ebdd77884a6cf7c" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(obj.hasDirectoryEntry()){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // The DirectoryEntry is a DocumentNode. Examine its entries to find out what it is</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_2d47be3322d04140adae7b85c36fdeb4" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Entry entry : dn) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(oleName + "." + entry.getName());</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7387368365064e68aa04e8cadad87ec6" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // There is no DirectoryEntry</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Recover the object's data from the HSSFObjectData instance.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_eec469f06f114d7dba15daa6c49251a0" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> byte[] objectData = obj.getObjectData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><strong>XSSF:</strong>
      <div name="tsUpdate" data-id="t_6df8e30c0cb44f2ca0392086b4809efe" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook("excel_with_embeded.xlsx");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (PackagePart pPart : workbook.getAllEmbeddedParts()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String contentType = pPart.getContentType();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel Workbook - either binary or OpenXML</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_428b197afc2440ed91f00e2d71be55cf" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (contentType.equals("application/vnd.ms-excel")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel Workbook - OpenXML file format</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_112ac18607bf40efa748d6988e07d17f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFWorkbook embeddedWorkbook = new XSSFWorkbook(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Word Document - binary (OLE2CDF) file format</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d33a1938696d41038aaa59d2748d6ce7" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/msword")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HWPFDocument document = new HWPFDocument(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Word Document - OpenXML file format</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_6d90cc6473034248ba123840f722bb9f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.wordprocessingml.document")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XWPFDocument document = new XWPFDocument(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // PowerPoint Document - binary file format</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_35f5940d45cf47b395cc40098d4b6a58" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.ms-powerpoint")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSLFSlideShow slideShow = new HSLFSlideShow(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // PowerPoint Document - OpenXML file format</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_f229f41151504e28b28e4874f222f796" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.presentationml.presentation")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSLFSlideShow slideShow = new XSLFSlideShow(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Any other type of embedded object.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_9c18f1b491624ce2b8ec0a6833ccdc8f" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Unknown Embedded Document: " + contentType);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputStream inputStream = pPart.getInputStream();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Autofilter" id="Autofilter"></a>
    <p>(Since POI-3.7)
     <div name="tsUpdate" data-id="t_f1160ec5a95248dcbd922b8fb68faeff" data-tpl="0" data-txt-color="green"></div></p>
    <a name="Autofilters"></a>
    <h2 class="boxed">Autofilters
     <div name="tsUpdate" data-id="t_cff02acc8c2746b2a60c63a72141ed57" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span>or new XSSFWorkbook();
         <div name="tsUpdate" data-id="t_6e6b3fe309584d998367103f5eefc87e" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setAutoFilter(CellRangeAddress.valueOf("C5:F200"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="ConditionalFormatting" id="ConditionalFormatting"></a> <a name="Conditional+Formatting"></a>
    <h2 class="boxed">Conditional Formatting
     <div name="tsUpdate" data-id="t_ace853548919493fa92bf6e873e5f5ff" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new HSSFWorkbook(); //<span> or new XSSFWorkbook();
         <div name="tsUpdate" data-id="t_247e8fe87edc49ff8ca056bfd0dd282a" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SheetConditionalFormatting sheetCF = sheet.getSheetConditionalFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule rule1 = sheetCF.createConditionalFormattingRule(ComparisonOperator.EQUAL, "0");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FontFormatting fontFmt = rule1.createFontFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fontFmt.setFontStyle(true, false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fontFmt.setFontColorIndex(IndexedColors.DARK_RED.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BorderFormatting bordFmt = rule1.createBorderFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderBottom(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderTop(BorderStyle.THICK);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderLeft(BorderStyle.DASHED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderRight(BorderStyle.DOTTED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PatternFormatting patternFmt = rule1.createPatternFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">patternFmt.setFillBackgroundColor(IndexedColors.YELLOW.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule rule2 = sheetCF.createConditionalFormattingRule(ComparisonOperator.BETWEEN, "-10", "10");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule [] cfRules =</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> rule1, rule2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">};</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddress[] regions = {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellRangeAddress.valueOf("A3:A5")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">};</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheetCF.addConditionalFormatting(regions, cfRules);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>See more examples on Excel conditional formatting in <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/ss/ConditionalFormats.java">ConditionalFormats.java</a>
      <div name="tsUpdate" data-id="t_2f8cd8d76248456bb711334c9db93c10" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="Hiding" id="Hiding"></a> <a name="Hiding+and+Un-Hiding+Rows"></a>
    <h2 class="boxed">Hiding and Un-Hiding Rows
     <div name="tsUpdate" data-id="t_c8ba0c0509344282b2076dfa89e8d33d" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Using Excel, it is possible to hide a row on a worksheet by selecting that row (or rows), right clicking once on the right hand mouse button and selecting 'Hide' from the pop-up menu that appears.
      <div name="tsUpdate" data-id="t_9349cb5f2c09434ab39108595421c476" data-tpl="0" data-txt-color="green"></div></p>
     <p>To emulate this using POI, simply call the setZeroHeight() method on an instance of either XSSFRow or HSSFRow (the method is defined on the ss.usermodel.Row interface that both classes implement), like this:
      <div name="tsUpdate" data-id="t_67f2e4b6f7834498ab1e070e5d4abcdd" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span> OR new HSSFWorkbook()
         <div name="tsUpdate" data-id="t_40181ecd74764b0091f2c301d1cda0c4" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = workbook.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.setZeroHeight();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>If the file were saved away to disc now, then the first row on the first sheet would not be visible.
      <div name="tsUpdate" data-id="t_06716c0d03e54eb5ade82c00222c2ea9" data-tpl="0" data-txt-color="green"></div></p>
     <p>Using Excel, it is possible to unhide previously hidden rows by selecting the row above and the row below the one that is hidden and then pressing and holding down the Ctrl key, the Shift and the pressing the number 9 before releasing them all.
      <div name="tsUpdate" data-id="t_f8f9c26948cd4cfe8077ca0416f07f5d" data-tpl="0" data-txt-color="green"></div></p>
     <p>To emulate this behaviour using POI do something like this:
      <div name="tsUpdate" data-id="t_32053245f33641df95c96b2bbb348345" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = WorkbookFactory.create(new File(.......));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Iterator&lt;Row&gt; row Iter = sheet.iterator();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">while(rowIter.hasNext()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = rowIter.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(row.getZeroHeight()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row.setZeroHeight(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>If the file were saved away to disc now, any previously hidden rows on the first sheet of the workbook would now be visible.
      <div name="tsUpdate" data-id="t_ebf56489563e4a5cbb6bf0da351695d8" data-tpl="0" data-txt-color="green"></div></p>
     <p>The example illustrates two features. Firstly, that it is possible to unhide a row simply by calling the setZeroHeight() method and passing the boolean value 'false'. Secondly, it illustrates how to test whether a row is hidden or not. Simply call the getZeroHeight() method and it will return 'true' if the row is hidden, 'false' otherwise.
      <div name="tsUpdate" data-id="t_1a01e97d798542ad887ad237c08b5127" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="CellProperties" id="CellProperties"></a> <a name="Setting+Cell+Properties"></a>
    <h2 class="boxed">Setting Cell Properties
     <div name="tsUpdate" data-id="t_58c6beb164b345248da8f74968c022a2" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Sometimes it is easier or more efficient to create a spreadsheet with basic styles and then apply special styles to certain cells such as drawing borders around a range of cells or setting fills for a region. CellUtil.setCellProperties lets you do that without creating a bunch of unnecessary intermediate styles in your spreadsheet.
      <div name="tsUpdate" data-id="t_f86c612a79b8434a890598f34b6118ae" data-tpl="0" data-txt-color="green"></div></p>
     <p>Properties are created as a Map and applied to a cell in the following manner.
      <div name="tsUpdate" data-id="t_b2b5ed451af64d44941e184da6e32d79" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span> OR new HSSFWorkbook()
         <div name="tsUpdate" data-id="t_815534ea03704024b082323f1a1ca1cf" data-tpl="0" data-txt-color="green"></div></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// border around a cell</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_57e0bca4eca249a9a4ac706c88d7addc" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_TOP, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_BOTTOM, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_LEFT, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_RIGHT, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Give it a color (RED)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_e3bc88398b9f45f2a7b18e3a72146461" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.TOP_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BOTTOM_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.LEFT_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.RIGHT_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Apply the borders to the cell at B2</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4e0f7cf237ab40578c5c03540c97031e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.setCellStyleProperties(cell, properties);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Apply the borders to a 3x3 region starting at D4</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ee1ba55ae54848668f730d472251e25d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int ix=3; ix &lt;= 5; ix++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row = sheet.createRow(ix);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int iy = 3; iy &lt;= 5; iy++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell = row.createCell(iy);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellUtil.setCellStyleProperties(cell, properties);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>NOTE: This does not replace the properties of the cell, it merges the properties you have put into the Map with the cell's existing style properties. If a property already exists, it is replaced with the new property. If a property does not exist, it is added. This method will not remove CellStyle properties.
      <div name="tsUpdate" data-id="t_25f53b768436451681fb7b93844dbdc6" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="DrawingBorders" id="DrawingBorders"></a> <a name="Drawing+Borders"></a>
    <h2 class="boxed">Drawing Borders
     <div name="tsUpdate" data-id="t_b1584147705d4820879586307568a711" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>In Excel, you can apply a set of borders on an entire workbook region at the press of a button. The PropertyTemplate object simulates this with methods and constants defined to allow drawing top, bottom, left, right, horizontal, vertical, inside, outside, or all borders around a range of cells. Additional methods allow for applying colors to the borders.
      <div name="tsUpdate" data-id="t_8ba6e771cee940f29e7aa3883cd2c1ef" data-tpl="0" data-txt-color="green"></div></p>
     <p>It works like this: you create a PropertyTemplate object which is a container for the borders you wish to apply to a sheet. Then you add borders and colors to the PropertyTemplate, and finally apply it to whichever sheets you need that set of borders on. You can create multiple PropertyTemplate objects and apply them to a single sheet, or you can apply the same PropertyTemplate object to multiple sheets. It is just like a preprinted form.
      <div name="tsUpdate" data-id="t_df3bae45dd4642ba8abe8b096125074c" data-tpl="0" data-txt-color="green"></div></p>
     <p>Enums:
      <div name="tsUpdate" data-id="t_03c7c354705b4a6c9d275b8f1d8f0385" data-tpl="0" data-txt-color="green"></div></p>
     <dl>
      <dt>BorderStyle</dt>
      <dd>Defines the look of the border, is it thick or thin, solid or dashed, single or double. This enum replaces the CellStyle.BORDER_XXXXX constants which have been deprecated. The PropertyTemplate will not support the older style BORDER_XXXXX constants. A special value of BorderStyle.NONE will remove the border from a Cell once it is applied.</dd>
      <dt>BorderExtent</dt>
      <dd>Describes the portion of the region that the BorderStyle will apply to. For example, TOP, BOTTOM, INSIDE, or OUTSIDE. A special value of BorderExtent.NONE will remove the border from the PropertyTemplate. When the template is applied, no change will be made to a cell border where no border properties exist in the PropertyTemplate.</dd>
     </dl>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// draw borders (three 3x3 grids)</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_570cf7799a0b4e16947e6efe8c7b6190" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PropertyTemplate pt = new PropertyTemplate();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #1) these borders will all be medium in default color</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_dbfa0322ca084608bda16bbc38c7812e" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(1, 3, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, BorderExtent.ALL);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #2) these cells will have medium outside borders and thin inside borders</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_fdc6366243954232b6e3b8cd72259491" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, BorderExtent.OUTSIDE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3), BorderStyle.THIN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #3) these cells will all be medium weight with different colors for the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// outside, inside horizontal, and inside vertical borders. The center</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// cell will have no borders.</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_77f541c6a5984bd5a0f1f6d5efbd386d" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.RED.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.OUTSIDE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.BLUE.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE_VERTICAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.GREEN.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE_HORIZONTAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(10, 10, 2, 2),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.NONE,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.ALL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// apply borders to sheet</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_ce429a59ca1b4199a8ef7e4eeae00619" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sh = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.applyBorders(sh);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>NOTE: The last pt.drawBorders() call removes the borders from the range by using BorderStyle.NONE. Like setCellStyleProperties, the applyBorders method merges the properties of a cell style, so existing borders are changed only if they are replaced by something else, or removed only if they are replaced by BorderStyle.NONE. To remove a color from a border, use IndexedColor.AUTOMATIC.getIndex().
      <div name="tsUpdate" data-id="t_0c366c8891084272abc8b8686149dfc2" data-tpl="0" data-txt-color="green"></div></p>
     <p>Additionally, to remove a border or color from the PropertyTemplate object, use BorderExtent.NONE.
      <div name="tsUpdate" data-id="t_68e24a515ff341e38e35ac15c1396236" data-tpl="0" data-txt-color="green"></div></p>
     <p>This does not work with diagonal borders yet.
      <div name="tsUpdate" data-id="t_8368616a30b4421fb81cef0c096a033a" data-tpl="0" data-txt-color="green"></div></p>
    </div>
    <a name="PivotTable" id="PivotTable"></a> <a name="Creating+a+Pivot+Table"></a>
    <h2 class="boxed">Creating a Pivot Table
     <div name="tsUpdate" data-id="t_2bf74a0b82a24181b6208f5d7030fde9" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>Pivot Tables are a powerful feature of spreadsheet files. You can create a pivot table with the following piece of code.
      <div name="tsUpdate" data-id="t_f7b167bfac924df69e5e0fed608c6cff" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Create some data to build the pivot table on</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_a0bb02de10104eeca5be79bfc78758bd" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">setCellData(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFPivotTable pivotTable = sheet.createPivotTable(new AreaReference("A1:D4"), new CellReference("H5"));</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Configure the pivot table</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Use first column as row label</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_01179ea9567f4ce4bf497a92c94772a3" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addRowLabel(0);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Sum up the second column</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_d3173049433544a494a17a42ecd7bb30" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addColumnLabel(DataConsolidateFunction.SUM, 1);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Set the third column as filter</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_b7d77c621e6342c99db37d167ce892ce" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addColumnLabel(DataConsolidateFunction.AVERAGE, 2);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Add filter on forth column</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_10facc1e1e3c4a949d7cdd64ec9dfcce" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addReportFilter(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="RichText" id="RichText"></a> <a name="Cells+with+multiple+styles+%28Rich+Text+Strings%29"></a>
    <h2 class="boxed">Cells with multiple styles (Rich Text Strings)
     <div name="tsUpdate" data-id="t_d43ed47b8f0a468f8a195fb5eabdb98f" data-tpl="0" data-txt-color="orange"></div></h2>
    <div class="section">
     <p>To apply a single set of text formatting (colour, style, font etc) to a cell, you should create a <a href="/../apidocs/dev/org/apache/poi/ss/usermodel/CellStyle.html">CellStyle</a> for the workbook, then apply to the cells.
      <div name="tsUpdate" data-id="t_cfa1fe4f26f9449fa7db43243e1cd84a" data-tpl="0" data-txt-color="green"></div></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSF Example</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_4381e39741fe45528928d41b58b038fe" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell hssfCell = row.createCell(idx);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//rich text consists of two runs</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_eeb4f5c80dae49b89d0b82ae6d90923b" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRichTextString richString = new HSSFRichTextString( "Hello, World!" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">richString.applyFont( 0, 6, font1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">richString.applyFont( 6, 13, font2 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hssfCell.setCellValue( richString );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSF Example</span>
      </div>
      <div name="tsUpdate" class="codeline" data-id="t_7307c0ea87dc4b2c8644a86bb1b2773c" data-tpl="1" data-txt-color="green"></div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFRichTextString rt = new XSSFRichTextString("The quick brown fox");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font1 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font1.setBold(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font1.setColor(new XSSFColor(new java.awt.Color(255, 0, 0)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.applyFont(0, 10, font1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setUnderline(XSSFFont.U_DOUBLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setColor(new XSSFColor(new java.awt.Color(0, 255, 0)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.applyFont(10, 19, font2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font3 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font3.setColor(new XSSFColor(new java.awt.Color(0, 0, 255)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.append(" Jumped over the lazy dog", font3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(rt);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p>To apply different formatting to different parts of a cell, you need to use <a href="../../apidocs/dev/org/apache/poi/ss/usermodel/RichTextString.html">RichTextString</a>, which permits styling of parts of the text within the cell.
      <div name="tsUpdate" data-id="t_fd75dd0cc8ee4e52b99bfd07f7fa40a1" data-tpl="0" data-txt-color="green"></div></p>
     <p>There are some slight differences between HSSF and XSSF, especially around font colours (the two formats store colours quite differently internally), refer to the <a href="../../apidocs/dev/org/apache/poi/hssf/usermodel/HSSFRichTextString.html">HSSF Rich Text String</a> and <a href="../../apidocs/dev/org/apache/poi/xssf/usermodel/XSSFRichTextString.html">XSSF Rich Text String</a> javadocs for more details.
      <div name="tsUpdate" data-id="t_1aa71a69876f4f0c95d5fd0a83ed3d48" data-tpl="0" data-txt-color="green"></div></p>
    </div>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright  2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/quick-guide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
  <script type="text/javascript">var projectId='5';var versionId='1';var fileId='8e795b66fc9341deaa018ede51b08280';</script>
  <script src="../../js/xst-update.js"></script>
 </body>
</html>