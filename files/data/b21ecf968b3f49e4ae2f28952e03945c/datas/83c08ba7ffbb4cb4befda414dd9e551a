[{"id":"t_ab91b55fc3394d76af24ff7fdf6d8632","oldText":"Formula Support","tlText":"公式支持","version":0},{"id":"t_20ca50dc430a4aa7a920aa8521177be2","oldText":"Introduction","tlText":"介绍","version":0},{"id":"t_bd83d8070b9a4ed49ca78d0fe5c903e7","oldText":"The basics","tlText":"基础","version":0},{"id":"t_e433b7c440f349a78f3f7cc0ef213469","oldText":"Supported Features","tlText":"支持的功能","version":0},{"id":"t_7e838dfcd5c34a818a344de4525d1dd1","oldText":"Not yet supported","tlText":"尚不支持","version":0},{"id":"t_b8fb69f2efcc43b89bcf47c0a09b7c4e","oldText":"Supported Functions","tlText":"支持的功能","version":0},{"id":"t_efa5e20efc8c40c79792dc065359578a","oldText":"Internals","tlText":"内件","version":0},{"id":"t_c4295e77cdd74d9db7b386ad089a3bb8","oldText":"This document describes the current state of formula support in POI. The information in this document currently applies to the 3.13 version of POI. Since this area is a work in progress, this document will be updated with new features as and when they are added.","tlText":"本文档描述了 POI 中公式支持的当前状态。本文档中的信息目前适用于 POI 3.13 版本。由于该领域正在进行中，因此本文档将在添加新功能时进行更新。","version":0},{"id":"t_a78818e1745d4ee2b94948fe908ca27a","oldText":"In org.apache.poi.ss.usermodel.Cell setCellFormula(\"formulaString\") is used to add a formula to a sheet, and getCellFormula() is used to retrieve the string representation of a formula.","tlText":"在 org.apache.poi.ss.usermodel.Cell 中，setCellFormula(\u0026quot;formulaString\u0026quot;) 用于向工作表添加公式，而 getCellFormula() 用于检索公式的字符串形式。","version":0},{"id":"t_23621090da0b47f3988b30fc8d39d93e","oldText":"We aim to support the complete excel grammar for formulas. Thus, the string that you pass in to the setCellFormula call should be what you expect to type into excel. Also, note that you should NOT add a \"\u003d\" to the front of the string.","tlText":"我们的目标是支持公式的完整 excel 语法。因此，您传递给 setCellFormula 调用的字符串应该是您希望在 Excel 中键入的内容。另外，请注意，您不需要在字符串的前面添加“\u003d”。","version":0},{"id":"t_faab0063bdf5423f861809707508a8a6","oldText":"Please note that localized versions of Excel allow to enter localized function-names. However internally Excel stores the English names and thus POI only supports these and not the localized ones. Also note that only commas may be used to separate arguments, as per the Excel English style, alternate delimeters used in other localizations are not supported.","tlText":"请注意，本地化版本的 Excel 允许输入本地化的函数名称。然而，Excel内部存储英文名称，因此POI只支持英文名称，而不支持本地化名称。另请注意，根据Excel英语风格，只有逗号可以用于分隔参数，不支持在本地化中使用的其他替代参数。","version":0},{"id":"t_62726b7d03a74f58af03a29d3d45b972","oldText":"To get the list of formula functions that POI supports, you need to call some code!","tlText":"您可以调用一些代码获取 POI 支持的公式函数列表！","version":0},{"id":"t_c17f100e925542179647389b243da381","oldText":"The methods you need are available on org.apache.poi.ss.formula.eval.FunctionEval. To find which functions your copy of Apache POI supports, use getSupportedFunctionNames() to get a list of the implemented function names. For the list of functions that POI knows the name of, but doesn\u0027t currently implement, use getNotSupportedFunctionNames()","tlText":"您需要的方法可在\u003ca href\u003d\"../../apidocs/org/apache/poi/ss/formula/eval/FunctionEval.html\" style\u003d\"color:blue\" target\u003d\"_blank\"\u003eorg.apache.poi.ss.formula.eval.FunctionEval\u003c/a\u003e中找到。要想知道您的Apache POI副本支持哪些函数，请使用\u003ca href\u003d\"../../apidocs/org/apache/poi/ss/formula/eval/FunctionEval.html#getSupportedFunctionNames()\" style\u003d\"color:blue\" target\u003d\"_blank\"\u003egetSupportedFunctionNames()\u003c/a\u003e获取已实现的函数名称列表。对于POI知道名称但尚未实现的函数列表，请使用\u003ca href\u003d\"../../apidocs/org/apache/poi/ss/formula/eval/FunctionEval.html#getNotSupportedFunctionNames()\" style\u003d\"color:blue\" target\u003d\"_blank\"\u003egetNotSupportedFunctionNames()\u003c/a\u003e","version":0},{"id":"t_0ce500a6e06d4b63b3ebfe5d27ac1ba8","oldText":"Formulas in Excel are stored as sequences of tokens in Reverse Polish Notation order. The open office XLS spec is the best documentation you will find for the format.","tlText":"Excel中的公式以逆波兰表示法为顺序存储标记序列。开放式\u003ca href\u003d\"http://sc.openoffice.org/excelfileformat.pdf\" style\u003d\"color:blue\" target\u003d\"_blank\"\u003eopen office XLS spec\u003c/a\u003e是您可以找到的格式的最佳文档。","version":0},{"id":"t_ca855e1b311a48268147330e5db23547","oldText":"The tokens used by excel are modeled as individual *Ptg classes in the org.apache.poi.hssf.record.formula package.","tlText":"excel 使用的标记被建模为 org.apache.poi.hssf.record.formula 包中的单个 *Ptg 类。","version":0},{"id":"t_bacf6e7d30d1405194a21b11cf0a6318","oldText":"The task of parsing a formula string into an array of RPN ordered tokens is done by the org.apache.poi.ss.formula.FormulaParser class. This class implements a hand written recursive descent parser.","tlText":"将公式字符串解析为 RPN 有序标记数组的任务由 org.apache.poi.ss.formula.FormulaParser 类完成。这个类实现了一个手工编写的递归下降解析器。","version":0},{"id":"t_29099cccb7254c909530544e49d9854c","oldText":"Formula tokens in Excel are stored in one of three possible operand classes : Reference, Value and Array. Based on the location of a token, its class can change in complicated and undocumented ways. While we have support for most cases, we are not sure if we have covered all bases (since there is no documentation for this area.) We would therefore like you to report any occurrence of #VALUE! in a cell upon opening a POI generated workbook in excel. (Check that typing the formula into Excel directly gives a valid result.)","tlText":"Excel 中的公式标记存储在三个可能的操作数类之一中：引用、值和数组。根据令牌的位置，它的类可能会以复杂且未记录的方式发生变化。虽然我们支持大多数情况，但我们不确定我们是否涵盖了所有情况（因为没有该领域的文档）。因此，我们希望您报告任何情况：在 Excel 中打开 POI 生成的工作簿时在单元格中出现#VALUE！（检查将公式直接输入Excel是否会给出有效结果）","version":0},{"id":"t_c20cc3dbbbfe481fba3e064495f1b7b0","oldText":"Check out the javadocs for details.","tlText":"查看 \u003ca href\u003d\"../../apidocs/index.html\" style\u003d\"color:blue\" target\u003d\"_blank\"\u003ejavadocs \u003c/a\u003e了解详细信息。","version":0},{"id":"t_043247c57d8a40079e6635554fcc1e4d","oldText":"by Avik Sengupta","tlText":"艾维克·森古普塔","version":0},{"id":"t_0b461ad8a3134ca5af40880b48690960","oldText":"References: single cell \u0026 area, 2D \u0026 3D, relative \u0026 absolute","tlText":"参考：单个单元格和面积、2D 和 3D、相对和绝对","version":0},{"id":"t_3dbad9ae751f43e19297fc07848e82b0","oldText":"Literals: number, text, boolean, error and array","tlText":"字面常量：数字、文本、布尔值、错误和数组","version":0},{"id":"t_900673613cef40dd9ab534014553c501","oldText":"Operators: arithmetic and logical, some region operators","tlText":"运算符：算术和逻辑，一些区域运算符","version":0},{"id":"t_c104811c2762480a8722550908d83d4d","oldText":"Built-in functions: over 350 recognised, 280 evaluatable","tlText":"内置函数：350多个已识别，280个可评估","version":0},{"id":"t_470dbbd10b414f59a9eb2f277a2a85b2","oldText":"Add-in functions: 24 from Analysis Toolpack","tlText":"插件函数：分析工具包有24个","version":0},{"id":"t_cc35d802f3e248f68b84d847e42a640f","oldText":"Array Formulas: via Sheet.setArrayFormula() and Sheet.removeArrayFormula()","tlText":"数组公式：通过 Sheet.setArrayFormula() 和 Sheet.removeArrayFormula()","version":0},{"id":"t_5f96be011e054a3d9c7748a55ebfa63e","oldText":"Region operators: union, intersection","tlText":"区域运算符：并集、交集","version":0},{"id":"t_bd96b16552cb4038a7784da21bb09a52","oldText":"Manipulating table formulas (In Excel, formulas that look like \"{\u003d...}\" as opposed to \"\u003d...\")","tlText":"操作表格的公式（在 Excel 中，公式看起来像“{\u003d...}”而不是“\u003d...”）","version":0},{"id":"t_dc00542882a04a78ba20593c4e07935b","oldText":"Parsing of previously uncalled add-in functions","tlText":"解析前未调用的加载项函数","version":0},{"id":"t_e06c85e2c4944300945a71d918c7c225","oldText":"Preservation of whitespace in formulas (when POI manipulates them)","tlText":"公式中保存的空白（当 POI 操作它们时）","version":0}]