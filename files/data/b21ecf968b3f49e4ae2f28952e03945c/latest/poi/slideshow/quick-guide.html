<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-HSLF - A Quick Guide</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_69f8ab9354f0462c921de62c1bad1fad">POI-HSLF - A Quick Guide</span><span class="tscolor" lg_zh="t_69f8ab9354f0462c921de62c1bad1fad"><span lg_kh="1">(</span>POI-HSLF - 快速指南<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_b150620ce2a34358aa1f591f5f3e7460">Overview</span><span class="tscolor" lg_zh="t_b150620ce2a34358aa1f591f5f3e7460"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Basic+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_bd1addda12c84320918c0b0166338b11">Basic Text Extraction</span><span class="tscolor" lg_zh="t_bd1addda12c84320918c0b0166338b11"><span lg_kh="1">(</span>基本文本提取<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_e34705099ad343479b42e3a7f7460f77">For basic text extraction, make use of <span class="codefrag">org.apache.poi.sl.extractor.SlideShowExtractor</span>. It accepts a slideshow which can be created from a file or stream via <span class="codefrag">org.apache.poi.sl.usermodel.SlideShowFactory</span>. The <span class="codefrag">getText()</span> method can be used to get the text from the slides.</span><span class="tscolor" lg_zh="t_e34705099ad343479b42e3a7f7460f77"><span lg_kh="1">(</span>对于基本的文本提取，请使用 org.apache.poi.sl.extractor.SlideShowExtractor。它接受可以通过 org.apache.poi.sl.usermodel.SlideShowFactory 从文件或流中创建的幻灯片。 getText() 方法可用于从幻灯片中获取文本。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Specific+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_15127a3ed1674f528503ed25e854727e">Specific Text Extraction</span><span class="tscolor" lg_zh="t_15127a3ed1674f528503ed25e854727e"><span lg_kh="1">(</span>特定文本提取<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_0491b1fad51145bcb6723ea37f8ce28a">To get specific bits of text, first create a <span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShow</span> (from a <span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShowImpl</span>, which accepts a file or an input stream). Use <span class="codefrag">getSlides()</span> and <span class="codefrag">getNotes()</span> to get the slides and notes. These can be queried to get their page ID (though they should be returned in the right order).</span><span class="tscolor" lg_zh="t_0491b1fad51145bcb6723ea37f8ce28a"><span lg_kh="1">(</span>要获取特定的文本位，首先创建一个 org.apache.poi.hslf.usermodel.HSLFSlideShow（来自 org.apache.poi.hslf.usermodel.HSLFSlideShowImpl，它接受文件或输入流）。使用 getSlides() 和 getNotes() 获取幻灯片和注释。可以查询这些以获取它们的页面 ID（尽管它们应该以正确的顺序返回）。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_01db8ae98830459d8523252ea68cc321">You can then call <span class="codefrag">getTextParagraphs()</span> on these, to get their blocks of text. (A list of <span class="codefrag">HSLFTextParagraph</span> normally holds all the text in a given area of the page, eg in the title bar, or in a box). From the <span class="codefrag">HSLFTextParagraph</span>, you can extract the text, and check what type of text it is (eg Body, Title). You can also call <span class="codefrag">getTextRuns()</span>, which will return the <span class="codefrag">HSLFTextRun</span>s that make up the <span class="codefrag">TextParagraph</span>. A <span class="codefrag">HSLFTextRun</span> is a text fragment, having the same character formatting. The paragraph formatting is defined in the parent <span class="codefrag">HSLFTextParagraph</span>.</span><span class="tscolor" lg_zh="t_01db8ae98830459d8523252ea68cc321"><span lg_kh="1">(</span>然后，您可以在这些上调用 getTextParagraphs() 以获取它们的文本块。 （HSLFTextParagraph 列表通常包含页面给定区域中的所有文本，例如在标题栏或框中）。从 HSLFTextParagraph 中，您可以提取文本，并检查它是什么类型的文本（例如正文、标题）。您还可以调用 getTextRuns()，它将返回组成 TextParagraph 的 HSLFTextRuns。 HSLFTextRun 是一个文本片段，具有相同的字符格式。段落格式在父 HSLFTextParagraph 中定义。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Poor+Quality+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_83ea6e20f16f4e5f8e0e0130ae20a5bd">Poor Quality Text Extraction</span><span class="tscolor" lg_zh="t_83ea6e20f16f4e5f8e0e0130ae20a5bd"><span lg_kh="1">(</span>差质量文本提取<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_727d6b15d633404e9457a3011d92ec5a">If speed is the most important thing for you, you don't care about getting duplicate blocks of text, you don't care about getting text from master sheets, and you don't care about getting old text, then <span class="codefrag">org.apache.poi.hslf.extractor.QuickButCruddyTextExtractor</span> might be of use.</span><span class="tscolor" lg_zh="t_727d6b15d633404e9457a3011d92ec5a"><span lg_kh="1">(</span>如果速度对您来说是最重要的事情，您不关心获取重复的文本块，不关心从母版中获取文本，也不关心获取旧文本，那 org.apache。 poi.hslf.extractor.QuickButCruddyTextExtractor 可能有用。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0418a29c558d4f0e981f67279db93006">QuickButCruddyTextExtractor doesn't use the normal record parsing code, instead it uses a tree structure blind search method to get all text holding records. You will get all the text, including lots of text you normally wouldn't ever want. However, you will get it back very very fast!</span><span class="tscolor" lg_zh="t_0418a29c558d4f0e981f67279db93006"><span lg_kh="1">(</span>QuickButCruddyTextExtractor 没有使用普通的记录解析代码，而是使用树形结构盲搜索的方法来获取所有的文本保存记录。你会得到所有的文本，包括很多你通常不会想要的文本。但是，您会非常非常快地找回它！<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_b1d8bf3fbcd94d15ba2d60413f107453">There are two ways of getting the text back. <span class="codefrag">getTextAsString()</span> will return a single string with all the text in it. <span class="codefrag">getTextAsVector()</span> will return a vector of strings, one for each text record found in the file.</span><span class="tscolor" lg_zh="t_b1d8bf3fbcd94d15ba2d60413f107453"><span lg_kh="1">(</span>有两种方法可以取回文本。 getTextAsString() 将返回一个包含所有文本的字符串。 getTextAsVector() 将返回一个字符串向量，文件中的每个文本记录对应一个。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Changing+Text"></a>
    <h2 class="boxed"><span lg_en="t_dbaf35344cdf40aab70872ed54366b64">Changing Text</span><span class="tscolor" lg_zh="t_dbaf35344cdf40aab70872ed54366b64"><span lg_kh="1">(</span>更改文本<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_78a0130c3cdc4bb6bd5fac565e5ecb84">It is possible to change the text via <span class="codefrag">HSLFTextParagraph.setText(List&lt;HSLFTextParagraph&gt;,String)</span> or <span class="codefrag">HSLFTextRun.setText(String)</span>. It is possible to add additional TextRuns with <span class="codefrag">HSLFTextParagraph.appendText(List&lt;HSLFTextParagraph&gt;,String,boolean)</span> or <span class="codefrag">HSLFTextParagraph.addTextRun(HSLFTextRun)</span></span><span class="tscolor" lg_zh="t_78a0130c3cdc4bb6bd5fac565e5ecb84"><span lg_kh="1">(</span>可以通过 HSLFTextParagraph.setText(List<HSLFTextParagraph> ,String) 或 HSLFTextRun.setText(String)来改变文本。可以用HSLFTextParagraph.appendText(List<HSLFTextParagraph> ,String,boolean) 或 HSLFTextParagraph.addTextRun(HSLFTextRun)来添加额外的TextRuns.<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5aa061e3d39d4d2e962e6d691f3d82c0">When calling <span class="codefrag">HSLFTextParagraph.setText(List&lt;HSLFTextParagraph&gt;,String)</span>, all the text will end up with the same formatting. When calling <span class="codefrag">HSLFTextRun.setText(String)</span>, the text will retain the old formatting of that <span class="codefrag">HSLFTextRun</span>.</span><span class="tscolor" lg_zh="t_5aa061e3d39d4d2e962e6d691f3d82c0"><span lg_kh="1">(</span>当调用 HSLFTextParagraph.setText(List<HSLFTextParagraph> ,String)时，所有文本都将以相同的格式结束。调用 HSLFTextRun.setText(String) 时，文本将保留该 HSLFTextRun 的旧格式。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Adding+Slides"></a>
    <h2 class="boxed"><span lg_en="t_43a0a82816c648378c4bda9cc561710b">Adding Slides</span><span class="tscolor" lg_zh="t_43a0a82816c648378c4bda9cc561710b"><span lg_kh="1">(</span>添加幻灯片<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_1f398b56e7f04f8daba746baf481e2d9">You may add new slides by calling <span class="codefrag">HSLFSlideShow.createSlide()</span>, which will add a new slide to the end of the SlideShow. It is possible to re-order slides with <span class="codefrag">HSLFSlideShow.reorderSlide(...)</span>.</span><span class="tscolor" lg_zh="t_1f398b56e7f04f8daba746baf481e2d9"><span lg_kh="1">(</span>您可以通过调用 HSLFSlideShow.createSlide()来添加新幻灯片，这将在 SlideShow 的末尾添加一张新幻灯片。可以使用 HSLFSlideShow.reorderSlide(...) 重新排序幻灯片。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Guide+to+key+classes"></a>
    <h2 class="boxed"><span lg_en="t_e771322c98364964bb035a2f87e50047">Guide to key classes</span><span class="tscolor" lg_zh="t_e771322c98364964bb035a2f87e50047"><span lg_kh="1">(</span>重点课程指南<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <ul>
      <li><span lg_en="t_12d12a6decf44acca224ff11b84e8014"><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShowImpl</span> Handles reading in and writing out files. Calls <span class="codefrag">org.apache.poi.hslf.record.record</span> to build a tree of all the records in the file, which it allows access to.</span><span class="tscolor" lg_zh="t_12d12a6decf44acca224ff11b84e8014"><span lg_kh="1">(</span>org.apache.poi.hslf.usermodel.HSLFSlideShowImpl 处理读入和写出文件。调用 org.apache.poi.hslf.record.record 来构建文件中所有记录的树，它允许访问。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_4182c8f3c7c54853ac2542a870ae8776"><span class="codefrag">org.apache.poi.hslf.record.Record</span> Base class of all records. Also provides the main record generation code, which will build up a tree of records for a file.</span><span class="tscolor" lg_zh="t_4182c8f3c7c54853ac2542a870ae8776"><span lg_kh="1">(</span>org.apache.poi.hslf.record.Record 所有记录的基类。还提供了主要的记录生成代码，它将为文件构建一棵记录树。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_eec71de171b447d6b63745d0041985a5"><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlideShow</span> Builds up model entries from the records, and presents a user facing view of the file</span><span class="tscolor" lg_zh="t_eec71de171b447d6b63745d0041985a5"><span lg_kh="1">(</span>org.apache.poi.hslf.usermodel.HSLFSlideShow 从记录中建立模型条目，并呈现一个面向用户的文件视图<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_01af82dbe0b844628eb6575686957f76"><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFSlide</span> A user facing view of a Slide in a slideshow. Allows you to get at the Text of the slide, and at any drawing objects on it.</span><span class="tscolor" lg_zh="t_01af82dbe0b844628eb6575686957f76"><span lg_kh="1">(</span>org.apache.poi.hslf.usermodel.HSLFSlide 幻灯片放映中面向用户的幻灯片视图。允许您获取幻灯片的文本以及其上的任何绘图对象。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_5b92473e70574dfd914a099d4f9489fc"><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFTextParagraph</span> A list of <span class="codefrag">HSLFTextParagraph</span>s holds all the text in a given area of the Slide, and will contain one or more <span class="codefrag">HSLFTextRun</span>s.</span><span class="tscolor" lg_zh="t_5b92473e70574dfd914a099d4f9489fc"><span lg_kh="1">(</span>org.apache.poi.hslf.usermodel.HSLFTextParagraph HSLFTextParagraphs 列表包含幻灯片给定区域中的所有文本，并将包含一个或多个 HSLFTextRuns。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b8ed421ef1d3403d976b888fcaaa492f"><span class="codefrag">org.apache.poi.hslf.usermodel.HSLFTextRun</span> Holds a run of text, all having the same character stylings. It is possible to modify text, and/or text stylings.</span><span class="tscolor" lg_zh="t_b8ed421ef1d3403d976b888fcaaa492f"><span lg_kh="1">(</span>org.apache.poi.hslf.usermodel.HSLFTextRun 保存一系列文本，所有文本都具有相同的字符样式。可以修改文本和/或文本样式。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e44ff4f348b94805944352ff06bd0e43"><span class="codefrag">org.apache.poi.sl.extractor.SlideShowExtractor</span> Uses the model code to allow extraction of text from files</span><span class="tscolor" lg_zh="t_e44ff4f348b94805944352ff06bd0e43"><span lg_kh="1">(</span>org.apache.poi.sl.extractor.SlideShowExtractor 使用模型代码允许从文件中提取文本<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_cb2fa6ff8910497a911e0b0e5765ae54"><span class="codefrag">org.apache.poi.hslf.extractor.QuickButCruddyTextExtractor</span> Uses the record code to extract all the text from files very fast, but including deleted text (and other bits of Crud).</span><span class="tscolor" lg_zh="t_cb2fa6ff8910497a911e0b0e5765ae54"><span lg_kh="1">(</span>org.apache.poi.hslf.extractor.QuickButCruddyTextExtractor 使用记录代码非常快速地从文件中提取所有文本，但包括已删除的文本（和 Crud 的其他部分）。<span lg_kh="1">)</span></span></li>
     </ul>
    </div>
    <p align="right"><span lg_en="t_2f7cfd2ef5de40b18f38c09e50a9a126"><font size="-2">by&nbsp;Nick Burch</font></span><span class="tscolor" lg_zh="t_2f7cfd2ef5de40b18f38c09e50a9a126"><span lg_kh="1">(</span>作者：尼克伯奇<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/slideshow/quick-guide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>