<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - HDGF and XDGF - Java API To Access Microsoft Visio Format Files</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_6cd0e0343679474aafab9a826c2d5f2b">Apache POI - HDGF and XDGF - Java API To Access Microsoft Visio Format Files</span><span class="tscolor" lg_zh="t_6cd0e0343679474aafab9a826c2d5f2b"><span lg_kh="1">(</span>Apache POI - HDGF 和 XDGF - 访问 Microsoft Visio 格式文件的 Java API<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_d18d6443d6e44fa8add3aa169b0af0d0">Overview</span><span class="tscolor" lg_zh="t_d18d6443d6e44fa8add3aa169b0af0d0"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Overview"></a>
    <h2 class="boxed"><span lg_en="t_81ad79971f1f4ae28cead0db32d6b84f">Overview</span><span class="tscolor" lg_zh="t_81ad79971f1f4ae28cead0db32d6b84f"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_0896ad8af227480c8daf3ca2fa07587a">HDGF is the POI Project's pure Java implementation of the Visio binary (VSD) file format. XDGF is the POI Project's pure Java implementation of the Visio XML (VSDX) file format.</span><span class="tscolor" lg_zh="t_0896ad8af227480c8daf3ca2fa07587a"><span lg_kh="1">(</span>HDGF 是 POI 项目的 Visio 二进制 (VSD) 文件格式的纯 Java 实现。 XDGF 是 POI 项目的 Visio XML (VSDX) 文件格式的纯 Java 实现。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_caabb33814294a71a6a84cd4a3ad9367">Currently, HDGF provides a low-level, read-only api for accessing Visio documents. It also provides a <a href="http://svn.apache.org/repos/asf/poi/trunk/src/scratchpad/src/org/apache/poi/hdgf/extractor/">way</a> to extract the textual content from a file.</span><span class="tscolor" lg_zh="t_caabb33814294a71a6a84cd4a3ad9367"><span lg_kh="1">(</span>目前，HDGF 提供了一个用于访问 Visio 文档的低级只读 api。它还提供了一种从文件中提取文本内容的方法。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c62430815b024f6986fb234324382cc5">At this time, there is no <em>usermodel</em> api or similar, only low level access to the streams, chunks and chunk commands. Users are advised to check the unit tests to see how everything works. They are also well advised to read the documentation supplied with <a href="http://web.archive.org/web/20071212220759/http://www.gnome.ru/projects/vsdump_en.html">vsdump</a> to get a feel for how Visio files are structured.</span><span class="tscolor" lg_zh="t_c62430815b024f6986fb234324382cc5"><span lg_kh="1">(</span>目前没有 usermodel api 或类似的api，只有对流、块和块命令的低级访问。建议用户检查单元测试以了解一切如何运行。也建议他们阅读随 vsdump 提供的文档，以了解 Visio 文件的结构。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1c6f68da35ef47e9937034825915f800">To get a feel for the contents of a file, and to track down where data of interest is stored, HDGF comes with <a href="http://svn.apache.org/repos/asf/poi/trunk/src/scratchpad/src/org/apache/poi/hdgf/dev/">VSDDumper</a> to print out the contents of the file. Users should also make use of <a href="http://web.archive.org/web/20071212220759/http://www.gnome.ru/projects/vsdump_en.html">vsdump</a> to probe the structure of files.</span><span class="tscolor" lg_zh="t_1c6f68da35ef47e9937034825915f800"><span lg_kh="1">(</span>为了了解文件的内容，并追踪感兴趣的数据的存储位置，带有 VSDDumper的HDGF会打印文件的内容。用户还应该使用 vsdump 来探测文件的结构。<span lg_kh="1">)</span></span></p>
     <div class="note">
      <div class="label">
       <span lg_en="t_7c686830eb134e529569892f66dba5ce">Note</span><span class="tscolor" lg_zh="t_7c686830eb134e529569892f66dba5ce"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_78d09e81b6de46b88905c5865ae14e2e">This code currently lives the <a href="http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/">scratchpad area</a> of the POI SVN repository. To use this component, ensure you have the Scratchpad Jar on your classpath, or a dependency defined on the <em>poi-scratchpad</em> artifact - the main POI jar is not enough! See the <a href="../../components/">POI Components Map</a> for more details.</span><span class="tscolor" lg_zh="t_78d09e81b6de46b88905c5865ae14e2e"><span lg_kh="1">(</span>此代码当前位于 POI SVN 存储库的暂存区。要使用这个组件，请确保您的类路径中有 Scratchpad Jar，或者在 poi-scratchpad 工件上定义了依赖项 - 主 POI jar 是不够的！有关详细信息，请参阅 POI 组件图。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <a name="Steps+required+for+write+support"></a>
     <h3 class="boxed"><span lg_en="t_09eca5ba89bf4e8dad249689ea296ae5">Steps required for write support</span><span class="tscolor" lg_zh="t_09eca5ba89bf4e8dad249689ea296ae5"><span lg_kh="1">(</span>写入支持所需的步骤<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_8c4175b1f7af4ad98db0fabc994f4626">Currently, HDGF is only able to read visio files, it is not able to write them back out again. We believe the following are the steps that would need to be taken to implement it.</span><span class="tscolor" lg_zh="t_8c4175b1f7af4ad98db0fabc994f4626"><span lg_kh="1">(</span>目前，HDGF 只能读取 visio 文件，无法再次将它们写回。我们认为以下是实施它需要采取的步骤。<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_7e034e80f88242268af1fc77e05d0c79">Re-write the decompression support in LZW4HDGF as HDGFLZW, which will be much better documented, and also under the ASL. <strong>Completed October 2007</strong></span><span class="tscolor" lg_zh="t_7e034e80f88242268af1fc77e05d0c79"><span lg_kh="1">(</span>将 LZW4HDGF 中的解压缩支持重写为 HDGFLZW，这将有更好的文档记录，并且也在 ASL 下。 2007 年 10 月完成<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b80316fea1cd443a8c652488e79d52cd">Add compression support to HDGFLZW. <strong>In progress - works for small streams but encoding goes wrong on larger ones</strong></span><span class="tscolor" lg_zh="t_b80316fea1cd443a8c652488e79d52cd"><span lg_kh="1">(</span>为 HDGFLZW 添加压缩支持。进行中 - 适用于小流，但在大流上编码出错<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_98fc9a06a2d64a879f90f687dce9dff1">Have HDGF just write back the raw bytes it read in, and have a test to ensure the file is un-changed.</span><span class="tscolor" lg_zh="t_98fc9a06a2d64a879f90f687dce9dff1"><span lg_kh="1">(</span>让 HDGF 只写回它读入的原始字节，并进行测试以确保文件未更改。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8db584f9a992476b888f3a56a4afb7ff">Have HDGF generate the bytes to write out from the Stream stores, using the compressed data as appropriate, without re-compressing. Plus test to ensure file is un-changed.</span><span class="tscolor" lg_zh="t_8db584f9a992476b888f3a56a4afb7ff"><span lg_kh="1">(</span>让 HDGF 生成要从 Stream 存储中写出的字节，使用适当的压缩数据，无需重新压缩。加上测试以确保文件未更改。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_f97d646393eb41238d56434ebef8ff65">Have HDGF generate the bytes to write out from the Stream stores, re-compressing any streams that were decompressed. Plus test to ensure file is un-changed.</span><span class="tscolor" lg_zh="t_f97d646393eb41238d56434ebef8ff65"><span lg_kh="1">(</span>让 HDGF 生成要从 Stream 存储中写出的字节，重新压缩任何已解压缩的流。加上测试以确保文件未更改。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9045fc2305a7417899388b4b0ff7c595">Have HDGF re-generate the offsets in pointers for the locations of the streams. Plus test to ensure file is un-changed.</span><span class="tscolor" lg_zh="t_9045fc2305a7417899388b4b0ff7c595"><span lg_kh="1">(</span>让 HDGF 在指针中重新生成流位置的偏移量。加上测试以确保文件未更改。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_18e6507b6bcd415486c41607762ce4cc">Have HDGF re-generate the bytes for all the chunks, from the chunk commands. Tests to ensure the chunks are serialized properly, and then that the file is un-changed</span><span class="tscolor" lg_zh="t_18e6507b6bcd415486c41607762ce4cc"><span lg_kh="1">(</span>让 HDGF 从块命令中重新生成所有块的字节。测试以确保块被正确序列化，然后文件未更改<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_3e589a6a56584dddae026c9593f22023">Alter the data of one command, but keep it the same length, and check visio can open the file when written out.</span><span class="tscolor" lg_zh="t_3e589a6a56584dddae026c9593f22023"><span lg_kh="1">(</span>修改一个命令的数据，但保持长度不变，写出时检查visio能否打开文件。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_7102bc7e1d564495be2eb37c08573127">Alter the data of one command, to a new length, and check that visio can open the file when written out.</span><span class="tscolor" lg_zh="t_7102bc7e1d564495be2eb37c08573127"><span lg_kh="1">(</span>将一个命令的数据更改为新的长度，并检查 visio 在写出时是否可以打开文件。<span lg_kh="1">)</span></span></li>
     </ol>
    </div>
    <p align="right"><span lg_en="t_1d1df1c823ac4653b1c665615859b8a6"><font size="-2">by&nbsp;POI Developers</font></span><span class="tscolor" lg_zh="t_1d1df1c823ac4653b1c665615859b8a6"><span lg_kh="1">(</span>通过 POI 开发人员<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="logos">
    <a href="http://validator.w3.org/check/referer"><img style="height: 31px; width: 88px;" title="Valid HTML 4.01!" alt="Valid HTML 4.01!" src="../../skin/images/valid-html401.png" class="logoImage"></a><a href="http://jigsaw.w3.org/css-validator/check/referer"><img style="height: 31px; width: 88px;" title="Valid CSS!" alt="Valid CSS!" src="../../skin/images/vcss.png" class="logoImage"></a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/diagram/index.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>