<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>HPSF HOW-TO</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_d2215d0660784ab591d26acb7592566a">HPSF HOW-TO</span><span class="tscolor" lg_zh="t_d2215d0660784ab591d26acb7592566a"><span lg_kh="1">(</span>HPSF 操作方法<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="How+To+Use+the+HPSF+API"></a>
    <h2 class="boxed"><span lg_en="t_0b5fd8fa78ee410b9bb724853843281b">How To Use the HPSF API</span><span class="tscolor" lg_zh="t_0b5fd8fa78ee410b9bb724853843281b"><span lg_kh="1">(</span>如何使用 HPSF API<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_52a8d9494e8e45c3b5434567f6d3d93d">This HOW-TO is organized in four sections. You should read them sequentially because the later sections build upon the earlier ones.</span><span class="tscolor" lg_zh="t_52a8d9494e8e45c3b5434567f6d3d93d"><span lg_kh="1">(</span>本 HOW-TO 分为四个部分。您应该按顺序阅读它们，因为后面的部分建立在前面的部分之上。<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_2d96a7c08e834a59b6ae66d3324b46c5">The <a href="#sec1">first section</a> explains how to <strong>read the most important standard properties</strong> of a Microsoft Office document. Standard properties are things like title, author, creation date etc. It is quite likely that you will find here what you need and don't have to read the other sections.</span><span class="tscolor" lg_zh="t_2d96a7c08e834a59b6ae66d3324b46c5"><span lg_kh="1">(</span>第一部分解释了如何阅读 Microsoft Office 文档最重要的标准属性。标准属性是标题、作者、创建日期等。您很可能会在这里找到您需要的内容，而不必阅读其他部分。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_4d66f41350614bbda6ae27dad6915342">The <a href="#sec2">second section</a> goes a small step further and focuses on <strong>reading additional standard properties</strong>. It also talks about <strong>exceptions</strong> that may be thrown when dealing with HPSF and shows how you can <strong>read properties of embedded objects</strong>.</span><span class="tscolor" lg_zh="t_4d66f41350614bbda6ae27dad6915342"><span lg_kh="1">(</span>第二部分更进一步，侧重于阅读其他标准属性。它还讨论了处理 HPSF 时可能引发的异常，并展示了如何读取嵌入对象的属性。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_befb476089b44689a7adee813b50297f">The <a href="#sec3">third section</a> explains how to <strong>write standard properties</strong>. HPSF provides some high-level classes and methods which make writing of standard properties easy. They are based on the low-level writing functions explained in the <a href="#sec3">fifth section</a>.</span><span class="tscolor" lg_zh="t_befb476089b44689a7adee813b50297f"><span lg_kh="1">(</span>第三部分解释了如何编写标准属性。 HPSF 提供了一些高级类和方法，使标准属性的编写变得容易。它们基于第五节中解释的低级写入函数。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_ea61c5d263d04a78ab733827e46967f0">The <a href="#sec4">fourth section</a> tells how to <strong>read non-standard properties</strong>. Non-standard properties are application-specific triples consisting of an ID, a type, and a value.</span><span class="tscolor" lg_zh="t_ea61c5d263d04a78ab733827e46967f0"><span lg_kh="1">(</span>第四部分讲述如何阅读非标准属性。非标准属性是由 ID、类型和值组成的特定于应用程序的三元组。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_5a9732c40b854dcf977845a4207774f0">The <a href="#sec5">fifth section</a> tells you how to <strong>write property set streams</strong> using HPSF's low-level methods. You have to understand the <a href="#sec3">fourth section</a> before you should think about low-level writing properties. Check the Javadoc API documentation to find out about the details!</span><span class="tscolor" lg_zh="t_5a9732c40b854dcf977845a4207774f0"><span lg_kh="1">(</span>第五部分告诉您如何使用 HPSF 的低级方法编写属性集流。在考虑低级写作属性之前，您必须了解第四部分。查看 Javadoc API 文档以了解详细信息！<span lg_kh="1">)</span></span></li>
     </ol>
     <div class="note">
      <div class="label">
       <span lg_en="t_7f3b26dd3142417da4f4484b4b9bd0d7">Note</span><span class="tscolor" lg_zh="t_7f3b26dd3142417da4f4484b4b9bd0d7"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_47ac10c869db479b9b73e797de79ee06"><strong>Please note:</strong> HPSF's writing functionality is <strong>not</strong> present in POI releases up to and including 2.5. In order to write properties you have to download a 3.0.x POI release, or retrieve the POI development version from the <a href="../../devel/subversion.html">Subversion repository</a>.</span><span class="tscolor" lg_zh="t_47ac10c869db479b9b73e797de79ee06"><span lg_kh="1">(</span>请注意：HPSF 的写入功能在 POI 版本（包括 2.5）中不存在。为了编写属性，您必须下载 3.0.x POI 版本，或者从 Subversion 存储库中检索 POI 开发版本。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <a name="sec1" id="sec1"></a><a name="Reading+Standard+Properties"></a>
     <h3 class="boxed"><span lg_en="t_9f808c1318b54c3f9cc010f2b3a0438c">Reading Standard Properties</span><span class="tscolor" lg_zh="t_9f808c1318b54c3f9cc010f2b3a0438c"><span lg_kh="1">(</span>读取标准属性<span lg_kh="1">)</span></span></h3>
     <div class="note">
      <div class="label">
       <span lg_en="t_3d91d567966a4bbc8fee9bc398bcccc9">Note</span><span class="tscolor" lg_zh="t_3d91d567966a4bbc8fee9bc398bcccc9"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_a6921956083a4b689ff518a9a3a31caa">This section explains how to read the most important standard properties of a Microsoft Office document. Standard properties are things like title, author, creation date etc. This section introduces the <strong>summary information stream</strong> which is used to keep these properties. Chances are that you will find here what you need and don't have to read the other sections.</span><span class="tscolor" lg_zh="t_a6921956083a4b689ff518a9a3a31caa"><span lg_kh="1">(</span>本节说明如何阅读 Microsoft Office 文档最重要的标准属性。标准属性是标题、作者、创建日期等。本节介绍用于保存这些属性的摘要信息流。您可能会在这里找到您需要的内容，而无需阅读其他部分。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_f8e53500131347f994dc522a6e3eba8b">If all you are interested in is getting the textual content of all the document properties, such as for full text indexing, then take a look at <span class="codefrag">org.apache.poi.hpsf.extractor.HPSFPropertiesExtractor</span>. However, if you want full access to the properties, please read on!</span><span class="tscolor" lg_zh="t_f8e53500131347f994dc522a6e3eba8b"><span lg_kh="1">(</span>如果您只对获取所有文档属性的文本内容（例如全文索引）感兴趣，请查看 org.apache.poi.hpsf.extractor.HPSFPropertiesExtractor。但是，如果您想完全访问这些属性，请继续阅读！<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_b77b41f0f63d41a19d575947e0b8792b">The first thing you should understand is that a Microsoft Office file is not one large bunch of bytes but has an internal filesystem structure with files and directories. You can access these files and directories using the <a href="../poifs/index.html">POI filesystem (POIFS)</a> provides. A file or document in a POI filesystem is also called a <strong>stream</strong> - The properties of, say, an Excel document are stored apart of the actual spreadsheet data in separate streams. The good new is that this separation makes the properties independent of the concrete Microsoft Office file. In the following text we will always say "POI filesystem" instead of "Microsoft Office file" because a POI filesystem is not necessarily created by or for a Microsoft Office application, because it is shorter, and because we want to avoid the name of That Redmond Company.</span><span class="tscolor" lg_zh="t_b77b41f0f63d41a19d575947e0b8792b"><span lg_kh="1">(</span>您应该了解的第一件事是，Microsoft Office 文件不是一大堆字节，而是具有包含文件和目录的内部文件系统结构。您可以使用 POI 文件系统 (POIFS) 提供的访问这些文件和目录。 POI 文件系统中的文件或文档也称为流 - 例如，Excel 文档的属性与实际电子表格数据分开存储在单独的流中。好消息是这种分离使属性独立于具体的 Microsoft Office 文件。在以下文本中，我们将始终使用“POI 文件系统”而不是“Microsoft Office 文件”，因为 POI 文件系统不一定由 Microsoft Office 创建。因为它更简短，且我们希望避免使用 That雷德蒙公司的名称。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f862a28a7a604280bf0f3aabd50afdaa">The following example shows how to read the "title" property. Reading other properties is similar. Consider the API documentation of the class <span class="codefrag">org.apache.poi.hpsf.SummaryInformation</span> to learn which methods are available.</span><span class="tscolor" lg_zh="t_f862a28a7a604280bf0f3aabd50afdaa"><span lg_kh="1">(</span>以下示例显示了如何读取“title”属性。读取其他属性与之类似。考虑类 org.apache.poi.hpsf.SummaryInformation 的 API 文档以了解哪些方法可用。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_6f24d21f72744502b83cefd66ca2e838">The standard properties this section focuses on can be found in a document called <em>\005SummaryInformation</em> located in the root of the POI filesystem. The notation <em>\005</em> in the document's name means the character with a decimal value of 5. In order to read the "title" property, an application has to perform the following steps:</span><span class="tscolor" lg_zh="t_6f24d21f72744502b83cefd66ca2e838"><span lg_kh="1">(</span>本节重点介绍的标准属性可以在位于POI文件系统根目录下的名为\005SummaryInformation的文档中找到。文档名称中的符号\005表示十进制值为5的字符。为了读取“title”属性，应用程序必须执行以下步骤：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_c356fd8a685b4acc98fa3d1fb1230c86">Open the document <em>\005SummaryInformation</em> located in the root of the POI filesystem.</span><span class="tscolor" lg_zh="t_c356fd8a685b4acc98fa3d1fb1230c86"><span lg_kh="1">(</span>打开位于兴趣点文件系统根目录中的文档' 005 SummaryInfo。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_321460ee44af43df8330706b5e342985">Create an instance of the class <span class="codefrag">SummaryInformation</span> from that document.</span><span class="tscolor" lg_zh="t_321460ee44af43df8330706b5e342985"><span lg_kh="1">(</span>从该文档创建类 SummaryInformation 的实例。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_cc8263955be94a3caa24b9395def9264">Call the <span class="codefrag">SummaryInformation</span> instance's <span class="codefrag">getTitle()</span> method.</span><span class="tscolor" lg_zh="t_cc8263955be94a3caa24b9395def9264"><span lg_kh="1">(</span>调用 SummaryInformation 实例的 getTitle() 方法。<span lg_kh="1">)</span></span></li>
     </ol>
     <p><span lg_en="t_baa3fcd1fb4c4e2ba35b12cd043856ea">Sounds easy, doesn't it? Here are the steps in detail.</span><span class="tscolor" lg_zh="t_baa3fcd1fb4c4e2ba35b12cd043856ea"><span lg_kh="1">(</span>听起来很容易，不是吗？以下是详细步骤。<span lg_kh="1">)</span></span></p>
     <a name="Open+the+document+%5C005SummaryInformation+in+the+root+of+the%0A+++++++POI+filesystem"></a>
     <h4><span lg_en="t_bc141d8c62bc45ad929cfc973ba28937">Open the document \005SummaryInformation in the root of the POI filesystem</span><span class="tscolor" lg_zh="t_bc141d8c62bc45ad929cfc973ba28937"><span lg_kh="1">(</span>打开兴趣点文件系统根目录中的文档' 005 SummaryInfo<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_1279c594fc174a94a97a424ee16f380c">An application that wants to open a document in a POI filesystem (POIFS) proceeds as shown by the following code fragment. The full source code of the sample application is available in the <em>examples</em> section of the POI source tree as <em>ReadTitle.java</em>.</span><span class="tscolor" lg_zh="t_1279c594fc174a94a97a424ee16f380c"><span lg_kh="1">(</span>想要在 POI 文件系统 (POIFS) 中打开文档的应用程序按照以下代码片段所示进行。示例应用程序的完整源代码可在 POI 源代码树的示例部分中获得，即 ReadTitle.java。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.poifs.eventfilesystem.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// ...</span>
      </div>
      <div class="codeline" lg_zh="t_c4787dfdab4f4539ad7103afb9992c89">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// ...
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public static void main(String[] args)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throws IOException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final String filename = args[0];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> POIFSReader r = new POIFSReader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r.registerListener(new MyPOIFSReaderListener(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "\005SummaryInformation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r.read(new FileInputStream(filename));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_3b1090559af04d3c844f243756ff5cbc">The first interesting statement is</span><span class="tscolor" lg_zh="t_3b1090559af04d3c844f243756ff5cbc"><span lg_kh="1">(</span>第一个有趣的说法是<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSReader r = new POIFSReader();</span>
      </div>
     </div>
     <p><span lg_en="t_b2b5ca1890af453c963ae6cbe49ec5d7">It creates a <span class="codefrag">org.apache.poi.poifs.eventfilesystem.POIFSReader</span> instance which we shall need to read the POI filesystem. Before the application actually opens the POI filesystem we have to tell the <span class="codefrag">POIFSReader</span> which documents we are interested in. In this case the application should do something with the document <em>\005SummaryInformation</em>.</span><span class="tscolor" lg_zh="t_b2b5ca1890af453c963ae6cbe49ec5d7"><span lg_kh="1">(</span>它创建了一个org.apache.poi.poifs.eventfilesystem.POIFSReader实例，我们需要该实例读取DOE文件系统。在应用程序真正打开DOE文件系统之前，我们必须告诉POIFSReader我们对哪些文档感兴趣。在这种情况下，应用程序应该对文档#005 SummaryInfo执行一些操作。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r.registerListener(new MyPOIFSReaderListener(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "\005SummaryInformation");</span>
      </div>
     </div>
     <p><span lg_en="t_868a1a1b85e44a6f91ee5da2493e9569">This method call registers a <span class="codefrag">org.apache.poi.poifs.eventfilesystem.POIFSReaderListener</span> with the <span class="codefrag">POIFSReader</span>. The <span class="codefrag">POIFSReaderListener</span> interface specifies the method <span class="codefrag">processPOIFSReaderEvent()</span> which processes a document. The class <span class="codefrag">MyPOIFSReaderListener</span> implements the <span class="codefrag">POIFSReaderListener</span> and thus the <span class="codefrag">processPOIFSReaderEvent()</span> method. The eventing POI filesystem calls this method when it finds the <em>\005SummaryInformation</em> document. In the sample application <span class="codefrag">MyPOIFSReaderListener</span> is a static class in the <em>ReadTitle.java</em> source file.</span><span class="tscolor" lg_zh="t_868a1a1b85e44a6f91ee5da2493e9569"><span lg_kh="1">(</span>此方法调用向POIFSReader注册org.apache.poi.poifs. eventfiles. POIFSReaderDoctor。POIFSReaderHandler接口指定处理文档的方法changePOIFSReaderEvents（）。MyPOIFSReaderSYS类实现POIFSReaderSYS，从而实现Process POIFSReaderEvents（）方法。事件发生的DOE文件系统在找到' 005 SummaryInfo文档时调用此方法。在示例应用程序中，MyPOIFSReaderSYS是ReadTitle.java源文件中的静态类。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8f72a11c4c15440eb4e1f43d0cb84274">Now everything is prepared and reading the POI filesystem can start:</span><span class="tscolor" lg_zh="t_8f72a11c4c15440eb4e1f43d0cb84274"><span lg_kh="1">(</span>现在一切准备就绪，可以开始读取 POI 文件系统：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r.read(new FileInputStream(filename));</span>
      </div>
     </div>
     <p><span lg_en="t_981237305d464a0fadf231c054541476">The following source code fragment shows the <span class="codefrag">MyPOIFSReaderListener</span> class and how it retrieves the title.</span><span class="tscolor" lg_zh="t_981237305d464a0fadf231c054541476"><span lg_kh="1">(</span>以下源代码片段显示了 MyPOIFSReaderListener 类以及它如何检索标题。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">static class MyPOIFSReaderListener implements POIFSReaderListener</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void processPOIFSReaderEvent(POIFSReaderEvent event)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SummaryInformation si = null;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> si = (SummaryInformation)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PropertySetFactory.create(event.getStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> catch (Exception ex)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throw new RuntimeException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ("Property set stream \"" +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> event.getPath() + event.getName() + "\": " + ex);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final String title = si.getTitle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (title != null)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Title: \"" + title + "\"");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Document has no title.");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_ee7d8755b32f4e09bc87f80e59ead111">The line</span><span class="tscolor" lg_zh="t_ee7d8755b32f4e09bc87f80e59ead111"><span lg_kh="1">(</span>线<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SummaryInformation si = null;</span>
      </div>
     </div>
     <p><span lg_en="t_ad91e43207ac412ea39588f56f332964">declares a <span class="codefrag">SummaryInformation</span> variable and initializes it with <span class="codefrag">null</span>. We need an instance of this class to access the title. The instance is created in a <span class="codefrag">try</span> block:</span><span class="tscolor" lg_zh="t_ad91e43207ac412ea39588f56f332964"><span lg_kh="1">(</span>声明一个 SummaryInformation 变量并将其初始化为 null。我们需要这个类的一个实例来访问标题。该实例在 try 块中创建：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">si = (SummaryInformation)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PropertySetFactory.create(event.getStream());</span>
      </div>
     </div>
     <p><span lg_en="t_76d23b47247f461f9da63246e0139a0a">The expression <span class="codefrag">event.getStream()</span> returns the input stream containing the bytes of the property set stream named <em>\005SummaryInformation</em>. This stream is passed into the <span class="codefrag">create</span> method of the factory class <span class="codefrag">org.apache.poi.hpsf.PropertySetFactory</span> which returns a <span class="codefrag">org.apache.poi.hpsf.PropertySet</span> instance. It is more or less safe to cast this result to <span class="codefrag">SummaryInformation</span>, a convenience class with methods like <span class="codefrag">getTitle()</span>, <span class="codefrag">getAuthor()</span> etc.</span><span class="tscolor" lg_zh="t_76d23b47247f461f9da63246e0139a0a"><span lg_kh="1">(</span>表达事件.getStream（）返回包含名为\005SummaryInfo的属性集流的字节的输入流。该流被传递到工厂类org.apache.poi.hpsf.PropertySetFactory的创建方法中，该方法返回org.apache.poi.hpsf.PropertySet实例。将此结果转换为SummaryInfo或多或少是安全的，这是一个具有getTitle（）、getAuthor（）等方法的便利类。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9f3cc1b37bd2461e82cae3acd544ae7f">The <span class="codefrag">PropertySetFactory.create()</span> method may throw all sorts of exceptions. We'll deal with them in the next sections. For now we just catch all exceptions and throw a <span class="codefrag">RuntimeException</span> containing the message text of the origin exception.</span><span class="tscolor" lg_zh="t_9f3cc1b37bd2461e82cae3acd544ae7f"><span lg_kh="1">(</span>PropertySetFactory.create() 方法可能会抛出各种异常。我们将在下一节中处理它们。现在我们只捕获所有异常并抛出一个包含原始异常消息文本的 RuntimeException。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_550f4aaa1e3d401582beec5203368685">If all goes well, the sample application retrieves the title and prints it to the standard output. As you can see you must be prepared for the case that the POI filesystem does not have a title.</span><span class="tscolor" lg_zh="t_550f4aaa1e3d401582beec5203368685"><span lg_kh="1">(</span>如果一切顺利，示例应用程序将检索标题并将其打印到标准输出。如您所见，您必须为 POI 文件系统没有标题的情况做好准备。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final String title = si.getTitle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if (title != null)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Title: \"" + title + "\"");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">else</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Document has no title.");</span>
      </div>
     </div>
     <p><span lg_en="t_47a69bc4261946f3814c2307fa63e080">Please note that a POI filesystem does not necessarily contain the <em>\005SummaryInformation</em> stream. The documents created by the Microsoft Office suite have one, as far as I know. However, an Excel spreadsheet exported from StarOffice 5.2 won't have a <em>\005SummaryInformation</em> stream. In this case the applications won't throw an exception but simply does not call the <span class="codefrag">processPOIFSReaderEvent</span> method. You have been warned!</span><span class="tscolor" lg_zh="t_47a69bc4261946f3814c2307fa63e080"><span lg_kh="1">(</span>请注意，POI文件系统不一定包含\005SummaryInformation流。据我所知，Microsoft Office套件创建的文档有一个。但是，从StarOffice 5.2导出的Excel电子表格不会有\005SummaryInformation流。在这种情况下，应用程序不会抛出异常，只是不调用processPOIFSReaderEvent方法。您已被警告！<span lg_kh="1">)</span></span></p>
     <a name="sec2" id="sec2"></a><a name="Additional+Standard+Properties%2C+Exceptions+And+Embedded%0A++++Objects"></a>
     <h3 class="boxed"><span lg_en="t_187fd9cb367f4b8595c76862ca26c2b9">Additional Standard Properties, Exceptions And Embedded Objects</span><span class="tscolor" lg_zh="t_187fd9cb367f4b8595c76862ca26c2b9"><span lg_kh="1">(</span>其他标准属性、异常和嵌入对象<span lg_kh="1">)</span></span></h3>
     <div class="note">
      <div class="label">
       <span lg_en="t_fd8b5cf0115c419da014e0db1ebb166d">Note</span><span class="tscolor" lg_zh="t_fd8b5cf0115c419da014e0db1ebb166d"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_f6b3375391cf48adb8aab240d8643e9c">This section focusses on reading additional standard properties which are kept in the <strong>document summary information</strong> stream. It also talks about exceptions that may be thrown when dealing with HPSF and shows how you can read properties of embedded objects.</span><span class="tscolor" lg_zh="t_f6b3375391cf48adb8aab240d8643e9c"><span lg_kh="1">(</span>本节重点阅读保存在文档摘要信息流中的其他标准属性。它还讨论了处理 HPSF 时可能引发的异常，并展示了如何读取嵌入对象的属性。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_f8e3e01dd2bb404b87e8bbf89c459f82">A couple of <strong>additional standard properties</strong> are not contained in the <em>\005SummaryInformation</em> stream explained above. Examples for such properties are a document's category or the number of multimedia clips in a PowerPoint presentation. Microsoft has invented an additional stream named <em>\005DocumentSummaryInformation</em> to hold these properties. With two minor exceptions you can proceed exactly as described above to read the properties stored in <em>\005DocumentSummaryInformation</em>:</span><span class="tscolor" lg_zh="t_f8e3e01dd2bb404b87e8bbf89c459f82"><span lg_kh="1">(</span>上面解释的\005 SummaryInfo流中不包含几个额外的标准属性。此类属性的示例包括文档的类别或PowerPoint演示文稿中的多媒体剪辑数量。Microsoft发明了一个名为' 005 Document SummaryInfo的附加流来保存这些属性。除了两个小例外之外，您可以完全按照上述操作来读取存储在\005 Document SummaryInfo中的属性：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_7639dfa2391b41bba1503ddeccb4da9a">Instead of <em>\005SummaryInformation</em> use <em>\005DocumentSummaryInformation</em> as the stream's name.</span><span class="tscolor" lg_zh="t_7639dfa2391b41bba1503ddeccb4da9a"><span lg_kh="1">(</span>不要使用\005 SummaryInfo作为流的名称。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_5f930140aa814d28a0b524d821d76fc0">Replace all occurrences of the class <span class="codefrag">SummaryInformation</span> by <span class="codefrag">DocumentSummaryInformation</span>.</span><span class="tscolor" lg_zh="t_5f930140aa814d28a0b524d821d76fc0"><span lg_kh="1">(</span>用 DocumentSummaryInformation 替换所有出现的类 SummaryInformation。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_b94595891b5a429da42173ecabaff334">And of course you cannot call <span class="codefrag">getTitle()</span> because <span class="codefrag">DocumentSummaryInformation</span> has different query methods, e.g. <span class="codefrag">getCategory</span>. See the Javadoc API documentation for the details.</span><span class="tscolor" lg_zh="t_b94595891b5a429da42173ecabaff334"><span lg_kh="1">(</span>当然你不能调用getTitle() 因为DocumentSummaryInformation 有不同的查询方法，例如getCategory。有关详细信息，请参阅 Javadoc API 文档。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5491fc61d1904a85922e977bb016250f">In the previous section the application simply caught all <strong>exceptions</strong> and was in no way interested in any details. However, a real application will likely want to know what went wrong and act appropriately. Besides any I/O exceptions there are three HPSF resp. POI specific exceptions you should know about:</span><span class="tscolor" lg_zh="t_5491fc61d1904a85922e977bb016250f"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <dl>
      <dt>
       <span class="codefrag">NoPropertySetStreamException</span>:
      </dt>
      <dd>
       This exception is thrown if the application tries to create a <span class="codefrag">PropertySet</span> instance from a stream that is not a property set stream. (<span class="codefrag">SummaryInformation</span> and <span class="codefrag">DocumentSummaryInformation</span> are subclasses of <span class="codefrag">PropertySet</span>.) A faulty property set stream counts as not being a property set stream at all. An application should be prepared to deal with this case even if it opens streams named <em>\005SummaryInformation</em> or <em>\005DocumentSummaryInformation</em>. These are just names. A stream's name by itself does not ensure that the stream contains the expected contents and that this contents is correct.
      </dd>
      <dt>
       <span class="codefrag">UnexpectedPropertySetTypeException</span>
      </dt>
      <dd>
       This exception is thrown if a certain type of property set is expected somewhere (e.g. a <span class="codefrag">SummaryInformation</span> or <span class="codefrag">DocumentSummaryInformation</span>) but the provided property set is not of that type.
      </dd>
      <dt>
       <span class="codefrag">MarkUnsupportedException</span>
      </dt>
      <dd>
       This exception is thrown if an input stream that is to be parsed into a property set does not support the <span class="codefrag">InputStream.mark(int)</span> operation. The POI filesystem uses the <span class="codefrag">DocumentInputStream</span> class which does support this operation, so you are safe here. However, if you read a property set stream from another kind of input stream things may be different.
      </dd>
     </dl>
     <p><span lg_en="t_b0332a58835b4020afd3a48f46895bdf">Many Microsoft Office documents contain <strong>embedded objects</strong>, for example an Excel sheet within a Word document. Embedded objects may have property sets of their own. An application can open these property set streams as described above. The only difference is that they are not located in the POI filesystem's root but in a <strong>nested directory</strong> instead. Just register a <span class="codefrag">POIFSReaderListener</span> for the property set streams you are interested in.</span><span class="tscolor" lg_zh="t_b0332a58835b4020afd3a48f46895bdf"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <a name="sec3" id="sec3"></a><a name="Writing+Standard+Properties"></a>
     <h3 class="boxed"><span lg_en="t_168c24203b4c474384e02c0d76951ef8">Writing Standard Properties</span><span class="tscolor" lg_zh="t_168c24203b4c474384e02c0d76951ef8"><span lg_kh="1">(</span>编写标准属性<span lg_kh="1">)</span></span></h3>
     <div class="note">
      <div class="label">
       <span lg_en="t_10a259e8dfd54538809cab72508d2039">Note</span><span class="tscolor" lg_zh="t_10a259e8dfd54538809cab72508d2039"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_2922edb37f054489a0c64e773387275b">This section explains how to <strong>write standard properties</strong>. HPSF provides some high-level classes and methods which make writing of standard properties easy. They are based on the low-level writing functions explained in <a href="#sec4">another section</a>.</span><span class="tscolor" lg_zh="t_2922edb37f054489a0c64e773387275b"><span lg_kh="1">(</span>本节说明如何编写标准属性。 HPSF 提供了一些高级类和方法，使标准属性的编写变得容易。它们基于另一部分中解释的低级写入函数。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_83b3ec6d66e941feb350748114b2d533">As explained above, standard properties are located in the summary information and document summary information streams of typical POI filesystems. You have already learned about the classes <span class="codefrag">SummaryInformation</span> and <span class="codefrag">DocumentSummaryInformation</span> and their <span class="codefrag">get...()</span> methods for reading standard properties. These classes also provide <span class="codefrag">set...()</span> methods for writing properties.</span><span class="tscolor" lg_zh="t_83b3ec6d66e941feb350748114b2d533"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f36922d99516453089696a7c9f9ba578">After setting properties in <span class="codefrag">SummaryInformation</span> or <span class="codefrag">DocumentSummaryInformation</span> you have to write them to a disk file. The following sample program shows how you can</span><span class="tscolor" lg_zh="t_f36922d99516453089696a7c9f9ba578"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_a3a736a4fe914f8c9af7a7a7fec8d192">read a disk file into a POI filesystem,</span><span class="tscolor" lg_zh="t_a3a736a4fe914f8c9af7a7a7fec8d192"><span lg_kh="1">(</span>将磁盘文件读入 POI 文件系统，<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_410264077b504cf2a32f2af2d3dc2ccb">read the document summary information from the POI filesystem,</span><span class="tscolor" lg_zh="t_410264077b504cf2a32f2af2d3dc2ccb"><span lg_kh="1">(</span>从 POI 文件系统读取文档摘要信息，<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_657f6e79e8944bef9252a2ed7ac77010">set a property to a new value,</span><span class="tscolor" lg_zh="t_657f6e79e8944bef9252a2ed7ac77010"><span lg_kh="1">(</span>将属性设置为新值，<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9618751eeb0e4fc2ac2c6925f66c9501">write the modified document summary information back to the POI filesystem, and</span><span class="tscolor" lg_zh="t_9618751eeb0e4fc2ac2c6925f66c9501"><span lg_kh="1">(</span>将修改后的文档摘要信息写回 POI 文件系统，以及<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_dc541e58c8b84a35b286e14958c0b2d2">write the POI filesystem to a disk file.</span><span class="tscolor" lg_zh="t_dc541e58c8b84a35b286e14958c0b2d2"><span lg_kh="1">(</span>将 POI 文件系统写入磁盘文件。<span lg_kh="1">)</span></span></li>
     </ol>
     <p><span lg_en="t_70706fdfa14144ff8acdaef4c22427af">The complete source code of this program is available as <em>ModifyDocumentSummaryInformation.java</em> in the <em>examples</em> section of the POI source tree.</span><span class="tscolor" lg_zh="t_70706fdfa14144ff8acdaef4c22427af"><span lg_kh="1">(</span>该程序的完整源代码可在 POI 源代码树的示例部分中以 ModifyDocumentSummaryInformation.java 的形式获得。<span lg_kh="1">)</span></span></p>
     <div class="note">
      <div class="label">
       <span lg_en="t_b65c5810277e49bc96b1503773307190">Note</span><span class="tscolor" lg_zh="t_b65c5810277e49bc96b1503773307190"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_557780ace09f4c68bb9be28f4a55b0ce">Dealing with the summary information stream is analogous to handling the document summary information and therefore does not need to be explained here in detailed. See the HPSF API documentation to learn about the <span class="codefrag">set...()</span> methods of the class <span class="codefrag">SummaryInformation</span>.</span><span class="tscolor" lg_zh="t_557780ace09f4c68bb9be28f4a55b0ce"><span lg_kh="1">(</span>对摘要信息流的处理类似于对文档摘要信息的处理，在此不再赘述。请参阅 HPSF API 文档以了解 SummaryInformation 类的 set...() 方法。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_fb0648cfbe7640ea8d0ed97f99ad6df4">The first step is to read the POI filesystem into memory:</span><span class="tscolor" lg_zh="t_fb0648cfbe7640ea8d0ed97f99ad6df4"><span lg_kh="1">(</span>第一步是将 POI 文件系统读入内存：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">InputStream is = new FileInputStream(poiFilesystem);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem poifs = new POIFSFileSystem(is);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">is.close();</span>
      </div>
     </div>
     <p><span lg_en="t_aa5fe3229b004af4a9d647a9b83d92f7">The code snippet above assumes that the variable <span class="codefrag">poiFilesystem</span> holds the name of a disk file. It reads the file from an input stream and creates a <span class="codefrag">POIFSFileSystem</span> object in memory. After having read the file, the input stream should be closed as shown.</span><span class="tscolor" lg_zh="t_aa5fe3229b004af4a9d647a9b83d92f7"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_40b35fb0023d413795dad6562f8a802d">In order to read the document summary information stream the application must open the element <em>\005DocumentSummaryInformation</em> in the POI filesystem's root directory. However, the POI filesystem does not necessarily contain a document summary information stream, and the application should be able to deal with that situation. The following code does so by creating a new <span class="codefrag">DocumentSummaryInformation</span> if there is none in the POI filesystem:</span><span class="tscolor" lg_zh="t_40b35fb0023d413795dad6562f8a802d"><span lg_kh="1">(</span>为了读取文档摘要信息流，应用程序必须打开兴趣点文件系统根目录中的元素\005DocumentSummaryInfo。然而，兴趣点文件系统不一定包含文档摘要信息流，并且应用程序应该能够处理这种情况。如果兴趣点文件系统中没有，以下代码将通过创建新的DocumentSummaryInfo来实现这一目标：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DirectoryEntry dir = poifs.getRoot();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DocumentSummaryInformation dsi;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DocumentEntry dsiEntry = (DocumentEntry)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dir.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DocumentInputStream dis = new DocumentInputStream(dsiEntry);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PropertySet ps = new PropertySet(dis);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dis.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dsi = new DocumentSummaryInformation(ps);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">catch (FileNotFoundException ex)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* There is no document summary information. We have to create a</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * new one. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dsi = PropertySetFactory.newDocumentSummaryInformation();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_4d1475893e7f41f392eee3af0a991315">In the source code above the statement</span><span class="tscolor" lg_zh="t_4d1475893e7f41f392eee3af0a991315"><span lg_kh="1">(</span>在上面的源代码中声明<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DirectoryEntry dir = poifs.getRoot();</span>
      </div>
     </div>
     <p><span lg_en="t_f5616089c84d49a2abddce9f918cec84">gets hold of the POI filesystem's root directory as a <span class="codefrag">DirectoryEntry</span>. The <span class="codefrag">getEntry()</span> method of this class is used to access a file or directory entry in a directory. However, if the file to be opened does not exist, a <span class="codefrag">FileNotFoundException</span> will be thrown. Therefore opening the document summary information entry should be done in a <span class="codefrag">try</span> block:</span><span class="tscolor" lg_zh="t_f5616089c84d49a2abddce9f918cec84"><span lg_kh="1">(</span>获取 POI 文件系统的根目录作为 DirectoryEntry。此类的 getEntry() 方法用于访问目录中的文件或目录条目。但是，如果要打开的文件不存在，则会抛出 FileNotFoundException。因此打开文档摘要信息条目应该在 try 块中完成：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DocumentEntry dsiEntry = (DocumentEntry)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dir.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);</span>
      </div>
     </div>
     <p><span lg_en="t_4353515520464876b947f257b0da7bc2"><span class="codefrag">DocumentSummaryInformation.DEFAULT_STREAM_NAME</span> represents the string "\005DocumentSummaryInformation", i.e. the standard name of a document summary information stream. If this stream exists, the <span class="codefrag">getEntry()</span> method returns a <span class="codefrag">DocumentEntry</span>. To read the <span class="codefrag">DocumentEntry</span>'s contents, create a <span class="codefrag">DocumentInputStream</span>:</span><span class="tscolor" lg_zh="t_4353515520464876b947f257b0da7bc2"><span lg_kh="1">(</span>Document SummaryInfo. DID_UTE_START表示字符串“\005Document SummaryInfo”，即文档摘要信息流的标准名称。如果此流存在，则getEntry（）方法返回Document entry。要读取Document entry的内容，请创建Document InputStream：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DocumentInputStream dis = new DocumentInputStream(dsiEntry);</span>
      </div>
     </div>
     <p><span lg_en="t_cd430704e322446daedbd44d26f8756d">Up to this point we have used POI's <a href="../poifs/index.html">POIFS component</a>. Now HPSF enters the stage. A property set is created from the input stream's data:</span><span class="tscolor" lg_zh="t_cd430704e322446daedbd44d26f8756d"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PropertySet ps = new PropertySet(dis);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dis.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dsi = new DocumentSummaryInformation(ps); </span>
      </div>
     </div>
     <p><span lg_en="t_5e37601323b34734a8491023f4cddabb">If the data really constitutes a property set, a <span class="codefrag">PropertySet</span> object is created. Otherwise a <span class="codefrag">NoPropertySetStreamException</span> is thrown. After having read the data from the input stream the latter should be closed.</span><span class="tscolor" lg_zh="t_5e37601323b34734a8491023f4cddabb"><span lg_kh="1">(</span>如果数据确实构成了一个属性集，则创建一个 PropertySet 对象。否则抛出 NoPropertySetStreamException。从输入流中读取数据后，后者应关闭。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f8efe7348244451d8549738535e0ebcb">Since we know - or at least hope - that the stream named "\005DocumentSummaryInformation" is not just any property set but really contains the document summary information, we try to create a new <span class="codefrag">DocumentSummaryInformation</span> from the property set. If the stream is not document summary information stream the sample application fails with a <span class="codefrag">UnexpectedPropertySetTypeException</span>.</span><span class="tscolor" lg_zh="t_f8efe7348244451d8549738535e0ebcb"><span lg_kh="1">(</span>由于我们知道--或者至少希望--名为“\005Document SummaryInfo”的流不仅仅是任何属性集，而是真正包含文档摘要信息，因此我们尝试从属性集创建新的Document SummaryInfo。如果该流不是文档摘要信息流，则示例应用程序失败，并出现UnexpectedPropertySetType异常。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_78ca60de1273478e8d72451ad577c503">If the POI document does not contain a document summary information stream, we can create a new one in the <span class="codefrag">catch</span> clause. The <span class="codefrag">PropertySetFactory</span>'s method <span class="codefrag">newDocumentSummaryInformation()</span> establishes a new and empty <span class="codefrag">DocumentSummaryInformation</span> instance:</span><span class="tscolor" lg_zh="t_78ca60de1273478e8d72451ad577c503"><span lg_kh="1">(</span>如果 POI 文档不包含文档摘要信息流，我们可以在 catch 子句中创建一个新的。 PropertySetFactory 的方法 newDocumentSummaryInformation() 建立一个新的空 DocumentSummaryInformation 实例：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dsi = PropertySetFactory.newDocumentSummaryInformation();</span>
      </div>
     </div>
     <p><span lg_en="t_c3bbf555356c4728b54b8649108e82d5">Whether we read the document summary information from the POI filesystem or created it from scratch, in either case we now have a <span class="codefrag">DocumentSummaryInformation</span> instance we can write to. Writing is quite simple, as the following line of code shows:</span><span class="tscolor" lg_zh="t_c3bbf555356c4728b54b8649108e82d5"><span lg_kh="1">(</span>无论我们是从 POI 文件系统读取文档摘要信息还是从头开始创建它，在任何一种情况下，我们现在都有一个可以写入的 DocumentSummaryInformation 实例。写起来很简单，如以下代码行所示：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dsi.setCategory("POI example");</span>
      </div>
     </div>
     <p><span lg_en="t_531ae062eeb848e0814456fa1174623d">This statement sets the "category" property to "POI example". Any former "category" value will be lost. If there hasn't been a "category" property yet, a new one will be created.</span><span class="tscolor" lg_zh="t_531ae062eeb848e0814456fa1174623d"><span lg_kh="1">(</span>此语句将“类别”属性设置为“POI 示例”。任何以前的“类别”值都将丢失。如果还没有“类别”属性，则会创建一个新属性。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_246c188af19d43219b60dfb60f4af5f9"><span class="codefrag">DocumentSummaryInformation</span> of course has methods to set the other standard properties, too - look into the API documentation to see all of them.</span><span class="tscolor" lg_zh="t_246c188af19d43219b60dfb60f4af5f9"><span lg_kh="1">(</span>DocumentSummaryInformation 当然也有设置其他标准属性的方法 - 查看 API 文档以查看所有这些属性。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8bae7b5f249f4da7ade337d8e4a1ad5e">Once all properties are set as needed, they should be stored into the file on disk. The first step is to write the <span class="codefrag">DocumentSummaryInformation</span> into the POI filesystem:</span><span class="tscolor" lg_zh="t_8bae7b5f249f4da7ade337d8e4a1ad5e"><span lg_kh="1">(</span>根据需要设置所有属性后，应将它们存储到磁盘上的文件中。第一步是将 DocumentSummaryInformation 写入 POI 文件系统：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dsi.write(dir, DocumentSummaryInformation.DEFAULT_STREAM_NAME);</span>
      </div>
     </div>
     <p><span lg_en="t_c51023af5ce849b5b37f266eec3898ae">The <span class="codefrag">DocumentSummaryInformation</span>'s <span class="codefrag">write()</span> method takes two parameters: The first is the <span class="codefrag">DirectoryEntry</span> in the POI filesystem, the second is the name of the stream to create in the directory. If this stream already exists, it will be overwritten.</span><span class="tscolor" lg_zh="t_c51023af5ce849b5b37f266eec3898ae"><span lg_kh="1">(</span>DocumentSummaryInformation 的 write() 方法有两个参数：第一个是 POI 文件系统中的 DirectoryEntry，第二个是要在目录中创建的流的名称。如果这个流已经存在，它将被覆盖。<span lg_kh="1">)</span></span></p>
     <div class="note">
      <div class="label">
       <span lg_en="t_379bea702cd94f26a1ea0c0ea0f8ebc0">Note</span><span class="tscolor" lg_zh="t_379bea702cd94f26a1ea0c0ea0f8ebc0"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_2cb733f5b16f42c0ac095bd8f4f94d82">If you not only modified the document summary information but also the summary information you have to write both of them to the POI filesystem.</span><span class="tscolor" lg_zh="t_2cb733f5b16f42c0ac095bd8f4f94d82"><span lg_kh="1">(</span>如果您不仅修改了文档摘要信息，还修改了摘要信息，您必须将它们都写入 POI 文件系统。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_9cec3dbd1ee14049b9fc7bffadcb5783">Still the POI filesystem is a data structure in memory only and must be written to a disk file to make it permanent. The following lines write back the POI filesystem to the file it was read from before. Please note that in production-quality code you should never write directly to the origin file, because in case of an error everything would be lost. Here it is done this way to keep the example short.</span><span class="tscolor" lg_zh="t_9cec3dbd1ee14049b9fc7bffadcb5783"><span lg_kh="1">(</span>POI 文件系统仍然只是内存中的数据结构，必须写入磁盘文件以使其永久化。以下行将 POI 文件系统写回到之前读取的文件中。请注意，在生产质量代码中，您永远不应该直接写入原始文件，因为如果出现错误，一切都会丢失。此处以这种方式完成以保持示例简短。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OutputStream out = new FileOutputStream(poiFilesystem);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">poifs.writeFilesystem(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out.close();</span>
      </div>
     </div>
     <a name="User-Defined+Properties"></a>
     <h4><span lg_en="t_6ec94912a0d841c485839e36ec2b1080">User-Defined Properties</span><span class="tscolor" lg_zh="t_6ec94912a0d841c485839e36ec2b1080"><span lg_kh="1">(</span>用户定义的属性<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_992f1fbed24a4fd6b7a7fdb85f4fdea6">If you compare the source code excerpts above with the file containing the full source code, you will notice that I left out some following lines of code. The are dealing with the special topic of custom properties.</span><span class="tscolor" lg_zh="t_992f1fbed24a4fd6b7a7fdb85f4fdea6"><span lg_kh="1">(</span>如果您将上面的源代码摘录与包含完整源代码的文件进行比较，您会注意到我遗漏了以下几行代码。正在处理自定义属性的特殊主题。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DocumentSummaryInformation dsi = ...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CustomProperties customProperties = dsi.getCustomProperties();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if (customProperties == null)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> customProperties = new CustomProperties();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Insert some custom properties into the container. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">customProperties.put("Key 1", "Value 1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">customProperties.put("Schlüssel 2", "Wert 2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">customProperties.put("Sample Number", new Integer(12345));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">customProperties.put("Sample Boolean", new Boolean(true));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">customProperties.put("Sample Date", new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Read a custom property. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Object value = customProperties.get("Sample Number");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Write the custom properties back to the document summary</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * information. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dsi.setCustomProperties(customProperties);</span>
      </div>
     </div>
     <p><span lg_en="t_754159b49b914997a02a69afa72d0aa2">Custom properties are properties the user can define himself. Using for example Microsoft Word he can define these extra properties and give each of them a <strong>name</strong>, a <strong>type</strong> and a <strong>value</strong>. The custom properties are stored in the document information summary along with the standard properties.</span><span class="tscolor" lg_zh="t_754159b49b914997a02a69afa72d0aa2"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5e88d4ee656c4eacaad9a4a8839422f2">The source code example shows how to retrieve the custom properties as a whole from a <span class="codefrag">DocumentSummaryInformation</span> instance using the <span class="codefrag">getCustomProperties()</span> method. The result is a <span class="codefrag">CustomProperties</span> instance or <span class="codefrag">null</span> if no user-defined properties exist.</span><span class="tscolor" lg_zh="t_5e88d4ee656c4eacaad9a4a8839422f2"><span lg_kh="1">(</span>源代码示例展示了如何使用 getCustomProperties() 方法从 DocumentSummaryInformation 实例中检索整个自定义属性。如果不存在用户定义的属性，则结果是 CustomProperties 实例或 null。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9ef9209e64bc4ce99c648f25359ba553">Since <span class="codefrag">CustomProperties</span> implements the <span class="codefrag">Map</span> interface you can read and write properties with the usual <span class="codefrag">Map</span> methods. However, <span class="codefrag">CustomProperties</span> poses some restrictions on the types of keys and values.</span><span class="tscolor" lg_zh="t_9ef9209e64bc4ce99c648f25359ba553"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_7c39e40263bb4875a5ad5555f3449cba">The <strong>key</strong> is a string.</span><span class="tscolor" lg_zh="t_7c39e40263bb4875a5ad5555f3449cba"><span lg_kh="1">(</span>键是一个字符串。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_baa8323b2fc4401d8b26ab356064a8fe">The <strong>value</strong> is one of <span class="codefrag">String</span>, <span class="codefrag">Boolean</span>, <span class="codefrag">Long</span>, <span class="codefrag">Integer</span>, <span class="codefrag">Short</span>, or <span class="codefrag">java.util.Date</span>.</span><span class="tscolor" lg_zh="t_baa8323b2fc4401d8b26ab356064a8fe"><span lg_kh="1">(</span>该值是 String、Boolean、Long、Integer、Short 或 java.util.Date 之一。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_a3fffabd9bf340d2b760a72d37998ac4">The <span class="codefrag">CustomProperties</span> class has been designed for easy access using just keys and values. The underlying Microsoft-specific custom properties data structure is more complicated. However, it does not provide noteworthy additional benefits. It is possible to have multiple properties with the same name or properties without a name at all. When reading custom properties from a document summary information stream, the <span class="codefrag">CustomProperties</span> class ignores properties without a name and keeps only the "last" (whatever that means) of those properties having the same name. You can find out whether a <span class="codefrag">CustomProperties</span> instance dropped any properties with the <span class="codefrag">isPure()</span> method.</span><span class="tscolor" lg_zh="t_a3fffabd9bf340d2b760a72d37998ac4"><span lg_kh="1">(</span>CustomProperties 类的设计目的是仅使用键和值即可轻松访问。底层的 Microsoft 特定的自定义属性数据结构更加复杂。但是，它没有提供值得注意的额外好处。可以有多个具有相同名称的属性或根本没有名称的属性。从文档摘要信息流中读取自定义属性时，CustomProperties 类会忽略没有名称的属性，并且仅保留具有相同名称的那些属性的“最后一个”（无论这意味着什么）。您可以使用 isPure() 方法查看 CustomProperties 实例是否删除了任何属性。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_055245aed1ba48f5a0e02b070766e147">You can read and write the full spectrum of custom properties with HPSF's low-level methods. They are explained in the <a href="#sec4">next section</a>.</span><span class="tscolor" lg_zh="t_055245aed1ba48f5a0e02b070766e147"><span lg_kh="1">(</span>您可以使用 HPSF 的低级方法读取和写入所有自定义属性。它们将在下一节中解释。<span lg_kh="1">)</span></span></p>
     <a name="sec4" id="sec4"></a><a name="Reading+Non-Standard+Properties"></a>
     <h3 class="boxed"><span lg_en="t_5cc2424ddbd24a278ee1310849eec3a1">Reading Non-Standard Properties</span><span class="tscolor" lg_zh="t_5cc2424ddbd24a278ee1310849eec3a1"><span lg_kh="1">(</span>读取非标准属性<span lg_kh="1">)</span></span></h3>
     <div class="note">
      <div class="label">
       <span lg_en="t_fa8fee51f6ed4a81b17aba81aa8f9b39">Note</span><span class="tscolor" lg_zh="t_fa8fee51f6ed4a81b17aba81aa8f9b39"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_ad3dbb06d9c24c66bcd7183d99c6f325">This section tells how to read non-standard properties. Non-standard properties are application-specific ID/type/value triples.</span><span class="tscolor" lg_zh="t_ad3dbb06d9c24c66bcd7183d99c6f325"><span lg_kh="1">(</span>本节介绍如何读取非标准属性。非标准属性是特定于应用程序的 ID/类型/值三元组。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <a name="Overview"></a>
     <h4><span lg_en="t_9b87a725cdda425dbca8e10e2c3401ae">Overview</span><span class="tscolor" lg_zh="t_9b87a725cdda425dbca8e10e2c3401ae"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_bc789faf2d3944049b885b9514749407">Now comes the real hardcode stuff. As mentioned above, <span class="codefrag">SummaryInformation</span> and <span class="codefrag">DocumentSummaryInformation</span> are just special cases of the general concept of a property set. This concept says that a <strong>property set</strong> consists of properties and that each <strong>property</strong> is an entity with an <strong>ID</strong>, a <strong>type</strong>, and a <strong>value</strong>.</span><span class="tscolor" lg_zh="t_bc789faf2d3944049b885b9514749407"><span lg_kh="1">(</span>现在是真正的硬编码的东西。如上所述，SummaryInformation 和 DocumentSummaryInformation 只是属性集一般概念的特例。这个概念表示属性集由属性组成，每个属性都是具有 ID、类型和值的实体。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_31e12188247c4685a3f7fd06504ed93e">Okay, that was still rather easy. However, to make things more complicated, Microsoft in its infinite wisdom decided that a property set shalt be broken into one or more <strong>sections</strong>. Each section holds a bunch of properties. But since that's still not complicated enough, a section may have an optional <strong>dictionary</strong> that maps property IDs to <strong>property names</strong> - we'll explain later what that means.</span><span class="tscolor" lg_zh="t_31e12188247c4685a3f7fd06504ed93e"><span lg_kh="1">(</span>好吧，那还是很容易的。然而，为了让事情变得更复杂，微软以其无限的智慧决定将一个属性集分成一个或多个部分。每个部分都有一堆属性。但是由于这还不够复杂，所以一个部分可能有一个可选的字典，将属性 ID 映射到属性名称 - 我们稍后会解释这意味着什么。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_79e8bd16f43e425685dabf26ea65d52c">The procedure to get to the properties is the following:</span><span class="tscolor" lg_zh="t_79e8bd16f43e425685dabf26ea65d52c"><span lg_kh="1">(</span>获取属性的过程如下：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_7e01feb144504d45b74449c3b8bc92cb">Use the <strong><span class="codefrag">PropertySetFactory</span></strong> class to create a <span class="codefrag">PropertySet</span> object from a property set stream. If you don't know whether an input stream is a property set stream, just try to call <span class="codefrag">PropertySetFactory.create(java.io.InputStream)</span>: You'll either get a <span class="codefrag">PropertySet</span> instance returned or an exception is thrown.</span><span class="tscolor" lg_zh="t_7e01feb144504d45b74449c3b8bc92cb"><span lg_kh="1">(</span>使用 PropertySetFactory 类从属性集流创建 PropertySet 对象。如果您不知道输入流是否是属性集流，只需尝试调用 PropertySetFactory.create(java.io.InputStream)：您将获得返回的 PropertySet 实例或引发异常。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a0b1257332674eb1b212685ba17c7444">Call the <span class="codefrag">PropertySet</span>'s method <span class="codefrag">getSections()</span> to get the sections contained in the property set. Each section is an instance of the <span class="codefrag">Section</span> class.</span><span class="tscolor" lg_zh="t_a0b1257332674eb1b212685ba17c7444"><span lg_kh="1">(</span>调用 PropertySet 的方法 getSections() 来获取属性集中包含的部分。每个部分都是 Section 类的一个实例。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_077374dfd8a3467bbe5ff4d96a7b2bee">Each section has a format ID. The format ID of the first section in a property set determines the property set's type. For example, the first (and only) section of the summary information property set has a format ID of <span class="codefrag">F29F85E0-4FF9-1068-AB-91-08-00-2B-27-B3-D9</span>. You can get the format ID with <span class="codefrag">Section.getFormatID()</span>.</span><span class="tscolor" lg_zh="t_077374dfd8a3467bbe5ff4d96a7b2bee"><span lg_kh="1">(</span>每个部分都有一个格式 ID。属性集中第一部分的格式 ID 决定了属性集的类型。例如，摘要信息属性集的第一个（也是唯一一个）部分的格式 ID 为 F29F85E0-4FF9-1068-AB-91-08-00-2B-27-B3-D9。您可以使用 Section.getFormatID() 获取格式 ID。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_7f54867df10444f3b1925870741fd1bf">The properties contained in a <span class="codefrag">Section</span> can be retrieved with <span class="codefrag">Section.getProperties()</span>. The result is an array of <span class="codefrag">Property</span> instances.</span><span class="tscolor" lg_zh="t_7f54867df10444f3b1925870741fd1bf"><span lg_kh="1">(</span>可以使用 Section.getProperties() 检索 Section 中包含的属性。结果是一组 Property 实例。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_3c8c40dfefd74a92b3427fe9b32302a9">A property has a name, a type, and a value. The <span class="codefrag">Property</span> class has methods to retrieve them.</span><span class="tscolor" lg_zh="t_3c8c40dfefd74a92b3427fe9b32302a9"><span lg_kh="1">(</span>属性具有名称、类型和值。 Property 类具有检索它们的方法。<span lg_kh="1">)</span></span></li>
     </ol>
     <a name="A+Sample+Application"></a>
     <h4><span lg_en="t_d976ce13983b46cc938636a47bd79595">A Sample Application</span><span class="tscolor" lg_zh="t_d976ce13983b46cc938636a47bd79595"><span lg_kh="1">(</span>示例应用程序<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_3ede541e976544939f289edf170c9fa4">Let's have a look at a sample Java application that dumps all property set streams contained in a POI file system. The full source code of this program can be found as <em>ReadCustomPropertySets.java</em> in the <em>examples</em> area of the POI source code tree. Here are the key sections:</span><span class="tscolor" lg_zh="t_3ede541e976544939f289edf170c9fa4"><span lg_kh="1">(</span>让我们看一个示例 Java 应用程序，它转储 POI 文件系统中包含的所有属性集流。该程序的完整源代码可以在 POI 源代码树的示例区域中的 ReadCustomPropertySets.java 中找到。以下是关键部分：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.util.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.poifs.eventfilesystem.*;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.util.HexDump;</span>
      </div>
     </div>
     <p><span lg_en="t_cbc74bed743e4a90b02f6f66fe1341d7">The most important package the application needs is <span class="codefrag">org.apache.poi.hpsf.*</span>. This package contains the HPSF classes. Most classes named below are from the HPSF package. Of course we also need the POIFS event file system's classes and <span class="codefrag">java.io.*</span> since we are dealing with POI I/O. From the <span class="codefrag">java.util</span> package we use the <span class="codefrag">List</span> and <span class="codefrag">Iterator</span> class. The class <span class="codefrag">org.apache.poi.util.HexDump</span> provides a methods to dump byte arrays as nicely formatted strings.</span><span class="tscolor" lg_zh="t_cbc74bed743e4a90b02f6f66fe1341d7"><span lg_kh="1">(</span>应用程序需要的最重要的包是 org.apache.poi.hpsf.*。该包包含 HPSF 类。下面命名的大多数类都来自 HPSF 包。当然，我们还需要 POIFS 事件文件系统的类和 java.io.*，因为我们正在处理 POI I/O。在 java.util 包中，我们使用 List 和 Iterator 类。 org.apache.poi.util.HexDump 类提供了一种将字节数组转储为格式良好的字符串的方法。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public static void main(String[] args)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throws IOException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final String filename = args[0];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> POIFSReader r = new POIFSReader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Register a listener for *all* documents. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r.registerListener(new MyPOIFSReaderListener());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r.read(new FileInputStream(filename));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_9b1c643fcd1b492ca4fc5741b3246a51">The <span class="codefrag">POIFSReader</span> is set up in a way that the listener <span class="codefrag">MyPOIFSReaderListener</span> is called on every file in the POI file system.</span><span class="tscolor" lg_zh="t_9b1c643fcd1b492ca4fc5741b3246a51"><span lg_kh="1">(</span>POIFSReader 的设置方式是在 POI 文件系统中的每个文件上调用侦听器 MyPOIFSReaderListener。<span lg_kh="1">)</span></span></p>
     <a name="The+Property+Set"></a>
     <h4><span lg_en="t_c12f7ff043a2440c9e083faaf1193619">The Property Set</span><span class="tscolor" lg_zh="t_c12f7ff043a2440c9e083faaf1193619"><span lg_kh="1">(</span>属性集<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_cb036052772c41b1b22f086e28919b18">The listener class tries to create a <span class="codefrag">PropertySet</span> from each stream using the <span class="codefrag">PropertySetFactory.create()</span> method:</span><span class="tscolor" lg_zh="t_cb036052772c41b1b22f086e28919b18"><span lg_kh="1">(</span>侦听器类尝试使用 PropertySetFactory.create() 方法从每个流创建一个 PropertySet：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">static class MyPOIFSReaderListener implements POIFSReaderListener</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void processPOIFSReaderEvent(POIFSReaderEvent event)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PropertySet ps = null;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ps = PropertySetFactory.create(event.getStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> catch (NoPropertySetStreamException ex)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out("No property set stream: \"" + event.getPath() +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> event.getName() + "\"");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> catch (Exception ex)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throw new RuntimeException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ("Property set stream \"" +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> event.getPath() + event.getName() + "\": " + ex);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Print the name of the property set stream: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out("Property set stream \"" + event.getPath() +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> event.getName() + "\":");</span>
      </div>
     </div>
     <p><span lg_en="t_d2a675abdf984b65a0e1bf9c5c51842c">Creating the <span class="codefrag">PropertySet</span> is done in a <span class="codefrag">try</span> block, because not each stream in the POI file system contains a property set. If it is some other file, the <span class="codefrag">PropertySetFactory.create()</span> throws a <span class="codefrag">NoPropertySetStreamException</span>, which is caught and logged. Then the program continues with the next stream. However, all other types of exceptions cause the program to terminate by throwing a runtime exception. If all went well, we can print the name of the property set stream.</span><span class="tscolor" lg_zh="t_d2a675abdf984b65a0e1bf9c5c51842c"><span lg_kh="1">(</span>创建 PropertySet 在 try 块中完成，因为不是 POI 文件系统中的每个流都包含一个属性集。如果是其他文件，PropertySetFactory.create() 会抛出 NoPropertySetStreamException，它会被捕获并记录下来。然后程序继续下一个流。但是，所有其他类型的异常都会通过引发运行时异常而导致程序终止。如果一切顺利，我们可以打印属性集流的名称。<span lg_kh="1">)</span></span></p>
     <a name="The+Sections"></a>
     <h4><span lg_en="t_f2d70d365f6e4dbbb0e4748c8134b3bf">The Sections</span><span class="tscolor" lg_zh="t_f2d70d365f6e4dbbb0e4748c8134b3bf"><span lg_kh="1">(</span>部分<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_bdcde3591aa94d94ab6a0b4052ab34dd">The next step is to print the number of sections followed by the sections themselves:</span><span class="tscolor" lg_zh="t_bdcde3591aa94d94ab6a0b4052ab34dd"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Print the number of sections: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final long sectionCount = ps.getSectionCount();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" No. of sections: " + sectionCount);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Print the list of sections: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">List sections = ps.getSections();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int nr = 0;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Iterator i = sections.iterator(); i.hasNext();)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Print a single section: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Section sec = (Section) i.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // See below for the complete loop body.</span>
      </div>
      <div class="codeline" lg_zh="t_1e45c6ed72854f6bb4c30a0c41fd700c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//有关完整的循环体，请参阅下文。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_5f967b9e618044a5891aaece7f362d89">The <span class="codefrag">PropertySet</span>'s method <span class="codefrag">getSectionCount()</span> returns the number of sections.</span><span class="tscolor" lg_zh="t_5f967b9e618044a5891aaece7f362d89"><span lg_kh="1">(</span>PropertySet 的方法 getSectionCount() 返回节数。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_71bae27ff4244710842e3cbc4c295cef">To retrieve the sections, use the <span class="codefrag">getSections()</span> method. This method returns a <span class="codefrag">java.util.List</span> containing instances of the <span class="codefrag">Section</span> class in their proper order.</span><span class="tscolor" lg_zh="t_71bae27ff4244710842e3cbc4c295cef"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4c3a2f629d5541e7941c5f668c8c8728">The sample code shows a loop that retrieves the <span class="codefrag">Section</span> objects one by one and prints some information about each one. Here is the complete body of the loop:</span><span class="tscolor" lg_zh="t_4c3a2f629d5541e7941c5f668c8c8728"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Print a single section: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Section sec = (Section) i.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" Section " + nr++ + ":");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String s = hex(sec.getFormatID().getBytes());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s = s.substring(0, s.length() - 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" Format ID: " + s);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Print the number of properties in this section. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int propertyCount = sec.getPropertyCount();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" No. of properties: " + propertyCount);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/* Print the properties: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Property[] properties = sec.getProperties();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i2 = 0; i2 &lt; properties.length; i2++)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Print a single property: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property p = properties[i2];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> int id = p.getID();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> long type = p.getType();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Object value = p.getValue();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out(" Property ID: " + id + ", type: " + type +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ", value: " + value);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <a name="The+Section%27s+Format+ID"></a>
     <h4><span lg_en="t_e6ae4c989c5146e1999677dcabc6895b">The Section's Format ID</span><span class="tscolor" lg_zh="t_e6ae4c989c5146e1999677dcabc6895b"><span lg_kh="1">(</span>节的格式 ID<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_409fabdf831c44b5baad73d3312314fc">The first method called on the <span class="codefrag">Section</span> instance is <span class="codefrag">getFormatID()</span>. As explained above, the format ID of the first section in a property set determines the type of the property set. Its type is <span class="codefrag">ClassID</span> which is essentially a sequence of 16 bytes. A real application using its own type of a custom property set should have defined a unique format ID and, when reading a property set stream, should check the format ID is equal to that unique format ID. The sample program just prints the format ID it finds in a section:</span><span class="tscolor" lg_zh="t_409fabdf831c44b5baad73d3312314fc"><span lg_kh="1">(</span>在 Section 实例上调用的第一个方法是 getFormatID()。如上所述，属性集中第一部分的格式 ID 决定了属性集的类型。它的类型是 ClassID，本质上是一个 16 字节的序列。使用自己的自定义属性集类型的实际应用程序应该定义唯一的格式 ID，并且在读取属性集流时，应该检查格式 ID 是否等于该唯一格式 ID。示例程序只打印它在一个部分中找到的格式 ID：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String s = hex(sec.getFormatID().getBytes());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s = s.substring(0, s.length() - 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" Format ID: " + s);</span>
      </div>
     </div>
     <p><span lg_en="t_582dc38c8dd14dfe90d323ead3c22100">As you can see, the <span class="codefrag">getFormatID()</span> method returns a <span class="codefrag">ClassID</span> object. An array containing the bytes can be retrieved with <span class="codefrag">ClassID.getBytes()</span>. In order to get a nicely formatted printout, the sample program uses the <span class="codefrag">hex()</span> helper method which in turn uses the POI utility class <span class="codefrag">HexDump</span> in the <span class="codefrag">org.apache.poi.util</span> package. Another helper method is <span class="codefrag">out()</span> which just saves typing <span class="codefrag">System.out.println()</span>.</span><span class="tscolor" lg_zh="t_582dc38c8dd14dfe90d323ead3c22100"><span lg_kh="1">(</span>如您所见，getFormatID() 方法返回一个 ClassID 对象。可以使用 ClassID.getBytes() 检索包含字节的数组。为了获得格式良好的打印输出，示例程序使用 hex() 辅助方法，该方法又使用 org.apache.poi.util 包中的 POI 实用程序类 HexDump。另一个辅助方法是 out()，它只保存输入 System.out.println()。<span lg_kh="1">)</span></span></p>
     <a name="The+Properties"></a>
     <h4><span lg_en="t_9441f7cd6d3c49deb7a09f3f496d1114">The Properties</span><span class="tscolor" lg_zh="t_9441f7cd6d3c49deb7a09f3f496d1114"><span lg_kh="1">(</span>属性<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_4bb26775cb804f8fbbe13143f4600085">Before getting the properties, it is possible to find out how many properties are available in the section via the <span class="codefrag">Section.getPropertyCount()</span>. The sample application uses this method to print the number of properties to the standard output:</span><span class="tscolor" lg_zh="t_4bb26775cb804f8fbbe13143f4600085"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int propertyCount = sec.getPropertyCount();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out(" No. of properties: " + propertyCount);</span>
      </div>
     </div>
     <p><span lg_en="t_adc6f6c020254ec3a7326657688436db">Now its time to get to the properties themselves. You can retrieve a section's properties with the method <span class="codefrag">Section.getProperties()</span>:</span><span class="tscolor" lg_zh="t_adc6f6c020254ec3a7326657688436db"><span lg_kh="1">(</span>现在是时候了解这些属性了。您可以使用 Section.getProperties() 方法检索节的属性：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Property[] properties = sec.getProperties();</span>
      </div>
     </div>
     <p><span lg_en="t_71118e347fb34d84a041eae1f9a5a53e">As you can see the result is an array of <span class="codefrag">Property</span> objects. This class has three methods to retrieve a property's ID, its type, and its value. The following code snippet shows how to call them:</span><span class="tscolor" lg_zh="t_71118e347fb34d84a041eae1f9a5a53e"><span lg_kh="1">(</span>如您所见，结果是一组 Property 对象。此类具有三种方法来检索属性的 ID、类型和值。以下代码片段显示了如何调用它们：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i2 = 0; i2 &lt; properties.length; i2++)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Print a single property: */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property p = properties[i2];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> int id = p.getID();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> long type = p.getType();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Object value = p.getValue();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out(" Property ID: " + id + ", type: " + type +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ", value: " + value);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <a name="Sample+Output"></a>
     <h4><span lg_en="t_fc8ca4d32e534566a16548b7a09876d7">Sample Output</span><span class="tscolor" lg_zh="t_fc8ca4d32e534566a16548b7a09876d7"><span lg_kh="1">(</span>样本输出<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_d22f0051412b4808ba0b354241447486">The output of the sample program might look like the following. It shows the summary information and the document summary information property sets of a Microsoft Word document. However, unlike the first and second section of this HOW-TO the application does not have any code which is specific to the <span class="codefrag">SummaryInformation</span> and <span class="codefrag">DocumentSummaryInformation</span> classes.</span><span class="tscolor" lg_zh="t_d22f0051412b4808ba0b354241447486"><span lg_kh="1">(</span>示例程序的输出可能如下所示。它显示 Microsoft Word 文档的摘要信息和文档摘要信息属性集。但是，与本 HOW-TO 的第一和第二部分不同，该应用程序没有任何特定于 SummaryInformation 和 DocumentSummaryInformation 类的代码。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Property set stream "/SummaryInformation":</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> No. of sections: 1</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Section 0:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Format ID: 00000000 F2 9F 85 E0 4F F9 10 68 AB 91 08 00 2B 27 B3 D9 ....O..h....+'..</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> No. of properties: 17</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 1, type: 2, value: 1252</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 2, type: 30, value: Titel</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 3, type: 30, value: Thema</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 4, type: 30, value: Rainer Klute (Autor)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 5, type: 30, value: Test (Stichwörter)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 6, type: 30, value: This is a document for testing HPSF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 7, type: 30, value: Normal.dot</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 8, type: 30, value: Unknown User</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 9, type: 30, value: 3</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 18, type: 30, value: Microsoft Word 9.0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 12, type: 64, value: Mon Jan 01 00:59:25 CET 1601</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 13, type: 64, value: Thu Jul 18 16:22:00 CEST 2002</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 14, type: 3, value: 1</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 15, type: 3, value: 20</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 16, type: 3, value: 93</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 19, type: 3, value: 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 17, type: 71, value: [B@13582d</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Property set stream "/DocumentSummaryInformation":</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> No. of sections: 2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Section 0:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Format ID: 00000000 D5 CD D5 02 2E 9C 10 1B 93 97 08 00 2B 2C F9 AE ............+,..</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> No. of properties: 14</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 1, type: 2, value: 1252</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 2, type: 30, value: Test</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 14, type: 30, value: Rainer Klute (Manager)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 15, type: 30, value: Rainer Klute IT-Consulting GmbH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 5, type: 3, value: 3</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 6, type: 3, value: 2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 17, type: 3, value: 111</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 23, type: 3, value: 592636</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 11, type: 11, value: false</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 16, type: 11, value: false</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 19, type: 11, value: false</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 22, type: 11, value: false</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 13, type: 4126, value: [B@56a499</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 12, type: 4108, value: [B@506411</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Section 1:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Format ID: 00000000 D5 CD D5 05 2E 9C 10 1B 93 97 08 00 2B 2C F9 AE ............+,..</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> No. of properties: 7</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 0, type: 0, value: {6=Test-JaNein, 5=Test-Zahl, 4=Test-Datum, 3=Test-Text, 2=_PID_LINKBASE}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 1, type: 2, value: 1252</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 2, type: 65, value: [B@c9ba38</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 3, type: 30, value: This is some text.</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 4, type: 64, value: Wed Jul 17 00:00:00 CEST 2002</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 5, type: 3, value: 27</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Property ID: 6, type: 11, value: true</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">No property set stream: "/WordDocument"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">No property set stream: "/CompObj"</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">No property set stream: "/1Table"</span>
      </div>
     </div>
     <p><span lg_en="t_a0d354c8fc3d4fbc8f3c93de70a54555">There are some interesting items to note:</span><span class="tscolor" lg_zh="t_a0d354c8fc3d4fbc8f3c93de70a54555"><span lg_kh="1">(</span>有一些有趣的项目需要注意：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_7c5d3e1966f84e8bb6d34a3e22ab8aee">The first property set (summary information) consists of a single section, the second property set (document summary information) consists of two sections.</span><span class="tscolor" lg_zh="t_7c5d3e1966f84e8bb6d34a3e22ab8aee"><span lg_kh="1">(</span>第一个属性集（摘要信息）由一个部分组成，第二个属性集（文档摘要信息）由两个部分组成。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_5edb36e6a352470a9189b6ee6ae85c8f">Each section type (identified by its format ID) has its own domain of property ID. For example, in the second property set the properties with ID 2 have different meanings in the two section. By the way, the format IDs of these sections are <strong>not</strong> equal, but you have to look hard to find the difference.</span><span class="tscolor" lg_zh="t_5edb36e6a352470a9189b6ee6ae85c8f"><span lg_kh="1">(</span>每个部分类型（由其格式 ID 标识）都有自己的属性 ID 域。例如，在第二个属性集中，ID 为 2 的属性在这两个部分中具有不同的含义。顺便说一句，这些部分的格式 ID 是不相等的，但您必须努力寻找差异。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e9f5fd53853141f2bc88956974ea1010">The properties are not in any particular order in the section, although they slightly tend to be sorted by their IDs.</span><span class="tscolor" lg_zh="t_e9f5fd53853141f2bc88956974ea1010"><span lg_kh="1">(</span>这些属性在该部分中没有任何特定的顺序，尽管它们稍微倾向于按其 ID 排序。<span lg_kh="1">)</span></span></li>
     </ul>
     <a name="Property+IDs"></a>
     <h4><span lg_en="t_7633a47bb77946da9f34ef294b019d1c">Property IDs</span><span class="tscolor" lg_zh="t_7633a47bb77946da9f34ef294b019d1c"><span lg_kh="1">(</span>属性 ID<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_5ac553322ce54cefae634cba38e3527a">Properties in the same section are distinguished by their IDs. This is similar to variables in a programming language like Java, which are distinguished by their names. But unlike variable names, property IDs are simple integral numbers. There is another similarity, however. Just like a Java variable has a certain scope (e.g. a member variables in a class), a property ID also has its scope of validity: the section.</span><span class="tscolor" lg_zh="t_5ac553322ce54cefae634cba38e3527a"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_14e79f7f50b7495a87d8578943bc64cf">Two property IDs in sections with different section format IDs don't have the same meaning even though their IDs might be equal. For example, ID 4 in the first (and only) section of a summary information property set denotes the document's author, while ID 4 in the first section of the document summary information property set means the document's byte count. The sample output above does not show a property with an ID of 4 in the first section of the document summary information property set. That means that the document does not have a byte count. However, there is a property with an ID of 4 in the <em>second</em> section: This is a user-defined property ID - we'll get to that topic in a minute.</span><span class="tscolor" lg_zh="t_14e79f7f50b7495a87d8578943bc64cf"><span lg_kh="1">(</span>具有不同部分格式 ID 的部分中的两个属性 ID 具有不同的含义，即使它们的 ID 可能相同。例如，摘要信息属性集的第一（也是唯一）部分中的 ID 4 表示文档的作者，而文档摘要信息属性集的第一部分中的 ID 4 表示文档的字节数。上面的示例输出未在文档摘要信息属性集的第一部分显示 ID 为 4 的属性。这意味着该文档没有字节数。但是，在第二部分中有一个 ID 为 4 的属性：这是用户定义的属性 ID - 我们将在稍后讨论该主题。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_edd933388b6e47a5a7ae72f6b6915e9b">So, how can you find out what the meaning of a certain property ID in the summary information and the document summary information property set is? The standard property sets as such don't have any hints about the <strong>meanings of their property IDs</strong>. For example, the summary information property set does not tell you that the property ID 4 stands for the document's author. This is external knowledge. Microsoft defined standard meanings for some of the property IDs in the summary information and the document summary information property sets. As a help to the Java and POI programmer, the class <span class="codefrag">PropertyIDMap</span> in the <span class="codefrag">org.apache.poi.hpsf.wellknown</span> package defines constants for the "well-known" property IDs. For example, there is the definition</span><span class="tscolor" lg_zh="t_edd933388b6e47a5a7ae72f6b6915e9b"><span lg_kh="1">(</span>那么，如何找出摘要信息和文档摘要信息属性集中的某个属性ID的含义是什么？这样的标准属性集没有任何关于其属性 ID 含义的提示。例如，摘要信息属性集不会告诉您属性 ID 4 代表文档的作者。这是外在的知识。 Microsoft 为摘要信息和文档摘要信息属性集中的某些属性 ID 定义了标准含义。作为对 Java 和 POI 程序员的帮助，org.apache.poi.hpsf.wellknown 包中的类 PropertyIDMap 定义了“知名”属性 ID 的常量。例如，有定义<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public final static int PID_AUTHOR = 4;</span>
      </div>
     </div>
     <p><span lg_en="t_8b5b7de817c94024bf70f774b850a2ba">These definitions allow you to use symbolic names instead of numbers.</span><span class="tscolor" lg_zh="t_8b5b7de817c94024bf70f774b850a2ba"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7b15019842fe4512824e7dc1b37e6305">In order to provide support for the other way, too, - i.e. to map property IDs to property names - the class <span class="codefrag">PropertyIDMap</span> defines two static methods: <span class="codefrag">getSummaryInformationProperties()</span> and <span class="codefrag">getDocumentSummaryInformationProperties()</span>. Both return <span class="codefrag">java.util.Map</span> objects which map property IDs to strings. Such a string gives a hint about the property's meaning. For example, <span class="codefrag">PropertyIDMap.getSummaryInformationProperties().get(4)</span> returns the string "PID_AUTHOR". An application could use this string as a key to a localized string which is displayed to the user, e.g. "Author" in English or "Verfasser" in German. HPSF might provide such language-dependent ("localized") mappings in a later release.</span><span class="tscolor" lg_zh="t_7b15019842fe4512824e7dc1b37e6305"><span lg_kh="1">(</span>为了也支持另一种方式，即将属性 ID 映射到属性名称，PropertyIDMap 类定义了两个静态方法：getSummaryInformationProperties() 和 getDocumentSummaryInformationProperties()。两者都返回将属性 ID 映射到字符串的 java.util.Map 对象。这样的字符串给出了关于属性含义的提示。例如，PropertyIDMap.getSummaryInformationProperties().get(4) 返回字符串“PID_AUTHOR”。应用程序可以将此字符串用作显示给用户的本地化字符串的键，例如英语中的“Author”或德语中的“Verfasser”。 HPSF 可能会在以后的版本中提供这种与语言相关的（“本地化”）映射。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_510d52446e5d4bc3a98f1b7a43776e91">Usually you won't have to deal with those two maps. Instead you should call the <span class="codefrag">Section.getPIDString(int)</span> method. It returns the string associated with the specified property ID in the context of the <span class="codefrag">Section</span> object.</span><span class="tscolor" lg_zh="t_510d52446e5d4bc3a98f1b7a43776e91"><span lg_kh="1">(</span>通常您不必处理这两个地图。相反，您应该调用 Section.getPIDString(int) 方法。它返回与 Section 对象上下文中的指定属性 ID 关联的字符串。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e50d563e402f4cecabd679c725aaf285">Above you learned that property IDs have a meaning in the scope of a section only. However, there are two exceptions to the rule: The property IDs 0 and 1 have a fixed meaning in <strong>all</strong> sections:</span><span class="tscolor" lg_zh="t_e50d563e402f4cecabd679c725aaf285"><span lg_kh="1">(</span>上面您了解到，属性 ID 仅在部分范围内有意义。但是，该规则有两个例外： 属性 ID 0 和 1 在所有部分中具有固定含义：<span lg_kh="1">)</span></span></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1"><span lg_en="t_367308b1779d469183b4b3fb8620cee6">Property ID</span><span class="tscolor" lg_zh="t_367308b1779d469183b4b3fb8620cee6"><span lg_kh="1">(</span>物业编号<span lg_kh="1">)</span></span></th>
        <th colspan="1" rowspan="1"><span lg_en="t_d23beccdcc2e4bd98720626f221af982">Meaning</span><span class="tscolor" lg_zh="t_d23beccdcc2e4bd98720626f221af982"><span lg_kh="1">(</span>意义<span lg_kh="1">)</span></span></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_e1de1edbf4094065b41d386e6ef7744e">0</span><span class="tscolor" lg_zh="t_e1de1edbf4094065b41d386e6ef7744e"><span lg_kh="1">(</span>0<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_61f7efdd7edf43bd8997ff094be51d62">The property's value is a <strong>dictionary</strong>, i.e. a mapping from property IDs to strings.</span><span class="tscolor" lg_zh="t_61f7efdd7edf43bd8997ff094be51d62"><span lg_kh="1">(</span>属性的值是一个字典，即从属性 ID 到字符串的映射。<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_c3ece5b952204202a414da5f48c2a3e8">1</span><span class="tscolor" lg_zh="t_c3ece5b952204202a414da5f48c2a3e8"><span lg_kh="1">(</span>1<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_7009683fd9884c8196254021bbc04cd7">The property's value is the number of a <strong>codepage</strong>, i.e. a mapping from character codes to characters. All strings in the section containing this property must be interpreted using this codepage. Typical property values are 1252 (8-bit "western" characters, ISO-8859-1), 1200 (16-bit Unicode characters, UFT-16), or 65001 (8-bit Unicode characters, UFT-8).</span><span class="tscolor" lg_zh="t_7009683fd9884c8196254021bbc04cd7"><span lg_kh="1">(</span>该属性的值是代码页的编号，即从字符代码到字符的映射。包含此属性的部分中的所有字符串都必须使用此代码页进行解释。典型的属性值为 1252（8 位“西方”字符，ISO-8859-1）、1200（16 位 Unicode 字符，UFT-16）或 65001（8 位 Unicode 字符，UFT-8）。<span lg_kh="1">)</span></span></td>
       </tr>
      </tbody>
     </table>
     <a name="Property+types"></a>
     <h4><span lg_en="t_3d70e62459f649cdaa8ca02982cbdfdf">Property types</span><span class="tscolor" lg_zh="t_3d70e62459f649cdaa8ca02982cbdfdf"><span lg_kh="1">(</span>属性类型<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_6e56f30434aa4c7c93c8f46a0d74b411">A property is nothing without its value. It is stored in a property set stream as a sequence of bytes. You must know the property's <strong>type</strong> in order to properly interpret those bytes and reasonably handle the value. A property's type is one of the so-called Microsoft-defined <strong>"variant types"</strong>. When you call <span class="codefrag">Property.getType()</span> you'll get a <span class="codefrag">long</span> value which denoting the property's variant type. The class <span class="codefrag">Variant</span> in the <span class="codefrag">org.apache.poi.hpsf</span> package holds most of those <span class="codefrag">long</span> values as named constants. For example, the constant <span class="codefrag">VT_I4 = 3</span> means a signed integer value of four bytes. Examples of other types are <span class="codefrag">VT_LPSTR = 30</span> meaning a null-terminated string of 8-bit characters, <span class="codefrag">VT_LPWSTR = 31</span> which means a null-terminated Unicode string, or <span class="codefrag">VT_BOOL = 11</span> denoting a boolean value.</span><span class="tscolor" lg_zh="t_6e56f30434aa4c7c93c8f46a0d74b411"><span lg_kh="1">(</span>没有价值的财产什么也不是。它作为字节序列存储在属性集流中。您必须知道属性的类型才能正确解释这些字节并合理处理该值。属性的类型是所谓的 Microsoft 定义的“变体类型”之一。当您调用 Property.getType() 时，您将获得一个表示属性变体类型的长值。 org.apache.poi.hpsf 包中的 Variant 类将这些长值中的大部分保存为命名常量。例如，常数 VT_I4 = 3 表示四个字节的有符号整数值。其他类型的示例有 VT_LPSTR = 30 表示以空字符结尾的 8 位字符字符串，VT_LPWSTR = 31 表示以空字符结尾的 Unicode 字符串，或 VT_BOOL = 11 表示布尔值。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_00f64fcc97a1404f9c3a19ba5f17e1aa">In most cases you won't need a property's type because HPSF does all the work for you.</span><span class="tscolor" lg_zh="t_00f64fcc97a1404f9c3a19ba5f17e1aa"><span lg_kh="1">(</span>在大多数情况下，您不需要属性类型，因为 HPSF 会为您完成所有工作。<span lg_kh="1">)</span></span></p>
     <a name="Property+values"></a>
     <h4><span lg_en="t_9c771d240cd14e5194c5173e2b4916a4">Property values</span><span class="tscolor" lg_zh="t_9c771d240cd14e5194c5173e2b4916a4"><span lg_kh="1">(</span>属性值<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_8f872e63ebb24265a523cfbdce946e95">When an application wants to retrieve a property's value and calls <span class="codefrag">Property.getValue()</span>, HPSF has to interpret the bytes making out the value according to the property's type. The type determines how many bytes the value consists of and what to do with them. For example, if the type is <span class="codefrag">VT_I4</span>, HPSF knows that the value is four bytes long and that these bytes comprise a signed integer value in the little-endian format. This is quite different from e.g. a type of <span class="codefrag">VT_LPWSTR</span>. In this case HPSF has to scan the value bytes for a Unicode null character and collect everything from the beginning to that null character as a Unicode string.</span><span class="tscolor" lg_zh="t_8f872e63ebb24265a523cfbdce946e95"><span lg_kh="1">(</span>当应用程序想要检索属性的值并调用 Property.getValue() 时，HPSF 必须根据属性的类型解释生成值的字节。类型决定了值包含多少字节以及如何处理它们。例如，如果类型是 VT_I4，HPSF 知道该值是四个字节长，并且这些字节包含小端格式的有符号整数值。这与例如一种类型的 VT_LPWSTR 完全不同。在这种情况下，HPSF 必须扫描值字节以查找 Unicode 空字符，并将从开头到该空字符的所有内容收集为 Unicode 字符串。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d7758f42df87472f89e6279be8c17125">The good new is that HPSF does another job for you, too: It maps the variant type to an adequate Java type.</span><span class="tscolor" lg_zh="t_d7758f42df87472f89e6279be8c17125"><span lg_kh="1">(</span>好消息是 HPSF 还为您完成了另一项工作：它将变体类型映射到适当的 Java 类型。<span lg_kh="1">)</span></span></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1"><span lg_en="t_525b5d86b7f3440fa2b3d21f0681172c">Variant type:</span><span class="tscolor" lg_zh="t_525b5d86b7f3440fa2b3d21f0681172c"><span lg_kh="1">(</span>变体类型：<span lg_kh="1">)</span></span></th>
        <th colspan="1" rowspan="1"><span lg_en="t_ea8539b67c0b498eae996dff88511392">Java type:</span><span class="tscolor" lg_zh="t_ea8539b67c0b498eae996dff88511392"><span lg_kh="1">(</span>Java类型：<span lg_kh="1">)</span></span></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_3e14cfd272e646cbac809909a3e1bef6">VT_I2</span><span class="tscolor" lg_zh="t_3e14cfd272e646cbac809909a3e1bef6"><span lg_kh="1">(</span>VT_I2<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_1b158967b6404f4fbbf8d07d52b2279a">java.lang.Integer</span><span class="tscolor" lg_zh="t_1b158967b6404f4fbbf8d07d52b2279a"><span lg_kh="1">(</span>java.lang.Integer<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_c45aa498e3094da48dc27755c063532f">VT_I4</span><span class="tscolor" lg_zh="t_c45aa498e3094da48dc27755c063532f"><span lg_kh="1">(</span>VT_I4<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_a9fff324c7fc4e48b5adacb3995e6c0d">java.lang.Long</span><span class="tscolor" lg_zh="t_a9fff324c7fc4e48b5adacb3995e6c0d"><span lg_kh="1">(</span>java.lang.Long<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_622eb842c4ab46e29e8c1304654f6a22">VT_FILETIME</span><span class="tscolor" lg_zh="t_622eb842c4ab46e29e8c1304654f6a22"><span lg_kh="1">(</span>VT_FILETIME<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_60c5e9be489c45f8ad1573f9b5cf278b">java.util.Date</span><span class="tscolor" lg_zh="t_60c5e9be489c45f8ad1573f9b5cf278b"><span lg_kh="1">(</span>java.util.日期<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_54ac85170a354b8fb708b1773a1315a0">VT_LPSTR</span><span class="tscolor" lg_zh="t_54ac85170a354b8fb708b1773a1315a0"><span lg_kh="1">(</span>VT_LPSTR<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_f9ab29418baf4904a5b5c55d0b48627b">java.lang.String</span><span class="tscolor" lg_zh="t_f9ab29418baf4904a5b5c55d0b48627b"><span lg_kh="1">(</span>java.lang.String<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_b7d8c688e48e4c128793ab1dd189225b">VT_LPWSTR</span><span class="tscolor" lg_zh="t_b7d8c688e48e4c128793ab1dd189225b"><span lg_kh="1">(</span>VT_LPWSTR<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_a4c1c68074fa49f89be1d38ab487f568">java.lang.String</span><span class="tscolor" lg_zh="t_a4c1c68074fa49f89be1d38ab487f568"><span lg_kh="1">(</span>java.lang.String<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_e924ef9bdf574bcc98e484613bd17f31">VT_CF</span><span class="tscolor" lg_zh="t_e924ef9bdf574bcc98e484613bd17f31"><span lg_kh="1">(</span>VT_CF<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_1161aee547c246ecaa9943912f76df40">byte[]</span><span class="tscolor" lg_zh="t_1161aee547c246ecaa9943912f76df40"><span lg_kh="1">(</span>字节[]<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_1d885da131574df6be7f921f8e668d2e">VT_BOOL</span><span class="tscolor" lg_zh="t_1d885da131574df6be7f921f8e668d2e"><span lg_kh="1">(</span>VT_BOOL<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_625d812ee6014964a2d3baa174fcc01e">java.lang.Boolean</span><span class="tscolor" lg_zh="t_625d812ee6014964a2d3baa174fcc01e"><span lg_kh="1">(</span>java.lang.Boolean<span lg_kh="1">)</span></span></td>
       </tr>
      </tbody>
     </table>
     <p><span lg_en="t_4a5b2cf1a5174d88b240cc47b02402bf">The bad news is that there are still a couple of variant types HPSF does not yet support. If it encounters one of these types it returns the property's value as a byte array and leaves it to be interpreted by the application.</span><span class="tscolor" lg_zh="t_4a5b2cf1a5174d88b240cc47b02402bf"><span lg_kh="1">(</span>坏消息是仍然有几个变体类型 HPSF 还不支持。如果遇到其中一种类型，它会将属性的值作为字节数组返回，并让应用程序对其进行解释。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9730ffd0f0d049e49294e695852462a7">An application retrieves a property's value by calling the <span class="codefrag">Property.getValue()</span> method. This method's return type is the abstract <span class="codefrag">Object</span> class. The <span class="codefrag">getValue()</span> method looks up the property's variant type, reads the property's value bytes, creates an instance of an adequate Java type, assigns it the property's value and returns it. Primitive types like <span class="codefrag">int</span> or <span class="codefrag">long</span> will be returned as the corresponding class, e.g. <span class="codefrag">Integer</span> or <span class="codefrag">Long</span>.</span><span class="tscolor" lg_zh="t_9730ffd0f0d049e49294e695852462a7"><span lg_kh="1">(</span>应用程序通过调用 Property.getValue() 方法来检索属性的值。此方法的返回类型是抽象 Object 类。 getValue() 方法查找属性的变体类型，读取属性的值字节，创建适当 Java 类型的实例，为其分配属性值并返回它。 int 或 long 等原始类型将作为相应的类返回，例如 Integer 或 Long。<span lg_kh="1">)</span></span></p>
     <a name="Dictionaries"></a>
     <h4><span lg_en="t_fcbd9a5fccd74940823038dfcd8a1d44">Dictionaries</span><span class="tscolor" lg_zh="t_fcbd9a5fccd74940823038dfcd8a1d44"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_95b467762ce5437dad01e63369e6407e">The property with ID 0 has a very special meaning: It is a <strong>dictionary</strong> mapping property IDs to property names. We have seen already that the meanings of standard properties in the summary information and the document summary information property sets have been defined by Microsoft. The advantage is that the labels of properties like "Author" or "Title" don't have to be stored in the property set. However, a user can define custom fields in, say, Microsoft Word. For each field the user has to specify a name, a type, and a value.</span><span class="tscolor" lg_zh="t_95b467762ce5437dad01e63369e6407e"><span lg_kh="1">(</span>ID 为 0 的属性有一个非常特殊的含义：它是一个将属性 ID 映射到属性名称的字典。我们已经看到，微软已经定义了摘要信息和文档摘要信息属性集中标准属性的含义。优点是“作者”或“标题”等属性的标签不必存储在属性集中。但是，用户可以在 Microsoft Word 中定义自定义字段。对于每个字段，用户必须指定名称、类型和值。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a3f0d093435e459fa2c780cf41a4e459">The names of the custom-defined fields (i.e. the property names) are stored in the document summary information second section's <strong>dictionary</strong>. The dictionary is a map which associates property IDs with property names.</span><span class="tscolor" lg_zh="t_a3f0d093435e459fa2c780cf41a4e459"><span lg_kh="1">(</span>自定义字段的名称（即属性名称）存储在文档摘要信息第二部分的字典中。字典是将属性 ID 与属性名称相关联的映射。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_381ba737e3144b0ca5fc49b486ada438">The method <span class="codefrag">Section.getPIDString(int)</span> not only returns with the well-known property names of the summary information and document summary information property sets, but with self-defined properties, too. It should also work with self-defined properties in self-defined sections.</span><span class="tscolor" lg_zh="t_381ba737e3144b0ca5fc49b486ada438"><span lg_kh="1">(</span>Section.getPIDString(int) 方法不仅返回摘要信息和文档摘要信息属性集的众所周知的属性名称，而且还返回自定义属性。它还应该与自定义部分中的自定义属性一起使用。<span lg_kh="1">)</span></span></p>
     <a name="Codepage+support"></a>
     <h4><span lg_en="t_85ff37414ef44679a50e37abc3ca816e">Codepage support</span><span class="tscolor" lg_zh="t_85ff37414ef44679a50e37abc3ca816e"><span lg_kh="1">(</span>代码页支持<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_f60efcec649048e2b52578bdca73d521">The property with ID 1 holds the number of the codepage which was used to encode the strings in this section. If this property is not available in a section, the platform's default character encoding will be used. This works fine as long as the document being read has been written on a platform with the same default character encoding. However, if you receive a document from another region of the world and the codepage is undefined, you are in trouble.</span><span class="tscolor" lg_zh="t_f60efcec649048e2b52578bdca73d521"><span lg_kh="1">(</span>ID 为 1 的属性保存用于对本节中的字符串进行编码的代码页编号。如果该属性在某个部分中不可用，则将使用平台的默认字符编码。只要正在读取的文档是在具有相同默认字符编码的平台上编写的，这就可以正常工作。但是，如果您收到来自世界其他地区的文档并且代码页未定义，那么您就有麻烦了。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a1354764e81345a19621f873e03ce67f">HPSF's codepage support is only as good as the character encoding support of the Java Virtual Machine (JVM) the application runs on. If HPSF encounters a codepage number it assumes that the JVM has a character encoding with a corresponding name. For example, if the codepage is 1252, HPSF uses the character encoding "cp1252" to read or write strings. If the JVM does not have that character encoding installed or if the codepage number is illegal, an UnsupportedEncodingException will be thrown. This works quite well with Java 2 Standard Edition (J2SE) versions since 1.4. However, under J2SE 1.3 or lower you are out of luck. You should install a newer J2SE version to process codepages with HPSF.</span><span class="tscolor" lg_zh="t_a1354764e81345a19621f873e03ce67f"><span lg_kh="1">(</span>HPSF 的代码页支持仅与运行应用程序的 Java 虚拟机 (JVM) 的字符编码支持一样好。如果 HPSF 遇到代码页编号，则假定 JVM 具有具有相应名称的字符编码。例如，如果代码页是 1252，HPSF 使用字符编码“cp1252”来读取或写入字符串。如果 JVM 没有安装该字符编码或者代码页号非法，则会抛出 UnsupportedEncodingException。这与自 1.4 以来的 Java 2 标准版 (J2SE) 版本配合得非常好。但是，在 J2SE 1.3 或更低版本下，您就不走运了。您应该安装更新的 J2SE 版本来使用 HPSF 处理代码页。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_cd4b2afd17af46239f60ffba6c53ce0b">There are some exceptions to the rule saying that a character encoding's name is derived from the codepage number by prepending the string "cp" to it. In these cases the codepage number is mapped to a well-known character encoding name. Here are a few examples:</span><span class="tscolor" lg_zh="t_cd4b2afd17af46239f60ffba6c53ce0b"><span lg_kh="1">(</span>该规则有一些例外情况，即字符编码的名称是通过在代码页号前面加上字符串“cp”来派生的。在这些情况下，代码页编号映射到众所周知的字符编码名称。这里有一些例子：<span lg_kh="1">)</span></span></p>
     <dl>
      <dt>Codepage 932</dt>
      <dd>is mapped to the character encoding "SJIS".</dd>
      <dt>Codepage 1200</dt>
      <dd>is mapped to the character encoding "UTF-16".</dd>
      <dt>Codepage 65001</dt>
      <dd>is mapped to the character encoding "UTF-8".</dd>
     </dl>
     <p><span lg_en="t_74c0f9d2ca26441c81956cc9083f5506">More of these mappings between codepage and character encoding name are hard-coded in the classes <span class="codefrag">org.apache.poi.hpsf.Constants</span> and <span class="codefrag">org.apache.poi.hpsf.VariantSupport</span>. Probably there will be a need to add more mappings. The HPSF author will appreciate any hints.</span><span class="tscolor" lg_zh="t_74c0f9d2ca26441c81956cc9083f5506"><span lg_kh="1">(</span>代码页和字符编码名称之间的更多映射在类 org.apache.poi.hpsf.Constants 和 org.apache.poi.hpsf.VariantSupport 中进行了硬编码。可能需要添加更多映射。 HPSF 作者将不胜感激任何提示。<span lg_kh="1">)</span></span></p>
     <a name="sec5" id="sec5"></a><a name="Writing+Properties"></a>
     <h3 class="boxed"><span lg_en="t_617aa5e986c6425da57c5ba4990c8ec8">Writing Properties</span><span class="tscolor" lg_zh="t_617aa5e986c6425da57c5ba4990c8ec8"><span lg_kh="1">(</span>编写属性<span lg_kh="1">)</span></span></h3>
     <div class="note">
      <div class="label">
       <span lg_en="t_424ac43890144d209756e531efc3bbc9">Note</span><span class="tscolor" lg_zh="t_424ac43890144d209756e531efc3bbc9"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_7323b3572ff24d7d8f866449eceed214">This section describes how to write properties.</span><span class="tscolor" lg_zh="t_7323b3572ff24d7d8f866449eceed214"><span lg_kh="1">(</span>本节介绍如何编写属性。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <a name="Overview+of+Writing+Properties"></a>
     <h4><span lg_en="t_2f4687c1011540328d030c9a42fbb856">Overview of Writing Properties</span><span class="tscolor" lg_zh="t_2f4687c1011540328d030c9a42fbb856"><span lg_kh="1">(</span>编写属性概述<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_7c34672c38184ad297a1752999be7615">Writing properties is possible at a high level and at a low level:</span><span class="tscolor" lg_zh="t_7c34672c38184ad297a1752999be7615"><span lg_kh="1">(</span>在高级和低级写入属性是可能的：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_9cc9aac49e4a41ff9cee5643efc02d1c">Most users will want to create or change entries in the summary information or document summary information streams.</span><span class="tscolor" lg_zh="t_9cc9aac49e4a41ff9cee5643efc02d1c"><span lg_kh="1">(</span>大多数用户都希望在摘要信息或文档摘要信息流中创建或更改条目。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_862d5659969b4980a84f94efb6786572">On the low level, there are no convenience classes or methods. You have to deal with things like property IDs and variant types to write properties. Therefore you should have read <a href="#sec3">section 3</a> to understand the description of the low-level writing functions.</span><span class="tscolor" lg_zh="t_862d5659969b4980a84f94efb6786572"><span lg_kh="1">(</span>在底层，没有便利类或方法。您必须处理诸如属性 ID 和变体类型之类的事情来编写属性。因此，您应该阅读第 3 节以了解低级写入函数的描述。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_7244ddcccc544092ad4ad6246586c664">HPSF's writing capabilities come with the classes <span class="codefrag">PropertySet</span>, <span class="codefrag">Section</span>, <span class="codefrag">Property</span>, and some helper classes.</span><span class="tscolor" lg_zh="t_7244ddcccc544092ad4ad6246586c664"><span lg_kh="1">(</span>HPSF 的编写功能包括 PropertySet、Section、Property 类和一些辅助类。<span lg_kh="1">)</span></span></p>
     <a name="Low-Level+Writing%3A+An+Overview"></a>
     <h4><span lg_en="t_aee4603462e740bc9e8a7294c719b015">Low-Level Writing: An Overview</span><span class="tscolor" lg_zh="t_aee4603462e740bc9e8a7294c719b015"><span lg_kh="1">(</span><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_b9ff5f73ade646b687b6c0f5fc99bb90">When you are going to write a property set stream your application has to perform the following steps:</span><span class="tscolor" lg_zh="t_b9ff5f73ade646b687b6c0f5fc99bb90"><span lg_kh="1">(</span>当您要编写属性集流时，您的应用程序必须执行以下步骤：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_323b8261bd25486a8a400dec2a235311">Create a <span class="codefrag">PropertySet</span> instance.</span><span class="tscolor" lg_zh="t_323b8261bd25486a8a400dec2a235311"><span lg_kh="1">(</span>创建一个 PropertySet 实例。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_c2efa9309c7148e4ac722e413af0ffda">Get hold of a <span class="codefrag">Section</span>. You can either retrieve the one that is always present in a new <span class="codefrag">PropertySet</span>, or you have to create a new <span class="codefrag">Section</span> and add it to the <span class="codefrag">PropertySet</span>.</span><span class="tscolor" lg_zh="t_c2efa9309c7148e4ac722e413af0ffda"><span lg_kh="1">(</span>抓住一个部分。您可以检索始终存在于新 PropertySet 中的部分，或者您必须创建一个新部分并将其添加到 PropertySet。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a153894d231347c7a6ce11d9b614341a">Set any <span class="codefrag">Section</span> fields as you like.</span><span class="tscolor" lg_zh="t_a153894d231347c7a6ce11d9b614341a"><span lg_kh="1">(</span>根据需要设置任何部分字段。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9901a084f4b0433088fcc56a8f0dc068">Create as many <span class="codefrag">Property</span> objects as you need. Set each property's ID, type, and value. Add the <span class="codefrag">Property</span> objects to the <span class="codefrag">Section</span>.</span><span class="tscolor" lg_zh="t_9901a084f4b0433088fcc56a8f0dc068"><span lg_kh="1">(</span>根据需要创建尽可能多的 Property 对象。设置每个属性的 ID、类型和值。将 Property 对象添加到 Section。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a8f1c69df67c4272ae7bfcc1b7a5fdf7">Create further <span class="codefrag">Section</span>s if you need them.</span><span class="tscolor" lg_zh="t_a8f1c69df67c4272ae7bfcc1b7a5fdf7"><span lg_kh="1">(</span>如果需要，请创建更多部分。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_c606bfae7a39485d8e287fc8805a7f5d">Eventually retrieve the property set as a byte stream using <span class="codefrag">PropertySet.toInputStream()</span> and write it to a POIFS document.</span><span class="tscolor" lg_zh="t_c606bfae7a39485d8e287fc8805a7f5d"><span lg_kh="1">(</span>最终使用 PropertySet.toInputStream() 将属性集检索为字节流并将其写入 POIFS 文档。<span lg_kh="1">)</span></span></li>
     </ol>
     <a name="Low-level+Writing+Functions+In+Details"></a>
     <h4><span lg_en="t_189255b95d324f2b9a6ad577cbb2ef98">Low-level Writing Functions In Details</span><span class="tscolor" lg_zh="t_189255b95d324f2b9a6ad577cbb2ef98"><span lg_kh="1">(</span>低级写函数详解<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_112e26c287014ffea460c93a84b4431a">Writing properties is introduced by an artificial but simple example: a program creating a new document (aka POI file system) which contains only a single document: a summary information property set stream. The latter will hold the document's title only. This is artificial in that it does not contain any Word, Excel or other kind of useful application document data. A document containing just a property set is without any practical use. However, it is perfectly fine for an example because it make it very simple and easy to understand, and you will get used to writing properties in real applications quickly.</span><span class="tscolor" lg_zh="t_112e26c287014ffea460c93a84b4431a"><span lg_kh="1">(</span>编写属性由一个人工但简单的示例介绍：一个程序创建一个仅包含单个文档的新文档（又名 POI 文件系统）：摘要信息属性集流。后者将仅保留文档的标题。这是人为的，因为它不包含任何 Word、Excel 或其他类型的有用应用程序文档数据。仅包含属性集的文档没有任何实际用途。然而，作为一个例子就很好了，因为它非常简单易懂，而且你很快就会习惯在实际应用程序中编写属性。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ada0ef413a784c858a2fb5aa75482c43">The application expects the name of the POI file system to be written on the command line. The title property it writes is "Sample title".</span><span class="tscolor" lg_zh="t_ada0ef413a784c858a2fb5aa75482c43"><span lg_kh="1">(</span>应用程序希望将 POI 文件系统的名称写入命令行。它写入的标题属性是“示例标题”。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_6978b96b5f934f0cb9adaff38880f145">Here's the application's source code. You can also find it in the "examples" section of the POI source code distribution. Explanations are following below.</span><span class="tscolor" lg_zh="t_6978b96b5f934f0cb9adaff38880f145"><span lg_kh="1">(</span>这是应用程序的源代码。您还可以在 POI 源代码分发的“示例”部分找到它。说明如下。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">package org.apache.poi.hpsf.examples;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.FileOutputStream;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.IOException;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.InputStream;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.Property;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.PropertySet;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.Section;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.Section;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.SummaryInformation;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.Variant;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.WritingNotSupportedException;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.wellknown.PropertyIDMap;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.hpsf.wellknown.SectionIDMap;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">/**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * &lt;p&gt;This class is a simple sample application showing how to create a property</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * set and write it to disk.&lt;/p&gt;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> *</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @author Rainer Klute</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @since 2003-09-12</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_0df79ca487cd4fe4a06583adb204d3bd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* <p>此类是一个简单的示例应用程序，展示如何创建属性
* 设置并将其写入磁盘。</p>
*
* @作者Rainer Klute
* @自2003-09-12
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public class WriteTitle</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> /**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * &lt;p&gt;Runs the example program.&lt;/p&gt;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> *</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param args Command-line arguments. The first and only command-line</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * argument is the name of the POI file system to create.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @throws IOException if any I/O exception occurs.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @throws WritingNotSupportedException if HPSF does not (yet) support</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * writing a certain property type.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_d7a4acbe81aa406fa5df9a62df1095c9">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* <p>初始化示例程序。</p>
*
* @param args命令行参数。第一个也是唯一的命令行
* 参数是要创建的POI文件系统的名称。
* 如果发生任何I/O异常，@throws IOException。
* 如果HPSF（尚）不支持，@将抛出ExceptionNotSupportedException
* 写出某种属性类型。
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public static void main(final String[] args)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throws WritingNotSupportedException, IOException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Check whether we have exactly one command-line argument. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (args.length != 1)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.err.println("Usage: " + WriteTitle.class.getName() +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "destinationPOIFS");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.exit(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final String fileName = args[0];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Create a mutable property set. Initially it contains a single section</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * with no properties. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final PropertySet mps = new PropertySet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Retrieve the section the property set already contains. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final Section ms = mps.getSections().get(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Turn the property set into a summary information property. This is</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * done by setting the format ID of its first section to</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * SectionIDMap.SUMMARY_INFORMATION_ID. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Create an empty property. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final Property p = new Property();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Fill the property with appropriate settings so that it specifies the</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * document's title. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> p.setID(PropertyIDMap.PID_TITLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> p.setType(Variant.VT_LPWSTR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> p.setValue("Sample title");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Place the property into the section. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ms.setProperty(p);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Create the POI file system the property set is to be written to. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final POIFSFileSystem poiFs = new POIFSFileSystem();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* For writing the property set into a POI file system it has to be</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * handed over to the POIFS.createDocument() method as an input stream</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * which produces the bytes making out the property set stream. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> final InputStream is = mps.toInputStream();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Create the summary information property set in the POI file</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * system. It is given the default name most (if not all) summary</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> * information property sets have. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> poiFs.createDocument(is, SummaryInformation.DEFAULT_STREAM_NAME);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> /* Write the whole POI file system to a disk file. */</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> poiFs.writeFilesystem(new FileOutputStream(fileName));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_f0aff924b1e242c594a2132f2ae04924">The application first checks that there is exactly one single argument on the command line: the name of the file to write. If this single argument is present, the application stores it in the <span class="codefrag">fileName</span> variable. It will be used in the end when the POI file system is written to a disk file.</span><span class="tscolor" lg_zh="t_f0aff924b1e242c594a2132f2ae04924"><span lg_kh="1">(</span>应用程序首先检查命令行上是否只有一个参数：要写入的文件的名称。如果存在此单个参数，则应用程序将其存储在 fileName 变量中。将在最后将 POI 文件系统写入磁盘文件时使用。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if (args.length != 1)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.err.println("Usage: " + WriteTitle.class.getName() +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "destinationPOIFS");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.exit(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final String fileName = args[0];</span>
      </div>
     </div>
     <p><span lg_en="t_b8d6ce2c9bfe4334be8d56e47c36cc41">Let's create a property set now. We cannot use the <span class="codefrag">PropertySet</span> class, because it is read-only. It does not have a constructor creating an empty property set, and it does not have any methods to modify its contents, i.e. to write sections containing properties into it.</span><span class="tscolor" lg_zh="t_b8d6ce2c9bfe4334be8d56e47c36cc41"><span lg_kh="1">(</span>现在让我们创建一个属性集。我们不能使用 PropertySet 类，因为它是只读的。它没有创建空属性集的构造函数，也没有任何方法来修改其内容，即将包含属性的部分写入其中。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_58b62081b0624fe789dcc3431fe5ad40">The class to use is <span class="codefrag">PropertySet</span>. The sample application calls its no-args constructor in order to establish an empty property set:</span><span class="tscolor" lg_zh="t_58b62081b0624fe789dcc3431fe5ad40"><span lg_kh="1">(</span>要使用的类是 PropertySet。示例应用程序调用其无参数构造函数以建立一个空属性集：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final PropertySet mps = new PropertySet();</span>
      </div>
     </div>
     <p><span lg_en="t_cb8513c724db46848ce0eb80a1399a7c">As said, we have an empty property set now. Later we will put some contents into it.</span><span class="tscolor" lg_zh="t_cb8513c724db46848ce0eb80a1399a7c"><span lg_kh="1">(</span>如前所述，我们现在有一个空属性集。稍后我们会将一些内容放入其中。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c463cb846b914ac69e4fc35b10016397">The <span class="codefrag">PropertySet</span> created by the no-args constructor is not really empty: It contains a single section without properties. We can either retrieve that section and fill it with properties or we can replace it by another section. We can also add further sections to the property set. The sample application decides to retrieve the section being already there:</span><span class="tscolor" lg_zh="t_c463cb846b914ac69e4fc35b10016397"><span lg_kh="1">(</span>由无参数构造函数创建的 PropertySet 并不是真正的空：它包含一个没有属性的部分。我们可以检索该部分并用属性填充它，也可以用另一个部分替换它。我们还可以向属性集添加更多部分。示例应用程序决定检索已经存在的部分：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final Section ms = mps.getSections().get(0);</span>
      </div>
     </div>
     <p><span lg_en="t_69f6ea6d9df94cccb42d1c8122e42d36">The <span class="codefrag">getSections()</span> method returns the property set's sections as a list, i.e. an instance of <span class="codefrag">java.util.List</span>. Calling <span class="codefrag">get(0)</span> returns the list's first (or zeroth, if you prefer) element.</span><span class="tscolor" lg_zh="t_69f6ea6d9df94cccb42d1c8122e42d36"><span lg_kh="1">(</span>getSections() 方法将属性集的部分作为列表返回，即 java.util.List 的实例。调用 get(0) 返回列表的第一个（或第零个，如果您愿意）元素。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4ade8953a51d443485a123c2c79b2f9f">The alternative to retrieving the <span class="codefrag">Section</span> being already there would have been to create an new <span class="codefrag">Section</span> like this:</span><span class="tscolor" lg_zh="t_4ade8953a51d443485a123c2c79b2f9f"><span lg_kh="1">(</span>检索已经存在的部分的替代方法是创建一个新的部分，如下所示：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Section s = new Section();</span>
      </div>
     </div>
     <p><span lg_en="t_91f5ceef79dc4f4ba609660afd4da440">The <span class="codefrag">Section</span> the sample application retrieved from the <span class="codefrag">PropertySet</span> is still empty. It contains no properties and does not have a format ID. As you have read <a href="#sec3">above</a> the format ID of the first section in a property set determines the property set's type. Since our property set should become a SummaryInformation property set we have to set the format ID of its first (and only) section to <span class="codefrag">F29F85E0-4FF9-1068-AB-91-08-00-2B-27-B3-D9</span>. However, you won't have to remember that ID: HPSF has it defined as the well-known constant <span class="codefrag">SectionIDMap.SUMMARY_INFORMATION_ID</span>. The sample application writes it to the section using the <span class="codefrag">setFormatID(byte[])</span> method:</span><span class="tscolor" lg_zh="t_91f5ceef79dc4f4ba609660afd4da440"><span lg_kh="1">(</span>从 PropertySet 中检索到的示例应用程序的 Section 仍然是空的。它不包含任何属性，也没有格式 ID。正如您在上面所读到的，属性集中第一部分的格式 ID 决定了属性集的类型。由于我们的属性集应该成为 SummaryInformation 属性集，我们必须将其第一个（也是唯一一个）部分的格式 ID 设置为 F29F85E0-4FF9-1068-AB-91-08-00-2B-27-B3-D9。但是，您不必记住该 ID：HPSF 将其定义为众所周知的常量 SectionIDMap.SUMMARY_INFORMATION_ID。示例应用程序使用 setFormatID(byte[]) 方法将其写入该部分：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);</span>
      </div>
     </div>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final Property p = new Property();</span>
      </div>
     </div>
     <p><span lg_en="t_f3c235a916d04ad9be16260c5fb0d7b6">A <span class="codefrag">Property</span> object must have an ID, a type, and a value (see <a href="#sec3">above</a> for details). The class provides methods to set these attributes:</span><span class="tscolor" lg_zh="t_f3c235a916d04ad9be16260c5fb0d7b6"><span lg_kh="1">(</span>一个 Property 对象必须有一个 ID、一个类型和一个值（详见上文）。该类提供了设置这些属性的方法：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">p.setID(PropertyIDMap.PID_TITLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">p.setType(Variant.VT_LPWSTR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">p.setValue("Sample title");</span>
      </div>
     </div>
     <p><span lg_en="t_34d710a93a1347c9a628dc192a0f4142">The <span class="codefrag">Property</span> class has a constructor which you can use to pass in all three attributes in a single call. See the Javadoc API documentation for details!</span><span class="tscolor" lg_zh="t_34d710a93a1347c9a628dc192a0f4142"><span lg_kh="1">(</span>Property 类有一个构造函数，您可以使用它在一次调用中传入所有三个属性。有关详细信息，请参阅 Javadoc API 文档！<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d0177ebbd1f64bf580652af7b2cd5fc2">The sample property set is complete now. We have a <span class="codefrag">PropertySet</span> containing a <span class="codefrag">Section</span> containing a <span class="codefrag">Property</span>. Of course we could have added more sections to the property set and more properties to the sections but we wanted to keep things simple.</span><span class="tscolor" lg_zh="t_d0177ebbd1f64bf580652af7b2cd5fc2"><span lg_kh="1">(</span>示例属性集现已完成。我们有一个 PropertySet，其中包含一个包含 Property 的 Section。当然，我们可以向属性集添加更多部分，并为这些部分添加更多属性，但我们希望保持简单。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ff2c3d521e184cc18a0abcea25e7104e">The property set has to be written to a POI file system. The following statement creates it.</span><span class="tscolor" lg_zh="t_ff2c3d521e184cc18a0abcea25e7104e"><span lg_kh="1">(</span>必须将属性集写入 POI 文件系统。以下语句创建它。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final POIFSFileSystem poiFs = new POIFSFileSystem();</span>
      </div>
     </div>
     <p><span lg_en="t_e521b8c2b1bd4ecea9290bd4c91887cf">Writing the property set includes the step of converting it into a sequence of bytes. The <span class="codefrag">PropertySet</span> class has the method <span class="codefrag">toInputStream()</span> for this purpose. It returns the bytes making out the property set stream as an <span class="codefrag">InputStream</span>:</span><span class="tscolor" lg_zh="t_e521b8c2b1bd4ecea9290bd4c91887cf"><span lg_kh="1">(</span>写入属性集包括将其转换为字节序列的步骤。为此，PropertySet 类具有 toInputStream() 方法。它以 InputStream 的形式返回生成属性集流的字节：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">final InputStream is = mps.toInputStream();</span>
      </div>
     </div>
     <p><span lg_en="t_27ff7504d332456db8c820ddbc87ca93">If you'd read from this input stream you'd receive all the property set's bytes. However, it is very likely that you'll never do that. Instead you'll pass the input stream to the <span class="codefrag">POIFSFileSystem.createDocument()</span> method, like this:</span><span class="tscolor" lg_zh="t_27ff7504d332456db8c820ddbc87ca93"><span lg_kh="1">(</span>如果您从此输入流中读取，您将收到所有属性集的字节。但是，您很可能永远不会这样做。相反，您会将输入流传递给 POIFSFileSystem.createDocument() 方法，如下所示：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">poiFs.createDocument(is, SummaryInformation.DEFAULT_STREAM_NAME);</span>
      </div>
     </div>
     <p><span lg_en="t_5f57909a5a8749e494acdbe7a4fc3c53">Besides the <span class="codefrag">InputStream</span> <span class="codefrag">createDocument()</span> takes a second parameter: the name of the document to be created. For a SummaryInformation property set stream the default name is available as the constant <span class="codefrag">SummaryInformation.DEFAULT_STREAM_NAME</span>.</span><span class="tscolor" lg_zh="t_5f57909a5a8749e494acdbe7a4fc3c53"><span lg_kh="1">(</span>除了 InputStream createDocument() 有第二个参数：要创建的文档的名称。对于 SummaryInformation 属性集流，默认名称可用作常量 SummaryInformation.DEFAULT_STREAM_NAME。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ba1cc7f865b74e92917fb54704e71d98">The last step is to write the POI file system to a disk file:</span><span class="tscolor" lg_zh="t_ba1cc7f865b74e92917fb54704e71d98"><span lg_kh="1">(</span>最后一步是将 POI 文件系统写入磁盘文件：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">poiFs.writeFilesystem(new FileOutputStream(fileName));</span>
      </div>
     </div>
     <a name="Further+Reading"></a>
     <h3 class="boxed"><span lg_en="t_81dea0cf80ff44099b60ad2483fcb203">Further Reading</span><span class="tscolor" lg_zh="t_81dea0cf80ff44099b60ad2483fcb203"><span lg_kh="1">(</span>拓展阅读<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_1b82cecdcdd648e89d025da829a75141">There are still some aspects of HSPF left which are not covered by this HOW-TO. You should dig into the Javadoc API documentation to learn further details. Since you've struggled through this document up to this point, you are well prepared.</span><span class="tscolor" lg_zh="t_1b82cecdcdd648e89d025da829a75141"><span lg_kh="1">(</span>HSPF 的某些方面仍然没有包含在本 HOW-TO 中。您应该深入研究 Javadoc API 文档以了解更多详细信息。由于到目前为止您一直在努力阅读本文档，因此您已经做好了充分的准备。<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_1be1f41668904c6a88fa931874e0d1fa"><font size="-2">by&nbsp;Rainer Klute</font></span><span class="tscolor" lg_zh="t_1be1f41668904c6a88fa931874e0d1fa"><span lg_kh="1">(</span>作者：Rainer Klute<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/hpsf/how-to.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>