<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Upgrading to POI 3.5, including converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_bc464e5f71424580b8c5f9a52b4ca875">Upgrading to POI 3.5, including converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)</span><span class="tscolor" lg_zh="t_bc464e5f71424580b8c5f9a52b4ca875"><span lg_kh="1">(</span>升级到 POI 3.5，包括将现有 HSSF Usermodel代码转换为 SS Usermodel（用于 XSSF 和 HSSF）<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="Things+that+have+to+be+changed+when+upgrading+to+POI+3.5"></a>
    <h2 class="boxed"><span lg_en="t_f9201cb1fc684fca90ea3f59a05ce428">Things that have to be changed when upgrading to POI 3.5</span><span class="tscolor" lg_zh="t_f9201cb1fc684fca90ea3f59a05ce428"><span lg_kh="1">(</span>升级到 POI 3.5 时必须更改的内容<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_d901aaeaf9d646ee87b673199155d981">Wherever possible, we have tried to ensure that you can use your existing POI code with POI 3.5 without requiring any changes. However, Java doesn't always make that easy, and unfortunately there are a few changes that may be required for some users.</span><span class="tscolor" lg_zh="t_d901aaeaf9d646ee87b673199155d981"><span lg_kh="1">(</span>我们尽可能确保您可以在POI 3.5中使用现有的POI代码，而无需做任何更改。但是，在Java没这么简单，所以，有些靓仔可能需要对程序做一些更改。<span lg_kh="1">)</span></span></p>
     <a name="org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue"></a>
     <h3 class="boxed"><span lg_en="t_ee8bed696d0045bcb88c67861d4280e0">org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue</span><span class="tscolor" lg_zh="t_ee8bed696d0045bcb88c67861d4280e0"><span lg_kh="1">(</span>org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_467384ac633249ea9ed05595074a6e26">Annoyingly, java will not let you access a static inner class via a child of the parent one. So, all references to <em>org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue</em> will need to be changed to <em>org.apache.poi.ss.usermodel.FormulaEvaluator.CellValue</em></span><span class="tscolor" lg_zh="t_467384ac633249ea9ed05595074a6e26"><span lg_kh="1">(</span>恼火的是，java 不允许您通过父类的子类访问静态内部类。因此，所有对 org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.CellValue 的引用都需要更改为 org.apache.poi.ss.usermodel.FormulaEvaluator.CellValue<span lg_kh="1">)</span></span></p>
     <a name="org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy"></a>
     <h3 class="boxed"><span lg_en="t_ef990f37cf5d418cad4d1539fe9db105">org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy</span><span class="tscolor" lg_zh="t_ef990f37cf5d418cad4d1539fe9db105"><span lg_kh="1">(</span>org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_20b3cadb3fd34523868e590bfde27111">Annoyingly, java will not let you access a static inner class via a child of the parent one. So, all references to <em>org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy</em> will need to be changed to <em>org.apache.poi.ss.usermodel.Row.MissingCellPolicy</em></span><span class="tscolor" lg_zh="t_20b3cadb3fd34523868e590bfde27111"><span lg_kh="1">(</span>恼火的是，java 不允许您通过父类的子类访问静态内部类。因此，所有对 org.apache.poi.hssf.usermodel.HSSFRow.MissingCellPolicy 的引用都需要更改为 org.apache.poi.ss.usermodel.Row.MissingCellPolicy<span lg_kh="1">)</span></span></p>
     <a name="DDF+and+org.apache.poi.hssf.record.RecordFormatException"></a>
     <h3 class="boxed"><span lg_en="t_48add1437ca84af39e57d13e9c954e77">DDF and org.apache.poi.hssf.record.RecordFormatException</span><span class="tscolor" lg_zh="t_48add1437ca84af39e57d13e9c954e77"><span lg_kh="1">(</span>DDF 和 org.apache.poi.hssf.record.RecordFormatException<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_1d0448677caf445eb74b27b84cf54399">Previously, record level errors within DDF would throw an exception from the hssf class hierarchy. Now, record level errors within DDF will throw a more general RecordFormatException, <em>org.apache.poi.util.RecordFormatException</em></span><span class="tscolor" lg_zh="t_1d0448677caf445eb74b27b84cf54399"><span lg_kh="1">(</span>以前，DDF 中的记录级错误会引发hssf类层次结构中的异常。现在，DDF 中的记录级别错误将引发更一般的 RecordFormatException，org.apache.poi.util.RecordFormatException<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_456f8f78eac24dc29238256d06e7e153">In addition, org.apache.poi.hssf.record.RecordFormatException has been changed to inherit from the new <em>org.apache.poi.util.RecordFormatException</em>, so you may wish to change catches of the hssf version to the new util version.</span><span class="tscolor" lg_zh="t_456f8f78eac24dc29238256d06e7e153"><span lg_kh="1">(</span>此外，org.apache.poi.hssf.record.RecordFormatException 已更改为从新的 org.apache.poi.util.RecordFormatException 继承，因此您可能需要将 hssf 版本的异常捕获更改为新的 util 版本。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Converting+existing+HSSF+Usermodel+code+to+SS+Usermodel+%28for+XSSF+and+HSSF%29"></a>
    <h2 class="boxed"><span lg_en="t_c84b9dde21de4e7bb0045d17c34936e4">Converting existing HSSF Usermodel code to SS Usermodel (for XSSF and HSSF)</span><span class="tscolor" lg_zh="t_c84b9dde21de4e7bb0045d17c34936e4"><span lg_kh="1">(</span>将现有 HSSF Usermodel代码转换为 SS Usermodel（用于 XSSF 和 HSSF）<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="Why+change%3F"></a>
     <h3 class="boxed"><span lg_en="t_6a380a4b9dfe4e4c951887f8a2107a4f">Why change?</span><span class="tscolor" lg_zh="t_6a380a4b9dfe4e4c951887f8a2107a4f"><span lg_kh="1">(</span>为什么要改？<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_060b54d207c04840b3167165df3c9723">If you have existing HSSF usermodel code that works just fine, and you don't want to use the new OOXML XSSF support, then you probably don't need to. Your existing HSSF only code will continue to work just fine.</span><span class="tscolor" lg_zh="t_060b54d207c04840b3167165df3c9723"><span lg_kh="1">(</span>如果您现有的HSSF 用户模型代码可以正常工作，并且您不想使用新的OOXML XSSF支持，那么您可能不需要改。您现有的代码仅 HSSF 部分代码将继续正常工作。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_172d866be8d949f69529026640207b0a">However, if you want to be able to work with both HSSF for your .xls files, and also XSSF for .xslx files, then you will need to make some slight tweaks to your code.</span><span class="tscolor" lg_zh="t_172d866be8d949f69529026640207b0a"><span lg_kh="1">(</span>但是，如果您希望能够同时使用 .xls 文件的 HSSF 和 .xslx 文件的 XSSF，那么您需要对您的代码进行一些细微的调整。<span lg_kh="1">)</span></span></p>
     <a name="org.apache.poi.ss.usermodel"></a>
     <h3 class="boxed"><span lg_en="t_faccfbee246440e28c572f9c468afbbb">org.apache.poi.ss.usermodel</span><span class="tscolor" lg_zh="t_faccfbee246440e28c572f9c468afbbb"><span lg_kh="1">(</span>org.apache.poi.ss.usermodel<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_85541e59619c4c70adba062a14104ec2">The new SS usermodel (org.apache.poi.ss.usermodel) is very heavily based on the old HSSF usermodel (org.apache.poi.hssf.usermodel). The main difference is that the package name and class names have been tweaked to remove HSSF from them. Otherwise, the new SS Usermodel interfaces should provide the same functionality.</span><span class="tscolor" lg_zh="t_85541e59619c4c70adba062a14104ec2"><span lg_kh="1">(</span>新的 SS usermodel (org.apache.poi.ss.usermodel) 在很大程度上基于旧的 HSSF 用户模型 (org.apache.poi.hssf.usermodel)。主要区别在于对软件包名称和类名称进行了调整，以从中删除HSSF。新的 SS Usermodel 接口会提供与HSSF相同的功能。<span lg_kh="1">)</span></span></p>
     <a name="Constructors"></a>
     <h3 class="boxed"><span lg_en="t_5865371b5ee24ffd95e6f25dd5286458">Constructors</span><span class="tscolor" lg_zh="t_5865371b5ee24ffd95e6f25dd5286458"><span lg_kh="1">(</span>构造函数<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_20f34178ea944ede9597afca154be7c2">Calling the empty HSSFWorkbook remains as the way to create a new, empty Workbook object. To open an existing Workbook, you should now call WorkbookFactory.create(inp).</span><span class="tscolor" lg_zh="t_20f34178ea944ede9597afca154be7c2"><span lg_kh="1">(</span>调用空的 HSSFWorkbook 仍然是创建新的空 Workbook 对象的方法。要打开现有工作簿，您现在应该调用 WorkbookFactory.create(inp)。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_92e78fadff4d4c63a3801779e6bff194">For all other cases when you would have called a Usermodel constructor, such as 'new HSSFRichTextString()' or 'new HSSFDataFormat', you should instead use a CreationHelper. There's a method on the Workbook to get a CreationHelper, and the CreationHelper will then handle constructing new objects for you.</span><span class="tscolor" lg_zh="t_92e78fadff4d4c63a3801779e6bff194"><span lg_kh="1">(</span>对于调用 Usermodel 构造函数的所有其他情况，例如“new HSSFRichTextString()”或“new HSSFDataFormat”，您应该改用 CreationHelper。 Workbook 上有一个获取 CreationHelper 的方法，CreationHelper 将为您构建新对象。<span lg_kh="1">)</span></span></p>
     <a name="Other+Code"></a>
     <h3 class="boxed"><span lg_en="t_b35586007c4741ff87f70d7e5b4b2810">Other Code</span><span class="tscolor" lg_zh="t_b35586007c4741ff87f70d7e5b4b2810"><span lg_kh="1">(</span>其他代码<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_40c060c9648b4ebab35d8094e9fb8e60">For all other code, generally change a reference from org.apache.poi.hssf.usermodel.HSSFFoo to a reference to org.apache.poi.ss.usermodel.Foo. Method signatures should otherwise remain the same, and it should all then work for both XSSF and HSSF.</span><span class="tscolor" lg_zh="t_40c060c9648b4ebab35d8094e9fb8e60"><span lg_kh="1">(</span>对于所有的其他代码，通常将引用从 org.apache.poi.hssf.usermodel.HSSFFoo 更改为 org.apache.poi.ss.usermodel.Foo。否则，方法签名应当保持不变，并且它应当同时适用于XSSF和HSSF。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Worked+Examples"></a>
    <h2 class="boxed"><span lg_en="t_bfa12b22ded848a6ba3a5a8c1c777870">Worked Examples</span><span class="tscolor" lg_zh="t_bfa12b22ded848a6ba3a5a8c1c777870"><span lg_kh="1">(</span>工作示例<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="Old+HSSF+Code"></a>
     <h3 class="boxed"><span lg_en="t_a6aa8f63754942e5a92bc8e230a388f2">Old HSSF Code</span><span class="tscolor" lg_zh="t_a6aa8f63754942e5a92bc8e230a388f2"><span lg_kh="1">(</span>旧 HSSF 代码<span lg_kh="1">)</span></span></h3>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.hssf.usermodel.*;</span>
      </div>
      <div class="codeline" lg_zh="t_f25b7b2eec794e769dd286fa30125363">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//导入org. apache. poi.hssf.usermodel. *;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new sheet</span>
      </div>
      <div class="codeline" lg_zh="t_5ea3ddd9cbfa4cf8ab8a58c5ca76edde">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新工作表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet s = wb.createSheet();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a row object reference</span>
      </div>
      <div class="codeline" lg_zh="t_78a3534098624d7895a0451775374c10">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明行对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRow r = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a cell object reference</span>
      </div>
      <div class="codeline" lg_zh="t_4d501a36c3f94ba6a9bd1e0470e296a3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明单元格对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell c = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 2 cell styles</span>
      </div>
      <div class="codeline" lg_zh="t_4868f033e88f48009a604e85032e27a0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建2个单元格样式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle cs2 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFDataFormat df = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 2 fonts objects</span>
      </div>
      <div class="codeline" lg_zh="t_53b1986a87db44f381b7d744e296dd72">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建2个字体对象
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont f = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont f2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set font 1 to 12 point type, blue and bold</span>
      </div>
      <div class="codeline" lg_zh="t_a9ecef345b0a4f5f97292bae3cb734cd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将字体1设置为12点类型，蓝色和粗体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setFontHeightInPoints((short) 12);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setColor( HSSFColor.RED.index );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set font 2 to 10 point type, red and bold</span>
      </div>
      <div class="codeline" lg_zh="t_7907a0315560440594002bb619b1e18b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将字体2设置为10点类型，红色和粗体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setFontHeightInPoints((short) 10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setColor( HSSFFont.RED.index );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set cell style and formatting</span>
      </div>
      <div class="codeline" lg_zh="t_2658aada698f49b4b29a9994e8c21c99">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置单元格样式和格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setFont(f);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setDataFormat(df.getFormat("#,##0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the other cell style and formatting</span>
      </div>
      <div class="codeline" lg_zh="t_75c1e062d5144f3299232e15d3332fde">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置其他单元格样式和格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setBorderBottom(cs2.BORDER_THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setDataFormat(HSSFDataFormat.getBuiltinFormat("text"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setFont(f2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Define a few rows</span>
      </div>
      <div class="codeline" lg_zh="t_ba5536842063416ebfc81dfb6e0eab73">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//定义几行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(short rownum = (short)0; rownum &lt; 30; rownum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFRow r = s.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(short cellnum = (short)0; cellnum &lt; 10; cellnum += 2) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFCell c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFCell c2 = r.createCell(cellnum+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue((double)rownum + (cellnum/10));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c2.setCellValue(new HSSFRichTextString("Hello! " + cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Save</span>
      </div>
      <div class="codeline" lg_zh="t_726d18ba2e48423e8077b06fc27ed020">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//保存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FileOutputStream out = new FileOutputStream("workbook.xls");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="New%2C+generic+SS+Usermodel+Code"></a>
     <h3 class="boxed"><span lg_en="t_a4002e392ac348b1a701195076cf8203">New, generic SS Usermodel Code</span><span class="tscolor" lg_zh="t_a4002e392ac348b1a701195076cf8203"><span lg_kh="1">(</span>新的通用 SS Usermodel 代码<span lg_kh="1">)</span></span></h3>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.ss.usermodel.*;</span>
      </div>
      <div class="codeline" lg_zh="t_e5cbcb3785284ca3b46cab928cf34ee8">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//导入org. apache. poi.ss.usermodel. *;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook[] wbs = new Workbook[] { new HSSFWorkbook(), new XSSFWorkbook() };</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for(int i=0; i&lt;wbs.length; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Workbook wb = wbs[i];</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a new sheet</span>
      </div>
      <div class="codeline" lg_zh="t_3a7e071be6204966bf4e554846e65fcd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新工作表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.createSheet();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // declare a row object reference</span>
      </div>
      <div class="codeline" lg_zh="t_03818648bced4cc6b16156d32bc04195">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明行对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // declare a cell object reference</span>
      </div>
      <div class="codeline" lg_zh="t_1e6cf3327f904ed589133e7871edabb8">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明单元格对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create 2 cell styles</span>
      </div>
      <div class="codeline" lg_zh="t_f6db35e8ac994c409b80da7d2d5e5d69">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建2个单元格样式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cs2 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DataFormat df = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create 2 fonts objects</span>
      </div>
      <div class="codeline" lg_zh="t_22805066dcf14cebb97985e60f5d45f0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建2个字体对象
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font f = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font f2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set font 1 to 12 point type, blue and bold</span>
      </div>
      <div class="codeline" lg_zh="t_8d43b253c5c641c99490f02414847ed7">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将字体1设置为12点类型，蓝色和粗体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setFontHeightInPoints((short) 12);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setColor( IndexedColors.RED.getIndex() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set font 2 to 10 point type, red and bold</span>
      </div>
      <div class="codeline" lg_zh="t_9a7238ee0d2c4cfdac8e1071623a0e4a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将字体2设置为10点类型，红色和粗体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setFontHeightInPoints((short) 10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setColor( IndexedColors.RED.getIndex() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> f2.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set cell style and formatting</span>
      </div>
      <div class="codeline" lg_zh="t_4ee51c75d7fa45b4983948dc0352a03b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置单元格样式和格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs.setFont(f);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs.setDataFormat(df.getFormat("#,##0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Set the other cell style and formatting</span>
      </div>
      <div class="codeline" lg_zh="t_39c060acb6ed45d99004c8219fc8169f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置其他单元格样式和格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setBorderBottom(cs2.BORDER_THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setDataFormat(df.getFormat("text"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cs2.setFont(f2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Define a few rows</span>
      </div>
      <div class="codeline" lg_zh="t_3d8073ee69b442668bf88502dbab796c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//定义几行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 0; rownum &lt; 30; rownum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = s.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int cellnum = 0; cellnum &lt; 10; cellnum += 2) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c2 = r.createCell(cellnum+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue((double)rownum + (cellnum/10));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c2.setCellValue(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createRichTextString("Hello! " + cellnum)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Save</span>
      </div>
      <div class="codeline" lg_zh="t_faec01e2fb944ce7b7e6c57830d6332d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//保存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String filename = "workbook.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(wb instanceof XSSFWorkbook) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> filename = filename + "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileOutputStream out = new FileOutputStream(filename);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <p align="right"><span lg_en="t_1ed81750cb0a43809b4963515a5b2525"><font size="-2">by&nbsp;Nick Burch</font></span><span class="tscolor" lg_zh="t_1ed81750cb0a43809b4963515a5b2525"><span lg_kh="1">(</span>作者：尼克伯奇<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/converting.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>