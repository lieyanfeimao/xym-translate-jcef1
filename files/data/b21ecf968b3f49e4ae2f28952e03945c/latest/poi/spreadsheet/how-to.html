<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>The New Halloween Document</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_b67d4714234d488081876d8a6de5d72a">The New Halloween Document</span><span class="tscolor" lg_zh="t_b67d4714234d488081876d8a6de5d72a"><span lg_kh="1">(</span>新的万圣节文档<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="How+to+use+the+HSSF+API"></a>
    <h2 class="boxed"><span lg_en="t_6fb66b489043446083c4eaf2db78f99b">How to use the HSSF API</span><span class="tscolor" lg_zh="t_6fb66b489043446083c4eaf2db78f99b"><span lg_kh="1">(</span>如何使用 HSSF API<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="Capabilities"></a>
     <h3 class="boxed"><span lg_en="t_6749df9a78ec41d68cde170543c19a5a">Capabilities</span><span class="tscolor" lg_zh="t_6749df9a78ec41d68cde170543c19a5a"><span lg_kh="1">(</span>能力<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_19a33e84c7b1409eb5ac82e6876365ac">This release of the how-to outlines functionality for the current svn trunk. Those looking for information on previous releases should look in the documentation distributed with that release.</span><span class="tscolor" lg_zh="t_19a33e84c7b1409eb5ac82e6876365ac"><span lg_kh="1">(</span>此版本的操作指南概述了当前 svn 主干的功能。如果想要了解以前版本信息，你应该查看与该版本一起分发的文档。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_24f0ad9a3524497ea443dc1e535f3abb">HSSF allows numeric, string, date or formula cell values to be written to or read from an XLS file. Also in this release is row and column sizing, cell styling (bold, italics, borders,etc), and support for both built-in and user defined data formats. Also available is an event-based API for reading XLS files. It differs greatly from the read/write API and is intended for intermediate developers who need a smaller memory footprint.</span><span class="tscolor" lg_zh="t_24f0ad9a3524497ea443dc1e535f3abb"><span lg_kh="1">(</span>HSSF 允许在 XLS 文件中写入或读取数字、字符串、日期或公式单元格值。此版本还支持行和列大小、单元格样式（粗体、斜体、边框等），并支持内置和用户定义的数据格式。还有一个用于读取 XLS 文件的基于事件的 API。它与读/写 API 有很大不同，适用于需要较小内存占用的中级开发人员。<span lg_kh="1">)</span></span></p>
     <a name="Different+APIs"></a>
     <h3 class="boxed"><span lg_en="t_d72b6baefe354d2e9ddcf721a2fa46a0">Different APIs</span><span class="tscolor" lg_zh="t_d72b6baefe354d2e9ddcf721a2fa46a0"><span lg_kh="1">(</span>不同的 API<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_5aea60188875413baf2b42c1670ec766">There are a few different ways to access the HSSF API. These have different characteristics, so you should read up on all to select the best for you.</span><span class="tscolor" lg_zh="t_5aea60188875413baf2b42c1670ec766"><span lg_kh="1">(</span>有几种不同的方法可以访问 HSSF API。它们具有不同的特征，因此您应该阅读所有内容以选择最适合您的。<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_983b37a9184b4f918a7a3741ac9c34e0"><a href="#user_api">User API (HSSF and XSSF)</a></span><span class="tscolor" lg_zh="t_983b37a9184b4f918a7a3741ac9c34e0"><span lg_kh="1">(</span><a href="#user_api" style="color:blue;">User API(HSSF 和 XSSF)</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e6464f10f82f4c82a35e048c3501c7a6"><a href="#event_api">Event API (HSSF Only)</a></span><span class="tscolor" lg_zh="t_e6464f10f82f4c82a35e048c3501c7a6"><span lg_kh="1">(</span>Event API（仅限 HSSF）<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_cb22f732f65840a08a42b342a57b7b2a"><a href="#record_aware_event_api">Event API with extensions to be Record Aware (HSSF Only)</a></span><span class="tscolor" lg_zh="t_cb22f732f65840a08a42b342a57b7b2a"><span lg_kh="1">(</span><a href="#record_aware_event_api" style="color:blue;">具有扩展的Event API，记录感知事件API（仅限 HSSF）</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e30d17f68f4d404d8eee6d80f8221ce1"><a href="#xssf_sax_api">XSSF and SAX (Event API)</a></span><span class="tscolor" lg_zh="t_e30d17f68f4d404d8eee6d80f8221ce1"><span lg_kh="1">(</span><a href="#xssf_sax_api" style="color:blue;">XSSF and SAX (Event API)</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a67d4839d23b475eb8fbd06e50de81ca"><a href="#sxssf">SXSSF (Streaming User API)</a></span><span class="tscolor" lg_zh="t_a67d4839d23b475eb8fbd06e50de81ca"><span lg_kh="1">(</span><a href="#sxssf" style="color:blue;">SXSSF（流式User API）</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_7b9d1926bc3e490d9b59f65f19bcf57a"><a href="#low_level_api">Low Level API</a></span><span class="tscolor" lg_zh="t_7b9d1926bc3e490d9b59f65f19bcf57a"><span lg_kh="1">(</span><a href="#low_level_api" style="color:blue;">低级 API</a><span lg_kh="1">)</span></span></li>
     </ul>
    </div>
    <a name="General+Use"></a>
    <h2 class="boxed"><span lg_en="t_dc55113e3e184dea82ead12c05d0c117">General Use</span><span class="tscolor" lg_zh="t_dc55113e3e184dea82ead12c05d0c117"><span lg_kh="1">(</span>一般使用<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="user_api" id="user_api"></a><a name="User+API+%28HSSF+and+XSSF%29"></a>
     <h3 class="boxed"><span lg_en="t_ea2609baf72743ba8cdc022db10a852f">User API (HSSF and XSSF)</span><span class="tscolor" lg_zh="t_ea2609baf72743ba8cdc022db10a852f"><span lg_kh="1">(</span><a href="#user_api" style="color:blue;">User API(HSSF 和 XSSF)</a><span lg_kh="1">)</span></span></h3>
     <a name="Writing+a+new+file"></a>
     <h4><span lg_en="t_8195459522bd4d83b8491677e9ca0438">Writing a new file</span><span class="tscolor" lg_zh="t_8195459522bd4d83b8491677e9ca0438"><span lg_kh="1">(</span>写一个新文件<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_d8d9bb9116f04b0f98260cc7097bd76b">The high level API (package: org.apache.poi.ss.usermodel) is what most people should use. Usage is very simple.</span><span class="tscolor" lg_zh="t_d8d9bb9116f04b0f98260cc7097bd76b"><span lg_kh="1">(</span>大多数人应该使用高级 API（包：org.apache.poi.ss.usermodel）。用法很简单。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_01d48450bd0540f0a9a53ec2cedc8c0e">Workbooks are created by creating an instance of org.apache.poi.ss.usermodel.Workbook. Either create a concrete class directly (org.apache.poi.hssf.usermodel.HSSFWorkbook or org.apache.poi.xssf.usermodel.XSSFWorkbook), or use the handy factory class org.apache.poi.ss.usermodel.WorkbookFactory.</span><span class="tscolor" lg_zh="t_01d48450bd0540f0a9a53ec2cedc8c0e"><span lg_kh="1">(</span>通过创建 org.apache.poi.ss.usermodel.Workbook 的实例来创建工作簿。也可以创建一个具体的类（org.apache.poi.hssf.usermodel.HSSFWorkbook 或 org.apache.poi.xssf.usermodel.XSSFWorkbook），或者使用便捷的工厂类 org.apache.poi.ss.usermodel.WorkbookFactory。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ca58ac5af624458f805b61299734329c">Sheets are created by calling createSheet() from an existing instance of Workbook, the created sheet is automatically added in sequence to the workbook. Sheets do not in themselves have a sheet name (the tab at the bottom); you set the name associated with a sheet by calling Workbook.setSheetName(sheetindex,"SheetName",encoding). For HSSF, the name may be in 8bit format (HSSFWorkbook.ENCODING_COMPRESSED_UNICODE) or Unicode (HSSFWorkbook.ENCODING_UTF_16). Default encoding for HSSF is 8bit per char. For XSSF, the name is automatically handled as unicode.</span><span class="tscolor" lg_zh="t_ca58ac5af624458f805b61299734329c"><span lg_kh="1">(</span>通过从现有的 Workbook 实例调用 createSheet() 创建工作表，创建的工作表会自动按顺序添加到工作簿中。工作表本身没有名称（底部的选项卡）；您可以通过调用 Workbook.setSheetName(sheetindex,&quot;SheetName&quot;,encoding) 设置与工作表关联的名称。对于 HSSF，名称可以是 8 位格式 (HSSFWorkbook.ENCODING_COMPRESSED_UNICODE) 或 Unicode (HSSFWorkbook.ENCODING_UTF_16)。 HSSF 的默认编码是每字符 8 位。对于 XSSF，名称会自动作为 unicode 处理。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_23958708958644cd9d4384460d8137cb">Rows are created by calling createRow(rowNumber) from an existing instance of Sheet. Only rows that have cell values should be added to the sheet. To set the row's height, you just call setRowHeight(height) on the row object. The height must be given in twips, or 1/20th of a point. If you prefer, there is also a setRowHeightInPoints method.</span><span class="tscolor" lg_zh="t_23958708958644cd9d4384460d8137cb"><span lg_kh="1">(</span>通过从 Sheet 的现有实例调用 createRow(rowNumber) 创建行。只有拥有单元格的行才应添加到工作表中。要设置行的高度，只需在行对象上调用 setRowHeight(height)。高度必须是缇或点的 1/20。如果您需要，可以用setRowHeightInPoints 方法。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_070e4c15bd5e44c7b28e947aedc5348f">Cells are created by calling createCell(column, type) from an existing Row. Only cells that have values should be added to the row. Cells should have their cell type set to either Cell.CELL_TYPE_NUMERIC or Cell.CELL_TYPE_STRING depending on whether they contain a numeric or textual value. Cells must also have a value set. Set the value by calling setCellValue with either a String or double as a parameter. Individual cells do not have a width; you must call setColumnWidth(colindex, width) (use units of 1/256th of a character) on the Sheet object. (You can't do it on an individual basis in the GUI either).</span><span class="tscolor" lg_zh="t_070e4c15bd5e44c7b28e947aedc5348f"><span lg_kh="1">(</span>单元格通过从现有行调用createCell(column, type) 来创建。只有拥有值的单元格才应添加到行中。单元格应将其类型设置为 Cell.CELL_TYPE_NUMERIC 或 Cell.CELL_TYPE_STRING，具体取决于它们是否包含数字或文本值。单元格还必须有一个值集。通过使用 String 或 double 作为参数调用 setCellValue 来设置值。单个单元格没有宽度；您必须在 Sheet 对象上调用 setColumnWidth(colindex, width) （使用字符的 1/256 的单位）。 （您不能在 GUI 中单独执行此操作）。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_41c6a71492034d36aec089da37a71bf5">Cells are styled with CellStyle objects which in turn contain a reference to an Font object. These are created via the Workbook object by calling createCellStyle() and createFont(). Once you create the object you must set its parameters (colors, borders, etc). To set a font for an CellStyle call setFont(fontobj).</span><span class="tscolor" lg_zh="t_41c6a71492034d36aec089da37a71bf5"><span lg_kh="1">(</span>单元格使用 CellStyle 对象设置样式，这些对象又包含对 Font 对象的引用。这些是通过 Workbook 对象调用 createCellStyle() 和 createFont() 创建的。创建对象后，您必须设置其参数（颜色、边框等）。使用 CellStyle 调用 setFont(fontobj) 设置字体。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f218133344d041ff99817b1c9b1ff8f6">Once you have generated your workbook, you can write it out by calling write(outputStream) from your instance of Workbook, passing it an OutputStream (for instance, a FileOutputStream or ServletOutputStream). You must close the OutputStream yourself. HSSF does not close it for you.</span><span class="tscolor" lg_zh="t_f218133344d041ff99817b1c9b1ff8f6"><span lg_kh="1">(</span>生成工作簿后，您可以通过从工作簿实例调用 write(outputStream) 将其写出，并将其传递给 OutputStream（例如，FileOutputStream 或 ServletOutputStream）。您必须自己关闭 OutputStream。 HSSF 不会为您关闭它。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9db06ac16bad4fa5aef095bd8c06a225">Here is some example code (excerpted and adapted from org.apache.poi.hssf.dev.HSSF test class):</span><span class="tscolor" lg_zh="t_9db06ac16bad4fa5aef095bd8c06a225"><span lg_kh="1">(</span>这是一些示例代码（摘自并改编自 org.apache.poi.hssf.dev.HSSF 测试类）：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">short rownum;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new file</span>
      </div>
      <div class="codeline" lg_zh="t_3b8910c93a0749c6ba94700504bce938">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FileOutputStream out = new FileOutputStream("workbook.xls");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new workbook</span>
      </div>
      <div class="codeline" lg_zh="t_453c29dc8b3c4c469009c51e1af3caef">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新工作簿
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new sheet</span>
      </div>
      <div class="codeline" lg_zh="t_25c320ee04e14f528aa26ea008c63572">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新工作表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet s = wb.createSheet();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a row object reference</span>
      </div>
      <div class="codeline" lg_zh="t_22558526daec43f9b5b37923c88930da">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明行对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row r = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// declare a cell object reference</span>
      </div>
      <div class="codeline" lg_zh="t_25a26737a6264641bb9b4a62fe03efb2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//声明单元格对象引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell c = null;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 3 cell styles</span>
      </div>
      <div class="codeline" lg_zh="t_826caabfd48f4c99bb4583e04a1620bc">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建3个单元格样式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cs2 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cs3 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataFormat df = wb.createDataFormat();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create 2 fonts objects</span>
      </div>
      <div class="codeline" lg_zh="t_ed8a53045fce4eb791d4c190d4f8f56b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建2个字体对象
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font f = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font f2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set font 1 to 12 point type</span>
      </div>
      <div class="codeline" lg_zh="t_869ee1ea349243af99faf13640a41d05">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置字体1到12点类型
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setFontHeightInPoints((short) 12);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//make it blue</span>
      </div>
      <div class="codeline" lg_zh="t_85cd3dc0f1904c7682d2a9334308e738">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//让它变成蓝色
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setColor( (short)0xc );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// make it bold</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//arial is the default font</span>
      </div>
      <div class="codeline" lg_zh="t_b814b9320aa042abbcd230e9ff17cd51">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//大胆一点
//arial是默认字体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set font 2 to 10 point type</span>
      </div>
      <div class="codeline" lg_zh="t_385ef0b569fa4de48e290b31a240a807">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将字体2设置为10分类型
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setFontHeightInPoints((short) 10);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//make it red</span>
      </div>
      <div class="codeline" lg_zh="t_88c40649542f4bf39e50db569a6f7008">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//让它变成红色
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setColor( (short)Font.COLOR_RED );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//make it bold</span>
      </div>
      <div class="codeline" lg_zh="t_f95bf5b173ca45efbe5c7d9bf41c6719">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//大胆一点
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f2.setStrikeout( true );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set cell stlye</span>
      </div>
      <div class="codeline" lg_zh="t_46fdefb00f4441498aff312bc6105280">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置单元格格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setFont(f);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set the cell format </span>
      </div>
      <div class="codeline" lg_zh="t_17b5c550bc0e49a2b4d3dfb2f9ee8651">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置单元格格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setDataFormat(df.getFormat("#,##0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set a thin border</span>
      </div>
      <div class="codeline" lg_zh="t_fbfbeb4d66ec4f83b1ee006cafa41f9b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置细边框
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setBorderBottom(cs2.BORDER_THIN);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//fill w fg fill color</span>
      </div>
      <div class="codeline" lg_zh="t_bd5fdc79c91943f1b42c439b2fa6bdd5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//用FG填充颜色填充
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setFillPattern((short) CellStyle.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set the cell format to text see DataFormat for a full list</span>
      </div>
      <div class="codeline" lg_zh="t_4ddb5efea3f248258ee65605cbde8c80">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将单元格格式设置为文本，请参阅数据格式以获取完整列表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setDataFormat(HSSFDataFormat.getBuiltinFormat("text"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// set the font</span>
      </div>
      <div class="codeline" lg_zh="t_cd3fa881b55c49e4ac26eb8daa477a6a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置字体
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs2.setFont(f2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// set the sheet name in Unicode</span>
      </div>
      <div class="codeline" lg_zh="t_2ab89d6bb3cc426e934be56018455d73">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在Unicode中设置工作表名称
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setSheetName(0, "\u0422\u0435\u0441\u0442\u043E\u0432\u0430\u044F " + </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "\u0421\u0442\u0440\u0430\u043D\u0438\u0447\u043A\u0430" );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// in case of plain ascii</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// wb.setSheetName(0, "HSSF Test");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a sheet with 30 rows (0-29)</span>
      </div>
      <div class="codeline" lg_zh="t_aba122f7d41c40a4a473aefccca64f0e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//如果是普通石棉
//.setSheetName（0，“HSSF Test”）;
//创建具有30行（0-29）的表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rownum;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (rownum = (short) 0; rownum &lt; 30; rownum++)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a row</span>
      </div>
      <div class="codeline" lg_zh="t_49a12d873d5a4271a0fb005182132173">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r = s.createRow(rownum);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // on every other row</span>
      </div>
      <div class="codeline" lg_zh="t_9e13ea9274bf43d499b5cbe96a5297ae">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//每隔一行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if ((rownum % 2) == 0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // make the row height bigger (in twips - 1/20 of a point)</span>
      </div>
      <div class="codeline" lg_zh="t_a0020056eab143a0ba895556535e42c0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使行高更大（单位：twips - 1/20一个点）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> r.setHeight((short) 0x249);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //r.setRowNum(( short ) rownum);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create 10 cells (0-9) (the += 2 becomes apparent later</span>
      </div>
      <div class="codeline" lg_zh="t_c55de5b0fd5e4234b246ed7051665586">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//r.setRowNum（（短）rownum）;
//创建10个单元格（0-9）（+= 2稍后变得明显
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (short cellnum = (short) 0; cellnum &lt; 10; cellnum += 2)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a numeric cell</span>
      </div>
      <div class="codeline" lg_zh="t_a3e69f7a2830482c8ccf2183b0211ede">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建数字单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // do some goofy math to demonstrate decimals</span>
      </div>
      <div class="codeline" lg_zh="t_0e0bd8dd14954335a5bd10fbf3de3032">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//做一些愚蠢的数学来演示小数
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue(rownum * 10000 + cellnum</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> + (((double) rownum / 1000)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> + ((double) cellnum / 10000)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String cellValue;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a string cell (see why += 2 in the</span>
      </div>
      <div class="codeline" lg_zh="t_ff42b1c1ff98433faeb4948888ec6224">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个字符串单元格（请参阅为什么在
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c = r.createCell((short) (cellnum + 1));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // on every other row</span>
      </div>
      <div class="codeline" lg_zh="t_121c67651b0a4fb39131b63c289d2550">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//每隔一行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if ((rownum % 2) == 0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // set this cell to the first cell style we defined</span>
      </div>
      <div class="codeline" lg_zh="t_20b623f734844d92af5b9cca37a97d04">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将此单元格设置为我们定义的第一个单元格样式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellStyle(cs);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // set the cell's string value to "Test"</span>
      </div>
      <div class="codeline" lg_zh="t_b3c4393c5f804d7b9879a90bff2f1eb9">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将单元格的字符串值设置为“Test”
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue( "Test" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellStyle(cs2);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // set the cell's string value to "\u0422\u0435\u0441\u0442"</span>
      </div>
      <div class="codeline" lg_zh="t_773e2f6fbca4464790930874985ac340">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将单元格的字符串值设置为“\u0422\u0435\u0441\u0442”
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellValue( "\u0422\u0435\u0441\u0442" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // make this column a bit wider</span>
      </div>
      <div class="codeline" lg_zh="t_500d1d5fda5945c0a08f2d3c350bf577">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//让这一栏宽一点
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> s.setColumnWidth((short) (cellnum + 1), (short) ((50 * 8) / ((double) 1 / 20)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//draw a thick black border on the row at the bottom using BLANKS</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// advance 2 rows</span>
      </div>
      <div class="codeline" lg_zh="t_19fd8a5e1709422ebdb1719d8d99fc6c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用BLANKS在底部的行上绘制一个厚厚的黑色边框
//前进2行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rownum++;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rownum++;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r = s.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// define the third style to be the default</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// except with a thick black border at the bottom</span>
      </div>
      <div class="codeline" lg_zh="t_bf7a46f148804ddc8e0de8bd9abbc3ed">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//定义第三种样式作为默认样式
//除了底部有厚厚的黑色边框
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs3.setBorderBottom(cs3.BORDER_THICK);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create 50 cells</span>
      </div>
      <div class="codeline" lg_zh="t_f8f3165b750042e09e9fcde8f90574b0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建50个单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (short cellnum = (short) 0; cellnum &lt; 50; cellnum++)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //create a blank type cell (no value)</span>
      </div>
      <div class="codeline" lg_zh="t_8f3b7b439475490c9f63ec4e0d113933">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建空白类型单元格（无值）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c = r.createCell(cellnum);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // set it to the thick black border style</span>
      </div>
      <div class="codeline" lg_zh="t_69183678b79342d6a66662933627e2f3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置为粗黑边框风格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> c.setCellStyle(cs3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//end draw thick black border</span>
      </div>
      <div class="codeline" lg_zh="t_037e430e1693486d98d746aa8a8a7efc">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//结束绘制厚厚的黑色边框
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// demonstrate adding/naming and deleting a sheet</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a sheet, set its title then delete it</span>
      </div>
      <div class="codeline" lg_zh="t_08d671d6c7284e11b09ed779284efbe8">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//演示添加/命名和删除工作表
//创建一个工作表，设置其标题，然后删除它
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setSheetName(1, "DeletedSheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.removeSheetAt(1);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//end deleted sheet</span>
      </div>
      <div class="codeline" lg_zh="t_7150532fdd544079914f91d817380ff6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//结束已删除的表格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// write the workbook to the output stream</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// close our file (don't blow out our file handles</span>
      </div>
      <div class="codeline" lg_zh="t_33f93a202e8a48bdb9f0ad9301c193a5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将工作簿写入输出流
//关闭我们的文件（不要炸毁我们的文件手柄
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Reading+or+modifying+an+existing+file"></a>
     <h4><span lg_en="t_d11140df03cf42ec9bc4c1fc9a0ddaeb">Reading or modifying an existing file</span><span class="tscolor" lg_zh="t_d11140df03cf42ec9bc4c1fc9a0ddaeb"><span lg_kh="1">(</span>读取或修改现有文件<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_2deba91b8ca74d358b07abc252e40452">Reading in a file is equally simple. To read in a file, create a new instance of org.apache.poi.poifs.Filesystem, passing in an open InputStream, such as a FileInputStream for your XLS, to the constructor. Construct a new instance of org.apache.poi.hssf.usermodel.HSSFWorkbook passing the Filesystem instance to the constructor. From there you have access to all of the high level model objects through their assessor methods (workbook.getSheet(sheetNum), sheet.getRow(rownum), etc).</span><span class="tscolor" lg_zh="t_2deba91b8ca74d358b07abc252e40452"><span lg_kh="1">(</span>读入文件同样简单。要读入文件，先创建 org.apache.poi.poifs.Filesystem 的新实例，将InputStream（例如XLS的FileInputStream）传递给构造函数。再把Filesystem 实例传递给构造函数，构造一个新的 org.apache.poi.hssf.usermodel.HSSFWorkbook 实例。从那里您可以通过他们的评估方法（workbook.getSheet(sheetNum)、sheet.getRow(rownum) 等）访问所有高级模型对象。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4be3f32465fb474f9eb597310a8545c5">Modifying the file you have read in is simple. You retrieve the object via an assessor method, remove it via a parent object's remove method (sheet.removeRow(hssfrow)) and create objects just as you would if creating a new xls. When you are done modifying cells just call workbook.write(outputstream) just as you did above.</span><span class="tscolor" lg_zh="t_4be3f32465fb474f9eb597310a8545c5"><span lg_kh="1">(</span>修改读入的文件很简单。您可以通过评估器方法检索对象，通过父对象的删除方法 (sheet.removeRow(hssfrow)) 将其删除，然后像创建新 xls 一样创建对象。完成修改单元格后，只需像上面那样调用 workbook.write(outputstream) 即可。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_3a649f740b6f4b3983ee6672aba4b8b8">An example of this can be seen in <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/hssf/usermodel/HSSFReadWrite.java">org.apache.poi.hssf.usermodel.examples.HSSFReadWrite</a>.</span><span class="tscolor" lg_zh="t_3a649f740b6f4b3983ee6672aba4b8b8"><span lg_kh="1">(</span>在 <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/hssf/usermodel/HSSFReadWrite.java" style="color:blue;" target="_blank">org.apache.poi.hssf.usermodel.examples.HSSFReadWrite</a> 中有一个例子可以参考。<span lg_kh="1">)</span></span></p>
     <a name="event_api" id="event_api"></a><a name="Event+API+%28HSSF+Only%29"></a>
     <h3 class="boxed"><span lg_en="t_34c7c014a7ec4991bb1d3c2421ee0087">Event API (HSSF Only)</span><span class="tscolor" lg_zh="t_34c7c014a7ec4991bb1d3c2421ee0087"><span lg_kh="1">(</span>Event API（仅限 HSSF）<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_f8e79bc09a00493380e08dd14c98fb3b">The event API is newer than the User API. It is intended for intermediate developers who are willing to learn a little bit of the low level API structures. Its relatively simple to use, but requires a basic understanding of the parts of an Excel file (or willingness to learn). The advantage provided is that you can read an XLS with a relatively small memory footprint.</span><span class="tscolor" lg_zh="t_f8e79bc09a00493380e08dd14c98fb3b"><span lg_kh="1">(</span>事件 API 比用户 API 更新。它适用于想要学习一点低级 API 结构的中级开发人员。它使用起来相对简单，但需要对 Excel 文件的各个部分有基本的了解（或想要学习）。它的优势是您可以使用相对较小的内存占用读取XLS。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_fd21c6ec59bd4e7fb6d4482fbc3b35ff">One important thing to note with the basic Event API is that it triggers events only for things actually stored within the file. With the XLS file format, it is quite common for things that have yet to be edited to simply not exist in the file. This means there may well be apparent "gaps" in the record stream, which you either need to work around, or use the <a href="#record_aware_event_api">Record Aware</a> extension to the Event API.</span><span class="tscolor" lg_zh="t_fd21c6ec59bd4e7fb6d4482fbc3b35ff"><span lg_kh="1">(</span>使用基础的Event API 需要注意的一件重要事情是，它只对文件中实际存储的内容触发事件。对于 XLS 文件格式，尚未编辑的内容不存在于文件中是很常见的。这意味着记录流中很可能存在明显的“差距”，您需要解决这些问题或者使用 Event API 的<a href="#record_aware_event_api" style="color:blue;">Record Aware</a>扩展。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a555e75b0434441ba4737efba939c13f">To use this API you construct an instance of org.apache.poi.hssf.eventmodel.HSSFRequest. Register a class you create that supports the org.apache.poi.hssf.eventmodel.HSSFListener interface using the HSSFRequest.addListener(yourlistener, recordsid). The recordsid should be a static reference number (such as BOFRecord.sid) contained in the classes in org.apache.poi.hssf.record. The trick is you have to know what these records are. Alternatively you can call HSSFRequest.addListenerForAllRecords(mylistener). In order to learn about these records you can either read all of the javadoc in the org.apache.poi.hssf.record package or you can just hack up a copy of org.apache.poi.hssf.dev.EFHSSF and adapt it to your needs. TODO: better documentation on records.</span><span class="tscolor" lg_zh="t_a555e75b0434441ba4737efba939c13f"><span lg_kh="1">(</span>要使用此API，您需要构建org.apache.poi.hssf.eventmodel.HSSFRequest的实例，并使用 HSSFRequest.addListener(yourlistener, recordsid) 注册您的实现了org.apache.poi.hssf.eventmodel.HSSFListener 接口的类。recordsid 应当是包含在 org.apache.poi.hssf.record 中的类中的静态引用数值（例如 BOFRecord.sid）。您必须知道这些记录是什么，或者，您可以调用 HSSFRequest.addListenerForAllRecords(mylistener)。为了了解这些记录，您可以阅读 org.apache.poi.hssf.record 包中的所有 javadoc，或者您可以直接破解 org.apache.poi.hssf.dev.EFHSSF 的副本并根据您的需要对其进行修改。 TODO：更好的记录文档。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1a63eb2dfea9447db2df159c04b4305a">Once you've registered your listeners in the HSSFRequest object you can construct an instance of org.apache.poi.poifs.filesystem.FileSystem (see POIFS howto) and pass it your XLS file inputstream. You can either pass this, along with the request you constructed, to an instance of HSSFEventFactory via the HSSFEventFactory.processWorkbookEvents(request, Filesystem) method, or you can get an instance of DocumentInputStream from Filesystem.createDocumentInputStream("Workbook") and pass it to HSSFEventFactory.processEvents(request, inputStream). Once you make this call, the listeners that you constructed receive calls to their processRecord(Record) methods with each Record they are registered to listen for until the file has been completely read.</span><span class="tscolor" lg_zh="t_1a63eb2dfea9447db2df159c04b4305a"><span lg_kh="1">(</span>一旦你在 HSSFRequest 对象中注册了你的监听器，你就可以构造一个 org.apache.poi.poifs.filesystem.FileSystem 的实例（参见 POIFS howto）并将它传递给你的 XLS 文件输入流。您可以通过 HSSFEventFactory.processWorkbookEvents(request, Filesystem) 方法将此连同您构造的请求一起传递给 HSSFEventFactory 的实例，或者您可以从 Filesystem.createDocumentInputStream(&quot;Workbook&quot;) 获取 DocumentInputStream 的实例并把它传递到 HSSFEventFactory.processEvents(request, inputStream)。进行此调用后，您构建的侦听器将收到对其 processRecord(Record) 方法的调用，其中每个 Record 都会被侦听，直到文件被完全读取。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_85403a5c39f44778963f945cb668bb95">A code excerpt from org.apache.poi.hssf.dev.EFHSSF (which is in CVS or the source distribution) is reprinted below with excessive comments:</span><span class="tscolor" lg_zh="t_85403a5c39f44778963f945cb668bb95"><span lg_kh="1">(</span>org.apache.poi.hssf.dev.EFHSSF 的代码摘录（在 CVS 或源代码分发中）在下面列出，并带有很多注释：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">/**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * This example shows how to use the event API for reading a file.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_15b7c58f4d3342f4aa6f8f42206ab58d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* 此示例展示如何使用事件API读取文件。
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public class EventExample</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> implements HSSFListener</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private SSTRecord sstrec;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> /**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * This method listens for incoming records and handles them as required.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param record The record that was found while reading.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_71d72b3578b64ec69046c8e09d0a2f69">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* 此方法监听输入的记录并根据需要处理它们。
* @param Record阅读时发现的记录。
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void processRecord(Record record)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> switch (record.getSid())</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // the BOFRecord can represent either the beginning of a sheet or the workbook</span>
      </div>
      <div class="codeline" lg_zh="t_6b663767c8fc4b6a9d9dbd612be746ee">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//BOFRecord可以代表工作表的开始或工作簿
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case BOFRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BOFRecord bof = (BOFRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (bof.getType() == bof.TYPE_WORKBOOK)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Encountered workbook");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // assigned to the class level member</span>
      </div>
      <div class="codeline" lg_zh="t_af6478a07a924f918215c5141de82b73">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//分配给班级级别成员
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (bof.getType() == bof.TYPE_WORKSHEET)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Encountered sheet reference");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case BoundSheetRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BoundSheetRecord bsr = (BoundSheetRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("New sheet named: " + bsr.getSheetname());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case RowRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> RowRecord rowrec = (RowRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Row found, first column at "</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> + rowrec.getFirstCol() + " last column at " + rowrec.getLastCol());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case NumberRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> NumberRecord numrec = (NumberRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Cell found with value " + numrec.getValue()</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> + " at row " + numrec.getRow() + " and column " + numrec.getColumn());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // SSTRecords store a array of unique strings used in Excel.</span>
      </div>
      <div class="codeline" lg_zh="t_a3e1fc236dd94eef86847d784d49ae64">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// SSTRecords存储Excel中使用的唯一字符串数组。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case SSTRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> sstrec = (SSTRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int k = 0; k &lt; sstrec.getNumUniqueStrings(); k++)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("String table value " + k + " = " + sstrec.getString(k));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case LabelSSTRecord.sid:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> LabelSSTRecord lrec = (LabelSSTRecord) record;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("String cell found with value "</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> + sstrec.getString(lrec.getSSTIndex()));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> /**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * Read an excel file and spit out what we find.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> *</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param args Expect one argument that is the file to read.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @throws IOException When there is an error processing the file.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_abdf6b13fa3e445f86722955a06874e6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* 阅读Excel文件并说出我们发现的内容。
*
* @param args预计要读取的文件有一个参数。
* @ throughes IOResponse处理文件时出现错误。
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public static void main(String[] args) throws IOException</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a new file input stream with the input file specified</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // at the command line</span>
      </div>
      <div class="codeline" lg_zh="t_841587a5d5e8406aac7f70f96512e044">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用指定的输入文件创建一个新的文件输入流
//在命令行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileInputStream fin = new FileInputStream(args[0]);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create a new org.apache.poi.poifs.filesystem.Filesystem</span>
      </div>
      <div class="codeline" lg_zh="t_5a39e4ddfc25474cbdec73b45b1108a4">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个新的org.apache.poi.poifs.filesystem. Filesbitum
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> POIFSFileSystem poifs = new POIFSFileSystem(fin);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // get the Workbook (excel part) stream in a InputStream</span>
      </div>
      <div class="codeline" lg_zh="t_c38cfaaaa67b49c2982f3e4b86038667">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在InputStream中获取Workbook（excel部分）流
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputStream din = poifs.createDocumentInputStream("Workbook");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // construct out HSSFRequest object</span>
      </div>
      <div class="codeline" lg_zh="t_f0cb588adee14ac1b324726845db86ee">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//构造出HSSF请求对象
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFRequest req = new HSSFRequest();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // lazy listen for ALL records with the listener shown above</span>
      </div>
      <div class="codeline" lg_zh="t_a6416f2e6e504cf3be8b217154b79e2a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//用上面显示的监听器懒惰地监听所有记录
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> req.addListenerForAllRecords(new EventExample());</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // create our event factory</span>
      </div>
      <div class="codeline" lg_zh="t_2cc9d688042c41728b780d1f027ce29f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建我们的活动工厂
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFEventFactory factory = new HSSFEventFactory();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // process our events based on the document input stream</span>
      </div>
      <div class="codeline" lg_zh="t_f6701e571b89443b87839e97fde4e2dc">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//根据文档输入流处理我们的事件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> factory.processEvents(req, din);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // once all the events are processed close our file input stream</span>
      </div>
      <div class="codeline" lg_zh="t_d385c93892bd49cdae4f5a7f5d47d8fe">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//处理完所有事件后，关闭我们的文件输入流
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> fin.close();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // and our document input stream (don't want to leak these!)</span>
      </div>
      <div class="codeline" lg_zh="t_f160a750835c4d379f243a9e140858bb">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//和我们的文档输入流（不想泄露这些！）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> din.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("done.");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <a name="record_aware_event_api" id="record_aware_event_api"></a><a name="Record+Aware+Event+API+%28HSSF+Only%29"></a>
     <h3 class="boxed"><span lg_en="t_672b77334b774c5ba360976e8bbcf20a">Record Aware Event API (HSSF Only)</span><span class="tscolor" lg_zh="t_672b77334b774c5ba360976e8bbcf20a"><span lg_kh="1">(</span>记录感知事件 API（仅限 HSSF）<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_63a0f48fd7504f9bb6137fc2d8a74c57">This is an extension to the normal <a href="#event_api">Event API</a>. With this, your listener will be called with extra, dummy records. These dummy records should alert you to records which aren't present in the file (eg cells that have yet to be edited), and allow you to handle these.</span><span class="tscolor" lg_zh="t_63a0f48fd7504f9bb6137fc2d8a74c57"><span lg_kh="1">(</span>这是对普通<a href="#event_api" style="color:blue;">Event API</a> 的扩展。这样，您的监听器将被额外的虚拟记录调用。这些虚拟记录应当提醒您文件中不存在的记录（例如，尚未编辑的单元格），并允许您处理这些记录。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_773ccd29fdb04e799bc98cb8df8cd53a">There are three dummy records that your HSSFListener will be called with:</span><span class="tscolor" lg_zh="t_773ccd29fdb04e799bc98cb8df8cd53a"><span lg_kh="1">(</span>您的 HSSFListener 将调用三个虚拟记录：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_36f5efec564144b29dee6cc4976f2ef3">org.apache.poi.hssf.eventusermodel.dummyrecord.MissingRowDummyRecord 
        <br> This is called during the row record phase (which typically occurs before the cell records), and indicates that the row record for the given row is not present in the file.</span><span class="tscolor" lg_zh="t_36f5efec564144b29dee6cc4976f2ef3"><span lg_kh="1">(</span>org.apache.poi.hssf.eventusermodel.dummyrecord.MissingRowDummyRecord在行记录阶段（通常发生在单元格记录之前）被调用，并指示给定行的行记录不存在于文件中。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1637885c7c4c4d80acfe016aed9b97e4">org.apache.poi.hssf.eventusermodel.dummyrecord.MissingCellDummyRecord 
        <br> This is called during the cell record phase. It is called when a cell record is encountered which leaves a gap between it an the previous one. You can get multiple of these, before the real cell record.</span><span class="tscolor" lg_zh="t_1637885c7c4c4d80acfe016aed9b97e4"><span lg_kh="1">(</span>org.apache.poi.hssf.eventusermodel.dummyrecord.MissingCellDummyRecord在单元记录阶段被调用。当遇到与前一个单元格记录之间存在差距的单元格记录时调用它。在真正的单元格记录之前，您可以获得其中的多个。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_6940a90a0a064161b619c5357e7ff2e3">org.apache.poi.hssf.eventusermodel.dummyrecord.LastCellOfRowDummyRecord 
        <br> This is called after the last cell of a given row. It indicates that there are no more cells for the row, and also tells you how many cells you have had. For a row with no cells, this will be the only record you get.</span><span class="tscolor" lg_zh="t_6940a90a0a064161b619c5357e7ff2e3"><span lg_kh="1">(</span>org.apache.poi.hssf.eventusermodel.dummyrecord.LastCellOfRowDummyRecord在给定行的最后一个单元格之后调用。它表示该行没有更多单元格，并且还告诉您有多少个单元格。对于没有单元格的行，这将是您获得的唯一记录。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_e9d89217bd774135aa3f3db946352e33">To use the Record Aware Event API, you should create an org.apache.poi.hssf.eventusermodel.MissingRecordAwareHSSFListener, and pass it your HSSFListener. Then, register the MissingRecordAwareHSSFListener to the event model, and start that as normal.</span><span class="tscolor" lg_zh="t_e9d89217bd774135aa3f3db946352e33"><span lg_kh="1">(</span>要使用 Record Aware Event API，您应该创建一个 org.apache.poi.hssf.eventusermodel.MissingRecordAwareHSSFListener，并将其传递给您的 HSSFListener。然后，将 MissingRecordAwareHSSFListener 注册到事件模型，并正常启动。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8df76f54ba414d22b934f3ed144e1c36">One example use for this API is to write a CSV outputter, which always outputs a minimum number of columns, even where the file doesn't contain some of the rows or cells. It can be found at <span class="codefrag">/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java</span>, and may be called on the command line, or from within your own code. The latest version is always available from <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/">subversion</a>.</span><span class="tscolor" lg_zh="t_8df76f54ba414d22b934f3ed144e1c36"><span lg_kh="1">(</span>此 API 的一个示例用途是编写一个 CSV 输出器，它始终输出最少数量的列，即使文件不包含某些行或单元格。它可以在 /src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java 中找到，并且可以在命令行上或从您自己的代码中调用。最新版本总是可以从 <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/" style="color:blue;" target="_blank">subversion</a>获得。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_3a98d73e15d840c294a33e5dabc3dd6a"><em>In POI versions before 3.0.3, this code lived in the scratchpad section. If you're using one of these older versions of POI, you will either need to include the scratchpad jar on your classpath, or build from a</em> <a href="../../devel/subversion.html">subversion checkout</a>.</span><span class="tscolor" lg_zh="t_3a98d73e15d840c294a33e5dabc3dd6a"><span lg_kh="1">(</span>在 3.0.3 之前的 POI 版本中，此代码位于scratchpad部分。如果您使用这些旧版本的 POI 之一，您将需要在类路径中包含scratchpad jar，或者从<a href="https://poi.apache.org/devel/subversion.html" style="color:blue;" target="_blank">subversion checkout</a>构建。<span lg_kh="1">)</span></span></p>
     <a name="xssf_sax_api" id="xssf_sax_api"></a><a name="XSSF+and+SAX+%28Event+API%29"></a>
     <h3 class="boxed"><span lg_en="t_0f941cdffa2046989ae73478abc181be">XSSF and SAX (Event API)</span><span class="tscolor" lg_zh="t_0f941cdffa2046989ae73478abc181be"><span lg_kh="1">(</span><a href="#xssf_sax_api" style="color:blue;">XSSF and SAX (Event API)</a><span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_d66a15a1fa8c4c359b6cf0bd6e811433">If memory footprint is an issue, then for XSSF, you can get at the underlying XML data, and process it yourself. This is intended for intermediate developers who are willing to learn a little bit of low level structure of .xlsx files, and who are happy processing XML in java. Its relatively simple to use, but requires a basic understanding of the file structure. The advantage provided is that you can read a XLSX file with a relatively small memory footprint.</span><span class="tscolor" lg_zh="t_d66a15a1fa8c4c359b6cf0bd6e811433"><span lg_kh="1">(</span>如果内存占用是一个问题，那么对于 XSSF，您可以获取底层 XML 数据，并自己处理它。这适用于愿意学习一点 .xlsx 文件的低级结构并且乐于在 java 中处理 XML 的中级开发人员。它使用起来相对简单，但需要对文件结构有基本的了解。提供的优势是您可以用相对较小的内存占用读取XLSX文件。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a3d5f53263664635946f0da3db93ff5d">One important thing to note with the basic Event API is that it triggers events only for things actually stored within the file. With the XLSX file format, it is quite common for things that have yet to be edited to simply not exist in the file. This means there may well be apparent "gaps" in the record stream, which you need to work around.</span><span class="tscolor" lg_zh="t_a3d5f53263664635946f0da3db93ff5d"><span lg_kh="1">(</span>使用基础Event API 需要注意的一件重要事情，它只为文件中实际存储的内容触发事件。对于 XLSX 文件格式，尚未编辑的内容在文件中不存在是很常见的。这意味着记录流中很可能存在明显的“差距”，您需要解决这些问题。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c52aa874b6da41749f123101ff81a017">To use this API you construct an instance of org.apache.poi.xssf.eventmodel.XSSFReader. This will optionally provide a nice interface on the shared strings table, and the styles. It provides methods to get the raw xml data from the rest of the file, which you will then pass to SAX.</span><span class="tscolor" lg_zh="t_c52aa874b6da41749f123101ff81a017"><span lg_kh="1">(</span>要使用此 API，您需要构建 org.apache.poi.xssf.eventmodel.XSSFReader 的实例。它在共享字符串表和样式上提供了一个很好的接口。它提供了从文件的其余部分获取原始 xml 数据的方法，然后将其传递给 SAX。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_b26bef4a34ee4b8492f378f985f767a9">This example shows how to get at a single known sheet, or at all sheets in the file. It is based on the example in <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/eventusermodel/FromHowTo.java">svn src/examples/src/org/apache/poi/examples/xssf/eventusermodel/FromHowTo.java</a></span><span class="tscolor" lg_zh="t_b26bef4a34ee4b8492f378f985f767a9"><span lg_kh="1">(</span>此示例展示如何获取单个已知工作表或文件中的所有工作表。它基于<a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/eventusermodel/FromHowTo.java" style="color:blue;" target="_blank">svn src/examples/src/org/apache/poi/examples/xssf/eventusermodel/FromHowTo.java</a>中的示例<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.io.InputStream;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import java.util.Iterator;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.util.XMLHelper;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.openxml4j.opc.OPCPackage;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.xssf.eventusermodel.XSSFReader;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.apache.poi.xssf.model.SharedStringsTable;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.Attributes;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.ContentHandler;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.InputSource;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.SAXException;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.XMLReader;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import org.xml.sax.helpers.DefaultHandler;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">import javax.xml.parsers.ParserConfigurationException;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public class ExampleEventUserModel {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void processOneSheet(String filename) throws Exception {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage pkg = OPCPackage.open(filename);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFReader r = new XSSFReader( pkg );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SharedStringsTable sst = r.getSharedStringsTable();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XMLReader parser = fetchSheetParser(sst);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // To look up the Sheet Name / Sheet Order / rID,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // you need to process the core Workbook stream.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Normally it's of the form rId# or rSheet#</span>
      </div>
      <div class="codeline" lg_zh="t_a2371d0363aa4d7f89f6097ed2212988">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//要查找工作表名称/工作表顺序/ rID，
//您需要处理核心工作簿流。
//通常它的形式为rId#或rSheet#
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputStream sheet2 = r.getSheet("rId2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputSource sheetSource = new InputSource(sheet2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> parser.parse(sheetSource);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> sheet2.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void processAllSheets(String filename) throws Exception {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage pkg = OPCPackage.open(filename);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFReader r = new XSSFReader( pkg );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SharedStringsTable sst = r.getSharedStringsTable();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XMLReader parser = fetchSheetParser(sst);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Iterator&lt;InputStream&gt; sheets = r.getSheetsData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> while(sheets.hasNext()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Processing new sheet:\n");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputStream sheet = sheets.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputSource sheetSource = new InputSource(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> parser.parse(sheetSource);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> sheet.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public XMLReader fetchSheetParser(SharedStringsTable sst) throws SAXException, ParserConfigurationException {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XMLReader parser = XMLHelper.newXMLReader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ContentHandler handler = new SheetHandler(sst);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> parser.setContentHandler(handler);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return parser;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> /**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * See org.xml.sax.helpers.DefaultHandler javadocs</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_5ad3b82f2e5d4b459ed29f169fd0ef47">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* 请参阅org. xl.sax.helpers.默认javadocs
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private static class SheetHandler extends DefaultHandler {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private SharedStringsTable sst;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private String lastContents;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private boolean nextIsString;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> private SheetHandler(SharedStringsTable sst) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> this.sst = sst;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void startElement(String uri, String localName, String name,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Attributes attributes) throws SAXException {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // c =&gt; cell</span>
      </div>
      <div class="codeline" lg_zh="t_654c1715f72b45a89dfe2a970db175a5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// c =>细胞
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(name.equals("c")) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Print the cell reference</span>
      </div>
      <div class="codeline" lg_zh="t_c5812e2532a34fc98a380a476556c414">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//打印单元格引用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.print(attributes.getValue("r") + " - ");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Figure out if the value is an index in the SST</span>
      </div>
      <div class="codeline" lg_zh="t_d2fa5ff6eebb4a19885638869255456b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//弄清楚该值是否是CST中的指数
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String cellType = attributes.getValue("t");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(cellType != null &amp;&amp; cellType.equals("s")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> nextIsString = true;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> nextIsString = false;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Clear contents cache</span>
      </div>
      <div class="codeline" lg_zh="t_694f68fe42894be08c645cf5c728b706">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//清除内容缓存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> lastContents = "";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void endElement(String uri, String localName, String name)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throws SAXException {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Process the last contents as required.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do now, as characters() may be called more than once</span>
      </div>
      <div class="codeline" lg_zh="t_a3aa1cb53ddb4df5b31e217238465cf1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//根据需要处理最后的内容。
//立即执行，因为characters（）可能会被多次调用
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(nextIsString) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> int idx = Integer.parseInt(lastContents);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> lastContents = sst.getItemAt(idx).getString();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> nextIsString = false;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // v =&gt; contents of a cell</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Output after we've seen the string contents</span>
      </div>
      <div class="codeline" lg_zh="t_852db4b31cda45178d6a356b3ec0f855">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// v =>单元格的内容
//看到字符串内容后输出
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(name.equals("v")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(lastContents);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public void characters(char[] ch, int start, int length) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> lastContents += new String(ch, start, length);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public static void main(String[] args) throws Exception {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ExampleEventUserModel example = new ExampleEventUserModel();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> example.processOneSheet(args[0]);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> example.processAllSheets(args[0]);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_6cd5e3c0c8dd4a469f05e0fd95d54438">For a fuller example, including support for fetching number formatting information and applying it to numeric cells (eg to format dates or percentages), please see <a href="https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/eventusermodel/XLSX2CSV.java">the XLSX2CSV example in svn</a></span><span class="tscolor" lg_zh="t_6cd5e3c0c8dd4a469f05e0fd95d54438"><span lg_kh="1">(</span>有关更完整的示例，包括支持获取数字格式信息并将其应用于数字单元格（例如格式化日期或百分比），请参阅 svn 中的 <a href="https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/eventusermodel/XLSX2CSV.java" style="color:blue;" target="_blank">XLSX2CSV  示例</a><span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_494e27c08bf1474bb15b11890b30b869">An example is also <a href="https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/streaming/HybridStreaming.java">provided</a> showing how to combine the user API and the SAX API by doing a streaming parse of larger worksheets and a traditional user-model parse of the rest of a workbook.</span><span class="tscolor" lg_zh="t_494e27c08bf1474bb15b11890b30b869"><span lg_kh="1">(</span>还提供了一个<a href="https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xssf/streaming/HybridStreaming.java" style="color:blue;" target="_blank">示例</a>，展示了如何通过对较大的工作表进行流式解析和对工作簿的其余部分进行传统的用户模型解析来组合用户 API 和 SAX API。<span lg_kh="1">)</span></span></p>
     <a name="sxssf" id="sxssf"></a><a name="SXSSF+%28Streaming+Usermodel+API%29"></a>
     <h3 class="boxed"><span lg_en="t_caa732a5aa5a498c98ccdce021abdbbd">SXSSF (Streaming Usermodel API)</span><span class="tscolor" lg_zh="t_caa732a5aa5a498c98ccdce021abdbbd"><span lg_kh="1">(</span>SXSSF（流式Usermodel API）<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_060d3c833ef540ce9ca74828a6dd18b0">SXSSF (package: org.apache.poi.xssf.streaming) is an API-compatible streaming extension of XSSF to be used when very large spreadsheets have to be produced, and heap space is limited. SXSSF achieves its low memory footprint by limiting access to the rows that are within a sliding window, while XSSF gives access to all rows in the document. Older rows that are no longer in the window become inaccessible, as they are written to the disk.</span><span class="tscolor" lg_zh="t_060d3c833ef540ce9ca74828a6dd18b0"><span lg_kh="1">(</span>SXSSF（包：org.apache.poi.xssf.streaming）是 XSSF 的 API 兼容的流式扩展，在必须生成非常大的电子表格并且堆空间有限时使用。 SXSSF 通过限制对滑动窗口内行的访问来实现其低内存占用，而 XSSF 允许访问文档中的所有行。不在窗口中的旧行会变得不可访问，因为它们被写入了磁盘。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_835467f5fa9d46ca8a2e9a61753ed835">You can specify the window size at workbook construction time via <em>new SXSSFWorkbook(int windowSize)</em> or you can set it per-sheet via <em>SXSSFSheet#setRandomAccessWindowSize(int windowSize)</em></span><span class="tscolor" lg_zh="t_835467f5fa9d46ca8a2e9a61753ed835"><span lg_kh="1">(</span>您可以通过 new SXSSFWorkbook(int windowSize) 在工作簿构建时指定窗口大小，也可以通过 SXSSFSheet#setRandomAccessWindowSize(int windowSize) 为每个工作表设置它<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0534cf3cba6c4901aeb909eeabf6f763">When a new row is created via createRow() and the total number of unflushed records would exceed the specified window size, then the row with the lowest index value is flushed and cannot be accessed via getRow() anymore.</span><span class="tscolor" lg_zh="t_0534cf3cba6c4901aeb909eeabf6f763"><span lg_kh="1">(</span>当通过 createRow() 创建新行并且未刷新的记录总数将超过指定的窗口大小时，索引值最低的行将被刷新并且不能再通过 getRow() 访问。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_fd53f8b02d01422e89633c8ca9956ce5">The default window size is <em>100</em> and defined by SXSSFWorkbook.DEFAULT_WINDOW_SIZE.</span><span class="tscolor" lg_zh="t_fd53f8b02d01422e89633c8ca9956ce5"><span lg_kh="1">(</span>默认窗口大小为 100，由 SXSSFWorkbook.DEFAULT_WINDOW_SIZE 定义。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1cc6066c5f0d44099a08b961b6f9d915">A windowSize of -1 indicates unlimited access. In this case all records that have not been flushed by a call to flushRows() are available for random access.</span><span class="tscolor" lg_zh="t_1cc6066c5f0d44099a08b961b6f9d915"><span lg_kh="1">(</span>windowSize值为-1时表示无限制访问。在这种情况下，所有未通过调用 flushRows() 刷新的记录都可用于随机访问。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f3f611f28180440486a4570108867d25">Note that SXSSF allocates temporary files that you <strong>must</strong> always clean up explicitly, by calling the dispose method.</span><span class="tscolor" lg_zh="t_f3f611f28180440486a4570108867d25"><span lg_kh="1">(</span>请注意，SXSSF会分配临时文件，您必须始终通过调用dispose方法来明确清理这些文件。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_584a4733bc7441e3b1de4d1f5a277e42">SXSSFWorkbook defaults to using inline strings instead of a shared strings table. This is very efficient, since no document content needs to be kept in memory, but is also known to produce documents that are incompatible with some clients. With shared strings enabled all unique strings in the document has to be kept in memory. Depending on your document content this could use a lot more resources than with shared strings disabled.</span><span class="tscolor" lg_zh="t_584a4733bc7441e3b1de4d1f5a277e42"><span lg_kh="1">(</span>SXSSFWorkbook 默认使用内联字符串而不是共享字符串表。这是非常高效的，因为不需要将文档内容保存在内存中，众所周知的事，它生成的文档与某些客户端不兼容。启用共享字符串后，文档中的所有唯一字符串都必须保存在内存中。与禁用共享字符串相比，根据您的文档内容，这可能会占用更多的资源。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_63ee3516854946f98d2e4afe733363cb">Please note that there are still things that still may consume a large amount of memory based on which features you are using, e.g. merged regions, hyperlinks, comments, ... are still only stored in memory and thus may require a lot of memory if used extensively.</span><span class="tscolor" lg_zh="t_63ee3516854946f98d2e4afe733363cb"><span lg_kh="1">(</span>请注意，根据您使用的功能，有一些东西可能会消耗大量内存，例如合并区域、超链接、注释……存储在内存中。因此如果要广泛使用，可能需要大量内存。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d1653074b31a4bf5adcab835f22d09fd">Carefully review your memory budget and compatibility needs before deciding whether to enable shared strings or not.</span><span class="tscolor" lg_zh="t_d1653074b31a4bf5adcab835f22d09fd"><span lg_kh="1">(</span>在决定是否启用共享字符串之前，请仔细检查您的内存预算和兼容性需求。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_170374ca7b414889ae1779af1dd72489">The example below writes a sheet with a window of 100 rows. When the row count reaches 101, the row with rownum=0 is flushed to disk and removed from memory, when rownum reaches 102 then the row with rownum=1 is flushed, etc.</span><span class="tscolor" lg_zh="t_170374ca7b414889ae1779af1dd72489"><span lg_kh="1">(</span>下面的示例编写了一个具有 100 行窗口的工作表。当行数达到 101 时，rownum=0 的行被刷新到磁盘并从内存中删除，当 rownum 达到 102 时，rownum=1 的行被刷新，以此类推。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport junit.framework.Assert;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Row;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Sheet;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Workbook;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.util.CellReference;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.xssf.streaming.SXSSFWorkbook;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public static void main(String[] args) throws Throwable {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFWorkbook wb = new SXSSFWorkbook(100); //<span><span lg_en="t_ffade02b68c041aab8edafd7306b2bf6">keep 100 rows in memory, exceeding rows will be flushed to disk</span><span class="tscolor" lg_zh="t_ffade02b68c041aab8edafd7306b2bf6"><span lg_kh="1">(</span>在内存中保留100行，超出的行将刷新到磁盘<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sh = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 0; rownum &lt; 1000; rownum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sh.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int cellnum = 0; cellnum &lt; 10; cellnum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String address = new CellReference(cell).formatAsString();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue(address);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Rows with rownum &lt; 900 are flushed and not accessible</span>
      </div>
      <div class="codeline" lg_zh="t_4bd57b88e4be45118c9f46d21f544e6e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//rownum < 900的收件箱已刷新且不可访问
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 0; rownum &lt; 900; rownum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Assert.assertNull(sh.getRow(rownum));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // ther last 100 rows are still in memory</span>
      </div>
      <div class="codeline" lg_zh="t_658e0839da6346a18f811769ef394311">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//最后100行仍在内存中
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 900; rownum &lt; 1000; rownum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Assert.assertNotNull(sh.getRow(rownum));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileOutputStream out = new FileOutputStream("/temp/sxssf.xlsx");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // dispose of temporary files backing this workbook on disk</span>
      </div>
      <div class="codeline" lg_zh="t_adb94516fc954c298eaa498240635440">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//处理磁盘上支持此工作簿的临时文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.dispose();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_4ed6f93ac21d4b6388edb85e6e24a09a">The next example turns off auto-flushing (windowSize=-1) and the code manually controls how portions of data are written to disk</span><span class="tscolor" lg_zh="t_4ed6f93ac21d4b6388edb85e6e24a09a"><span lg_kh="1">(</span>下一个示例关闭自动刷新 (windowSize=-1)，代码手动控制部分数据写入磁盘的方式<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Row;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Sheet;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.usermodel.Workbook;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.ss.util.CellReference;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">mport org.apache.poi.xssf.streaming.SXSSFWorkbook;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public static void main(String[] args) throws Throwable {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFWorkbook wb = new SXSSFWorkbook(-1); //<span><span lg_en="t_b9687bb45f5d41b2b299e4ee732062a7">turn off auto-flushing and accumulate all rows in memory</span><span class="tscolor" lg_zh="t_b9687bb45f5d41b2b299e4ee732062a7"><span lg_kh="1">(</span>关闭自动刷新并在内存中累积所有行<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sh = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int rownum = 0; rownum &lt; 1000; rownum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sh.createRow(rownum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for(int cellnum = 0; cellnum &lt; 10; cellnum++){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(cellnum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String address = new CellReference(cell).formatAsString();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue(address);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // manually control how rows are flushed to disk </span>
      </div>
      <div class="codeline" lg_zh="t_8ef31b972bea4907b7a703c876002a13">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//手动控制行如何刷新到磁盘
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(rownum % 100 == 0) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">((SXSSFSheet)sh).flushRows(100); //<span><span lg_en="t_a78faad6aeed404b8af7dfc197a1cb01">retain 100 last rows and flush all others</span><span class="tscolor" lg_zh="t_a78faad6aeed404b8af7dfc197a1cb01"><span lg_kh="1">(</span>保留最后100行并刷新所有其他行<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // ((SXSSFSheet)sh).flushRows() is a shortcut for ((SXSSFSheet)sh).flushRows(0),</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // this method flushes all rows</span>
      </div>
      <div class="codeline" lg_zh="t_685ec0c548f441738cb5f3e7087c4847">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//（（SXSSFsheet）sh）. flushspel（）是（（SXSSFsheet）sh）. flushspel（0）的快捷方式，
//此方法刷新所有行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> FileOutputStream out = new FileOutputStream("/temp/sxssf.xlsx");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // dispose of temporary files backing this workbook on disk</span>
      </div>
      <div class="codeline" lg_zh="t_20c10660b56e4422b74c87973c71392c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//处理磁盘上支持此工作簿的临时文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.dispose();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_bed7309fa74147ff925aaa3e1837b55f">SXSSF flushes sheet data in temporary files (a temp file per sheet) and the size of these temporary files can grow to a very large value. For example, for a 20 MB csv data the size of the temp xml becomes more than a gigabyte. If the size of the temp files is an issue, you can tell SXSSF to use gzip compression:</span><span class="tscolor" lg_zh="t_bed7309fa74147ff925aaa3e1837b55f"><span lg_kh="1">(</span>SXSSF 刷新临时文件中的工作表数据（每个工作表一个临时文件），这些临时文件的大小可以增长到一个非常大的值。例如，对于 20 MB 的 csv 数据，临时 xml 的大小变得超过 1 GB。如果临时文件的大小有问题，您可以告诉 SXSSF 使用 gzip 压缩：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFWorkbook wb = new SXSSFWorkbook(); </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setCompressTempFiles(true); //<span><span lg_en="t_2c90836640884a86b165ede73b450c10">temp files will be gzipped</span><span class="tscolor" lg_zh="t_2c90836640884a86b165ede73b450c10"><span lg_kh="1">(</span>临时文件将被压缩<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="low_level_api" id="low_level_api"></a><a name="Low+Level+APIs"></a>
     <h3 class="boxed"><span lg_en="t_1775000756a6462b890902193f03cc3e">Low Level APIs</span><span class="tscolor" lg_zh="t_1775000756a6462b890902193f03cc3e"><span lg_kh="1">(</span>低级 API<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_9ab411c6c1864f22990a2fabd43bc927">The low level API is not much to look at. It consists of lots of "Records" in the org.apache.poi.hssf.record.* package, and set of helper classes in org.apache.poi.hssf.model.*. The record classes are consistent with the low level binary structures inside a BIFF8 file (which is embedded in a POIFS file system). You probably need the book: "Microsoft Excel 97 Developer's Kit" from Microsoft Press in order to understand how these fit together (out of print but easily obtainable from Amazon's used books). In order to gain a good understanding of how to use the low level APIs should view the source in org.apache.poi.hssf.usermodel.* and the classes in org.apache.poi.hssf.model.*. You should read the documentation for the POIFS libraries as well.</span><span class="tscolor" lg_zh="t_9ab411c6c1864f22990a2fabd43bc927"><span lg_kh="1">(</span>低级API没什么可看的。它由org.apache.poi.hssf.record.*包中的许多“记录”以及org.apache.poi.hssf.model.*中的帮助程序类集组成。记录类与BIFF8文件（嵌入POIFS文件系统）中的低级二进制结构一致。您可能需要这本书：Microsoft Press的“ Microsoft Excel 97开发人员工具包”，以了解它们的组合方式（绝版但可从Amazon的二手书中获得）。为了更好地了解如何使用低级API，您应当查看org.apache.poi.hssf.usermodel.*中的源代码以及org.apache.poi.hssf.model.*中的类。您还应该阅读POIFS库的文档。<span lg_kh="1">)</span></span></p>
     <a name="Generating+XLS+from+XML"></a>
     <h3 class="boxed"><span lg_en="t_07bdd3009db140cab9831e84fca17e45">Generating XLS from XML</span><span class="tscolor" lg_zh="t_07bdd3009db140cab9831e84fca17e45"><span lg_kh="1">(</span>从 XML 生成 XLS<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_5d35f5df4e5c4679ada7cee6dedc2988">If you wish to generate an XLS file from some XML, it is possible to write your own XML processing code, then use the User API to write out the document.</span><span class="tscolor" lg_zh="t_5d35f5df4e5c4679ada7cee6dedc2988"><span lg_kh="1">(</span>如果您希望从一些 XML 生成 XLS 文件，可以编写自己的 XML 处理代码，然后使用User API 来写出文档。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_fbf46a4e9ea84558ba0611bf5667055d">The other option is to use <a href="http://cocoon.apache.org/">Cocoon</a>. In Cocoon, there is the <a href="http://cocoon.apache.org/2.1/userdocs/xls-serializer.html">HSSF Serializer</a>, which takes in XML (in the gnumeric format), and outputs an XLS file for you.</span><span class="tscolor" lg_zh="t_fbf46a4e9ea84558ba0611bf5667055d"><span lg_kh="1">(</span>另一种选择是使用 <a href="http://cocoon.apache.org/" style="color:blue" target="_blank">Cocoon</a>。在 Cocoon 中，有一个 <a href="http://cocoon.apache.org/2.1/userdocs/xls-serializer.html" style="color:blue" target="_blank">HSSF Serializer</a>，它接收 XML（以 gnumeric 格式），并为您输出一个 XLS 文件。<span lg_kh="1">)</span></span></p>
     <a name="HSSF+Class%2FTest+Application"></a>
     <h3 class="boxed"><span lg_en="t_b2018df2a7864edfafa6d342fe49a9dd">HSSF Class/Test Application</span><span class="tscolor" lg_zh="t_b2018df2a7864edfafa6d342fe49a9dd"><span lg_kh="1">(</span>HSSF 类/测试应用<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_5c9269084bcd42e1b9101db7240b9f0d">The HSSF application is nothing more than a test for the high level API (and indirectly the low level support). The main body of its code is repeated above. To run it:</span><span class="tscolor" lg_zh="t_5c9269084bcd42e1b9101db7240b9f0d"><span lg_kh="1">(</span>HSSF 应用程序只不过是对高级 API 的测试（以及间接的低级支持）。上面重复了它的代码主体。要运行它：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_9bb5429382af4610af7d1628216f7e3e">download the poi-alpha build and untar it (tar xvzf tarball.tar.gz)</span><span class="tscolor" lg_zh="t_9bb5429382af4610af7d1628216f7e3e"><span lg_kh="1">(</span>下载 poi-alpha 构建并解压它 (tar xvzf tarball.tar.gz)<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d75af3aeea0145a999a601a1e657adb5">set up your classpath as follows: <span class="codefrag">export HSSFDIR={wherever you put HSSF's jar files} export LOG4JDIR={wherever you put LOG4J's jar files} export CLASSPATH=$CLASSPATH:$HSSFDIR/hssf.jar:$HSSFDIR/poi-poifs.jar:$HSSFDIR/poi-util.jar:$LOG4JDIR/jog4j.jar</span></span><span class="tscolor" lg_zh="t_d75af3aeea0145a999a601a1e657adb5"><span lg_kh="1">(</span>如下设置您的类路径： export HSSFDIR={无论您将 HSSF 的 jar 文件放在哪里} export LOG4JDIR={无论您将 LOG4J 的 jar 文件放在哪里} export CLASSPATH=$CLASSPATH:$HSSFDIR/hssf.jar:$HSSFDIR/poi-poifs.jar:$HSSFDIR/poi-util.jar:$LOG4JDIR/jog4j.jar<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_f4e5cb8796434984837448939579aefa">type: <span class="codefrag">java org.apache.poi.hssf.dev.HSSF ~/myxls.xls write</span></span><span class="tscolor" lg_zh="t_f4e5cb8796434984837448939579aefa"><span lg_kh="1">(</span>类型：java org.apache.poi.hssf.dev.HSSF ~/myxls.xls write<span lg_kh="1">)</span></span></li>
     </ul>
     <p></p>
     <p><span lg_en="t_ce253d66659d478f8ec1b258433790bd">This should generate a test sheet in your home directory called <span class="codefrag">"myxls.xls"</span>.</span><span class="tscolor" lg_zh="t_ce253d66659d478f8ec1b258433790bd"><span lg_kh="1">(</span>这应当在您的主目录中生成一个名为“myxls.xls”的测试表。<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_06ade8301d3f482d8cfc4c0223ca5655">Type: <span class="codefrag">java org.apache.poi.hssf.dev.HSSF ~/input.xls output.xls</span> 
        <br> 
        <br> This is the read/write/modify test. It reads in the spreadsheet, modifies a cell, and writes it back out. Failing this test is not necessarily a bad thing. If HSSF tries to modify a non-existant sheet then this will most likely fail. No big deal.</span><span class="tscolor" lg_zh="t_06ade8301d3f482d8cfc4c0223ca5655"><span lg_kh="1">(</span>类型：java org.apache.poi.hssf.dev.HSSF ~/input.xls output.xls <br>
这是读/写/修改测试。它读入电子表格，修改单元格，然后将其写回。没通过测试不一定是坏事。如果 HSSF尝试修改不存在的工作表，那么这很可能会失败。没什么大不了的。<span lg_kh="1">)</span></span></li>
     </ul>
     <a name="HSSF+Developer%27s+Tools"></a>
     <h3 class="boxed"><span lg_en="t_ca262e609ae645f6855368a4c36cc5cd">HSSF Developer's Tools</span><span class="tscolor" lg_zh="t_ca262e609ae645f6855368a4c36cc5cd"><span lg_kh="1">(</span>HSSF 开发者工具<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_b23080d000bb42939eefea6a0e0383a0">HSSF has a number of tools useful for developers to debug/develop stuff using HSSF (and more generally XLS files). We've already discussed the app for testing HSSF read/write/modify capabilities; now we'll talk a bit about BiffViewer. Early on in the development of HSSF, it was decided that knowing what was in a record, what was wrong with it, etc. was virtually impossible with the available tools. So we developed BiffViewer. You can find it at org.apache.poi.hssf.dev.BiffViewer. It performs two basic functions and a derivative.</span><span class="tscolor" lg_zh="t_b23080d000bb42939eefea6a0e0383a0"><span lg_kh="1">(</span>HSSF具有许多对开发人员有用的工具，这些工具可用于使用HSSF（以及常见的XLS文件）调试/开发内容。我们已经讨论过用于测试HSSF读/写/修改功能的应用程序；现在我们来谈谈BiffViewer。在开发HSSF的早期，用现有的工具几乎不可能知道记录中的内容，出了什么问题等。因此，我们开发了BiffViewer。您可以在org.apache.poi.hssf.dev.BiffViewer中找到它。它拥有两个基本功能和一个派生物。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c84367c3a6a04e438c89ba2607fee4c3">The first is "biffview". To do this you run it (assumes you have everything setup in your classpath and that you know what you're doing enough to be thinking about this) with an xls file as a parameter. It will give you a listing of all understood records with their data and a list of not-yet-understood records with no data (because it doesn't know how to interpret them). This listing is useful for several things. First, you can look at the values and SEE what is wrong in quasi-English. Second, you can send the output to a file and compare it.</span><span class="tscolor" lg_zh="t_c84367c3a6a04e438c89ba2607fee4c3"><span lg_kh="1">(</span>第一个是“biffview”。所以，您可以使用 xls 文件作为参数运行它（假设您已在类路径中设置了所有内容，并且您知道自己在做什么）。它将为您提供所有已了解的记录及其数据列表和尚未理解的无数据记录列表（因为它不知道如何解释它们）。这个清单对几件事很有用。首先，您可以查看这些值并查看准英语有什么问题。其次，您可以输出到文件并进行比较。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_6b453a3124584e9abf8df56859e208a6">The second function is "big freakin dump", just pass a file and a second argument matching "bfd" exactly. This will just make a big hexdump of the file.</span><span class="tscolor" lg_zh="t_6b453a3124584e9abf8df56859e208a6"><span lg_kh="1">(</span>第二个函数是“big freakin dump”，只需传递一个文件和一个与“bfd”完全匹配的参数。这将使文件变成一个大的hexdump。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_786a733ce07a451ca9a2726db611e2ab">Lastly, there is "mixed" mode which does the same as regular biffview, only it includes hex dumps of certain records intertwined. To use that just pass a file with a second argument matching "on" exactly.</span><span class="tscolor" lg_zh="t_786a733ce07a451ca9a2726db611e2ab"><span lg_kh="1">(</span>最后，有一种“混合”模式，它与常规的 biffview 相同，只是它包含某些交织在一起的记录的十六进制转储。要使用它，只需传递一个与“on”完全匹配的文件(第二个参数)。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_973b9a99b59b49fab9f57c76195637df">In the next release cycle we'll also have something called a FormulaViewer. The class is already there, but its not very useful yet. When it does something, we'll document it.</span><span class="tscolor" lg_zh="t_973b9a99b59b49fab9f57c76195637df"><span lg_kh="1">(</span>在下一个发布周期中，我们还将拥有一个叫做 FormulaViewer 的东西。该类已经存在，但还没什么卵用。等它干活时，我们会记录。<span lg_kh="1">)</span></span></p>
     <a name="What%27s+Next%3F"></a>
     <h3 class="boxed"><span lg_en="t_3e8729012bc544d798dd10abf5b6365d">What's Next?</span><span class="tscolor" lg_zh="t_3e8729012bc544d798dd10abf5b6365d"><span lg_kh="1">(</span>下一步是什么？<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_90cfe14d30a04a1c95fbc1217f771c4b">Further effort on HSSF is going to focus on the following major areas:</span><span class="tscolor" lg_zh="t_90cfe14d30a04a1c95fbc1217f771c4b"><span lg_kh="1">(</span>HSSF 的进一步研发将集中在以下主要领域：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_e828567df3d3451f9fa0ab315917d5f1">Performance: POI currently uses a lot of memory for large sheets.</span><span class="tscolor" lg_zh="t_e828567df3d3451f9fa0ab315917d5f1"><span lg_kh="1">(</span>性能：POI 目前对大型工作表使用大量内存。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_fa60bc9315c74f7d9d3a146db086e347">Charts: This is a hard problem, with very little documentation.</span><span class="tscolor" lg_zh="t_fa60bc9315c74f7d9d3a146db086e347"><span lg_kh="1">(</span>图表：这是一个难题，文档很少。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_bffd42b5fa1a41a1b1787de96c184e8d"><a href="../../devel/guidelines.html"> So jump in! </a></span><span class="tscolor" lg_zh="t_bffd42b5fa1a41a1b1787de96c184e8d"><span lg_kh="1">(</span><a href="https://poi.apache.org/devel/guidelines.html">点这里！</a><span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_aeecd0e2a6f042219ddb9fbb2ab2f4a1"><font size="-2">by&nbsp;Andrew C. Oliver,&nbsp;Glen Stampoultzis,&nbsp;Nick Burch,&nbsp;Sergei Kozello</font></span><span class="tscolor" lg_zh="t_aeecd0e2a6f042219ddb9fbb2ab2f4a1"><span lg_kh="1">(</span>作者：Andrew C. Oliver、Glen Stampoultzis、Nick Burch、Sergei Kozello<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/how-to.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>