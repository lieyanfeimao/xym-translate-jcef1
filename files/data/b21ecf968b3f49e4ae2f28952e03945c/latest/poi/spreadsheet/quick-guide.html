<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Busy Developers' Guide to HSSF and XSSF Features</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_242a0fdae48546d5880f0d484a151c33">Busy Developers' Guide to HSSF and XSSF Features</span><span class="tscolor" lg_zh="t_242a0fdae48546d5880f0d484a151c33"><span lg_kh="1">(</span>给忙成狗的开发者的HSSF和XSSF功能指南<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="Busy+Developers%27+Guide+to+Features"></a>
    <h2 class="boxed"><span lg_en="t_62233788c88f46f49546162d6ea5767d">Busy Developers' Guide to Features</span><span class="tscolor" lg_zh="t_62233788c88f46f49546162d6ea5767d"><span lg_kh="1">(</span>给忙成狗的开发者的HSSF和XSSF功能指南<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_081e01465031486188e799cbb1cfd462">Want to use HSSF and XSSF read and write spreadsheets in a hurry? This guide is for you. If you're after more in-depth coverage of the HSSF and XSSF user-APIs, please consult the <a href="how-to.html">HOWTO</a> guide as it contains actual descriptions of how to use this stuff.</span><span class="tscolor" lg_zh="t_081e01465031486188e799cbb1cfd462"><span lg_kh="1">(</span>想要快速使用 HSSF 和 XSSF 读写电子表格？本指南适合您。如果您想要更深入地了解 HSSF 和 XSSF 用户 API，请参阅<a href="how-to.html" style="color:blue;">HOWTO</a>指南，因为它包含有关如何使用这些内容的描述。<span lg_kh="1">)</span></span></p>
     <a name="Index+of+Features"></a>
     <h3 class="boxed"><span lg_en="t_8c33887641db4bf8892c72155232e15a">Index of Features</span><span class="tscolor" lg_zh="t_8c33887641db4bf8892c72155232e15a"><span lg_kh="1">(</span>特征索引<span lg_kh="1">)</span></span></h3>
     <ul>
      <li><span lg_en="t_e8e02a8b4b6d43d8ace2b60ab508a054"><a href="#NewWorkbook">How to create a new workbook</a></span><span class="tscolor" lg_zh="t_e8e02a8b4b6d43d8ace2b60ab508a054"><span lg_kh="1">(</span><a href="#NewWorkbook" style="color:blue;">如何创建新工作簿</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_c3311b89aebf4007bc8e27e9b5d2ee7e"><a href="#NewSheet">How to create a sheet</a></span><span class="tscolor" lg_zh="t_c3311b89aebf4007bc8e27e9b5d2ee7e"><span lg_kh="1">(</span><a href="#NewSheet" style="color:blue;">如何创建工作表</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_18e5583b80ec4941ae941bc1bb21eef8"><a href="#CreateCells">How to create cells</a></span><span class="tscolor" lg_zh="t_18e5583b80ec4941ae941bc1bb21eef8"><span lg_kh="1">(</span><a href="#CreateCells" style="color:blue;">如何创建单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_717700a732cd4b9eaaba02ec2754540e"><a href="#CreateDateCells">How to create date cells</a></span><span class="tscolor" lg_zh="t_717700a732cd4b9eaaba02ec2754540e"><span lg_kh="1">(</span><a href="#CreateDateCells" style="color:blue;">如何创建日期单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a084697c444b42669154adafb630c6cc"><a href="#CellTypes">Working with different types of cells</a></span><span class="tscolor" lg_zh="t_a084697c444b42669154adafb630c6cc"><span lg_kh="1">(</span><a href="#CellTypes" style="color:blue;">使用不同类型的单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d7b54d0a74fa4de0845c3655df38d1d9"><a href="#Iterator">Iterate over rows and cells</a></span><span class="tscolor" lg_zh="t_d7b54d0a74fa4de0845c3655df38d1d9"><span lg_kh="1">(</span><a href="#Iterator" style="color:blue;">迭代行和单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_03dc211bcc4d450892d32ef1255e3b34"><a href="#CellContents">Getting the cell contents</a></span><span class="tscolor" lg_zh="t_03dc211bcc4d450892d32ef1255e3b34"><span lg_kh="1">(</span><a href="#CellContents" style="color:blue;">获取单元格内容</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_80a63339de194a1a9a0e19c084186f75"><a href="#TextExtraction">Text Extraction</a></span><span class="tscolor" lg_zh="t_80a63339de194a1a9a0e19c084186f75"><span lg_kh="1">(</span><a href="#TextExtraction" style="color:blue;">文本提取</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d9a15d4501ae4920904cc030f47a8042"><a href="#FileInputStream">Files vs InputStreams</a></span><span class="tscolor" lg_zh="t_d9a15d4501ae4920904cc030f47a8042"><span lg_kh="1">(</span><a href="#FileInputStream" style="color:blue;">文件与输入流</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d1fc46a34fda4239842532b5f65f0d81"><a href="#Alignment">Aligning cells</a></span><span class="tscolor" lg_zh="t_d1fc46a34fda4239842532b5f65f0d81"><span lg_kh="1">(</span><a href="#Alignment" style="color:blue;">对齐单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_ce82697547794426a553109b4da25b57"><a href="#Borders">Working with borders</a></span><span class="tscolor" lg_zh="t_ce82697547794426a553109b4da25b57"><span lg_kh="1">(</span><a href="#Borders" style="color:blue;">使用边框</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_c2b8dd559ef44997b8638f78cd53dfa6"><a href="#FillsAndFrills">Fills and color</a></span><span class="tscolor" lg_zh="t_c2b8dd559ef44997b8638f78cd53dfa6"><span lg_kh="1">(</span><a href="#FillsAndFrills" style="color:blue;">填充和颜色</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_deebd3988c5648eab5cf55ad8911a596"><a href="#MergedCells">Merging cells</a></span><span class="tscolor" lg_zh="t_deebd3988c5648eab5cf55ad8911a596"><span lg_kh="1">(</span><a href="#MergedCells" style="color:blue;">合并单元格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a3a1bfa8a4814a4f8625bc55a5e9530a"><a href="#WorkingWithFonts">Working with fonts</a></span><span class="tscolor" lg_zh="t_a3a1bfa8a4814a4f8625bc55a5e9530a"><span lg_kh="1">(</span><a href="#WorkingWithFonts" style="color:blue;">使用字体</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_96dc099431b645fb991624fbcfb7df00"><a href="#CustomColors">Custom colors</a></span><span class="tscolor" lg_zh="t_96dc099431b645fb991624fbcfb7df00"><span lg_kh="1">(</span><a href="#CustomColors" style="color:blue;">自定义颜色</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_138236c44b474ff9b44b73f190f94d05"><a href="#ReadWriteWorkbook">Reading and writing</a></span><span class="tscolor" lg_zh="t_138236c44b474ff9b44b73f190f94d05"><span lg_kh="1">(</span><a href="#ReadWriteWorkbook" style="color:blue;">读和写</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_868dfcddba4a4685b91bfe94990bc499"><a href="#NewLinesInCells">Use newlines in cells.</a></span><span class="tscolor" lg_zh="t_868dfcddba4a4685b91bfe94990bc499"><span lg_kh="1">(</span><a href="#NewLinesInCells" style="color:blue;">在单元格中使用换行符</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_fc34d73d4b4f4211aaaabb15a489401e"><a href="#DataFormats">Create user defined data formats</a></span><span class="tscolor" lg_zh="t_fc34d73d4b4f4211aaaabb15a489401e"><span lg_kh="1">(</span><a href="#DataFormats" style="color:blue;">创建用户定义的数据格式</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d6ec7540400b464f9935b6c6db68c013"><a href="#FitTo">Fit Sheet to One Page</a></span><span class="tscolor" lg_zh="t_d6ec7540400b464f9935b6c6db68c013"><span lg_kh="1">(</span><a href="#FitTo" style="color:blue;">将工作表设置为一页(打印设置)</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_147c3f6b2f8e480e977fc038efd0a14d"><a href="#PrintArea2">Set print area for a sheet</a></span><span class="tscolor" lg_zh="t_147c3f6b2f8e480e977fc038efd0a14d"><span lg_kh="1">(</span><a href="#PrintArea2" style="color:blue;">设置工作表的打印区域</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_c082f7e91cf049b0b4441a7746d1dd5a"><a href="#FooterPageNumbers">Set page numbers on the footer of a sheet</a></span><span class="tscolor" lg_zh="t_c082f7e91cf049b0b4441a7746d1dd5a"><span lg_kh="1">(</span><a href="#FooterPageNumbers" style="color:blue;">在工作表的页脚上设置页码</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b7b5fc78c3b54c92aafe22e9df1ea849"><a href="#ShiftRows">Shift rows</a></span><span class="tscolor" lg_zh="t_b7b5fc78c3b54c92aafe22e9df1ea849"><span lg_kh="1">(</span><a href="#ShiftRows" style="color:blue;">移动行</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_7a61db10a03e4838a37d647c40774cdf"><a href="#SelectSheet">Set a sheet as selected</a></span><span class="tscolor" lg_zh="t_7a61db10a03e4838a37d647c40774cdf"><span lg_kh="1">(</span><a href="#SelectSheet" style="color:blue;">将工作表设置为选中</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_727982c4e22b4ea18e5f0078dca98e7d"><a href="#Zoom">Set the zoom magnification for a sheet</a></span><span class="tscolor" lg_zh="t_727982c4e22b4ea18e5f0078dca98e7d"><span lg_kh="1">(</span><a href="#Zoom" style="color:blue;">设置工作表的缩放倍率</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e789a51805f141588b9e628c36bd0d5a"><a href="#Splits">Create split and freeze panes</a></span><span class="tscolor" lg_zh="t_e789a51805f141588b9e628c36bd0d5a"><span lg_kh="1">(</span><a href="#Splits" style="color:blue;">创建拆分和冻结窗格</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a4a8a786b9de40cca4e9bb3331170cfa"><a href="#Repeating">Repeating rows and columns</a></span><span class="tscolor" lg_zh="t_a4a8a786b9de40cca4e9bb3331170cfa"><span lg_kh="1">(</span><a href="#Repeating" style="color:blue;">重复行和列</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_14ea5d2d27a147d28ebecbcd1b746433"><a href="#HeaderFooter">Headers and Footers</a></span><span class="tscolor" lg_zh="t_14ea5d2d27a147d28ebecbcd1b746433"><span lg_kh="1">(</span><a href="#HeaderFooter" style="color:blue;">页眉和页脚</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a199ffd05a984d3bb5981f4e25ff4a74"><a href="#XSSFHeaderFooter">XSSF enhancement for Headers and Footers</a></span><span class="tscolor" lg_zh="t_a199ffd05a984d3bb5981f4e25ff4a74"><span lg_kh="1">(</span><a href="#XSSFHeaderFooter" style="color:blue;">页眉和页脚的XSSF增强</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8f7bb19b0bb84d77bbc16c84b9937ff7"><a href="#DrawingShapes">Drawing Shapes</a></span><span class="tscolor" lg_zh="t_8f7bb19b0bb84d77bbc16c84b9937ff7"><span lg_kh="1">(</span><a href="#DrawingShapes" style="color:blue;">绘制形状</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_72522bfe2c9a49d5a4c323f16ae54007"><a href="#StylingShapes">Styling Shapes</a></span><span class="tscolor" lg_zh="t_72522bfe2c9a49d5a4c323f16ae54007"><span lg_kh="1">(</span><a href="#StylingShapes" style="color:blue;">样式形状</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1f51342d03ab404f9fbdaee7e60dee32"><a href="#Graphics2d">Shapes and Graphics2d</a></span><span class="tscolor" lg_zh="t_1f51342d03ab404f9fbdaee7e60dee32"><span lg_kh="1">(</span><a href="#Graphics2d" style="color:blue;">形状和Graphics2d</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8f85a16d9a274b4686172b0040e1bde9"><a href="#Outlining">Outlining</a></span><span class="tscolor" lg_zh="t_8f85a16d9a274b4686172b0040e1bde9"><span lg_kh="1">(</span><a href="#Outlining" style="color:blue;">概述</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_f6fdbd05e0a24e5f8d634769bd7995ef"><a href="#Images">Images</a></span><span class="tscolor" lg_zh="t_f6fdbd05e0a24e5f8d634769bd7995ef"><span lg_kh="1">(</span><a href="#Images" style="color:blue;">图片</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e211d38b3c5b41be91cd0785c87901e3"><a href="#NamedRanges">Named Ranges and Named Cells</a></span><span class="tscolor" lg_zh="t_e211d38b3c5b41be91cd0785c87901e3"><span lg_kh="1">(</span><a href="#NamedRanges" style="color:blue;">范围命名和单元格命名</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_922630ba635e4ddf8efcafc86baafb6c"><a href="#CellComments">How to set cell comments</a></span><span class="tscolor" lg_zh="t_922630ba635e4ddf8efcafc86baafb6c"><span lg_kh="1">(</span><a href="#CellComments" style="color:blue;">如何设置单元格注释</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_72001d39a5ad4c95875785029237d78c"><a href="#Autofit">How to adjust column width to fit the contents</a></span><span class="tscolor" lg_zh="t_72001d39a5ad4c95875785029237d78c"><span lg_kh="1">(</span><a href="#Autofit" style="color:blue;">如何调整列宽以适应内容</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_339b37e89c5a42e498d9f4d7c004114b"><a href="#Hyperlinks">Hyperlinks</a></span><span class="tscolor" lg_zh="t_339b37e89c5a42e498d9f4d7c004114b"><span lg_kh="1">(</span><a href="#Hyperlinks" style="color:blue;">超链接</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_854727287d994c44be22d9dab90e8bd5"><a href="#Validation">Data Validations</a></span><span class="tscolor" lg_zh="t_854727287d994c44be22d9dab90e8bd5"><span lg_kh="1">(</span><a href="#Validation" style="color:blue;">数据验证</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_ec4d511c91ae49d79893d30785403dd7"><a href="#Embedded">Embedded Objects</a></span><span class="tscolor" lg_zh="t_ec4d511c91ae49d79893d30785403dd7"><span lg_kh="1">(</span><a href="#Embedded" style="color:blue;">嵌入对象</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_f82c6fdda7ff4ae6bfb9b3693c4679b4"><a href="#Autofilter">Autofilters</a></span><span class="tscolor" lg_zh="t_f82c6fdda7ff4ae6bfb9b3693c4679b4"><span lg_kh="1">(</span><a href="#Autofilter" style="color:blue;">自动过滤器</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d100d3cec9c9456689834c84607e18c2"><a href="#ConditionalFormatting">Conditional Formatting</a></span><span class="tscolor" lg_zh="t_d100d3cec9c9456689834c84607e18c2"><span lg_kh="1">(</span><a href="#ConditionalFormatting" style="color:blue;">条件格式</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9ebb9fbc532a406cb5af37fa74a6166a"><a href="#Hiding">Hiding and Un-Hiding Rows</a></span><span class="tscolor" lg_zh="t_9ebb9fbc532a406cb5af37fa74a6166a"><span lg_kh="1">(</span><a href="#Hiding" style="color:blue;">隐藏和显示隐藏行</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1f3283b83efb43828bcccc456f254549"><a href="#CellProperties">Setting Cell Properties</a></span><span class="tscolor" lg_zh="t_1f3283b83efb43828bcccc456f254549"><span lg_kh="1">(</span><a href="#CellProperties" style="color:blue;">设置单元格属性</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_11f0ef956f2d40c89dace7863f71edca"><a href="#DrawingBorders">Drawing Borders</a></span><span class="tscolor" lg_zh="t_11f0ef956f2d40c89dace7863f71edca"><span lg_kh="1">(</span><a href="#DrawingBorders" style="color:blue;">绘制边框</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_0b0504c45d9a43f68cad4d58165b8259"><a href="#PivotTable">Create a Pivot Table</a></span><span class="tscolor" lg_zh="t_0b0504c45d9a43f68cad4d58165b8259"><span lg_kh="1">(</span><a href="#PivotTable" style="color:blue;">创建数据透视表</a><span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_22d887bf3c5b4c4d80a90cb40193178a"><a href="#RichText">Cells with multiple styles</a></span><span class="tscolor" lg_zh="t_22d887bf3c5b4c4d80a90cb40193178a"><span lg_kh="1">(</span><a href="#RichText" style="color:blue;">具有多种样式的单元格</a><span lg_kh="1">)</span></span></li>
     </ul>
     <a name="Features"></a>
     <h3 class="boxed"><span lg_en="t_5a1a533ba26843f29b5c42255bc8244e">Features</span><span class="tscolor" lg_zh="t_5a1a533ba26843f29b5c42255bc8244e"><span lg_kh="1">(</span>特征<span lg_kh="1">)</span></span></h3>
     <a name="NewWorkbook" id="NewWorkbook"></a><a name="New+Workbook"></a>
     <h4><span lg_en="t_29283b9eb79444a4b86c369cb15b36bb">New Workbook</span><span class="tscolor" lg_zh="t_29283b9eb79444a4b86c369cb15b36bb"><span lg_kh="1">(</span>新工作簿<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">...</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="NewSheet" id="NewSheet"></a><a name="New+Sheet"></a>
     <h4><span lg_en="t_1b39d037708f4770ad0e57cbc3968651">New Sheet</span><span class="tscolor" lg_zh="t_1b39d037708f4770ad0e57cbc3968651"><span lg_kh="1">(</span>新工作表<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span><span lg_en="t_1e64cd35e08740959bd7f69fac61c59f">or new XSSFWorkbook();</span><span class="tscolor" lg_zh="t_1e64cd35e08740959bd7f69fac61c59f"><span lg_kh="1">(</span>或新的XSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("second sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note that sheet name is Excel must not exceed 31 characters</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// and must not contain any of the any of the following characters:</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 0x0000</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 0x0003</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// colon (:)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// backslash (\)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// asterisk (*)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// question mark (?)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// forward slash (/)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// opening square bracket ([)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// closing square bracket (])</span>
      </div>
      <div class="codeline" lg_zh="t_5477a6aeadc6472a9ac9822242e0aabf">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//请注意，表格名称为Excel不得超过31个字符
//并且不得包含以下任何字符：
//0x 0000
// 0x0003
// colon（：）
//反斜线（\）
//星号（*）
//问号（？）
//正斜线（/）
//正方括号（[）
//右方括号（]）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// You can use org.apache.poi.ss.util.WorkbookUtil#createSafeSheetName(String nameProposal)}</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// for a safe way to create valid names, this utility replaces invalid characters with a space (' ')</span>
      </div>
      <div class="codeline" lg_zh="t_0c53e4d15a5544669548c45c4f631bce">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//可以使用org.apache.poi.ss.util.WorkbookUtil#WorksafeSheetName（String nameProposal）}
//为了安全地创建有效名称，此实用程序将无效字符替换为空格（“”）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String safeName = WorkbookUtil.createSafeSheetName("[O'Brien's sales*?]"); //<span><span lg_en="t_e7c26643cca541b7aae7fb0a69c7304b">returns " O'Brien's sales "</span><span class="tscolor" lg_zh="t_e7c26643cca541b7aae7fb0a69c7304b"><span lg_kh="1">(</span>返回“O'Brien的销售“<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet3 = wb.createSheet(safeName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CreateCells" id="CreateCells"></a><a name="Creating+Cells"></a>
     <h4><span lg_en="t_bdb89f3e22b84025bfd29d0ed27b9436">Creating Cells</span><span class="tscolor" lg_zh="t_bdb89f3e22b84025bfd29d0ed27b9436"><span lg_kh="1">(</span>创建单元格<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_zh="t_9d22272bd2414a3b901e9b687ddbfc22">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//Workbook RST = new XSSFWorkbook（）;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div class="codeline" lg_zh="t_1f561bec6101407f81ea4c90efdecd91">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行并将一些单元格放入其中。收件箱以0为基础。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(0);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div class="codeline" lg_zh="t_cf566613fbee4503a65ec9342370a9cc">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个单元格并在其中添加值。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Or do it on one line.</span>
      </div>
      <div class="codeline" lg_zh="t_44ec31e27aa9457fbfc9156848a47f28">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//或者在一行上执行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(1).setCellValue(1.2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(2).setCellValue(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createRichTextString("This is a string"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(3).setCellValue(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_6e83fb500cff4880b72d0a879bce9a42">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CreateDateCells" id="CreateDateCells"></a><a name="Creating+Date+Cells"></a>
     <h4><span lg_en="t_47878dcc2454438895cfa8852b297c35">Creating Date Cells</span><span class="tscolor" lg_zh="t_47878dcc2454438895cfa8852b297c35"><span lg_kh="1">(</span>创建日期单元格<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline" lg_zh="t_b4219b57e2a24866be99f5cfa84044a2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//Workbook RST = new XSSFWorkbook（）;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div class="codeline" lg_zh="t_530127825f31405c94a1d6ee2d7400f6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行并将一些单元格放入其中。收件箱以0为基础。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a date value in it. The first cell is not styled</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// as a date.</span>
      </div>
      <div class="codeline" lg_zh="t_01cb4a8e4b764e54a237ca620fd477e9">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个单元格并在其中添加日期值。第一个单元格没有样式
//作为日期。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// we style the second cell as a date (and time). It is important to</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create a new cell style from the workbook otherwise you can end up</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// modifying the built in style and effecting not only this cell but other cells.</span>
      </div>
      <div class="codeline" lg_zh="t_b21dc5cc0c9f47daa3253ef6c868cc91">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//我们将第二个单元格设置为日期（和时间）的样式。重要的是要
//从工作簿中创建新的单元格样式，否则您最终可能会
//修改内置风格并不仅影响这个单元格，还影响其他单元格。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cellStyle = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cellStyle.setDataFormat(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createHelper.createDataFormat().getFormat("m/d/yy h:mm"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//you can also set date as java.util.Calendar</span>
      </div>
      <div class="codeline" lg_zh="t_b08430b080584f8a9a2eba5dfd629ba3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//您还可以将日期设置为java.util.Calendar
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(Calendar.getInstance());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_689392d8ec45455db78f07350265fed6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="CellTypes" id="CellTypes"></a><a name="Working+with+different+types+of+cells"></a>
     <h4><span lg_en="t_fd16d3be0fdc45d29798d98802644aac">Working with different types of cells</span><span class="tscolor" lg_zh="t_fd16d3be0fdc45d29798d98802644aac"><span lg_kh="1">(</span><a href="#CellTypes" style="color:blue;">使用不同类型的单元格</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(0).setCellValue(1.1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(1).setCellValue(new Date());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(2).setCellValue(Calendar.getInstance());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(3).setCellValue("a string");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(4).setCellValue(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.createCell(5).setCellType(CellType.ERROR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_dffa2681c19a4d52a0e47e50c6d34700">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FileInputStream" id="FileInputStream"></a><a name="Files+vs+InputStreams"></a>
     <h4><span lg_en="t_1186962294e74489930557470698cc45">Files vs InputStreams</span><span class="tscolor" lg_zh="t_1186962294e74489930557470698cc45"><span lg_kh="1">(</span><a href="#FileInputStream" style="color:blue;">文件与输入流</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_9835b2653edc41c2b0f54aaa24ab5f76">When opening a workbook, either a .xls HSSFWorkbook, or a .xlsx XSSFWorkbook, the Workbook can be loaded from either a <em>File</em> or an <em>InputStream</em>. Using a <em>File</em> object allows for lower memory consumption, while an <em>InputStream</em> requires more memory as it has to buffer the whole file.</span><span class="tscolor" lg_zh="t_9835b2653edc41c2b0f54aaa24ab5f76"><span lg_kh="1">(</span>打开工作簿(.xls HSSFWorkbook 或 .xlsx XSSFWorkbook)时，可以从File或InputStream加载工作簿。使用 File 对象可以降低内存消耗，而InputStream需要更多内存，因为它必须缓冲整个文件。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e257ed9da39047fba9a06a80478f025f">If using <em>WorkbookFactory</em>, it's very easy to use one or the other:</span><span class="tscolor" lg_zh="t_e257ed9da39047fba9a06a80478f025f"><span lg_kh="1">(</span>如果使用 WorkbookFactory，那么使用其中一个非常容易：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Use a file</span>
      </div>
      <div class="codeline" lg_zh="t_09f6d10608fc4cce82736a0746a16965">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = WorkbookFactory.create(new File("MyExcel.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Use an InputStream, needs more memory</span>
      </div>
      <div class="codeline" lg_zh="t_54b293309a5d41d4a0a342d9f0bb83e1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用InputStream，需要更多内存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = WorkbookFactory.create(new FileInputStream("MyExcel.xlsx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_c1d65cfe25e84e84947b2bbf551df7f5">If using <em>HSSFWorkbook</em> or <em>XSSFWorkbook</em> directly, you should generally go through <em>POIFSFileSystem</em> or <em>OPCPackage</em>, to have full control of the lifecycle (including closing the file when done):</span><span class="tscolor" lg_zh="t_c1d65cfe25e84e84947b2bbf551df7f5"><span lg_kh="1">(</span>如果直接使用 HSSFWorkbook 或 XSSFWorkbook，一般应该通过 POIFSFileSystem 或 OPCPackage 来完全控制生命周期（包括完成后关闭文件）：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSFWorkbook, File</span>
      </div>
      <div class="codeline" lg_zh="t_7b4061948d3a43d1a23b4c0afbff8c0a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// HSSFWorkbook，File
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(new File("file.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook(fs.getRoot(), true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fs.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSFWorkbook, InputStream, needs more memory</span>
      </div>
      <div class="codeline" lg_zh="t_219bb3fb207d446a805e9c951e7bb1d7">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// HSSFWorkbook，InputStream，需要更多内存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(myInputStream);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook(fs.getRoot(), true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSFWorkbook, File</span>
      </div>
      <div class="codeline" lg_zh="t_ab9688e324564a8790aade3d9fb0cd7e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//XSSF工作簿，文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OPCPackage pkg = OPCPackage.open(new File("file.xlsx"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook(pkg);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pkg.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSFWorkbook, InputStream, needs more memory</span>
      </div>
      <div class="codeline" lg_zh="t_cd94b18e9e9749b3ad29f715657f3044">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// XSSFWorkbook，InputStream，需要更多内存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OPCPackage pkg = OPCPackage.open(myInputStream);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook(pkg);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pkg.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Alignment" id="Alignment"></a><a name="Demonstrates+various+alignment+options"></a>
     <h4><span lg_en="t_f010317b63294c48b2205478d251b6eb">Demonstrates various alignment options</span><span class="tscolor" lg_zh="t_f010317b63294c48b2205478d251b6eb"><span lg_kh="1">(</span>演示各种对齐选项<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">public static void main(String[] args) throws Exception {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span><span lg_en="t_69a13a2eab02494bbaf98da0a656bbbc">or new HSSFWorkbook();</span><span class="tscolor" lg_zh="t_69a13a2eab02494bbaf98da0a656bbbc"><span lg_kh="1">(</span>或新的HSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row.setHeightInPoints(30);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 0, HorizontalAlignment.CENTER, VerticalAlignment.BOTTOM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 1, HorizontalAlignment.CENTER_SELECTION, VerticalAlignment.BOTTOM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 2, HorizontalAlignment.FILL, VerticalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 3, HorizontalAlignment.GENERAL, VerticalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 4, HorizontalAlignment.JUSTIFY, VerticalAlignment.JUSTIFY);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 5, HorizontalAlignment.LEFT, VerticalAlignment.TOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> createCell(wb, row, 6, HorizontalAlignment.RIGHT, VerticalAlignment.TOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_85ad5215eba0411983c7164b054f2a74">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream fileOut = new FileOutputStream("xssf-align.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">/**</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * Creates a cell and aligns it a certain way.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> *</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param wb the workbook</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param row the row to create the cell in</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param column the column number to create the cell in</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param halign the horizontal alignment for the cell.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> * @param valign the vertical alignment for the cell.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> */</span>
      </div>
      <div class="codeline" lg_zh="t_26d599dd901b43bbab963f725f8853c3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">/**
* 创建一个单元格并以某种方式对齐它。
*
* @param删除工作簿
* @param行要创建单元格的行
* @param列要在其中创建单元格的列号
* @param将单元格的水平对齐方式分开。
* @param验证单元格的垂直对齐方式。
*/
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">private static void createCell(Workbook wb, Row row, int column, HorizontalAlignment halign, VerticalAlignment valign) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(column);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("Align It");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle cellStyle = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cellStyle.setAlignment(halign);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cellStyle.setVerticalAlignment(valign);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(cellStyle);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Borders" id="Borders"></a><a name="Working+with+borders"></a>
     <h4><span lg_en="t_cd3dcbad4f424061b32b7902d02ffd7e">Working with borders</span><span class="tscolor" lg_zh="t_cd3dcbad4f424061b32b7902d02ffd7e"><span lg_kh="1">(</span><a href="#Borders" style="color:blue;">使用边框</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div class="codeline" lg_zh="t_5fc0ec66bc5b499f91a42aef75f724b1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行并将一些单元格放入其中。收件箱以0为基础。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div class="codeline" lg_zh="t_22923f0de06b4490b98ebf98fa479757">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个单元格并在其中添加值。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(4);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Style the cell with borders all around.</span>
      </div>
      <div class="codeline" lg_zh="t_97ffdd73494c458ead6b72baba71a22a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//为单元格设置四周有边界的样式。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderBottom(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBottomBorderColor(IndexedColors.BLACK.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderLeft(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setLeftBorderColor(IndexedColors.GREEN.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderRight(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setRightBorderColor(IndexedColors.BLUE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setBorderTop(BorderStyle.MEDIUM_DASHED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setTopBorderColor(IndexedColors.BLACK.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_ddcb409efcf649dbb209e49cff80f805">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Iterator" id="Iterator"></a><a name="Iterate+over+rows+and+cells"></a>
     <h4><span lg_en="t_bc948794a5fe4ebe814ea88eaf24335d">Iterate over rows and cells</span><span class="tscolor" lg_zh="t_bc948794a5fe4ebe814ea88eaf24335d"><span lg_kh="1">(</span><a href="#Iterator" style="color:blue;">迭代行和单元格</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_8adfa585ef544b60a15ab735e0dcca55">Sometimes, you'd like to just iterate over all the sheets in a workbook, all the rows in a sheet, or all the cells in a row. This is possible with a simple for loop.</span><span class="tscolor" lg_zh="t_8adfa585ef544b60a15ab735e0dcca55"><span lg_kh="1">(</span>有时，您只想遍历工作簿中的所有工作表、工作表中的所有行或一行中的所有单元格。这可以通过一个简单的 for 循环来实现。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_57f9d3218e8a431d8bb1ff44c04beba8">These iterators are available by calling <em>workbook.sheetIterator()</em>, <em>sheet.rowIterator()</em>, and <em>row.cellIterator()</em>, or implicitly using a for-each loop. Note that a rowIterator and cellIterator iterate over rows or cells that have been created, skipping empty rows and cells.</span><span class="tscolor" lg_zh="t_57f9d3218e8a431d8bb1ff44c04beba8"><span lg_kh="1">(</span>这些迭代器可通过调用 workbook.sheetIterator()、sheet.rowIterator() 和 row.cellIterator() 或隐式使用 for-each 循环获得。请注意，rowIterator 和 cellIterator 遍历已创建的行或单元格，跳过空行和单元格。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Sheet sheet : wb ) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Row row : sheet) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Cell cell : row) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something here</span>
      </div>
      <div class="codeline" lg_zh="t_f448edb3fd5d4a0186e8f93ca77cfb92">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在这里做点什么
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="Iterate+over+cells%2C+with+control+of+missing+%2F+blank+cells"></a>
     <h4><span lg_en="t_b4abc7b4286e4fa09b4ff99dc2686ee2">Iterate over cells, with control of missing / blank cells</span><span class="tscolor" lg_zh="t_b4abc7b4286e4fa09b4ff99dc2686ee2"><span lg_kh="1">(</span>迭代单元格，控制缺失/空白单元格<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_f298b0cc6a874488b489ef90c1d4afc3">In some cases, when iterating, you need full control over how missing or blank rows and cells are treated, and you need to ensure you visit every cell and not just those defined in the file. (The CellIterator will only return the cells defined in the file, which is largely those with values or stylings, but it depends on Excel).</span><span class="tscolor" lg_zh="t_f298b0cc6a874488b489ef90c1d4afc3"><span lg_kh="1">(</span>在某些情况下，在迭代时，您需要完全控制丢失或空白行和单元格的处理方式，并且您需要确保访问每个单元格，而不仅仅是文件中定义的单元格。 （CellIterator 将只返回文件中定义的单元格，主要是那些具有值或样式的单元格，这取决于 Excel）。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4c2c1724ca8d41608c702c0d25ed2529">In cases such as these, you should fetch the first and last column information for a row, then call <em>getCell(int, MissingCellPolicy)</em> to fetch the cell. Use a <a href="../../apidocs/dev/org/apache/poi/ss/usermodel/Row.MissingCellPolicy.html">MissingCellPolicy</a> to control how blank or null cells are handled.</span><span class="tscolor" lg_zh="t_4c2c1724ca8d41608c702c0d25ed2529"><span lg_kh="1">(</span>在这种情况下，您应该获取一行的第一列和最后一列信息，然后调用 getCell(int, MissingCellPolicy) 来获取单元格。使用 <a href="../../apidocs/org/apache/poi/ss/usermodel/Row.MissingCellPolicy.html" style="color:blue" target="_blank">MissingCellPolicy</a>控制如何处理空白或空单元格。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Decide which rows to process</span>
      </div>
      <div class="codeline" lg_zh="t_24a95faf914d401194dd0a460294385b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//决定要处理哪些行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowStart = Math.min(15, sheet.getFirstRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowEnd = Math.max(1400, sheet.getLastRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int rowNum = rowStart; rowNum &lt; rowEnd; rowNum++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = sheet.getRow(rowNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (r == null) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // This whole row is empty</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Handle it as needed</span>
      </div>
      <div class="codeline" lg_zh="t_58a8ed154338458c9b9eeddb9817bf9b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//这整行都是空的
//根据需要处理
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> continue;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> int lastColumn = Math.max(r.getLastCellNum(), MY_MINIMUM_COLUMN_COUNT);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int cn = 0; cn &lt; lastColumn; cn++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(cn, Row.RETURN_BLANK_AS_NULL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (c == null) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // The spreadsheet is empty in this cell</span>
      </div>
      <div class="codeline" lg_zh="t_4c27312c15894610afedf18a59c7214d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//此单元格中的电子表格为空
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something useful with the cell's contents</span>
      </div>
      <div class="codeline" lg_zh="t_3432214dc8994f07962b44dcc44b3f98">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//对单元格的内容执行一些有用的操作
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="CellContents" id="CellContents"></a><a name="Getting+the+cell+contents"></a>
     <h4><span lg_en="t_751ce994362b492eadf9bfe353f449a8">Getting the cell contents</span><span class="tscolor" lg_zh="t_751ce994362b492eadf9bfe353f449a8"><span lg_kh="1">(</span><a href="#CellContents" style="color:blue;">获取单元格内容</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_82352701030143f08f0af277e7418cb1">To get the contents of a cell, you first need to know what kind of cell it is (asking a string cell for its numeric contents will get you a NumberFormatException for example). So, you will want to switch on the cell's type, and then call the appropriate getter for that cell.</span><span class="tscolor" lg_zh="t_82352701030143f08f0af277e7418cb1"><span lg_kh="1">(</span>要获取单元格的内容，您首先需要知道它是什么类型的单元格（例如，向字符串单元格获取一个数字内容会得到一个 NumberFormatException）。因此，您需要获取单元格的类型，然后对该单元格调用适当的 getter方法。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a8562fa6fb184ac6abc8d685ed8ed9d9">In the code below, we loop over every cell in one sheet, print out the cell's reference (eg A3), and then the cell's contents.</span><span class="tscolor" lg_zh="t_a8562fa6fb184ac6abc8d685ed8ed9d9"><span lg_kh="1">(</span>在下面的代码中，我们循环遍历一张表中的每个单元格，打印出单元格的引用（例如A3、Sheet1!A3），然后打印出单元格的内容。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// import org.apache.poi.ss.usermodel.*;</span>
      </div>
      <div class="codeline" lg_zh="t_d7712335651e42019f50d4a3b89a5168">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//导入org. apache. poi.ss.usermodel. *;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataFormatter formatter = new DataFormatter();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Row row : sheet1) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Cell cell : row) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellReference cellRef = new CellReference(row.getRowNum(), cell.getColumnIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.print(cellRef.formatAsString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.print(" - ");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // get the text that appears in the cell by getting the cell value and applying any data formats (Date, 0.00, 1.23e9, $1.23, etc)</span>
      </div>
      <div class="codeline" lg_zh="t_70c2a9994dad4ff2a1829a3b7d9e1e69">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//通过获取单元格值并应用任何数据格式（Date，0.00，1.23e9，$1.23等）来获取单元格中出现的文本
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String text = formatter.formatCellValue(cell);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(text);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Alternatively, get the value and format it yourself</span>
      </div>
      <div class="codeline" lg_zh="t_61e6fbcc16814ec19903eb9dee8b8b73">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//或者，获取值并自行格式化
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> switch (cell.getCellType()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.STRING:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getRichStringCellValue().getString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.NUMERIC:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (DateUtil.isCellDateFormatted(cell)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getDateCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getNumericCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.BOOLEAN:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getBooleanCellValue());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.FORMULA:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(cell.getCellFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> case CellType.BLANK:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> break;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> default:</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <a name="TextExtraction" id="TextExtraction"></a><a name="Text+Extraction"></a>
     <h4><span lg_en="t_2568a1627ac74b3f87395dcd23eb89e1">Text Extraction</span><span class="tscolor" lg_zh="t_2568a1627ac74b3f87395dcd23eb89e1"><span lg_kh="1">(</span><a href="#TextExtraction" style="color:blue;">文本提取</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_7f6fe4848da547f291511b2e6bf66746">For most text extraction requirements, the standard ExcelExtractor class should provide all you need.</span><span class="tscolor" lg_zh="t_7f6fe4848da547f291511b2e6bf66746"><span lg_kh="1">(</span>对于大多数文本提取要求，标准 ExcelExtractor 类应该满足您的需要。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (InputStream inp = new FileInputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook wb = new HSSFWorkbook(new POIFSFileSystem(inp));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ExcelExtractor extractor = new ExcelExtractor(wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> extractor.setFormulasNotResults(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> extractor.setIncludeSheetNames(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String text = extractor.getText();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_b27ab018e5d044f6b28ad3dc2be1673b">For very fancy text extraction, XLS to CSV etc, take a look at <em>/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java</em></span><span class="tscolor" lg_zh="t_b27ab018e5d044f6b28ad3dc2be1673b"><span lg_kh="1">(</span>对于非常花哨的文本提取、XLS 到 CSV 等，请查看 /src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java<span lg_kh="1">)</span></span></p>
     <a name="FillsAndFrills" id="FillsAndFrills"></a><a name="Fills+and+colors"></a>
     <h4><span lg_en="t_3f31c95cb4c44f96be7560a796d4262f">Fills and colors</span><span class="tscolor" lg_zh="t_3f31c95cb4c44f96be7560a796d4262f"><span lg_kh="1">(</span>填充和颜色<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div class="codeline" lg_zh="t_92c2af35f2a24c43af37bc2c94357241">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行并将一些单元格放入其中。收件箱以0为基础。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Aqua background</span>
      </div>
      <div class="codeline" lg_zh="t_bc315792f8af458ba5964eff76c0f234">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Aqua背景
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillBackgroundColor(IndexedColors.AQUA.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.BIG_SPOTS);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("X");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Orange "foreground", foreground being the fill foreground not the font color.</span>
      </div>
      <div class="codeline" lg_zh="t_65b11970bfcd4d3aa890a0123acc888b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//橙色“前景”，前景是填充前景，而不是字体颜色。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillForegroundColor(IndexedColors.ORANGE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("X");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_cfb45adf0e544cefbc9d94ee0aa05abe">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="MergedCells" id="MergedCells"></a><a name="Merging+cells"></a>
     <h4><span lg_en="t_c270a5e55bc7475d8aa88c502e249003">Merging cells</span><span class="tscolor" lg_zh="t_c270a5e55bc7475d8aa88c502e249003"><span lg_kh="1">(</span><a href="#MergedCells" style="color:blue;">合并单元格</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("This is a test of merging");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addMergedRegion(new CellRangeAddress(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span><span lg_en="t_a8d673c23ac94dccb971fdef732451c6">first row (0-based)</span><span class="tscolor" lg_zh="t_a8d673c23ac94dccb971fdef732451c6"><span lg_kh="1">(</span>第一行（从0开始）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span><span lg_en="t_c7da2e0829494d3ea2f9b84e3c6ad476">last row (0-based)</span><span class="tscolor" lg_zh="t_c7da2e0829494d3ea2f9b84e3c6ad476"><span lg_kh="1">(</span>最后一行（从0开始）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span><span lg_en="t_a40a49c6bc524e68af049c6c58742abe">first column (0-based)</span><span class="tscolor" lg_zh="t_a40a49c6bc524e68af049c6c58742abe"><span lg_kh="1">(</span>第一列（从0开始）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">2 //<span><span lg_en="t_f60e4321cc1a4bc1ba19e9fbcb83e780">last column (0-based)</span><span class="tscolor" lg_zh="t_f60e4321cc1a4bc1ba19e9fbcb83e780"><span lg_kh="1">(</span>最后一列（从0开始）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_006d93f3e8b640988cd19d4f0abdb0f3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="WorkingWithFonts" id="WorkingWithFonts"></a><a name="Working+with+fonts"></a>
     <h4><span lg_en="t_9a3251b37edd48388dcf6aa77629849d">Working with fonts</span><span class="tscolor" lg_zh="t_9a3251b37edd48388dcf6aa77629849d"><span lg_kh="1">(</span><a href="#WorkingWithFonts" style="color:blue;">使用字体</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a row and put some cells in it. Rows are 0 based.</span>
      </div>
      <div class="codeline" lg_zh="t_c09dccce818647f4a9e8cb8f76f2d6f5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一行并将一些单元格放入其中。收件箱以0为基础。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a new font and alter it.</span>
      </div>
      <div class="codeline" lg_zh="t_30c13584412d42ba9b93b77898c9888d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个新的字体并修改它。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setFontHeightInPoints((short)24);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setFontName("Courier New");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setStrikeout(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Fonts are set into a style so create a new one to use.</span>
      </div>
      <div class="codeline" lg_zh="t_2089a3bdd16a47de8b3b40226ad9787e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//字体已设置为样式，因此创建一个新的字体来使用。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a cell and put a value in it.</span>
      </div>
      <div class="codeline" lg_zh="t_2664ddf2ed9745dc8dc8699db03bf552">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个单元格并在其中添加值。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("This is a test of fonts");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_1efaa2a849b04efb88573ae304421f25">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_5d99ccc676354ad7b36606c7e495510f">Note, the maximum number of unique fonts in a workbook is limited to 32767. You should re-use fonts in your applications instead of creating a font for each cell. Examples:</span><span class="tscolor" lg_zh="t_5d99ccc676354ad7b36606c7e495510f"><span lg_kh="1">(</span>请注意，工作簿中唯一字体的最大数量限制为 32767。您应该在应用程序中重复使用字体，而不是为每个单元格创建字体。例子：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_39cf0134e3264273b788d0f61bc771f7"><strong>Wrong:</strong></span><span class="tscolor" lg_zh="t_39cf0134e3264273b788d0f61bc771f7"><span lg_kh="1">(</span>错误的：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i = 0; i &lt; 10000; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(i);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellStyle style = workbook.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Font font = workbook.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> font.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <p><span lg_en="t_82f8d1a8535a45ab9307115bf7257aa0"><strong>Correct:</strong></span><span class="tscolor" lg_zh="t_82f8d1a8535a45ab9307115bf7257aa0"><span lg_kh="1">(</span>正确的：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = workbook.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font font = workbook.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setBoldweight(Font.BOLDWEIGHT_BOLD);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i = 0; i &lt; 10000; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(i);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
     </div>
     <a name="CustomColors" id="CustomColors"></a><a name="Custom+colors"></a>
     <h4><span lg_en="t_676a2b0d4caa49e5b7c465d04828dd53">Custom colors</span><span class="tscolor" lg_zh="t_676a2b0d4caa49e5b7c465d04828dd53"><span lg_kh="1">(</span><a href="#CustomColors" style="color:blue;">自定义颜色</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_46b93f7aacce4109873ac5a20719278b"><strong>HSSF:</strong></span><span class="tscolor" lg_zh="t_46b93f7aacce4109873ac5a20719278b"><span lg_kh="1">(</span>HSSF：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRow row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell cell = row.createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Default Palette");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//apply some colors from the standard palette,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// as in the previous examples.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//we'll use red text on a lime background</span>
      </div>
      <div class="codeline" lg_zh="t_57ce515650074303ab19a9933d3c64ef">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//应用标准调色板中的一些颜色，
//与前面的例子一样。
//我们将在石灰背景上使用红色文本
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillForegroundColor(HSSFColor.LIME.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setColor(HSSFColor.RED.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setFont(font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save with the default palette</span>
      </div>
      <div class="codeline" lg_zh="t_ebf69d3cbc084255aa329f27d7825d5f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用默认调色板保存
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream("default_palette.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//now, let's replace RED and LIME in the palette</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// with a more attractive combination</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// (lovingly borrowed from freebsd.org)</span>
      </div>
      <div class="codeline" lg_zh="t_9a07fae4d55242008e22bdf9d9aa2dcb">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//现在，让我们替换调色板中的RED和LIME
//一个更有吸引力的组合
//（从freebsd.org上借来的）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Modified Palette");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//creating a custom palette for the workbook</span>
      </div>
      <div class="codeline" lg_zh="t_1a274e2d9e424c3c9cc98bb615dc60ac">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//为工作簿创建自定义调色板
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFPalette palette = wb.getCustomPalette();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//replacing the standard red with freebsd.org red</span>
      </div>
      <div class="codeline" lg_zh="t_c9f24a58a82e423184e08ae7b4fdf099">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将标准红色替换为freebsd.org红色
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">palette.setColorAtIndex(HSSFColor.RED.index,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 153, //<span><span lg_en="t_5e837169fb30468096766deabc4662f4">RGB red (0-255)</span><span class="tscolor" lg_zh="t_5e837169fb30468096766deabc4662f4"><span lg_kh="1">(</span>RB红色（0-255）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 0, //<span><span lg_en="t_54dfc152ae314685b58449019e638e1c">RGB green</span><span class="tscolor" lg_zh="t_54dfc152ae314685b58449019e638e1c"><span lg_kh="1">(</span>三原色绿色<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(byte) 0 //<span><span lg_en="t_92f977b059ae4fc7917b0b8d60ecfa9c">RGB blue</span><span class="tscolor" lg_zh="t_92f977b059ae4fc7917b0b8d60ecfa9c"><span lg_kh="1">(</span>三色蓝<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//replacing lime with freebsd.org gold</span>
      </div>
      <div class="codeline" lg_zh="t_f51ebd7933a54d74b4ae2f1338297d2b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//用freebsd.org黄金取代石灰
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">palette.setColorAtIndex(HSSFColor.LIME.index, (byte) 255, (byte) 204, (byte) 102);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save with the modified palette</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// note that wherever we have previously used RED or LIME, the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// new colors magically appear</span>
      </div>
      <div class="codeline" lg_zh="t_38ef4e8cb7014f54969f36003a704daf">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//使用修改后的调色板保存
//请注意，无论我们以前使用过RED或LIME，
//新颜色神奇地出现
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (out = new FileOutputStream("modified_palette.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_3bc89ee43e6c41e88252c02337fe6279"><strong>XSSF:</strong></span><span class="tscolor" lg_zh="t_3bc89ee43e6c41e88252c02337fe6279"><span lg_kh="1">(</span>XSSF：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFRow row = sheet.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCell cell = row.createCell( 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("custom XSSF colors");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCellStyle style1 = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style1.setFillForegroundColor(new XSSFColor(new java.awt.Color(128, 0, 128), new DefaultIndexedColorMap()));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style1.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ReadWriteWorkbook" id="ReadWriteWorkbook"></a><a name="Reading+and+Rewriting+Workbooks"></a>
     <h4><span lg_en="t_d122139834a64aeca552af502d35b9bf">Reading and Rewriting Workbooks</span><span class="tscolor" lg_zh="t_d122139834a64aeca552af502d35b9bf"><span lg_kh="1">(</span>读取和重写工作簿<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (InputStream inp = new FileInputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//InputStream inp = new FileInputStream("workbook.xlsx");</span>
      </div>
      <div class="codeline" lg_zh="t_74eed0c8ca7445339ab2f4dd7e250730">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//InputStream inp = new File InputStream（“workbook.xlsx”）;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Workbook wb = WorkbookFactory.create(inp);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet sheet = wb.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.getRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.getCell(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (cell == null)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell = row.createCell(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellType(CellType.STRING);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("a test");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Write the output to a file</span>
      </div>
      <div class="codeline" lg_zh="t_6bce7821a7f44e3ea00c702474396822">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将输出写入文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="NewLinesInCells" id="NewLinesInCells"></a><a name="Using+newlines+in+cells"></a>
     <h4><span lg_en="t_9abe02d073cf4c6ca89df0d72ff4fcbb">Using newlines in cells</span><span class="tscolor" lg_zh="t_9abe02d073cf4c6ca89df0d72ff4fcbb"><span lg_kh="1">(</span>在单元格中使用换行符<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span><span lg_en="t_58fe779fca2844b0a421086318f401a6">or new HSSFWorkbook();</span><span class="tscolor" lg_zh="t_58fe779fca2844b0a421086318f401a6"><span lg_kh="1">(</span>或新的HSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Use \n with word wrap on to create a new line");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//to enable newlines you need set a cell styles with wrap=true</span>
      </div>
      <div class="codeline" lg_zh="t_fd50fcfe9adf4bb5830aafd45bbfbf47">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//要启用白线，您需要使用wrap=true设置单元格样式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle cs = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cs.setWrapText(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(cs);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//increase row height to accommodate two lines of text</span>
      </div>
      <div class="codeline" lg_zh="t_12e03d7217b0419d8398e946077412c3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//增加行高以容纳两行文本
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.setHeightInPoints((2*sheet.getDefaultRowHeightInPoints()));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//adjust column width to fit the content</span>
      </div>
      <div class="codeline" lg_zh="t_051187ed5c3b444baa51c91f4bd9ced1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//调整列宽以适应内容
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("ooxml-newlines.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="DataFormats" id="DataFormats"></a><a name="Data+Formats"></a>
     <h4><span lg_en="t_84b3c88f5fea472cab616665aac67579">Data Formats</span><span class="tscolor" lg_zh="t_84b3c88f5fea472cab616665aac67579"><span lg_kh="1">(</span>数据格式<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataFormat format = wb.createDataFormat();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int rowNum = 0;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int colNum = 0;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row = sheet.createRow(rowNum++);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(colNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(11111.25);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setDataFormat(format.getFormat("0.0"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row = sheet.createRow(rowNum++);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = row.createCell(colNum);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(11111.25);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setDataFormat(format.getFormat("#,##0.0000"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FitTo" id="FitTo"></a><a name="Fit+Sheet+to+One+Page"></a>
     <h4><span lg_en="t_6fa05d4cbdf34b228e486e42909c839c">Fit Sheet to One Page</span><span class="tscolor" lg_zh="t_6fa05d4cbdf34b228e486e42909c839c"><span lg_kh="1">(</span><a href="#FitTo" style="color:blue;">将工作表设置为一页(打印设置)</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PrintSetup ps = sheet.getPrintSetup();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setAutobreaks(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ps.setFitHeight((short)1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ps.setFitWidth((short)1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div class="codeline" lg_zh="t_3ee17f80e7a540daa60e3081a3967cb1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//为电子表格创建各种单元格和行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="PrintArea2" id="PrintArea2"></a><a name="Set+Print+Area"></a>
     <h4><span lg_en="t_605564e7c4484cc1a5f19865a371cf67">Set Print Area</span><span class="tscolor" lg_zh="t_605564e7c4484cc1a5f19865a371cf67"><span lg_kh="1">(</span>设置打印区域<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//sets the print area for the first sheet</span>
      </div>
      <div class="codeline" lg_zh="t_cb7ff736760348d0b545060331257d49">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置第一张纸的打印区域
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setPrintArea(0, "$A$1:$C$2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Alternatively:</span>
      </div>
      <div class="codeline" lg_zh="t_8179d1387acc457f8bc5d7cabdbed798">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//或者：
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.setPrintArea(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span><span lg_en="t_c54764f248174dad884c44ca28c6d1df">sheet index</span><span class="tscolor" lg_zh="t_c54764f248174dad884c44ca28c6d1df"><span lg_kh="1">(</span>图纸索引<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span><span lg_en="t_82758636af1c4e1db9700b14f0a9ebc6">start column</span><span class="tscolor" lg_zh="t_82758636af1c4e1db9700b14f0a9ebc6"><span lg_kh="1">(</span>起始列<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1, //<span><span lg_en="t_a9b130c39474419385e98b7f4088a9e9">end column</span><span class="tscolor" lg_zh="t_a9b130c39474419385e98b7f4088a9e9"><span lg_kh="1">(</span>馏分塔<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0, //<span><span lg_en="t_5d899fa7efb5449dbddd27eefc225613">start row</span><span class="tscolor" lg_zh="t_5d899fa7efb5449dbddd27eefc225613"><span lg_kh="1">(</span>开始行<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0 //<span><span lg_en="t_de32070ba53d4ffa8db65ca4711bf37a">end row</span><span class="tscolor" lg_zh="t_de32070ba53d4ffa8db65ca4711bf37a"><span lg_kh="1">(</span>结束行<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="FooterPageNumbers" id="FooterPageNumbers"></a><a name="Set+Page+Numbers+on+Footer"></a>
     <h4><span lg_en="t_baef387ebebf4a77972e77344ba1ae47">Set Page Numbers on Footer</span><span class="tscolor" lg_zh="t_baef387ebebf4a77972e77344ba1ae47"><span lg_kh="1">(</span>在页脚设置页码<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span><span lg_en="t_57d8d8a79b5245208e879cacd0eee6d7">or new XSSFWorkbook();</span><span class="tscolor" lg_zh="t_57d8d8a79b5245208e879cacd0eee6d7"><span lg_kh="1">(</span>或新的XSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("format sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Footer footer = sheet.getFooter();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">footer.setRight( "Page " + HeaderFooter.page() + " of " + HeaderFooter.numPages() );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div class="codeline" lg_zh="t_cf642f9bb43546388e40a5a06584bb0e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//为电子表格创建各种单元格和行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ConvenienceFunctions" id="ConvenienceFunctions"></a><a name="Using+the+Convenience+Functions"></a>
     <h4><span lg_en="t_89a12d713d6247e7ac377cabe68aec33">Using the Convenience Functions</span><span class="tscolor" lg_zh="t_89a12d713d6247e7ac377cabe68aec33"><span lg_kh="1">(</span>使用便捷函式<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_2a3791f572204557a00064c2a9126e5f">The convenience functions provide utility features such as setting borders around merged regions and changing style attributes without explicitly creating new styles.</span><span class="tscolor" lg_zh="t_2a3791f572204557a00064c2a9126e5f"><span lg_kh="1">(</span>便捷函式提供实用功能，例如在合并区域周围设置边框和更改样式属性而无需显式创建新样式。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span><span lg_en="t_a6b837a6a0234c1e85e549c3c846e7b0">or new XSSFWorkbook()</span><span class="tscolor" lg_zh="t_a6b837a6a0234c1e85e549c3c846e7b0"><span lg_kh="1">(</span>或新的XSSFWorkbook（）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet( "new sheet" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a merged region</span>
      </div>
      <div class="codeline" lg_zh="t_c257b37f72c1469d8651033f72603c96">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建合并区域
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet1.createRow( 1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row2 = sheet1.createRow( 2 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell( 1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue( "This is a test of merging" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddress region = CellRangeAddress.valueOf("B2:E5");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.addMergedRegion( region );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the border and border colors.</span>
      </div>
      <div class="codeline" lg_zh="t_2ba02ef737974172be7c3d0059cd9b19">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置边框和边框颜色。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderBottom( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderTop( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderLeft( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBorderRight( BorderStyle.MEDIUM_DASHED, region, sheet1, wb );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setBottomBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setTopBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setLeftBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RegionUtil.setRightBorderColor( IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Shows some usages of HSSFCellUtil</span>
      </div>
      <div class="codeline" lg_zh="t_d5ee3894c36043a29d7f84ce31f01cd6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//显示HSSFCellUtil的一些用法
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">style.setIndention((short)4);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.createCell(row, 8, "This is the value of the cell", style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell2 = CellUtil.createCell( row2, 8, "This is the value of the cell");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.setAlignment(cell2, HorizontalAlignment.CENTER);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Write out the workbook</span>
      </div>
      <div class="codeline" lg_zh="t_1bcc93ea74e144fea27c075c757c2463">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//写出工作簿
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream( "workbook.xls" )) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write( fileOut );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="ShiftRows" id="ShiftRows"></a><a name="Shift+rows+up+or+down+on+a+sheet"></a>
     <h4><span lg_en="t_021d6d4c8b5743e2944516a5197c38b0">Shift rows up or down on a sheet</span><span class="tscolor" lg_zh="t_021d6d4c8b5743e2944516a5197c38b0"><span lg_kh="1">(</span>在工作表上向上或向下移动行<span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("row sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create various cells and rows for spreadsheet.</span>
      </div>
      <div class="codeline" lg_zh="t_aceecb62c73e4462ad4abe1a9893fb21">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//为电子表格创建各种单元格和行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Shift rows 6 - 11 on the spreadsheet to the top (rows 0 - 5)</span>
      </div>
      <div class="codeline" lg_zh="t_f5703308f19d4073bee542bd2b71a88e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将电子表格上的第6 - 11行移至顶部（第0 - 5行）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.shiftRows(5, 10, -5);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="SelectSheet" id="SelectSheet"></a><a name="Set+a+sheet+as+selected"></a>
     <h4><span lg_en="t_c852be4847ed49c4ad21640267cae8fc">Set a sheet as selected</span><span class="tscolor" lg_zh="t_c852be4847ed49c4ad21640267cae8fc"><span lg_kh="1">(</span><a href="#SelectSheet" style="color:blue;">将工作表设置为选中</a><span lg_kh="1">)</span></span></h4>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("row sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setSelected(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Zoom" id="Zoom"></a><a name="Set+the+zoom+magnification"></a>
     <h4><span lg_en="t_68094816a55c4e1a86e3dfaed780cfd0">Set the zoom magnification</span><span class="tscolor" lg_zh="t_68094816a55c4e1a86e3dfaed780cfd0"><span lg_kh="1">(</span>设置缩放倍率<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_59e1bc47b7ee4ecdbf91d4b7c652b6af">The zoom is expressed as a fraction. For example to express a zoom of 75% use 3 for the numerator and 4 for the denominator.</span><span class="tscolor" lg_zh="t_59e1bc47b7ee4ecdbf91d4b7c652b6af"><span lg_kh="1">(</span>缩放以分数表示。例如，要表示 75% 的缩放，分子使用 3，分母使用 4。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setZoom(75); //<span><span lg_en="t_c44f2997ba1b45e193e3f9d7fc530d8f">75 percent magnification</span><span class="tscolor" lg_zh="t_c44f2997ba1b45e193e3f9d7fc530d8f"><span lg_kh="1">(</span>75%放大率<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Splits" id="Splits"></a><a name="Splits+and+freeze+panes"></a>
     <h4><span lg_en="t_d7cf132ab66749eea90fcf1b57d90269">Splits and freeze panes</span><span class="tscolor" lg_zh="t_d7cf132ab66749eea90fcf1b57d90269"><span lg_kh="1">(</span>拆分和冻结窗格<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_b976543210a04a9d89e4ab95eb479c0e">There are two types of panes you can create; freeze panes and split panes.</span><span class="tscolor" lg_zh="t_b976543210a04a9d89e4ab95eb479c0e"><span lg_kh="1">(</span>您可以创建两种类型的窗格；冻结窗格和拆分窗格。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_13525ffdcb1e44adafc393c0f3f2d2ff">A freeze pane is split by columns and rows. You create a freeze pane using the following mechanism:</span><span class="tscolor" lg_zh="t_13525ffdcb1e44adafc393c0f3f2d2ff"><span lg_kh="1">(</span>冻结窗格按列和行进行冻结，您可以使用以下机制创建冻结窗格：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e275f2242ec445b7b7a17ac84bd6652c">sheet1.createFreezePane( 3, 2, 3, 2 );</span><span class="tscolor" lg_zh="t_e275f2242ec445b7b7a17ac84bd6652c"><span lg_kh="1">(</span>sheet1.createFreezePane(3,2,3,2);<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9cffec8ba5304f82b8bdf9b494ff9b10">The first two parameters are the columns and rows you wish to split by. The second two parameters indicate the cells that are visible in the bottom right quadrant.</span><span class="tscolor" lg_zh="t_9cffec8ba5304f82b8bdf9b494ff9b10"><span lg_kh="1">(</span>前两个参数是您希望冻结的列和行。后两个参数表示右下象限中可见的单元格。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_907750d0c8d347fb97bbc9c27fce8bd6">Split panes appear differently. The split area is divided into four separate work area's. The split occurs at the pixel level and the user is able to adjust the split by dragging it to a new position.</span><span class="tscolor" lg_zh="t_907750d0c8d347fb97bbc9c27fce8bd6"><span lg_kh="1">(</span>拆分窗格的显示方式不同。分割区域分为四个独立的工作区域。分割发生在像素级别，用户可以通过将分割拖动到新位置来调整。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_2db0671502244030a1d4eb44835d3c4b">Split panes are created with the following call:</span><span class="tscolor" lg_zh="t_2db0671502244030a1d4eb44835d3c4b"><span lg_kh="1">(</span>拆分窗格是通过以下调用创建的：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8f9ed7acbc50427b81e9813226440e26">sheet2.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT );</span><span class="tscolor" lg_zh="t_8f9ed7acbc50427b81e9813226440e26"><span lg_kh="1">(</span>sheet2.createSplitPane(2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT);<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0e6f56eb981148afaf7b87ef91955b9f">The first parameter is the x position of the split. This is in 1/20th of a point. A point in this case seems to equate to a pixel. The second parameter is the y position of the split. Again in 1/20th of a point.</span><span class="tscolor" lg_zh="t_0e6f56eb981148afaf7b87ef91955b9f"><span lg_kh="1">(</span>第一个参数是分割的x位置。它是一个点的 1/20。在这种情况下，一个点大概等同于一个像素。第二个参数是分割的y位置，也是一个点的1/20。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1f28a67553cc4e41aaf5d86d41215b6e">The last parameter indicates which pane currently has the focus. This will be one of Sheet.PANE_LOWER_LEFT, PANE_LOWER_RIGHT, PANE_UPPER_RIGHT or PANE_UPPER_LEFT.</span><span class="tscolor" lg_zh="t_1f28a67553cc4e41aaf5d86d41215b6e"><span lg_kh="1">(</span>最后一个参数指示当前哪个窗格具有焦点。这将是 Sheet.PANE_LOWER_LEFT、PANE_LOWER_RIGHT、PANE_UPPER_RIGHT 或 PANE_UPPER_LEFT 之一。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("second sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet3 = wb.createSheet("third sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet4 = wb.createSheet("fourth sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze just one row</span>
      </div>
      <div class="codeline" lg_zh="t_17d2be30a31d421a9c672b0a30f8d86f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//仅冻结一行
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.createFreezePane( 0, 1, 0, 1 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze just one column</span>
      </div>
      <div class="codeline" lg_zh="t_b4563032dcc94cfe8883247e58995eb2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//仅冻结一列
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.createFreezePane( 1, 0, 1, 0 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Freeze the columns and rows (forget about scrolling position of the lower right quadrant).</span>
      </div>
      <div class="codeline" lg_zh="t_e7531ca660fe4b73832f5fa8452f4b30">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//冻结列和行（忘记右下象限的滚动位置）。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet3.createFreezePane( 2, 2 );</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a split with the lower left side being the active quadrant</span>
      </div>
      <div class="codeline" lg_zh="t_2a3d8a288d0046de9f1f90946435121f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建左下角为活动象限的分裂
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet4.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Repeating" id="Repeating"></a><a name="Repeating+rows+and+columns"></a>
     <h4><span lg_en="t_21c45b8ff35e40ebb3f5a646a09c35b9">Repeating rows and columns</span><span class="tscolor" lg_zh="t_21c45b8ff35e40ebb3f5a646a09c35b9"><span lg_kh="1">(</span><a href="#Repeating" style="color:blue;">重复行和列</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_7c52630498244b4187538ae7430daf25">It's possible to set up repeating rows and columns in your printouts by using the setRepeatingRows() and setRepeatingColumns() methods in the Sheet class.</span><span class="tscolor" lg_zh="t_7c52630498244b4187538ae7430daf25"><span lg_kh="1">(</span>可以使用 Sheet 类中的 setRepeatingRows() 和 setRepeatingColumns() 方法在打印输出中设置重复的行和列。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_99c4a5807f8342a7aa260f606334f5bc">These methods expect a CellRangeAddress parameter which specifies the range for the rows or columns to repeat. For setRepeatingRows(), it should specify a range of rows to repeat, with the column part spanning all columns. For setRepeatingColums(), it should specify a range of columns to repeat, with the row part spanning all rows. If the parameter is null, the repeating rows or columns will be removed.</span><span class="tscolor" lg_zh="t_99c4a5807f8342a7aa260f606334f5bc"><span lg_kh="1">(</span>这些方法需要一个 CellRangeAddress 参数，该参数指定要重复的行或列的范围。对于 setRepeatingRows()，它应该指定要重复的行范围，列部分跨越所有列。对于 setRepeatingColums()，它应该指定要重复的列范围，其中行部分跨越所有行。如果该参数为空，则将删除重复的行或列。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span><span lg_en="t_d0f1bacf5ec24200b3246de23e181fc7">or new XSSFWorkbook();</span><span class="tscolor" lg_zh="t_d0f1bacf5ec24200b3246de23e181fc7"><span lg_kh="1">(</span>或新的XSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("Sheet2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the rows to repeat from row 4 to 5 on the first sheet.</span>
      </div>
      <div class="codeline" lg_zh="t_a7631dac34c24546b2ebf6952372b118">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在第一张纸上设置从第4行到第5行重复的行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setRepeatingRows(CellRangeAddress.valueOf("4:5"));</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set the columns to repeat from column A to C on the second sheet</span>
      </div>
      <div class="codeline" lg_zh="t_aeaaff7bf9cc46089e424ec974411718">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将列设置为从第二张工作表上的A列到C列重复
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.setRepeatingColumns(CellRangeAddress.valueOf("A:C"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="HeaderFooter" id="HeaderFooter"></a><a name="Headers+and+Footers"></a>
     <h4><span lg_en="t_7acdbd815edb479aba4f44ca8f25aca0">Headers and Footers</span><span class="tscolor" lg_zh="t_7acdbd815edb479aba4f44ca8f25aca0"><span lg_kh="1">(</span><a href="#HeaderFooter" style="color:blue;">页眉和页脚</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_f2874e68b26f47b0aeea6a4fc19ca4b8">Example is for headers but applies directly to footers.</span><span class="tscolor" lg_zh="t_f2874e68b26f47b0aeea6a4fc19ca4b8"><span lg_kh="1">(</span>示例适用于页眉，也适用于页脚。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header = sheet.getHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setCenter("Center Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setLeft("Left Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setRight(HSSFHeader.font("Stencil-Normal", "Italic") +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFHeader.fontSize((short) 16) + "Right w/ Stencil-Normal Italic font and size 16");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xls")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="XSSFHeaderFooter" id="XSSFHeaderFooter"></a><a name="XSSF+Enhancement+for+Headers+and+Footers"></a>
     <h4><span lg_en="t_eeba066cd27e4cafa8495489bc5c9fb3">XSSF Enhancement for Headers and Footers</span><span class="tscolor" lg_zh="t_eeba066cd27e4cafa8495489bc5c9fb3"><span lg_kh="1">(</span>页眉和页脚的 XSSF 增强<span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_3587899c735043b7a99e2d77b0c149e8">Example is for headers but applies directly to footers. Note, the above example for basic headers and footers applies to XSSF Workbooks as well as HSSF Workbooks. The HSSFHeader stuff does not work for XSSF Workbooks.</span><span class="tscolor" lg_zh="t_3587899c735043b7a99e2d77b0c149e8"><span lg_kh="1">(</span>示例适用于页眉，也适用于页脚。请注意，上述基本页眉和页脚示例适用于 XSSF 工作簿以及 HSSF 工作簿。 HSSFHeader 内容不适用于 XSSF 工作簿。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_fa2c6ab2ef714e999bbb2474ec6dc25d">XSSF has the ability to handle First page headers and footers, as well as Even/Odd headers and footers. All Header/Footer Property flags can be handled in XSSF as well. The odd header and footer is the default header and footer. It is displayed on all pages that do not display either a first page header or an even page header. That is, if the Even header/footer does not exist, then the odd header/footer is displayed on even pages. If the first page header/footer does not exist, then the odd header/footer is displayed on the first page. If the even/odd property is not set, that is the same as the even header/footer not existing. If the first page property does not exist, that is the same as the first page header/footer not existing.</span><span class="tscolor" lg_zh="t_fa2c6ab2ef714e999bbb2474ec6dc25d"><span lg_kh="1">(</span>XSSF 能够处理首页页眉和页脚，以及偶数/奇数页眉和页脚。所有页眉/页脚属性标志也可以在 XSSF 中处理。奇数页眉和页脚是默认页眉和页脚。它显示在除了首页标题或偶数页标题的所有页面上。也就是说，如果偶数页眉/页脚不存在，则奇数页眉/页脚将显示在偶数页上。如果第一页页眉/页脚不存在，则奇数页眉/页脚显示在第一页上。如果未设置偶数/奇数属性，则与相当于不存在偶数页眉/页脚。如果首页页属性不存在，则相当于首页页眉/页脚不存在。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = (XSSFSheet) wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a first page header</span>
      </div>
      <div class="codeline" lg_zh="t_b17c833016a44b7c96ca054f5deb81e0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建第一个页面标题
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header = sheet.getFirstHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setCenter("Center First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setLeft("Left First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header.setRight("Right First Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create an even page header</span>
      </div>
      <div class="codeline" lg_zh="t_f5eed6ac9e314b328480c056314cf7cd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建偶数页面标题
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header2 = sheet.getEvenHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">der2.setCenter("Center Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header2.setLeft("Left Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header2.setRight("Right Even Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create an odd page header</span>
      </div>
      <div class="codeline" lg_zh="t_b713d5f14eef4b7382bc634c9fc1dab2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建奇数页面标题
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Header header3 = sheet.getOddHeader();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">der3.setCenter("Center Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header3.setLeft("Left Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">header3.setRight("Right Odd Page Header");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Set/Remove Header properties</span>
      </div>
      <div class="codeline" lg_zh="t_3d5e8826a9094d6eafaaacf6d44c9f8b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置/删除标题属性
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFHeaderProperties prop = sheet.getHeaderFooterProperties();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.setAlignWithMargins();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.scaleWithDoc();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.removeDifferentFirstPage(); //<span><span lg_en="t_187e8019cfd1408a84701b81bd7d1564">This does not remove first page headers or footers</span><span class="tscolor" lg_zh="t_187e8019cfd1408a84701b81bd7d1564"><span lg_kh="1">(</span>这不会删除第一页的标题或页脚<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">prop.removeDifferentEvenOdd(); //<span><span lg_en="t_6e58737fdf8746f28e33a18472febd19">This does not remove even headers or footers</span><span class="tscolor" lg_zh="t_6e58737fdf8746f28e33a18472febd19"><span lg_kh="1">(</span>这甚至不会删除标题或页脚<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream("workbook.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="DrawingShapes" id="DrawingShapes"></a><a name="Drawing+Shapes"></a>
     <h4><span lg_en="t_5d4273a28b614ab1bdcb110d8809a45f">Drawing Shapes</span><span class="tscolor" lg_zh="t_5d4273a28b614ab1bdcb110d8809a45f"><span lg_kh="1">(</span><a href="#DrawingShapes" style="color:blue;">绘制形状</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_47cbceae98254277af08f45488f8a51e">POI supports drawing shapes using the Microsoft Office drawing tools. Shapes on a sheet are organized in a hierarchy of groups and and shapes. The top-most shape is the patriarch. This is not visible on the sheet at all. To start drawing you need to call <span class="codefrag">createPatriarch</span> on the <span class="codefrag">HSSFSheet</span> class. This has the effect erasing any other shape information stored in that sheet. By default POI will leave shape records alone in the sheet unless you make a call to this method.</span><span class="tscolor" lg_zh="t_47cbceae98254277af08f45488f8a51e"><span lg_kh="1">(</span>POI 支持使用 Microsoft Office 绘图工具绘制图形。工作表上的图形根据组和图形的层次结构进行组织，顶层图形叫做“族长”，它们在工作表上并不可见。要开始绘图，您需要在 HSSFSheet 类上调用 createPatriarch。这会删除该工作表中存储的任何其他图形信息。默认情况下，除非您调用此方法，否则 POI 将在工作表中保留图形记录。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c84e382324dc4911bb7a31d797d6e95f">To create a shape you have to go through the following steps:</span><span class="tscolor" lg_zh="t_c84e382324dc4911bb7a31d797d6e95f"><span lg_kh="1">(</span>要创建图形，您必须执行以下步骤：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_6bc48c212c464a6c821890e62d81d35e">Create the patriarch.</span><span class="tscolor" lg_zh="t_6bc48c212c464a6c821890e62d81d35e"><span lg_kh="1">(</span>创建“族长”。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_69188ee74bfc468ea595424726cf7ad2">Create an anchor to position the shape on the sheet.</span><span class="tscolor" lg_zh="t_69188ee74bfc468ea595424726cf7ad2"><span lg_kh="1">(</span>创建一个锚点以将形状定位在图纸上。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_356d3300cdf14cc2b0ef2502b25b1874">Ask the patriarch to create the shape.</span><span class="tscolor" lg_zh="t_356d3300cdf14cc2b0ef2502b25b1874"><span lg_kh="1">(</span>使用“族长”创建图形。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_67f9585d27dc4eb0afda6c98f677f258">Set the shape type (line, oval, rectangle etc...)</span><span class="tscolor" lg_zh="t_67f9585d27dc4eb0afda6c98f677f258"><span lg_kh="1">(</span>设置图形类型（线、椭圆、矩形等...）<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_2d865052943749988a6d9efef27be08b">Set any other style details concerning the shape. (eg: line thickness, etc...)</span><span class="tscolor" lg_zh="t_2d865052943749988a6d9efef27be08b"><span lg_kh="1">(</span>设置图形的其他样式细节。 （例如：线条粗细等...）<span lg_kh="1">)</span></span></li>
     </ol>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFPatriarch patriarch = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape1 = patriarch.createSimpleShape(a1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_244c31633dc3450da373e78f325cb116">Text boxes are created using a different call:</span><span class="tscolor" lg_zh="t_244c31633dc3450da373e78f325cb116"><span lg_kh="1">(</span>文本框是调用另一个方法创建的：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFTextbox textbox1 = patriarch.createTextbox(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new HSSFClientAnchor(0,0,0,0,(short)1,1,(short)2,2));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">textbox1.setString(new HSSFRichTextString("This is a test") );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_7f55547be0484ad5bb454337553a3045">It's possible to use different fonts to style parts of the text in the textbox. Here's how:</span><span class="tscolor" lg_zh="t_7f55547be0484ad5bb454337553a3045"><span lg_kh="1">(</span>可以使用不同的字体来设置文本框中部分文本的样式。比如这样：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFFont font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font.setUnderline(HSSFFont.U_DOUBLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRichTextString string = new HSSFRichTextString("Woo!!!");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">string.applyFont(2,5,font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">textbox.setString(string );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_e7bbac3db6214da6818e065d6933a5a1">Just as can be done manually using Excel, it is possible to group shapes together. This is done by calling <span class="codefrag">createGroup()</span> and then creating the shapes using those groups.</span><span class="tscolor" lg_zh="t_e7bbac3db6214da6818e065d6933a5a1"><span lg_kh="1">(</span>图形可以进行分组，就像使用Excel手动操作一样。可以通过调用 createGroup() 然后使用这些组创建图形。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7144d9f64d584bbab559b990b27d9e0f">It's also possible to create groups within groups.</span><span class="tscolor" lg_zh="t_7144d9f64d584bbab559b990b27d9e0f"><span lg_kh="1">(</span>也可以在组内创建组。<span lg_kh="1">)</span></span></p>
     <div class="warning">
      <div class="label">
       <span lg_en="t_5cd455259f5948108961b437111c2963">Warning</span><span class="tscolor" lg_zh="t_5cd455259f5948108961b437111c2963"><span lg_kh="1">(</span>警告<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_783617373aad499da63d4ed0d1b840f4">Any group you create should contain at least two other shapes or subgroups.</span><span class="tscolor" lg_zh="t_783617373aad499da63d4ed0d1b840f4"><span lg_kh="1">(</span>您创建的任何组都应包含至少两个其他图形或子组。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_ef7607625c744d33a73c7f4d95de6a78">Here's how to create a shape group:</span><span class="tscolor" lg_zh="t_ef7607625c744d33a73c7f4d95de6a78"><span lg_kh="1">(</span>以下是创建图形组的方法：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a shape group.</span>
      </div>
      <div class="codeline" lg_zh="t_34c310c4c81c428db0b911d25c30bbb3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建形状组。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFShapeGroup group = patriarch.createGroup(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new HSSFClientAnchor(0,0,900,200,(short)2,2,(short)2,2));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create a couple of lines in the group.</span>
      </div>
      <div class="codeline" lg_zh="t_61f2dc975d2243c494233b029629877d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在组中创建几行。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape1 = group.createShape(new HSSFChildAnchor(3,3,500,500));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">( (HSSFChildAnchor) shape1.getAnchor() ).setAnchor(3,3,500,500);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape shape2 = group.createShape(new HSSFChildAnchor(1,200,400,600));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">shape2.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_137823f9a699445f913792ad244c7cad">If you're being observant you'll noticed that the shapes that are added to the group use a new type of anchor: the <span class="codefrag">HSSFChildAnchor</span>. What happens is that the created group has it's own coordinate space for shapes that are placed into it. POI defaults this to (0,0,1023,255) but you are able to change it as desired. Here's how:</span><span class="tscolor" lg_zh="t_137823f9a699445f913792ad244c7cad"><span lg_kh="1">(</span>如果您仔细观察，您会注意到添加到组中的形状使用了一种新类型的锚：HSSFChildAnchor。因为放置在组中的图形拥有相对于组的坐标空间。POI 默认为 (0,0,1023,255)，但您可以根据需要更改它。比如这样：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">myGroup.setCoordinates(10,10,20,20); //<span><span lg_en="t_779d01a86e1a4be3ae1c0e428f6e1170">top-left, bottom-right</span><span class="tscolor" lg_zh="t_779d01a86e1a4be3ae1c0e428f6e1170"><span lg_kh="1">(</span>左上、右下<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_fd6d35edbab0425a9ba00497c9aff552">If you create a group within a group it's also going to have it's own coordinate space.</span><span class="tscolor" lg_zh="t_fd6d35edbab0425a9ba00497c9aff552"><span lg_kh="1">(</span>如果您在组内创建一个组，它也将拥有自己的坐标空间。<span lg_kh="1">)</span></span></p>
     <a name="StylingShapes" id="StylingShapes"></a><a name="Styling+Shapes"></a>
     <h4><span lg_en="t_2806568de7c34faa88730df48bb4b96e">Styling Shapes</span><span class="tscolor" lg_zh="t_2806568de7c34faa88730df48bb4b96e"><span lg_kh="1">(</span><a href="#StylingShapes" style="color:blue;">样式形状</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_b4f95dff2cf149f6a82c6d7e57b0088f">By default shapes can look a little plain. It's possible to apply different styles to the shapes however. The sorts of things that can currently be done are:</span><span class="tscolor" lg_zh="t_b4f95dff2cf149f6a82c6d7e57b0088f"><span lg_kh="1">(</span>默认情况下，图形看上去很简单。但是，可以对图形应用不同的样式来让它变得花哨。目前可以这样做：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_c9fa4d53bd4140798703fbe257cdc763">Change the fill color.</span><span class="tscolor" lg_zh="t_c9fa4d53bd4140798703fbe257cdc763"><span lg_kh="1">(</span>更改填充颜色。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b554d5d49e6c49f69ae0f48f57715c65">Make a shape with no fill color.</span><span class="tscolor" lg_zh="t_b554d5d49e6c49f69ae0f48f57715c65"><span lg_kh="1">(</span>创建一个没有填充颜色的图形。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_f324309403df45d98d49c6b0dc727c1e">Change the thickness of the lines.</span><span class="tscolor" lg_zh="t_f324309403df45d98d49c6b0dc727c1e"><span lg_kh="1">(</span>更改线条的粗细。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_428f63e4962d489a890431f7bc534090">Change the style of the lines. Eg: dashed, dotted.</span><span class="tscolor" lg_zh="t_428f63e4962d489a890431f7bc534090"><span lg_kh="1">(</span>更改线条的样式。如：虚线、点线。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e8103c2ddb0447dc9affc3f625d4ce1c">Change the line color.</span><span class="tscolor" lg_zh="t_e8103c2ddb0447dc9affc3f625d4ce1c"><span lg_kh="1">(</span>更改线条颜色。<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_8fd12884c04d4c3495daf2f73d2c592c">Here's an examples of how this is done:</span><span class="tscolor" lg_zh="t_8fd12884c04d4c3495daf2f73d2c592c"><span lg_kh="1">(</span>下述代码演示如何完成：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSimpleShape s = patriarch.createSimpleShape(a);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setShapeType(HSSFSimpleShape.OBJECT_TYPE_OVAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineStyleColor(10,10,10);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setFillColor(90,10,200);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineWidth(HSSFShape.LINEWIDTH_ONE_PT * 3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s.setLineStyle(HSSFShape.LINESTYLE_DOTSYS);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="Graphics2d" id="Graphics2d"></a><a name="Shapes+and+Graphics2d"></a>
     <h4><span lg_en="t_86e58fec6c71419fa245ce988b6caa29">Shapes and Graphics2d</span><span class="tscolor" lg_zh="t_86e58fec6c71419fa245ce988b6caa29"><span lg_kh="1">(</span><a href="#Graphics2d" style="color:blue;">形状和Graphics2d</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_b118c84457b14ff2941e6262cf81f028">While the native POI shape drawing commands are the recommended way to draw shapes in a shape it's sometimes desirable to use a standard API for compatibility with external libraries. With this in mind we created some wrappers for <span class="codefrag">Graphics</span> and <span class="codefrag">Graphics2d</span>.</span><span class="tscolor" lg_zh="t_b118c84457b14ff2941e6262cf81f028"><span lg_kh="1">(</span>虽然本机POI图形绘制命令是在图形中绘制图形的推荐方法，但有时需要使用标准 API 以与外部库兼容。考虑到这一点，我们为 Graphics 和 Graphics2d 创建了一些包装器。<span lg_kh="1">)</span></span></p>
     <div class="warning">
      <div class="label">
       <span lg_en="t_f355d3b6fb9244d5bb9b6b5c3f169594">Warning</span><span class="tscolor" lg_zh="t_f355d3b6fb9244d5bb9b6b5c3f169594"><span lg_kh="1">(</span>警告<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_830c27fc32c04b11af863d5d4235a271">It's important to not however before continuing that <span class="codefrag">Graphics2d</span> is a poor match to the capabilities of the Microsoft Office drawing commands. The older <span class="codefrag">Graphics</span> class offers a closer match but is still a square peg in a round hole.</span><span class="tscolor" lg_zh="t_830c27fc32c04b11af863d5d4235a271"><span lg_kh="1">(</span>重要的是，在继续之前，Graphics2d 与 Microsoft Office 绘图命令的功能不匹配。较旧的 Graphics 类提供了更紧密的匹配，但仍然显得格格不入。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_abd94badd22440479fae69330b3c9957">All Graphics commands are issued into an <span class="codefrag">HSSFShapeGroup</span>. Here's how it's done:</span><span class="tscolor" lg_zh="t_abd94badd22440479fae69330b3c9957"><span lg_kh="1">(</span>所有图形命令都会发送到一个 HSSFShapeGroup。下述代码演示如何完成：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">group = patriarch.createGroup( a );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">group.setCoordinates( 0, 0, 80 * 4 , 12 * 23 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">float verticalPointsPerPixel = a.getAnchorHeightInPoints(sheet) / (float)Math.abs(group.getY2() - group.getY1());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">g = new EscherGraphics( group, wb, Color.black, verticalPointsPerPixel );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">g2d = new EscherGraphics2d( g );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">drawChemicalStructure( g2d );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_c11a7cccb5b841a1bdf085da04d9051a">The first thing we do is create the group and set it's coordinates to match what we plan to draw. Next we calculate a reasonable fontSizeMultiplier then create the EscherGraphics object. Since what we really want is a <span class="codefrag">Graphics2d</span> object we create an EscherGraphics2d object and pass in the graphics object we created. Finally we call a routine that draws into the EscherGraphics2d object.</span><span class="tscolor" lg_zh="t_c11a7cccb5b841a1bdf085da04d9051a"><span lg_kh="1">(</span>我们要做的第一件事是创建组并设置它的坐标以匹配我们计划绘制的内容。接下来我们计算一个合理的 fontSizeMultiplier 然后创建 EscherGraphics 对象。因为我们真正想要的是一个 Graphics2d 对象，所以我们创建一个 EscherGraphics2d 对象并传入我们创建的图形对象。最后，我们调用一个绘制到 EscherGraphics2d 对象中的例程。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_2fb322f9df4c4bc5a74b784c64d40251">The vertical points per pixel deserves some more explanation. One of the difficulties in converting Graphics calls into escher drawing calls is that Excel does not have the concept of absolute pixel positions. It measures it's cell widths in 'characters' and the cell heights in points. Unfortunately it's not defined exactly what type of character it's measuring. Presumably this is due to the fact that the Excel will be using different fonts on different platforms or even within the same platform.</span><span class="tscolor" lg_zh="t_2fb322f9df4c4bc5a74b784c64d40251"><span lg_kh="1">(</span>每个像素的垂直点需要更多解释。将 Graphics转换为Escher绘图的困难之一是 Excel 没有绝对像素位置的概念。它以“字符”为单位测量其单元格宽度和以点为单位的单元格高度。不幸的是，它没有准确定义它正在测量的字符类型。这大概是由于Excel在不同平台上甚至在同一平台内使用不同的字体。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0a2897d0805f4e6d83a9b738287a2193">Because of this constraint we've had to implement the concept of a verticalPointsPerPixel. This the amount the font should be scaled by when you issue commands such as drawString(). To calculate this value use the follow formula:</span><span class="tscolor" lg_zh="t_0a2897d0805f4e6d83a9b738287a2193"><span lg_kh="1">(</span>由于这个限制，我们不得不实现verticalPointsPerPixel 的概念，它是当您发出诸如 drawString() 之类的命令时字体应该被缩放的值。要计算此值，请使用以下公式：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">multipler = groupHeightInPoints / heightOfGroup</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_75a3100c1d314fc8a17eb4ca1bdf393f">The height of the group is calculated fairly simply by calculating the difference between the y coordinates of the bounding box of the shape. The height of the group can be calculated by using a convenience called <span class="codefrag">HSSFClientAnchor.getAnchorHeightInPoints()</span>.</span><span class="tscolor" lg_zh="t_75a3100c1d314fc8a17eb4ca1bdf393f"><span lg_kh="1">(</span>通过计算图形边界框的y坐标之间的距离，可以相当简单地计算组的高度。组的高度可以通过使用HSSFClientAnchor.getAnchorHeightInPoints() 来便捷计算。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8653b0f70dde433ba0cd5fdd6aae3fd8">Many of the functions supported by the graphics classes are not complete. Here's some of the functions that are known to work.</span><span class="tscolor" lg_zh="t_8653b0f70dde433ba0cd5fdd6aae3fd8"><span lg_kh="1">(</span>图形类支持的很多功能并不完整。以下是一些已知的有用的功能。<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_f44b0e80d8014f17ad2493902a6aa393">fillRect()</span><span class="tscolor" lg_zh="t_f44b0e80d8014f17ad2493902a6aa393"><span lg_kh="1">(</span>fillRect() 填充矩形<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1f32e5ecf3e64f36b0f9ead0209f7fc7">fillOval()</span><span class="tscolor" lg_zh="t_1f32e5ecf3e64f36b0f9ead0209f7fc7"><span lg_kh="1">(</span>fillOval() 填充椭圆<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_fe5197a55f2e4a2fb047504e7a7e0c93">drawString()</span><span class="tscolor" lg_zh="t_fe5197a55f2e4a2fb047504e7a7e0c93"><span lg_kh="1">(</span>drawString() 绘制字符串<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b8ca263f5f824ff8a38328677bc4a835">drawOval()</span><span class="tscolor" lg_zh="t_b8ca263f5f824ff8a38328677bc4a835"><span lg_kh="1">(</span>drawOval() 绘制椭圆<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_e5914437625848acb32c99901176effa">drawLine()</span><span class="tscolor" lg_zh="t_e5914437625848acb32c99901176effa"><span lg_kh="1">(</span>drawLine() 画线<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_40199c6eff2b48aeaf781a2eed655fab">clearRect()</span><span class="tscolor" lg_zh="t_40199c6eff2b48aeaf781a2eed655fab"><span lg_kh="1">(</span>clearRect() 清除矩形<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_1fe3bc8b06da49f5b8c4ac2a89a4ae23">Functions that are not supported will return and log a message using the POI logging infrastructure (disabled by default).</span><span class="tscolor" lg_zh="t_1fe3bc8b06da49f5b8c4ac2a89a4ae23"><span lg_kh="1">(</span>不受支持的函数将使用POI日志基础结构返回并记录消息（默认情况下禁用）。<span lg_kh="1">)</span></span></p>
     <a name="Outlining" id="Outlining"></a><a name="Outlining-N118D8"></a>
     <h4><span lg_en="t_e92355ffd97d4123ba5fc6478672dec8">Outlining</span><span class="tscolor" lg_zh="t_e92355ffd97d4123ba5fc6478672dec8"><span lg_kh="1">(</span><a href="#Outlining" style="color:blue;">概述</a><span lg_kh="1">)</span></span></h4>
     <p><span lg_en="t_a609c422ff54418db2d644e306ae3891">Outlines are great for grouping sections of information together and can be added easily to columns and rows using the POI API. Here's how:</span><span class="tscolor" lg_zh="t_a609c422ff54418db2d644e306ae3891"><span lg_kh="1">(</span>大纲非常适合将信息部分组合在一起，并且可以使用 POI API 轻松添加到列和行中。如下所示：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet1 = wb.createSheet("new sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 5, 14 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 7, 14 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupRow( 16, 19 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 4, 7 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 9, 12 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.groupColumn( 10, 11 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream(filename)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_a9451e2034c54fb499b863ed8adb4efe">To collapse (or expand) an outline use the following calls:</span><span class="tscolor" lg_zh="t_a9451e2034c54fb499b863ed8adb4efe"><span lg_kh="1">(</span>要折叠（或展开）大纲，请使用以下调用：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setRowGroupCollapsed( 7, true );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet1.setColumnGroupCollapsed( 4, true );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_82052acba8cc41bd864613385752d805">The row/column you choose should contain an already created group. It can be anywhere within the group.</span><span class="tscolor" lg_zh="t_82052acba8cc41bd864613385752d805"><span lg_kh="1">(</span>您选择的行/列应包含已创建的组。它可以是组内的任何位置。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Images" id="Images"></a> <a name="Images-N1197A"></a>
    <h2 class="boxed"><span lg_en="t_037879b4f1984d089d5d91718b25f72e">Images</span><span class="tscolor" lg_zh="t_037879b4f1984d089d5d91718b25f72e"><span lg_kh="1">(</span><a href="#Images" style="color:blue;">图片</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_3d7029b3b35442b99c996d32c537f097">Images are part of the drawing support. To add an image just call <span class="codefrag">createPicture()</span> on the drawing patriarch. At the time of writing the following types are supported:</span><span class="tscolor" lg_zh="t_3d7029b3b35442b99c996d32c537f097"><span lg_kh="1">(</span>图像是绘图支持的一部分。要添加图像，只需在绘图族长上调用 createPicture()。在撰写本文时，它支持以下图片类型：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_e297813f4ecd48e28281660546101113">PNG</span><span class="tscolor" lg_zh="t_e297813f4ecd48e28281660546101113"><span lg_kh="1">(</span>PNG<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_33f48c8c45a44b05bb8752f7ed1afbcb">JPG</span><span class="tscolor" lg_zh="t_33f48c8c45a44b05bb8752f7ed1afbcb"><span lg_kh="1">(</span>JPG<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_62760c2c5cc6491ca349a4ef7fc0ca78">DIB</span><span class="tscolor" lg_zh="t_62760c2c5cc6491ca349a4ef7fc0ca78"><span lg_kh="1">(</span>DIB<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_f1a43eb28be54afeb141215075b6714c">It should be noted that any existing drawings may be erased once you add a image to a sheet.</span><span class="tscolor" lg_zh="t_f1a43eb28be54afeb141215075b6714c"><span lg_kh="1">(</span>应该注意的是，一旦您将图像添加到工作表，任何现有的图纸都可能会被删除。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create a new workbook</span>
      </div>
      <div class="codeline" lg_zh="t_d6cf1e36736449b1bc9aa1eaad84870b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建新工作簿
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span><span lg_en="t_ec639c0ab4b243b0ba01092681e8e25c">or new HSSFWorkbook();</span><span class="tscolor" lg_zh="t_ec639c0ab4b243b0ba01092681e8e25c"><span lg_kh="1">(</span>或新的HSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//add picture data to this workbook.</span>
      </div>
      <div class="codeline" lg_zh="t_112f1665a1024c0c9d2b2bb2cb496219">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将图片数据添加到此工作簿中。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">InputStream is = new FileInputStream("image1.jpeg");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">byte[] bytes = IOUtils.toByteArray(is);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int pictureIdx = wb.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">is.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper helper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create sheet</span>
      </div>
      <div class="codeline" lg_zh="t_4c6e76a414514a22b6e100b69824d365">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建工作表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create the drawing patriarch. This is the top level container for all shapes.</span>
      </div>
      <div class="codeline" lg_zh="t_9d2588d104804fcb9e6c48257e66f416">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建绘图族长。这是所有形状的顶级容器。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Drawing drawing = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//add a picture shape</span>
      </div>
      <div class="codeline" lg_zh="t_5addc51b7256428e955f1207d88d1fce">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//添加图片形状
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ClientAnchor anchor = helper.createClientAnchor();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//set top-left corner of the picture,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//subsequent call of Picture#resize() will operate relative to it</span>
      </div>
      <div class="codeline" lg_zh="t_8a36002c28eb4852adeca1eb82523eea">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置图片左上角，
//随后调用Picture#resize（）将相对于它进行操作
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol1(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow1(2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Picture pict = drawing.createPicture(anchor, pictureIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//auto-size picture relative to its top-left corner</span>
      </div>
      <div class="codeline" lg_zh="t_91161fe0161646c9891b177b56199696">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//相对于其左上角自动调整图片大小
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pict.resize();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//save workbook</span>
      </div>
      <div class="codeline" lg_zh="t_095d41b9b939480da19c74000f4dad08">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//保存工作簿
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String file = "picture.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(wb instanceof XSSFWorkbook) file += "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream fileOut = new FileOutputStream(file)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(fileOut);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <div class="warning">
      <div class="label">
       <span lg_en="t_9e108f27eed3474abc97d7a6891dc162">Warning</span><span class="tscolor" lg_zh="t_9e108f27eed3474abc97d7a6891dc162"><span lg_kh="1">(</span>警告<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_870d667ac5974e239639786eb7ecd6dc">Picture.resize() works only for JPEG and PNG. Other formats are not yet supported.</span><span class="tscolor" lg_zh="t_870d667ac5974e239639786eb7ecd6dc"><span lg_kh="1">(</span>Picture.resize() 仅适用于 JPEG 和 PNG。尚不支持其他格式。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_b4fc0575c6a048a3850eeb0e089d3fc8">Reading images from a workbook:</span><span class="tscolor" lg_zh="t_b4fc0575c6a048a3850eeb0e089d3fc8"><span lg_kh="1">(</span>从工作簿中读取图像：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ist lst = workbook.getAllPictures();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">or (Iterator it = lst.iterator(); it.hasNext(); ) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> PictureData pict = (PictureData)it.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String ext = pict.suggestFileExtension();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> byte[] data = pict.getData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (ext.equals("jpeg")){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try (OutputStream out = new FileOutputStream("pict.jpg")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> out.write(data);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="NamedRanges" id="NamedRanges"></a> <a name="Named+Ranges+and+Named+Cells"></a>
    <h2 class="boxed"><span lg_en="t_4e7b968f168249c9b4953b5370bfef65">Named Ranges and Named Cells</span><span class="tscolor" lg_zh="t_4e7b968f168249c9b4953b5370bfef65"><span lg_kh="1">(</span><a href="#NamedRanges" style="color:blue;">范围命名和单元格命名</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_1622924064b549968f5666ac5157bd5d">Named Range is a way to refer to a group of cells by a name. Named Cell is a degenerate case of Named Range in that the 'group of cells' contains exactly one cell. You can create as well as refer to cells in a workbook by their named range. When working with Named Ranges, the classes <span class="codefrag">org.apache.poi.ss.util.CellReference</span> and <span class="codefrag">org.apache.poi.ss.util.AreaReference</span> are used.</span><span class="tscolor" lg_zh="t_1622924064b549968f5666ac5157bd5d"><span lg_kh="1">(</span>命名范围是一种通过名称引用一组单元格的方法。命名单元格是命名范围的退化情况，因为“单元格组”仅包含一个单元格。您可以通过命名范围创建和引用工作簿中的单元格。使用命名范围时，使用类 org.apache.poi.ss.util.CellReference 和 org.apache.poi.ss.util.AreaReference。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_59522845aa2140d7b5020acea4e0b7a3">Note: Using relative values like 'A1:B1' can lead to unexpected moving of the cell that the name points to when working with the workbook in Microsoft Excel, usually using absolute references like '$A$1:$B$1' avoids this, see also <a href="https://superuser.com/a/1031047/126954">this discussion</a>.</span><span class="tscolor" lg_zh="t_59522845aa2140d7b5020acea4e0b7a3"><span lg_kh="1">(</span>注意：在 Microsoft Excel 中使用工作簿时，使用像“A1:B1”这样的相对值可能会导致名称指向的单元格发生意外移动，通常使用像“$A$1:$B$1”这样的绝对引用可以避免这种情况，另见此<a href="https://superuser.com/a/1031047/126954" target="_blank" style="color:blue;">讨论</a>。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d5964790138d4486ab1305f83326a3ee">Creating Named Range / Named Cell</span><span class="tscolor" lg_zh="t_d5964790138d4486ab1305f83326a3ee"><span lg_kh="1">(</span>创建命名范围/命名单元格<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// setup code</span>
      </div>
      <div class="codeline" lg_zh="t_454db840daf140d3b8704acac8ecb3eb">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置代码
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String sname = "TestSheet", cname = "TestName", cvalue = "TestVal";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet(sname);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.createRow(0).createCell(0).setCellValue(cvalue);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 1. create named range for a single cell using areareference</span>
      </div>
      <div class="codeline" lg_zh="t_6c0da446ffb240b4b8c8cee2ac51b919">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// 1。使用区域参考为单个单元格创建命名范围
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCell = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCell.setNameName(cname + "1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String reference = sname+"!$A$1:$A$1"; //<span><span lg_en="t_8bc7c6b6d99c416099d6a00d74f4f951">area reference</span><span class="tscolor" lg_zh="t_8bc7c6b6d99c416099d6a00d74f4f951"><span lg_kh="1">(</span>区域参照<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCell.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 2. create named range for a single cell using cellreference</span>
      </div>
      <div class="codeline" lg_zh="t_4b71b8143e7a4196a804b28dd5713a5c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// 2。使用cell引用为单个单元格创建命名范围
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel2 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel2.setNameName(cname + "2");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">reference = sname+"!$A$1"; //<span><span lg_en="t_efb4a1f118ef49439a129b73ab244899">cell reference</span><span class="tscolor" lg_zh="t_efb4a1f118ef49439a129b73ab244899"><span lg_kh="1">(</span>单元格引用<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel2.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 3. create named range for an area using AreaReference</span>
      </div>
      <div class="codeline" lg_zh="t_94b6ea9683f449508b5f7db12d9c10dd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// 3.使用AreaReference为区域创建命名范围
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel3 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel3.setNameName(cname + "3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">reference = sname+"!$A$1:$C$5"; //<span><span lg_en="t_9a29dfd8e69f4354886088ddf1e62d50">area reference</span><span class="tscolor" lg_zh="t_9a29dfd8e69f4354886088ddf1e62d50"><span lg_kh="1">(</span>区域参照<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel3.setRefersToFormula(reference);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// 4. create named formula</span>
      </div>
      <div class="codeline" lg_zh="t_2c101efa09bd4694940f49b253c755a1">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// 4。创建命名公式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedCel4 = wb.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel4.setNameName("my_sum");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedCel4.setRefersToFormula("SUM(" + sname + "!$I$2:$I$6)");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_ed3997e4eb0b4224bd35056525e93105">Reading from Named Range / Named Cell</span><span class="tscolor" lg_zh="t_ed3997e4eb0b4224bd35056525e93105"><span lg_kh="1">(</span>从命名范围/命名单元格中读取<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// setup code</span>
      </div>
      <div class="codeline" lg_zh="t_5b35f1c69af34199b5881c83d3688216">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置代码
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String cname = "TestName";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = getMyWorkbook(); //<span><span lg_en="t_dfaba7af758c440884382bf375b77351">retrieve workbook</span><span class="tscolor" lg_zh="t_dfaba7af758c440884382bf375b77351"><span lg_kh="1">(</span>检索工作簿<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// retrieve the named range</span>
      </div>
      <div class="codeline" lg_zh="t_1ee7e50db2184d18a8a4196ac780f704">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//检索命名范围
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int namedCellIdx = wb.getNameIndex(cellName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name aNamedCell = wb.getNameAt(namedCellIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// retrieve the cell at the named range and test its contents</span>
      </div>
      <div class="codeline" lg_zh="t_e3160789a4374a52b0dc10235a596762">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//检索指定范围内的单元格并测试其内容
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AreaReference aref = new AreaReference(aNamedCell.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellReference[] crefs = aref.getAllReferencedCells();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i=0; i&lt;crefs.length; i++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.getSheet(crefs[i].getSheetName());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = sheet.getRow(crefs[i].getRow());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(crefs[i].getCol());</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // extract the cell contents based on cell type etc.</span>
      </div>
      <div class="codeline" lg_zh="t_93c680cebda04dbaa956dbe57784e307">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//根据单元类型等提取单元内容。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_6f23e1050b1c4b888e9376d694b38e14">Reading from non-contiguous Named Ranges</span><span class="tscolor" lg_zh="t_6f23e1050b1c4b888e9376d694b38e14"><span lg_kh="1">(</span>从不连续的命名范围中读取<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Setup code</span>
      </div>
      <div class="codeline" lg_zh="t_b48bcd672e0b4ac99e31c54048b0211b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//设置代码
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String cname = "TestName";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = getMyWorkbook(); //<span><span lg_en="t_2ef2513c4149472d80faef59c72485c5">retrieve workbook</span><span class="tscolor" lg_zh="t_2ef2513c4149472d80faef59c72485c5"><span lg_kh="1">(</span>检索工作簿<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Retrieve the named range</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Will be something like "$C$10,$D$12:$D$14";</span>
      </div>
      <div class="codeline" lg_zh="t_452ff8566d694174985d2b32d9be50df">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//初始化命名范围
//类似于“$C$10，$D$12：$D$14”;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">int namedCellIdx = wb.getNameIndex(cellName);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name aNamedCell = wb.getNameAt(namedCellIdx);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Retrieve the cell at the named range and test its contents</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Will get back one AreaReference for C10, and</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// another for D12 to D14</span>
      </div>
      <div class="codeline" lg_zh="t_ff6bebecbbad4f2b8ee20bf68dafa499">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//初始化指定范围内的单元格并测试其内容
//将恢复一个C10的AreaReference，并且
//D12至D14的另一个
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AreaReference[] arefs = AreaReference.generateContiguous(aNamedCell.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int i=0; i&lt;arefs.length; i++) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Only get the corners of the Area</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // (use arefs[i].getAllReferencedCells() to get all cells)</span>
      </div>
      <div class="codeline" lg_zh="t_3d682130e710407aa9bcad428eb60fdd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//仅获得区域的角落
//（使用arefs[i].getAllReferencedCells（）获取所有单元格）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellReference[] crefs = arefs[i].getCells();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int j=0; j&lt;crefs.length; j++) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Check it turns into real stuff</span>
      </div>
      <div class="codeline" lg_zh="t_2fc38ff58f784c9cba4ea876a2bbfec3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//检查它变成了真实的东西
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Sheet s = wb.getSheet(crefs[j].getSheetName());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row r = s.getRow(crefs[j].getRow());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell c = r.getCell(crefs[j].getCol());</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Do something with this corner cell</span>
      </div>
      <div class="codeline" lg_zh="t_e453e792e02f4a71884695385713fa0e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//用这个角单元格做点什么
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_91cbfd912b16436096795976bbbccbd8">Note, when a cell is deleted, Excel does not delete the attached named range. As result, workbook can contain named ranges that point to cells that no longer exist. You should check the validity of a reference before constructing AreaReference</span><span class="tscolor" lg_zh="t_91cbfd912b16436096795976bbbccbd8"><span lg_kh="1">(</span>请注意，删除单元格时，Excel 不会删除附加的命名范围。因此，工作簿可以包含指向不再存在的单元格的命名范围。您应该在构建 AreaReference 之前检查引用的有效性<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(name.isDeleted()){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //named range points to a deleted cell.</span>
      </div>
      <div class="codeline" lg_zh="t_99e33a16ddbf41bc91b7caec6f3bb780">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//命名范围指向已删除的单元格。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">} else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> AreaReference ref = new AreaReference(name.getRefersToFormula());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="CellComments" id="CellComments"></a> <a name="Cell+Comments+-+HSSF+and+XSSF"></a>
    <h2 class="boxed"><span lg_en="t_99db04d052d94acebfe69b657a626e5b">Cell Comments - HSSF and XSSF</span><span class="tscolor" lg_zh="t_99db04d052d94acebfe69b657a626e5b"><span lg_kh="1">(</span>单元格注释 - HSSF 和 XSSF<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_7576e395700a4dc894ab99976ffecbab">A comment is a rich text note that is attached to &amp; associated with a cell, separate from other cell content. Comment content is stored separate from the cell, and is displayed in a drawing object (like a text box) that is separate from, but associated with, a cell</span><span class="tscolor" lg_zh="t_7576e395700a4dc894ab99976ffecbab"><span lg_kh="1">(</span>注释是附加到单元格并与单元格相关联的富文本注释，与其他单元格内容不相干。注释内容与单元格分开存储，并显示在与单元格分开但与单元格相关联的绘图对象（如文本框）中<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span><span lg_en="t_89dfadc25cc64d08a4eed0cb756908e5">or new HSSFWorkbook();</span><span class="tscolor" lg_zh="t_89dfadc25cc64d08a4eed0cb756908e5"><span lg_kh="1">(</span>或新的HSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper factory = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(5);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("F4");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Drawing drawing = sheet.createDrawingPatriarch();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// When the comment box is visible, have it show in a 1x3 space</span>
      </div>
      <div class="codeline" lg_zh="t_d581d5e9d03d42528292186d9df8f29e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//当注释框可见时，将其显示在1x 3的空间中
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ClientAnchor anchor = factory.createClientAnchor();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol1(cell.getColumnIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setCol2(cell.getColumnIndex()+1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow1(row.getRowNum());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">anchor.setRow2(row.getRowNum()+3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Create the comment and set the text+author</span>
      </div>
      <div class="codeline" lg_zh="t_ce91c9fdba794b4096ff5786dafbb6ed">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建评论并设置文本+作者
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment comment = drawing.createCellComment(anchor);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RichTextString str = factory.createRichTextString("Hello, World!");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment.setString(str);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment.setAuthor("Apache POI");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Assign the comment to the cell</span>
      </div>
      <div class="codeline" lg_zh="t_1fbb7e4a479e4561999273354aafda72">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将评论分配给单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellComment(comment);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">String fname = "comment-xssf.xls";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(wb instanceof XSSFWorkbook) fname += "x";</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream(fname)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_54661e5038954682a0cd6efe750d4d2f">Reading cell comments</span><span class="tscolor" lg_zh="t_54661e5038954682a0cd6efe750d4d2f"><span lg_kh="1">(</span>读取单元格注释<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = sheet.get(3).getColumn(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment comment = cell.getCellComment();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if (comment != null) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> RichTextString str = comment.getString();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String author = comment.getAuthor();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// alternatively you can retrieve cell comments by (row, column)</span>
      </div>
      <div class="codeline" lg_zh="t_44c43da9e2d64107bc567f91dd680a53">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//或者，您可以按（行、列）检索单元格评论
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">comment = sheet.getCellComment(3, 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_1e50e4af77ec4d608398722540835cf1">To get all the comments on a sheet:</span><span class="tscolor" lg_zh="t_1e50e4af77ec4d608398722540835cf1"><span lg_kh="1">(</span>获取工作表上的所有注释：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Map&lt;CellAddress, Comment&gt; comments = sheet.getCellComments();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment commentA1 = comments.get(new CellAddress(0, 0));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Comment commentB1 = comments.get(new CellAddress(0, 1));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (Entry&lt;CellAddress, ? extends Comment&gt; e : comments.entrySet()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellAddress loc = e.getKey();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Comment comment = e.getValue();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Comment at " + loc + ": " +</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "[" + comment.getAuthor() + "] " + comment.getString().getString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
    </div>
    <a name="Autofit" id="Autofit"></a> <a name="Adjust+column+width+to+fit+the+contents"></a>
    <h2 class="boxed"><span lg_en="t_2f1d4b19827e41b3b825e3e3d973a41c">Adjust column width to fit the contents</span><span class="tscolor" lg_zh="t_2f1d4b19827e41b3b825e3e3d973a41c"><span lg_kh="1">(</span>调整列宽以适应内容<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(0); //<span><span lg_en="t_b365da57911447488b6b48f0f66b9e16">adjust width of the first column</span><span class="tscolor" lg_zh="t_b365da57911447488b6b48f0f66b9e16"><span lg_kh="1">(</span>调整第一列的宽度<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(1); //<span><span lg_en="t_2664d27443974170a84f53ae60dfa3ed">adjust width of the second column</span><span class="tscolor" lg_zh="t_2664d27443974170a84f53ae60dfa3ed"><span lg_kh="1">(</span>调整第二列的宽度<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_fe42e0eb130b49809e70121cffc857f6">For SXSSFWorkbooks only, because the random access window is likely to exclude most of the rows in the worksheet, which are needed for computing the best-fit width of a column, the columns must be tracked for auto-sizing prior to flushing any rows.</span><span class="tscolor" lg_zh="t_fe42e0eb130b49809e70121cffc857f6"><span lg_kh="1">(</span>仅对于 SXSSFWorkbooks，由于随机访问窗口可能会排除工作表中的大多数行，而这些行是计算列的最佳适应宽度所需的，因此必须在刷新任何行之前跟踪列以自动调整大小。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFWorkbook workbook = new SXSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SXSSFSheet sheet = workbook.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.trackColumnForAutoSizing(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.trackColumnForAutoSizing(1);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If you have a Collection of column indices, see SXSSFSheet#trackColumnForAutoSizing(Collection&lt;Integer&gt;)</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// or roll your own for-loop.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Alternatively, use SXSSFSheet#trackAllColumnsForAutoSizing() if the columns that will be auto-sized aren't</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// known in advance or you are upgrading existing code and are trying to minimize changes. Keep in mind</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// that tracking all columns will require more memory and CPU cycles, as the best-fit width is calculated</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// on all tracked columns on every row that is flushed.</span>
      </div>
      <div class="codeline" lg_zh="t_f0ef48754e904cf39383b6a30f2f2ca5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//如果您有列索引的集合，请参阅SXSSFsheet#TrackColumnForAutoSizing（集合<Integer>）
//或滚动您自己的for-循环。
//或者，如果将自动调整大小的列未被调整，则使用SXSSFsheet#track AllColumbnsForAutoSizing（）
//提前知道，或者您正在升级现有代码并试图最大限度地减少更改。牢记
//跟踪所有列将需要更多的内存和CPU周期，因为计算最佳宽度
//在刷新的每一行上的所有跟踪列上。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// create some cells</span>
      </div>
      <div class="codeline" lg_zh="t_64f5a7e0ed654fe6bf63961665f37be2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一些单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int r=0; r &lt; 10; r++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = sheet.createRow(r);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int c; c &lt; 10; c++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Cell cell = row.createCell(c);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell.setCellValue("Cell " + c.getAddress().formatAsString());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Auto-size the columns.</span>
      </div>
      <div class="codeline" lg_zh="t_3eadf7021465433796454c6cae991b02">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//自动调整列的大小。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.autoSizeColumn(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_661e9bc831bf4984940fe89b593fc26e">Note, that Sheet#autoSizeColumn() does not evaluate formula cells, the width of formula cells is calculated based on the cached formula result. If your workbook has many formulas then it is a good idea to evaluate them before auto-sizing.</span><span class="tscolor" lg_zh="t_661e9bc831bf4984940fe89b593fc26e"><span lg_kh="1">(</span>请注意，Sheet#autoSizeColumn() 不会计算公式单元格，公式单元格的宽度是根据缓存的公式结果计算的。如果您的工作簿有许多公式，那么在自动调整大小之前评估它们是个好主意。<span lg_kh="1">)</span></span></p>
     <div class="warning">
      <div class="label">
       <span lg_en="t_4f37fa410a8a4875a07ee0c39448a94a">Warning</span><span class="tscolor" lg_zh="t_4f37fa410a8a4875a07ee0c39448a94a"><span lg_kh="1">(</span>警告<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_078bb1ad5cb4498a8c3fa24d112c5389">To calculate column width Sheet.autoSizeColumn uses Java2D classes that throw exception if graphical environment is not available. In case if graphical environment is not available, you must tell Java that you are running in headless mode and set the following system property: <span class="codefrag"> java.awt.headless=true </span>. You should also ensure that the fonts you use in your workbook are available to Java.</span><span class="tscolor" lg_zh="t_078bb1ad5cb4498a8c3fa24d112c5389"><span lg_kh="1">(</span>计算列宽 Sheet.autoSizeColumn 使用 Java2D 类，如果图形环境不可用，则会抛出异常。如果图形环境不可用，您必须告诉 Java 您正在以无头模式运行并设置以下系统属性： java.awt.headless=true 。您还应该确保您在工作簿中使用的字体可用于 Java。<span lg_kh="1">)</span></span>
      </div>
     </div>
    </div>
    <a name="Hyperlinks" id="Hyperlinks"></a> <a name="How+to+read+hyperlinks"></a>
    <h2 class="boxed"><span lg_en="t_e2a0bbbfe632408eb804e33d3b93269a">How to read hyperlinks</span><span class="tscolor" lg_zh="t_e2a0bbbfe632408eb804e33d3b93269a"><span lg_kh="1">(</span>如何读取超链接<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = sheet.getRow(0).getCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link = cell.getHyperlink();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(link != null){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println(link.getAddress());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="How+to+create+hyperlinks"></a>
    <h2 class="boxed"><span lg_en="t_7423561b7d314d43bcf6f9ec513d6105">How to create hyperlinks</span><span class="tscolor" lg_zh="t_7423561b7d314d43bcf6f9ec513d6105"><span lg_kh="1">(</span>如何创建超链接<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook(); //<span><span lg_en="t_eb1ca22ef8ba432d8afa56848dd37bd5">or new HSSFWorkbook();</span><span class="tscolor" lg_zh="t_eb1ca22ef8ba432d8afa56848dd37bd5"><span lg_kh="1">(</span>或新的HSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CreationHelper createHelper = wb.getCreationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//cell style for hyperlinks</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//by default hyperlinks are blue and underlined</span>
      </div>
      <div class="codeline" lg_zh="t_9da1758457974c328caa7c97310ef993">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//超链接的单元格样式
//默认情况下超链接为蓝色并带线
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellStyle hlink_style = wb.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Font hlink_font = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_font.setUnderline(Font.U_SINGLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_font.setColor(IndexedColors.BLUE.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hlink_style.setFont(hlink_font);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet("Hyperlinks");</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//URL</span>
      </div>
      <div class="codeline" lg_zh="t_af26495288904d4a9ccf49a5c0521605">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//URL
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(0).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("URL Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link = createHelper.createHyperlink(Hyperlink.LINK_URL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("https://<span><span lg_en="t_d648c385b4c94f96bd9c9c8d4a099a12">poi.apache.org/");</span><span class="tscolor" lg_zh="t_d648c385b4c94f96bd9c9c8d4a099a12"><span lg_kh="1">(</span>poi.apache.org/");<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//link to a file in the current directory</span>
      </div>
      <div class="codeline" lg_zh="t_20ed2fe7edea49e980566060079c3028">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//链接到当前目录中的文件
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(1).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("File Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link = createHelper.createHyperlink(Hyperlink.LINK_FILE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("link1.xls");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//e-mail link</span>
      </div>
      <div class="codeline" lg_zh="t_81ddb3c07e7341e18fee8300eaade611">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//电子邮件链接
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(2).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Email Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link = createHelper.createHyperlink(Hyperlink.LINK_EMAIL);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//note, if subject contains white spaces, make sure they are url-encoded</span>
      </div>
      <div class="codeline" lg_zh="t_a0fb70af5d4d43b094155421b8147fa5">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//注意，如果主题包含空白，请确保它们是URL编码的
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link.setAddress("mailto:poi@apache.org?subject=Hyperlinks");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//link to a place in this workbook</span>
      </div>
      <div class="codeline" lg_zh="t_0332469406b241a3abaa3733f35c2247">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//链接到此工作簿中的位置
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//create a target sheet and cell</span>
      </div>
      <div class="codeline" lg_zh="t_d304f92f737d42f8a8955b2b027db0d2">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一个目标工作表和单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet2 = wb.createSheet("Target Sheet");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet2.createRow(0).createCell(0).setCellValue("Target Cell");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell = sheet.createRow(3).createCell(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue("Worksheet Link");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Hyperlink link2 = createHelper.createHyperlink(Hyperlink.LINK_DOCUMENT);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">link2.setAddress("'Target Sheet'!A1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setHyperlink(link2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellStyle(hlink_style);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">try (OutputStream out = new FileOutputStream("hyperinks.xlsx")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> wb.write(out);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">wb.close();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Validation" id="Validation"></a> <a name="Data+Validations"></a>
    <h2 class="boxed"><span lg_en="t_88591fd349b4485881be518a4e0de738">Data Validations</span><span class="tscolor" lg_zh="t_88591fd349b4485881be518a4e0de738"><span lg_kh="1">(</span><a href="#Validation" style="color:blue;">数据验证</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_6c54cf0c213745eebc7d7d144f94878b">As of version 3.8, POI has slightly different syntax to work with data validations with .xls and .xlsx formats.</span><span class="tscolor" lg_zh="t_6c54cf0c213745eebc7d7d144f94878b"><span lg_kh="1">(</span>从 3.8 版开始，POI 使用 .xls 和 .xlsx 格式的数据验证的语法略有不同。<span lg_kh="1">)</span></span></p>
     <a name="hssf.usermodel+%28binary+.xls+format%29"></a>
     <h3 class="boxed"><span lg_en="t_c3ee0b830ff04f4e8209e12267146522">hssf.usermodel (binary .xls format)</span><span class="tscolor" lg_zh="t_c3ee0b830ff04f4e8209e12267146522"><span lg_kh="1">(</span>hssf.usermodel (binary .xls format)<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_a2a80dc30f814e5e8a9c6ad48e578b03"><strong>Check the value a user enters into a cell against one or more predefined value(s).</strong></span><span class="tscolor" lg_zh="t_a2a80dc30f814e5e8a9c6ad48e578b03"><span lg_kh="1">(</span>对照一个或多个预定义值检查用户在单元格中输入的值。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9d78daa6dbd64ffabf5cb73aee182bfc">The following code will limit the value the user can enter into cell A1 to one of three integer values, 10, 20 or 30.</span><span class="tscolor" lg_zh="t_9d78daa6dbd64ffabf5cb73aee182bfc"><span lg_kh="1">(</span>以下代码将用户可以在单元格 A1 中输入的值限制为三个整数值之一，即 10、20 或 30。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"10", "20", "30"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation dataValidation = new HSSFDataValidation</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (addressList, dvConstraint);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(dataValidation);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_1a8d54b2f15d442d936a6315e28622c1"><strong> Drop Down Lists:</strong></span><span class="tscolor" lg_zh="t_1a8d54b2f15d442d936a6315e28622c1"><span lg_kh="1">(</span>下拉列表：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a4769689712b4e49b8297529e7d9dce3">This code will do the same but offer the user a drop down list to select a value from.</span><span class="tscolor" lg_zh="t_a4769689712b4e49b8297529e7d9dce3"><span lg_kh="1">(</span>此代码将执行相同的操作，但会为用户提供一个下拉列表以从中选择一个值。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"10", "20", "30"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation dataValidation = new HSSFDataValidation</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (addressList, dvConstraint);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(dataValidation);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_19848b0eb34e41a0b74247be4ec10cf8"><strong>Messages On Error:</strong></span><span class="tscolor" lg_zh="t_19848b0eb34e41a0b74247be4ec10cf8"><span lg_kh="1">(</span>错误消息：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_17ee633c5b684378a20391acc8cc3e03">To create a message box that will be shown to the user if the value they enter is invalid.</span><span class="tscolor" lg_zh="t_17ee633c5b684378a20391acc8cc3e03"><span lg_kh="1">(</span>创建一个消息框，如果用户输入的值无效，该消息框将显示。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setErrorStyle(DataValidation.ErrorStyle.STOP);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.createErrorBox("Box Title", "Message Text");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_6babf0a377ac459ba3eed5f535bc6d5d">Replace 'Box Title' with the text you wish to display in the message box's title bar and 'Message Text' with the text of your error message.</span><span class="tscolor" lg_zh="t_6babf0a377ac459ba3eed5f535bc6d5d"><span lg_kh="1">(</span>将“框标题”替换为您希望在消息框标题栏中显示的文本，将“消息文本”替换为错误消息的文本。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ebae036fb1754cf1810ab34ba30351ee"><strong>Prompts:</strong></span><span class="tscolor" lg_zh="t_ebae036fb1754cf1810ab34ba30351ee"><span lg_kh="1">(</span>提示：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f2d9669432ef48589183cadefc31ecb7">To create a prompt that the user will see when the cell containing the data validation receives focus</span><span class="tscolor" lg_zh="t_f2d9669432ef48589183cadefc31ecb7"><span lg_kh="1">(</span>创建一个提示，当包含数据验证的单元格获得焦点时，用户将看到该提示<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.createPromptBox("Title", "Message Text");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dataValidation.setShowPromptBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_1899954171f849e189343391023cbb92">The text encapsulated in the first parameter passed to the createPromptBox() method will appear emboldened and as a title to the prompt whilst the second will be displayed as the text of the message. The createExplicitListConstraint() method can be passed and array of String(s) containing interger, floating point, dates or text values.</span><span class="tscolor" lg_zh="t_1899954171f849e189343391023cbb92"><span lg_kh="1">(</span>传递给 createPromptBox() 方法的第一个参数中封装的文本将显示为粗体并作为提示的标题，而第二个参数将显示为消息的文本。createExplicitListConstraint()方法可以使用包含整数、浮点、日期或文本值的字符串数组。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d67b2a6edd664c359507101cce6e9632"><strong>Further Data Validations:</strong></span><span class="tscolor" lg_zh="t_d67b2a6edd664c359507101cce6e9632"><span lg_kh="1">(</span>进一步的数据验证：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ae5831582ae84f5fa5e006d5fe59ce58">To obtain a validation that would check the value entered was, for example, an integer between 10 and 100, use the DVConstraint.createNumericConstraint(int, int, String, String) factory method.</span><span class="tscolor" lg_zh="t_ae5831582ae84f5fa5e006d5fe59ce58"><span lg_kh="1">(</span>要获得并检查输入的值是否为 10 到 100 之间的整数，请使用 DVConstraint.createNumericConstraint(int, int, String, String) 工厂方法。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.OperatorType.BETWEEN, "10", "100");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_1fb81c55f2a1417e930606e4279ad51d">Look at the javadoc for the other validation and operator types; also note that not all validation types are supported for this method. The values passed to the two String parameters can be formulas; the '=' symbol is used to denote a formula</span><span class="tscolor" lg_zh="t_1fb81c55f2a1417e930606e4279ad51d"><span lg_kh="1">(</span>查看 javadoc 以了解其他验证和运算符类型；另请注意，此方法并非支持所有验证类型。传递给两个 String 参数的值可以是公式； &#39;=&#39; 符号用于表示公式<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DVConstraint.OperatorType.BETWEEN, "=SUM(A1:A3)", "100");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_58af5fbbbea146139baddbcfe8d3e28b">It is not possible to create a drop down list if the createNumericConstraint() method is called, the setSuppressDropDownArrow(false) method call will simply be ignored.</span><span class="tscolor" lg_zh="t_58af5fbbbea146139baddbcfe8d3e28b"><span lg_kh="1">(</span>如果调用 createNumericConstraint() 方法，则无法创建下拉列表，setSuppressDropDownArrow(false) 方法调用将被忽略。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1d21d5e6481a45bc8a29579418836f84">Date and time constraints can be created by calling the createDateConstraint(int, String, String, String) or the createTimeConstraint(int, String, String). Both are very similar to the above and are explained in the javadoc.</span><span class="tscolor" lg_zh="t_1d21d5e6481a45bc8a29579418836f84"><span lg_kh="1">(</span>可以通过调用 createDateConstraint(int, String, String, String) 或 createTimeConstraint(int, String, String) 来创建日期和时间约束。两者与上述所说非常相似，并在 javadoc 中有说明。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f97de06306c347cfb9b7ed6435445b28"><strong>Creating Data Validations From Spreadsheet Cells.</strong></span><span class="tscolor" lg_zh="t_f97de06306c347cfb9b7ed6435445b28"><span lg_kh="1">(</span>从电子表格单元格创建数据验证。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_107816f19f114f9dbae00b9676913902">The contents of specific cells can be used to provide the values for the data validation and the DVConstraint.createFormulaListConstraint(String) method supports this. To specify that the values come from a contiguous range of cells do either of the following:</span><span class="tscolor" lg_zh="t_107816f19f114f9dbae00b9676913902"><span lg_kh="1">(</span>特定单元格的内容可用于为数据验证提供值，DVConstraint.createFormulaListConstraint(String) 方法支持这一点。要指定验证的值来自连续的单元格范围，请执行以下任一操作：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_efe808d6874140af8c27c0ee198a6021">or</span><span class="tscolor" lg_zh="t_efe808d6874140af8c27c0ee198a6021"><span lg_kh="1">(</span>或者<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_294e9c20d6c7439c89251bfcde9a3894">and in both cases the user will be able to select from a drop down list containing the values from cells A1, A2 and A3.</span><span class="tscolor" lg_zh="t_294e9c20d6c7439c89251bfcde9a3894"><span lg_kh="1">(</span>在这两种情况下，用户都可以从包含单元格 A1、A2 和 A3 的值的下拉列表中进行选择。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5b269e3c4bcd4d519a6efd8ffd39aba0">The data does not have to be as the data validation. To select the data from a different sheet however, the sheet must be given a name when created and that name should be used in the formula. So assuming the existence of a sheet named 'Data Sheet' this will work:</span><span class="tscolor" lg_zh="t_5b269e3c4bcd4d519a6efd8ffd39aba0"><span lg_kh="1">(</span>数据不一定要做数据验证。但是，要从不同的工作表中选择数据，必须在创建工作表时为工作表指定名称，并且要在公式中使用该名称。因此，假设存在名为“Data Sheet”的工作表，应该这样写：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("'Data Sheet'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_c79194b5d6924059a9f0990666bb59aa">as will this:</span><span class="tscolor" lg_zh="t_c79194b5d6924059a9f0990666bb59aa"><span lg_kh="1">(</span>就像这样：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("'Data Sheet'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_6299675d990549969ffb97dc20c7b11b">whilst this will not:</span><span class="tscolor" lg_zh="t_6299675d990549969ffb97dc20c7b11b"><span lg_kh="1">(</span>显然这不会起作用：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Name namedRange = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setNameName("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">namedRange.setRefersToFormula("'Sheet1'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("list1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_cafe9a874413462dada9af5719189182">and nor will this:</span><span class="tscolor" lg_zh="t_cafe9a874413462dada9af5719189182"><span lg_kh="1">(</span>这也不会：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">dvConstraint = DVConstraint.createFormulaListConstraint("'Sheet1'!$A$1:$A$3");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <a name="xssf.usermodel+%28.xlsx+format%29"></a>
     <h3 class="boxed"><span lg_en="t_318d9a27a5bc454c8e0844b00fd55c52">xssf.usermodel (.xlsx format)</span><span class="tscolor" lg_zh="t_318d9a27a5bc454c8e0844b00fd55c52"><span lg_kh="1">(</span>xssf.usermodel (.xlsx format)<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_d372edf5085a424380f7944372792b4f">Data validations work similarly when you are creating an xml based, SpreadsheetML, workbook file; but there are differences. Explicit casts are required, for example, in a few places as much of the support for data validations in the xssf stream was built into the unifying ss stream, of which more later. Other differences are noted with comments in the code.</span><span class="tscolor" lg_zh="t_d372edf5085a424380f7944372792b4f"><span lg_kh="1">(</span>当您创建基于 xml 的 SpreadsheetML 工作簿文件时，数据验证的工作方式类似；但也有区别。例如，在一些地方需要显式强制转换，因为xssf流中对数据验证的大部分支持都内置在统一的ss流中，后续会有更多支持。代码中的注释说明了其他差异<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_6ef42ea89efa4d399dd2d626741c571b"><strong>Check the value the user enters into a cell against one or more predefined value(s).</strong></span><span class="tscolor" lg_zh="t_6ef42ea89efa4d399dd2d626741c571b"><span lg_kh="1">(</span>对照一个或多个预定义值检查用户在单元格中输入的值。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createExplicitListConstraint(new String[]{"11", "21", "31"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation =(XSSFDataValidation)dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Here the boolean value false is passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method. In the hssf.usermodel examples above, the value passed to this</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method is true.</span>
      </div>
      <div class="codeline" lg_zh="t_e6c7a8cd24e34db39f42279cbf1a9e00">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//这里的布尔值false被传递给setSuppressDropDownArrow（）
//方法。在上面的hssf.usermodel示例中，传递给
//方法为true。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note this extra method call. If this method call is omitted, or if the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value false is passed, then Excel will not validate the value the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// user enters into the cell.</span>
      </div>
      <div class="codeline" lg_zh="t_851a55a8a53d45ba9691091f6bc8a868">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//请注意这个额外的方法调用。如果省略此方法调用，或者如果
//传递布尔值为假，则Excel将不会验证
//用户进入单元格。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_24888ec25c30439baafb72b3c90dd07b"><strong>Drop Down Lists:</strong></span><span class="tscolor" lg_zh="t_24888ec25c30439baafb72b3c90dd07b"><span lg_kh="1">(</span>下拉列表：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_61116dffc0f34e52afd86c2bfa4a8ab6">This code will do the same but offer the user a drop down list to select a value from.</span><span class="tscolor" lg_zh="t_61116dffc0f34e52afd86c2bfa4a8ab6"><span lg_kh="1">(</span>此代码将执行相同的操作，但会为用户提供一个下拉列表以从中选择一个值。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createExplicitListConstraint(new String[]{"11", "21", "31"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation = (XSSFDataValidation)dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_bfd161696aae49ab93e3366222e53af7">Note that the call to the setSuppressDropDowmArrow() method can either be simply excluded or replaced with:</span><span class="tscolor" lg_zh="t_bfd161696aae49ab93e3366222e53af7"><span lg_kh="1">(</span>请注意，对 setSuppressDropDowmArrow() 方法的调用可以不写或写成如下形式：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(true);</span>
      </div>
     </div>
     <p><span lg_en="t_0b28b3d423ab4923b85032c7a8458242"><strong>Prompts and Error Messages:</strong></span><span class="tscolor" lg_zh="t_0b28b3d423ab4923b85032c7a8458242"><span lg_kh="1">(</span>提示和错误信息：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_76450dd2201c46bab458a1f17369bf9c">These both exactly mirror the hssf.usermodel so please refer to the 'Messages On Error:' and 'Prompts:' sections above.</span><span class="tscolor" lg_zh="t_76450dd2201c46bab458a1f17369bf9c"><span lg_kh="1">(</span>这些都和 hssf.usermodel一样，因此请参阅上面的'Messages On Error:'和'Prompts:'部分。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d35b7926eaca496b807498e7a0965c80"><strong>Further Data Validations:</strong></span><span class="tscolor" lg_zh="t_d35b7926eaca496b807498e7a0965c80"><span lg_kh="1">(</span>进一步的数据验证：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_cd5b9938391b4b578eb90dbab10df510">To obtain a validation that would check the value entered was, for example, an integer between 10 and 100, use the XSSFDataValidationHelper(s) createNumericConstraint(int, int, String, String) factory method.</span><span class="tscolor" lg_zh="t_cd5b9938391b4b578eb90dbab10df510"><span lg_kh="1">(</span>例如，要获得并检查输入值是否为 10 到 100 之间的整数，请使用 XSSFDataValidationHelper(s) createNumericConstraint(int, int, String, String) 工厂方法。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.OperatorType.BETWEEN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "10", "100");</span>
      </div>
     </div>
     <p><span lg_en="t_c6a4c0b74c88467689f16569eafcb42d">The values passed to the final two String parameters can be formulas; the '=' symbol is used to denote a formula. Thus, the following would create a validation the allows values only if they fall between the results of summing two cell ranges</span><span class="tscolor" lg_zh="t_c6a4c0b74c88467689f16569eafcb42d"><span lg_kh="1">(</span>传递给最后两个 String 参数的值可以是公式； &#39;=&#39; 符号用于表示公式。因此，以下内容将创建一个验证，仅当值介于两个单元格范围求和的结果之间时，才允许进行验证<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createNumericConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.ValidationType.INTEGER,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFDataValidationConstraint.OperatorType.BETWEEN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "=SUM(A1:A10)", "=SUM(B24:B27)");</span>
      </div>
     </div>
     <p><span lg_en="t_c8c06227a6324f65b80fd5a7b0def33e">It is not possible to create a drop down list if the createNumericConstraint() method is called, the setSuppressDropDownArrow(true) method call will simply be ignored.</span><span class="tscolor" lg_zh="t_c8c06227a6324f65b80fd5a7b0def33e"><span lg_kh="1">(</span>如果调用 createNumericConstraint() 方法，则无法创建下拉列表，setSuppressDropDownArrow(true) 方法调用将被忽略。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_50ca4f116dee4eff8cbc7b5f3f2a0cbf">Please check the javadoc for other constraint types as examples for those will not be included here. There are, for example, methods defined on the XSSFDataValidationHelper class allowing you to create the following types of constraint; date, time, decimal, integer, numeric, formula, text length and custom constraints.</span><span class="tscolor" lg_zh="t_50ca4f116dee4eff8cbc7b5f3f2a0cbf"><span lg_kh="1">(</span>请检查 javadoc 以了解其他约束类型，因为这里没有这些约束类型的示例。例如，在 XSSFDataValidationHelper 类中定义的方法允许您创建以下类型的约束；日期、时间、小数、整数、数字、公式、文本长度和自定义约束。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7ac97c11face47caa7c2e54d547faf20"><strong>Creating Data Validations From Spread Sheet Cells:</strong></span><span class="tscolor" lg_zh="t_7ac97c11face47caa7c2e54d547faf20"><span lg_kh="1">(</span>从电子表格单元格创建数据验证：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_68f5aba44e5945949727e704fcf1f35b">One other type of constraint not mentioned above is the formula list constraint. It allows you to create a validation that takes it value(s) from a range of cells. This code</span><span class="tscolor" lg_zh="t_68f5aba44e5945949727e704fcf1f35b"><span lg_kh="1">(</span>上面未提及的另一种类型的约束是公式列表约束。它允许您创建一个从一系列单元格中获取值的验证。如下代码<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createFormulaListConstraint("$A$1:$F$1");</span>
      </div>
     </div>
     <p><span lg_en="t_5cd22fad4ba841ecae06af5671c8b157">would create a validation that took it's values from cells in the range A1 to F1.</span><span class="tscolor" lg_zh="t_5cd22fad4ba841ecae06af5671c8b157"><span lg_kh="1">(</span>将创建一个从 A1 到 F1 范围内的单元格值的验证。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d864633535ce4669b83f45e055e1ee15">The usefulness of this technique can be extended if you use named ranges like this;</span><span class="tscolor" lg_zh="t_d864633535ce4669b83f45e055e1ee15"><span lg_kh="1">(</span>如果您使用这样的命名范围，则可以扩展此技术的实用性；<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFName name = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setNameName("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setRefersToFormula("$B$1:$F$1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createFormulaListConstraint("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> 0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFDataValidation validation = (XSSFDataValidation)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvHelper.createValidation(dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_fcd1f06445ed4a199b2a6d9b486bcbf4">OpenOffice Calc has slightly different rules with regard to the scope of names. Excel supports both Workbook and Sheet scope for a name but Calc does not, it seems only to support Sheet scope for a name. Thus it is often best to fully qualify the name for the region or area something like this;</span><span class="tscolor" lg_zh="t_fcd1f06445ed4a199b2a6d9b486bcbf4"><span lg_kh="1">(</span>OpenOffice Calc 在名称范围方面的规则略有不同。Excel支持工作簿和工作表范围的名称，但Calc不支持，它似乎只支持工作表范围的名称。因此，通常最好完全限定该地区或区域的名称，例如：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFName name = workbook.createName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setNameName("data");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">name.setRefersToFormula("'Data Validation'!$B$1:$F$1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">....</span>
      </div>
     </div>
     <p><span lg_en="t_c098101fade747e5b86257649c78dc16">This does open a further, interesting opportunity however and that is to place all of the data for the validation(s) into named ranges of cells on a hidden sheet within the workbook. These ranges can then be explicitly identified in the setRefersToFormula() method argument.</span><span class="tscolor" lg_zh="t_c098101fade747e5b86257649c78dc16"><span lg_kh="1">(</span>然而，这带来了另一个有趣的机会，那就是将所有用于验证的数据放入工作簿中一个隐藏工作表上的命名单元格区域。然后可以在setRefersToFormula（）方法参数中显式标识这些范围<span lg_kh="1">)</span></span></p>
     <a name="ss.usermodel"></a>
     <h3 class="boxed"><span lg_en="t_124099d4a81e4797843a6d781c0644e2">ss.usermodel</span><span class="tscolor" lg_zh="t_124099d4a81e4797843a6d781c0644e2"><span lg_kh="1">(</span>ss.usermodel<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_654a653141ca4a07ae799a6970e5310c">The classes within the ss.usermodel package allow developers to create code that can be used to generate both binary (.xls) and SpreadsheetML (.xlsx) workbooks.</span><span class="tscolor" lg_zh="t_654a653141ca4a07ae799a6970e5310c"><span lg_kh="1">(</span>ss.usermodel 包中的类允许开发人员创建可用于生成二进制 (.xls) 和 SpreadsheetML (.xlsx) 工作簿的代码。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a225e111976849d0a9fef056fa632504">The techniques used to create data validations share much in common with the xssf.usermodel examples above. As a result just one or two examples will be presented here.</span><span class="tscolor" lg_zh="t_a225e111976849d0a9fef056fa632504"><span lg_kh="1">(</span>用于创建数据验证的技术与上面的 xssf.usermodel 示例有很多共同之处。因此，这里只介绍一两个示例。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_329992d38083496d9019de6d38924a24"><strong>Check the value the user enters into a cell against one or more predefined value(s).</strong></span><span class="tscolor" lg_zh="t_329992d38083496d9019de6d38924a24"><span lg_kh="1">(</span>对照一个或多个预定义值检查用户在单元格中输入的值。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span><span lg_en="t_754e47d1d61c45678a0acd6eb2b70c02">or new HSSFWorkbook</span><span class="tscolor" lg_zh="t_754e47d1d61c45678a0acd6eb2b70c02"><span lg_kh="1">(</span>或新的HSSF工作簿<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"13", "23", "33"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note the check on the actual type of the DataValidation object.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If it is an instance of the XSSFDataValidation class then the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value 'false' must be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method and an explicit call made to the setShowErrorBox() method.</span>
      </div>
      <div class="codeline" lg_zh="t_78ce6d8cb7874f9aae7ebf40ecf69d3d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//请注意对数据验证对象的实际类型的检查。
//如果它是XSSFDataVal类的实例，那么
//布尔值“true”必须传递给setSuppressDropDownArrow（）
//方法以及对setShowWRBox（）方法的显式调用。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(validation instanceof XSSFDataValidation) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // If the Datavalidation contains an instance of the HSSFDataValidation</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // class then 'true' should be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // method and the call to setShowErrorBox() is not necessary.</span>
      </div>
      <div class="codeline" lg_zh="t_1e8513ea4da14e25a8656f2dc3f0c113">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//如果Data validation包含HSSFDatavalidation的实例
//类则应将“true”传递给setSuppressDropDownArrow（）
//方法和对setShowWRBox（）的调用是不必要的。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_9e8e82841b374132acf10ba53704b878"><strong>Drop Down Lists:</strong></span><span class="tscolor" lg_zh="t_9e8e82841b374132acf10ba53704b878"><span lg_kh="1">(</span>下拉列表：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ff9584a95b2a4257926f8a983f753dca">This code will do the same but offer the user a drop down list to select a value from.</span><span class="tscolor" lg_zh="t_ff9584a95b2a4257926f8a983f753dca"><span lg_kh="1">(</span>此代码将执行相同的操作，但会为用户提供一个下拉列表以从中选择一个值。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span><span lg_en="t_be93f3c923024447b90ba96732a70721">or new HSSFWorkbook</span><span class="tscolor" lg_zh="t_be93f3c923024447b90ba96732a70721"><span lg_kh="1">(</span>或新的HSSF工作簿<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Data Validation");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createExplicitListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> new String[]{"13", "23", "33"});</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Note the check on the actual type of the DataValidation object.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// If it is an instance of the XSSFDataValidation class then the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// boolean value 'false' must be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// method and an explicit call made to the setShowErrorBox() method.</span>
      </div>
      <div class="codeline" lg_zh="t_d09e319ff4484518917756fd6a9a90ad">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//请注意对数据验证对象的实际类型的检查。
//如果它是XSSFDataVal类的实例，那么
//布尔值“true”必须传递给setSuppressDropDownArrow（）
//方法以及对setShowWRBox（）方法的显式调用。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(validation instanceof XSSFDataValidation) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setShowErrorBox(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // If the Datavalidation contains an instance of the HSSFDataValidation</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // class then 'true' should be passed to the setSuppressDropDownArrow()</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // method and the call to setShowErrorBox() is not necessary.</span>
      </div>
      <div class="codeline" lg_zh="t_7c478b9da9834fa899e1b7ee8e10ec1f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//如果Data validation包含HSSFDatavalidation的实例
//类则应将“true”传递给setSuppressDropDownArrow（）
//方法和对setShowWRBox（）的调用是不必要的。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> validation.setSuppressDropDownArrow(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_d4237fd59aea4f10ba77a3d416149886"><strong>Prompts and Error Messages:</strong></span><span class="tscolor" lg_zh="t_d4237fd59aea4f10ba77a3d416149886"><span lg_kh="1">(</span>提示和错误信息：<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_27245f2b36ea4b62a47464e2789cb697">These both exactly mirror the hssf.usermodel so please refer to the 'Messages On Error:' and 'Prompts:' sections above.</span><span class="tscolor" lg_zh="t_27245f2b36ea4b62a47464e2789cb697"><span lg_kh="1">(</span>这些都和 hssf.usermodel一样，因此请参阅上面的'Messages On Error:'和'Prompts:'部分。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c9b4635ad8a745c59a6ec2099f642a5f">As the differences between the ss.usermodel and xssf.usermodel examples are small - restricted largely to the way the DataValidationHelper is obtained, the lack of any need to explicitly cast data types and the small difference in behaviour between the hssf and xssf interpretation of the setSuppressDropDowmArrow() method, no further examples will be included in this section.</span><span class="tscolor" lg_zh="t_c9b4635ad8a745c59a6ec2099f642a5f"><span lg_kh="1">(</span>由于 ss.usermodel 和 xssf.usermodel 示例之间的差异很小 - 主要限于获取 DataValidationHelper 的方式，不需要显式转换数据类型，以及SetSuppressDropDowmorrow（）方法的hssf和xssf解释之间的行为差异很小，本节不再举例。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_2ec39cae26d9474092225b15d11bc7b7"><strong>Advanced Data Validations.</strong></span><span class="tscolor" lg_zh="t_2ec39cae26d9474092225b15d11bc7b7"><span lg_kh="1">(</span>高级数据验证。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0a1839a7175043f4bd0c8c61749d30f8"><strong>Dependent Drop Down Lists.</strong></span><span class="tscolor" lg_zh="t_0a1839a7175043f4bd0c8c61749d30f8"><span lg_kh="1">(</span>从属下拉列表。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_64c82575a7b2431ba0c43d70a5ac18f5">In some cases, it may be necessary to present to the user a sheet which contains more than one drop down list. Further, the choice the user makes in one drop down list may affect the options that are presented to them in the second or subsequent drop down lists. One technique that may be used to implement this behaviour will now be explained.</span><span class="tscolor" lg_zh="t_64c82575a7b2431ba0c43d70a5ac18f5"><span lg_kh="1">(</span>在某些情况下，可能需要向用户呈现包含多个下拉列表的工作表。此外，用户在一个下拉列表中所做的选择可能会影响在第二个或后续下拉列表中呈现给他们的选项。现在将讲述可用于实现该行为的一种技术。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7fbf572402b84b84b575b3c96b5c59df">There are two keys to the technique; one is to use named areas or regions of cells to hold the data for the drop down lists, the second is to use the INDIRECT() function to convert between the name and the actual addresses of the cells. In the example section there is a complete working example- called LinkedDropDownLists.java - that demonstrates how to create linked or dependent drop down lists. Only the more relevant points are explained here.</span><span class="tscolor" lg_zh="t_7fbf572402b84b84b575b3c96b5c59df"><span lg_kh="1">(</span>该技术有两个关键；一种是使用命名区域或单元格区域来保存下拉列表的数据，第二种是使用 INDIRECT() 函数在单元格的名称和实际地址之间进行转换。在示例部分有一个完整的工作示例——名为 LinkedDropDownLists.java——它演示了如何创建链接或依赖下拉列表。这里只解释更相关的点。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4e9b69653d6f487a9636151a1bfebaf1">To create two drop down lists where the options shown in the second depend upon the selection made in the first, begin by creating a named region of cells to hold all of the data for populating the first drop down list. Next, create a data validation that will look to this named area for its data, something like this;</span><span class="tscolor" lg_zh="t_4e9b69653d6f487a9636151a1bfebaf1"><span lg_kh="1">(</span>要创建两个下拉列表，其中第二个中显示的选项取决于第一个中所做的选择，首先创建一个命名的单元格区域来保存用于填充第一个下拉列表的所有数据。接下来，创建一个数据验证，它将在这个命名区域中查找其数据，如下所示；<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationHelper dvHelper = sheet.getDataValidationHelper();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createFormulaListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "CHOICES");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_c6b2558790e74f5eace8445d0697e1df">Note that the name of the area - in the example above it is 'CHOICES' - is simply passed to the createFormulaListConstraint() method. This is sufficient to cause Excel to populate the drop down list with data from that named region.</span><span class="tscolor" lg_zh="t_c6b2558790e74f5eace8445d0697e1df"><span lg_kh="1">(</span>请注意，区域的名称（在上面的示例中为“CHOICES”）只是传递给 createFormulaListConstraint() 方法。这足以使 Excel 使用来自该命名区域的数据填充下拉列表。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_28b47ea0eac74bf1acd284edf76be1a6">Next, for each of the options the user could select in the first drop down list, create a matching named region of cells. The name of that region should match the text the user could select in the first drop down list. Note, in the example, all upper case letters are used in the names of the regions of cells.</span><span class="tscolor" lg_zh="t_28b47ea0eac74bf1acd284edf76be1a6"><span lg_kh="1">(</span>接下来，对于用户可以在第一个下拉列表中选择的每个选项，创建一个匹配的命名单元格区域。该区域的名称应与用户可以在第一个下拉列表中选择的文本相匹配。请注意，在示例中，所有大写字母都用于单元格区域的名称中。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a195550a80604f38b8b5b1fc44910855">Now, very similar code can be used to create a second, linked, drop down list;</span><span class="tscolor" lg_zh="t_a195550a80604f38b8b5b1fc44910855"><span lg_kh="1">(</span>现在，可以使用非常相似的代码来创建第二个链接的下拉列表；<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 1, 1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidationConstraint dvConstraint = dvHelper.createFormulaListConstraint(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> "INDIRECT(UPPER($A$1))");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DataValidation validation = dvHelper.createValidation(</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> dvConstraint, addressList);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.addValidationData(validation);</span>
      </div>
     </div>
     <p><span lg_en="t_c9df6e52a405461f91bb1ae298417194">The key here is in the following Excel function - INDIRECT(UPPER($A$1)) - which is used to populate the second, linked, drop down list. Working from the inner-most pair of brackets, it instructs Excel to look at the contents of cell A1, to convert what it reads there into upper case – as upper case letters are used in the names of each region - and then convert this name into the addresses of those cells that contain the data to populate another drop down list.</span><span class="tscolor" lg_zh="t_c9df6e52a405461f91bb1ae298417194"><span lg_kh="1">(</span>这里的关键在于以下 Excel 函数 - INDIRECT(UPPER($A$1)) - 用于填充第二个链接的下拉列表。从最里面的一对括号开始，它指示 Excel 查看单元格 A1 的内容，将其中读取的内容转换为大写字母 - 因为每个区域的名称中使用大写字母 - 然后转换此名称到包含数据的单元格的地址以填充另一个下拉列表。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Embedded" id="Embedded"></a> <a name="Embedded+Objects"></a>
    <h2 class="boxed"><span lg_en="t_0443af253f89498cb60f890286375432">Embedded Objects</span><span class="tscolor" lg_zh="t_0443af253f89498cb60f890286375432"><span lg_kh="1">(</span><a href="#Embedded" style="color:blue;">嵌入对象</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_ca47750fc01d4a09a3025e96cd02ea76">It is possible to perform more detailed processing of an embedded Excel, Word or PowerPoint document, or to work with any other type of embedded object.</span><span class="tscolor" lg_zh="t_ca47750fc01d4a09a3025e96cd02ea76"><span lg_kh="1">(</span>可以对嵌入的 Excel、Word 或 PowerPoint 文档执行更详细的处理，或者使用任何其他类型的嵌入对象。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4858a8bfdec1431ab1e53f881b7e67ef"><strong>HSSF:</strong></span><span class="tscolor" lg_zh="t_4858a8bfdec1431ab1e53f881b7e67ef"><span lg_kh="1">(</span>HSSF：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POIFSFileSystem fs = new POIFSFileSystem(new File("excel_with_embeded.xls"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFWorkbook workbook = new HSSFWorkbook(fs);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (HSSFObjectData obj : workbook.getAllEmbeddedObjects()) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //the OLE2 Class Name of the object</span>
      </div>
      <div class="codeline" lg_zh="t_313c381fa5904c7b8f4ffe2cc325e420">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//对象的MBE 2类名称
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String oleName = obj.getOLE2ClassName();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (oleName.equals("Worksheet")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(dn, false);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedWorkbook.getNumberOfSheets());</span>
      </div>
      <div class="codeline" lg_zh="t_e4595f398ddb4b96bc64c5504fc0f92c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//System.out.println（entry.getName（）+“：”+ embeddedWorkbook.getNumberOfSheets（））;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (oleName.equals("Document")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HWPFDocument embeddedWordDocument = new HWPFDocument(dn);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedWordDocument.getRange().text());</span>
      </div>
      <div class="codeline" lg_zh="t_94d6916493444b47bd0c8178031aaeb0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//System.out.println（entry.getName（）+“：”+ embeddedWordDocument.getRange（）.text（））;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else if (oleName.equals("Presentation")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SlideShow&lt;?,?&gt; embeddedPowerPointDocument = new HSLFSlideShow(dn);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(entry.getName() + ": " + embeddedPowerPointDocument.getSlides().length);</span>
      </div>
      <div class="codeline" lg_zh="t_539b2109649a4b398ebdd77884a6cf7c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//System.out.println（entry.getName（）+“：”+ embeddedPowerPointDocument.getSlides（）. size）;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(obj.hasDirectoryEntry()){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // The DirectoryEntry is a DocumentNode. Examine its entries to find out what it is</span>
      </div>
      <div class="codeline" lg_zh="t_2d47be3322d04140adae7b85c36fdeb4">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//DirectoryEntry是DocumentNode。检查它的条目，找出它是什么
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DirectoryNode dn = (DirectoryNode) obj.getDirectory();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (Entry entry : dn) {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> //System.out.println(oleName + "." + entry.getName());</span>
      </div>
      <div class="codeline" lg_zh="t_7387368365064e68aa04e8cadad87ec6">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//System.out.println（oleName +”。“+ entry.getName（））;
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // There is no DirectoryEntry</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Recover the object's data from the HSSFObjectData instance.</span>
      </div>
      <div class="codeline" lg_zh="t_eec469f06f114d7dba15daa6c49251a0">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//没有Diretoryentry
//从HSSFjectData实例恢复对象的数据。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> byte[] objectData = obj.getObjectData();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_6df8e30c0cb44f2ca0392086b4809efe"><strong>XSSF:</strong></span><span class="tscolor" lg_zh="t_6df8e30c0cb44f2ca0392086b4809efe"><span lg_kh="1">(</span>XSSF：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook workbook = new XSSFWorkbook("excel_with_embeded.xlsx");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (PackagePart pPart : workbook.getAllEmbeddedParts()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> String contentType = pPart.getContentType();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel Workbook - either binary or OpenXML</span>
      </div>
      <div class="codeline" lg_zh="t_428b197afc2440ed91f00e2d71be55cf">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Excel工作簿-二进制或OpenML
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (contentType.equals("application/vnd.ms-excel")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel Workbook - OpenXML file format</span>
      </div>
      <div class="codeline" lg_zh="t_112ac18607bf40efa748d6988e07d17f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Excel工作簿-OpenML文件格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSSFWorkbook embeddedWorkbook = new XSSFWorkbook(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Word Document - binary (OLE2CDF) file format</span>
      </div>
      <div class="codeline" lg_zh="t_d33a1938696d41038aaa59d2748d6ce7">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Word文档-二进制（MBE 2 EDF）文件格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/msword")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HWPFDocument document = new HWPFDocument(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Word Document - OpenXML file format</span>
      </div>
      <div class="codeline" lg_zh="t_6d90cc6473034248ba123840f722bb9f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Word文档-OpenML文件格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.wordprocessingml.document")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XWPFDocument document = new XWPFDocument(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // PowerPoint Document - binary file format</span>
      </div>
      <div class="codeline" lg_zh="t_35f5940d45cf47b395cc40098d4b6a58">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// PowerPoint文档-二进制文件格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.ms-powerpoint")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> HSLFSlideShow slideShow = new HSLFSlideShow(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // PowerPoint Document - OpenXML file format</span>
      </div>
      <div class="codeline" lg_zh="t_f229f41151504e28b28e4874f222f796">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// PowerPoint文档-OpenML文件格式
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else if (contentType.equals("application/vnd.openxmlformats-officedocument.presentationml.presentation")) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> XSLFSlideShow slideShow = new XSLFSlideShow(docPackage);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Any other type of embedded object.</span>
      </div>
      <div class="codeline" lg_zh="t_9c18f1b491624ce2b8ec0a6833ccdc8f">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//任何其他类型的嵌入对象。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> else {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> System.out.println("Unknown Embedded Document: " + contentType);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> InputStream inputStream = pPart.getInputStream();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Autofilter" id="Autofilter"></a>
    <p><span lg_en="t_f1160ec5a95248dcbd922b8fb68faeff">(Since POI-3.7)</span><span class="tscolor" lg_zh="t_f1160ec5a95248dcbd922b8fb68faeff"><span lg_kh="1">(</span>（自 POI-3.7 起）<span lg_kh="1">)</span></span></p>
    <a name="Autofilters"></a>
    <h2 class="boxed"><span lg_en="t_cff02acc8c2746b2a60c63a72141ed57">Autofilters</span><span class="tscolor" lg_zh="t_cff02acc8c2746b2a60c63a72141ed57"><span lg_kh="1">(</span><a href="#Autofilter" style="color:blue;">自动过滤器</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new HSSFWorkbook(); //<span><span lg_en="t_6e6b3fe309584d998367103f5eefc87e">or new XSSFWorkbook();</span><span class="tscolor" lg_zh="t_6e6b3fe309584d998367103f5eefc87e"><span lg_kh="1">(</span>或新的XSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheet.setAutoFilter(CellRangeAddress.valueOf("C5:F200"));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="ConditionalFormatting" id="ConditionalFormatting"></a> <a name="Conditional+Formatting"></a>
    <h2 class="boxed"><span lg_en="t_ace853548919493fa92bf6e873e5f5ff">Conditional Formatting</span><span class="tscolor" lg_zh="t_ace853548919493fa92bf6e873e5f5ff"><span lg_kh="1">(</span><a href="#ConditionalFormatting" style="color:blue;">条件格式</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new HSSFWorkbook(); //<span><span lg_en="t_247e8fe87edc49ff8ca056bfd0dd282a">or new XSSFWorkbook();</span><span class="tscolor" lg_zh="t_247e8fe87edc49ff8ca056bfd0dd282a"><span lg_kh="1">(</span>或新的XSSFWorkbook（）;<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SheetConditionalFormatting sheetCF = sheet.getSheetConditionalFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule rule1 = sheetCF.createConditionalFormattingRule(ComparisonOperator.EQUAL, "0");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FontFormatting fontFmt = rule1.createFontFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fontFmt.setFontStyle(true, false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">fontFmt.setFontColorIndex(IndexedColors.DARK_RED.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BorderFormatting bordFmt = rule1.createBorderFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderBottom(BorderStyle.THIN);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderTop(BorderStyle.THICK);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderLeft(BorderStyle.DASHED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">bordFmt.setBorderRight(BorderStyle.DOTTED);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PatternFormatting patternFmt = rule1.createPatternFormatting();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">patternFmt.setFillBackgroundColor(IndexedColors.YELLOW.index);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule rule2 = sheetCF.createConditionalFormattingRule(ComparisonOperator.BETWEEN, "-10", "10");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ConditionalFormattingRule [] cfRules =</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">{</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> rule1, rule2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">};</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellRangeAddress[] regions = {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellRangeAddress.valueOf("A3:A5")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">};</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">sheetCF.addConditionalFormatting(regions, cfRules);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_2f8cd8d76248456bb711334c9db93c10">See more examples on Excel conditional formatting in <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/ss/ConditionalFormats.java">ConditionalFormats.java</a></span><span class="tscolor" lg_zh="t_2f8cd8d76248456bb711334c9db93c10"><span lg_kh="1">(</span>在 <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/ss/ConditionalFormats.java" style="color:blue;" target="_blank">ConditionalFormats.java</a>中查看有关 Excel 条件格式的更多示例<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Hiding" id="Hiding"></a> <a name="Hiding+and+Un-Hiding+Rows"></a>
    <h2 class="boxed"><span lg_en="t_c8ba0c0509344282b2076dfa89e8d33d">Hiding and Un-Hiding Rows</span><span class="tscolor" lg_zh="t_c8ba0c0509344282b2076dfa89e8d33d"><span lg_kh="1">(</span><a href="#Hiding" style="color:blue;">隐藏和显示隐藏行</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_9349cb5f2c09434ab39108595421c476">Using Excel, it is possible to hide a row on a worksheet by selecting that row (or rows), right clicking once on the right hand mouse button and selecting 'Hide' from the pop-up menu that appears.</span><span class="tscolor" lg_zh="t_9349cb5f2c09434ab39108595421c476"><span lg_kh="1">(</span>使用 Excel，可以通过选择该行（或多行）、单击鼠标右键并从出现的弹出菜单中选择“隐藏”来隐藏工作表上的一行。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_67f2e4b6f7834498ab1e070e5d4abcdd">To emulate this using POI, simply call the setZeroHeight() method on an instance of either XSSFRow or HSSFRow (the method is defined on the ss.usermodel.Row interface that both classes implement), like this:</span><span class="tscolor" lg_zh="t_67f2e4b6f7834498ab1e070e5d4abcdd"><span lg_kh="1">(</span>要使用 POI 进行模拟，只需在 XSSFRow 或 HSSFRow 的实例上调用 setZeroHeight() 方法（该方法在两个类都实现的 ss.usermodel.Row 接口上定义），如下所示：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span><span lg_en="t_40181ecd74764b0091f2c301d1cda0c4">OR new HSSFWorkbook()</span><span class="tscolor" lg_zh="t_40181ecd74764b0091f2c301d1cda0c4"><span lg_kh="1">(</span>或新的HSSFWorkbook（）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = workbook.createRow(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">row.setZeroHeight();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_06716c0d03e54eb5ade82c00222c2ea9">If the file were saved away to disc now, then the first row on the first sheet would not be visible.</span><span class="tscolor" lg_zh="t_06716c0d03e54eb5ade82c00222c2ea9"><span lg_kh="1">(</span>如果现在将文件保存到光盘，则第一个工作表上的第一行将不可见。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_f8f9c26948cd4cfe8077ca0416f07f5d">Using Excel, it is possible to unhide previously hidden rows by selecting the row above and the row below the one that is hidden and then pressing and holding down the Ctrl key, the Shift and the pressing the number 9 before releasing them all.</span><span class="tscolor" lg_zh="t_f8f9c26948cd4cfe8077ca0416f07f5d"><span lg_kh="1">(</span>使用 Excel，可以显示隐藏的行，方法是选择隐藏行的上方和下方的行，然后按住 Ctrl 键、Shift 和按数字 9，然后再释放它们。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_32053245f33641df95c96b2bbb348345">To emulate this behaviour using POI do something like this:</span><span class="tscolor" lg_zh="t_32053245f33641df95c96b2bbb348345"><span lg_kh="1">(</span>要使用 POI 模拟此行为，请执行以下操作：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = WorkbookFactory.create(new File(.......));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet = workbook.getSheetAt(0);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Iterator&lt;Row&gt; row Iter = sheet.iterator();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">while(rowIter.hasNext()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Row row = rowIter.next();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if(row.getZeroHeight()) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row.setZeroHeight(false);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_ebf56489563e4a5cbb6bf0da351695d8">If the file were saved away to disc now, any previously hidden rows on the first sheet of the workbook would now be visible.</span><span class="tscolor" lg_zh="t_ebf56489563e4a5cbb6bf0da351695d8"><span lg_kh="1">(</span>如果现在将文件保存到光盘上，那么现在可以看到工作簿第一张表上以前隐藏的行。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1a01e97d798542ad887ad237c08b5127">The example illustrates two features. Firstly, that it is possible to unhide a row simply by calling the setZeroHeight() method and passing the boolean value 'false'. Secondly, it illustrates how to test whether a row is hidden or not. Simply call the getZeroHeight() method and it will return 'true' if the row is hidden, 'false' otherwise.</span><span class="tscolor" lg_zh="t_1a01e97d798542ad887ad237c08b5127"><span lg_kh="1">(</span>该示例说明了两个功能。首先，可以简单地通过调用 setZeroHeight() 方法并传递布尔值“false”来取消隐藏一行。其次，它说明了如何测试一行是否隐藏。只需调用 getZeroHeight() 方法，如果该行被隐藏，它将返回“true”，否则返回“false”。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="CellProperties" id="CellProperties"></a> <a name="Setting+Cell+Properties"></a>
    <h2 class="boxed"><span lg_en="t_58c6beb164b345248da8f74968c022a2">Setting Cell Properties</span><span class="tscolor" lg_zh="t_58c6beb164b345248da8f74968c022a2"><span lg_kh="1">(</span><a href="#CellProperties" style="color:blue;">设置单元格属性</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_f86c612a79b8434a890598f34b6118ae">Sometimes it is easier or more efficient to create a spreadsheet with basic styles and then apply special styles to certain cells such as drawing borders around a range of cells or setting fills for a region. CellUtil.setCellProperties lets you do that without creating a bunch of unnecessary intermediate styles in your spreadsheet.</span><span class="tscolor" lg_zh="t_f86c612a79b8434a890598f34b6118ae"><span lg_kh="1">(</span>有时，创建具有基本样式的电子表格，然后将特殊样式应用于某些单元格，例如在一系列单元格周围绘制边框或为某个区域设置填充，会更容易或更有效。 CellUtil.setCellProperties 让您可以做到这一点，而无需在电子表格中创建一堆不必要的中间样式。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_b2b5ed451af64d44941e184da6e32d79">Properties are created as a Map and applied to a cell in the following manner.</span><span class="tscolor" lg_zh="t_b2b5ed451af64d44941e184da6e32d79"><span lg_kh="1">(</span>属性被创建为 Map 并以下列方式应用于单元格。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook workbook = new XSSFWorkbook(); //<span><span lg_en="t_815534ea03704024b082323f1a1ca1cf">OR new HSSFWorkbook()</span><span class="tscolor" lg_zh="t_815534ea03704024b082323f1a1ca1cf"><span lg_kh="1">(</span>或新的HSSFWorkbook（）<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sheet = workbook.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// border around a cell</span>
      </div>
      <div class="codeline" lg_zh="t_57e0bca4eca249a9a4ac706c88d7addc">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//单元格周围的边界
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_TOP, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_BOTTOM, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_LEFT, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BORDER_RIGHT, BorderStyle.MEDIUM);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Give it a color (RED)</span>
      </div>
      <div class="codeline" lg_zh="t_e3bc88398b9f45f2a7b18e3a72146461">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//给它一个颜色（红色）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.TOP_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.BOTTOM_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.LEFT_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">properties.put(CellUtil.RIGHT_BORDER_COLOR, IndexedColors.RED.getIndex());</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Apply the borders to the cell at B2</span>
      </div>
      <div class="codeline" lg_zh="t_4e0f7cf237ab40578c5c03540c97031e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将边界应用于B2处的单元格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Row row = sheet.createRow(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Cell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CellUtil.setCellStyleProperties(cell, properties);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// Apply the borders to a 3x3 region starting at D4</span>
      </div>
      <div class="codeline" lg_zh="t_ee1ba55ae54848668f730d472251e25d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将边界应用于从D4开始的3x 3区域
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">for (int ix=3; ix &lt;= 5; ix++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> row = sheet.createRow(ix);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> for (int iy = 3; iy &lt;= 5; iy++) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> cell = row.createCell(iy);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CellUtil.setCellStyleProperties(cell, properties);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_25f53b768436451681fb7b93844dbdc6">NOTE: This does not replace the properties of the cell, it merges the properties you have put into the Map with the cell's existing style properties. If a property already exists, it is replaced with the new property. If a property does not exist, it is added. This method will not remove CellStyle properties.</span><span class="tscolor" lg_zh="t_25f53b768436451681fb7b93844dbdc6"><span lg_kh="1">(</span>注意：这不会替换单元格的属性，它会将您放入地图的属性与单元格的现有样式属性合并。如果属性已存在，则将其替换为新属性。如果属性不存在，则添加它。此方法不会删除 CellStyle 属性。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="DrawingBorders" id="DrawingBorders"></a> <a name="Drawing+Borders"></a>
    <h2 class="boxed"><span lg_en="t_b1584147705d4820879586307568a711">Drawing Borders</span><span class="tscolor" lg_zh="t_b1584147705d4820879586307568a711"><span lg_kh="1">(</span><a href="#DrawingBorders" style="color:blue;">绘制边框</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_8ba6e771cee940f29e7aa3883cd2c1ef">In Excel, you can apply a set of borders on an entire workbook region at the press of a button. The PropertyTemplate object simulates this with methods and constants defined to allow drawing top, bottom, left, right, horizontal, vertical, inside, outside, or all borders around a range of cells. Additional methods allow for applying colors to the borders.</span><span class="tscolor" lg_zh="t_8ba6e771cee940f29e7aa3883cd2c1ef"><span lg_kh="1">(</span>在 Excel 中，您可以通过按下按钮在整个工作簿区域上应用一组边框。 PropertyTemplate 对象使用定义的方法和常量来模拟这一点，以允许在一系列单元格周围绘制顶部、底部、左侧、右侧、水平、垂直、内部、外部或所有边框。其他方法允许将颜色应用于边框。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_df3bae45dd4642ba8abe8b096125074c">It works like this: you create a PropertyTemplate object which is a container for the borders you wish to apply to a sheet. Then you add borders and colors to the PropertyTemplate, and finally apply it to whichever sheets you need that set of borders on. You can create multiple PropertyTemplate objects and apply them to a single sheet, or you can apply the same PropertyTemplate object to multiple sheets. It is just like a preprinted form.</span><span class="tscolor" lg_zh="t_df3bae45dd4642ba8abe8b096125074c"><span lg_kh="1">(</span>它的工作原理如下：您创建一个 PropertyTemplate 对象，该对象是您希望应用于工作表的边框的容器。然后为 PropertyTemplate 添加边框和颜色，最后将其应用到您需要该组边框的任何工作表上。您可以创建多个 PropertyTemplate 对象并将它们应用到单个工作表，也可以将相同的 PropertyTemplate 对象应用到多个工作表。它就像一个预印的表格。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_03c7c354705b4a6c9d275b8f1d8f0385">Enums:</span><span class="tscolor" lg_zh="t_03c7c354705b4a6c9d275b8f1d8f0385"><span lg_kh="1">(</span>枚举：<span lg_kh="1">)</span></span></p>
     <dl>
      <dt>BorderStyle</dt>
      <dd>Defines the look of the border, is it thick or thin, solid or dashed, single or double. This enum replaces the CellStyle.BORDER_XXXXX constants which have been deprecated. The PropertyTemplate will not support the older style BORDER_XXXXX constants. A special value of BorderStyle.NONE will remove the border from a Cell once it is applied.</dd>
      <dt>BorderExtent</dt>
      <dd>Describes the portion of the region that the BorderStyle will apply to. For example, TOP, BOTTOM, INSIDE, or OUTSIDE. A special value of BorderExtent.NONE will remove the border from the PropertyTemplate. When the template is applied, no change will be made to a cell border where no border properties exist in the PropertyTemplate.</dd>
     </dl>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// draw borders (three 3x3 grids)</span>
      </div>
      <div class="codeline" lg_zh="t_570cf7799a0b4e16947e6efe8c7b6190">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//绘制边界（三个3x 3网格）
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PropertyTemplate pt = new PropertyTemplate();</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #1) these borders will all be medium in default color</span>
      </div>
      <div class="codeline" lg_zh="t_dbfa0322ca084608bda16bbc38c7812e">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// #1）这些边框的默认颜色都是中等
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(1, 3, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, BorderExtent.ALL);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #2) these cells will have medium outside borders and thin inside borders</span>
      </div>
      <div class="codeline" lg_zh="t_fdc6366243954232b6e3b8cd72259491">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// #2）这些细胞的外部边界中等，内部边界较薄
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, BorderExtent.OUTSIDE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3), BorderStyle.THIN,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// #3) these cells will all be medium weight with different colors for the</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// outside, inside horizontal, and inside vertical borders. The center</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// cell will have no borders.</span>
      </div>
      <div class="codeline" lg_zh="t_77f541c6a5984bd5a0f1f6d5efbd386d">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// #3）这些单元格都将是中等重量，具有不同的颜色，
//在水平边界外、水平边界内和垂直边界内。中心
//单元格没有边界。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.RED.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.OUTSIDE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.BLUE.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE_VERTICAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.MEDIUM, IndexedColors.GREEN.getIndex(),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.INSIDE_HORIZONTAL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.drawBorders(new CellRangeAddress(10, 10, 2, 2),</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderStyle.NONE,</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> BorderExtent.ALL);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// apply borders to sheet</span>
      </div>
      <div class="codeline" lg_zh="t_ce429a59ca1b4199a8ef7e4eeae00619">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将边框应用于表格
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Workbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Sheet sh = wb.createSheet("Sheet1");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pt.applyBorders(sh);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_0c366c8891084272abc8b8686149dfc2">NOTE: The last pt.drawBorders() call removes the borders from the range by using BorderStyle.NONE. Like setCellStyleProperties, the applyBorders method merges the properties of a cell style, so existing borders are changed only if they are replaced by something else, or removed only if they are replaced by BorderStyle.NONE. To remove a color from a border, use IndexedColor.AUTOMATIC.getIndex().</span><span class="tscolor" lg_zh="t_0c366c8891084272abc8b8686149dfc2"><span lg_kh="1">(</span>注意：最后一个 pt.drawBorders() 调用时使用 BorderStyle.NONE 从范围中删除边框。与 setCellStyleProperties 一样，applyBorders 方法合并单元格样式的属性，因此现有边框只有在被其他东西替换时才会更改，或者只有在被 BorderStyle.NONE 替换时才会删除。要从边框中删除颜色，请使用 IndexedColor.AUTOMATIC.getIndex()。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_68e24a515ff341e38e35ac15c1396236">Additionally, to remove a border or color from the PropertyTemplate object, use BorderExtent.NONE.</span><span class="tscolor" lg_zh="t_68e24a515ff341e38e35ac15c1396236"><span lg_kh="1">(</span>此外，要从 PropertyTemplate 对象中删除边框或颜色，请使用 BorderExtent.NONE。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8368616a30b4421fb81cef0c096a033a">This does not work with diagonal borders yet.</span><span class="tscolor" lg_zh="t_8368616a30b4421fb81cef0c096a033a"><span lg_kh="1">(</span>这不适用于对角线边框。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="PivotTable" id="PivotTable"></a> <a name="Creating+a+Pivot+Table"></a>
    <h2 class="boxed"><span lg_en="t_2bf74a0b82a24181b6208f5d7030fde9">Creating a Pivot Table</span><span class="tscolor" lg_zh="t_2bf74a0b82a24181b6208f5d7030fde9"><span lg_kh="1">(</span>创建数据透视表<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_f7b167bfac924df69e5e0fed608c6cff">Pivot Tables are a powerful feature of spreadsheet files. You can create a pivot table with the following piece of code.</span><span class="tscolor" lg_zh="t_f7b167bfac924df69e5e0fed608c6cff"><span lg_kh="1">(</span>数据透视表是电子表格文件的一项强大功能。您可以使用以下代码创建数据透视表。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFWorkbook wb = new XSSFWorkbook();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFSheet sheet = wb.createSheet();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Create some data to build the pivot table on</span>
      </div>
      <div class="codeline" lg_zh="t_a0bb02de10104eeca5be79bfc78758bd">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//创建一些数据来构建数据透视表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">setCellData(sheet);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFPivotTable pivotTable = sheet.createPivotTable(new AreaReference("A1:D4"), new CellReference("H5"));</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Configure the pivot table</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Use first column as row label</span>
      </div>
      <div class="codeline" lg_zh="t_01179ea9567f4ce4bf497a92c94772a3">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//配置数据透视表
//使用第一列作为行标签
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addRowLabel(0);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Sum up the second column</span>
      </div>
      <div class="codeline" lg_zh="t_d3173049433544a494a17a42ecd7bb30">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//总结第二列
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addColumnLabel(DataConsolidateFunction.SUM, 1);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Set the third column as filter</span>
      </div>
      <div class="codeline" lg_zh="t_b7d77c621e6342c99db37d167ce892ce">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//将第三列设置为过滤器
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addColumnLabel(DataConsolidateFunction.AVERAGE, 2);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//Add filter on forth column</span>
      </div>
      <div class="codeline" lg_zh="t_10facc1e1e3c4a949d7cdd64ec9dfcce">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//在第四列添加过滤器
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">pivotTable.addReportFilter(3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="RichText" id="RichText"></a> <a name="Cells+with+multiple+styles+%28Rich+Text+Strings%29"></a>
    <h2 class="boxed"><span lg_en="t_d43ed47b8f0a468f8a195fb5eabdb98f">Cells with multiple styles (Rich Text Strings)</span><span class="tscolor" lg_zh="t_d43ed47b8f0a468f8a195fb5eabdb98f"><span lg_kh="1">(</span>具有多种样式的单元格（富文本字符串）<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_cfa1fe4f26f9449fa7db43243e1cd84a">To apply a single set of text formatting (colour, style, font etc) to a cell, you should create a <a href="/../apidocs/dev/org/apache/poi/ss/usermodel/CellStyle.html">CellStyle</a> for the workbook, then apply to the cells.</span><span class="tscolor" lg_zh="t_cfa1fe4f26f9449fa7db43243e1cd84a"><span lg_kh="1">(</span>要将一组文本格式（颜色、样式、字体等）应用于单元格，您应该为工作簿创建一个 <a href="../../apidocs/org/apache/poi/ss/usermodel/CellStyle.html" style="color:blue" target="_blank">CellStyle</a>，然后应用于单元格。<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// HSSF Example</span>
      </div>
      <div class="codeline" lg_zh="t_4381e39741fe45528928d41b58b038fe">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// HSSF示例
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFCell hssfCell = row.createCell(idx);</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">//rich text consists of two runs</span>
      </div>
      <div class="codeline" lg_zh="t_eeb4f5c80dae49b89d0b82ae6d90923b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//富文本由两个运行组成
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HSSFRichTextString richString = new HSSFRichTextString( "Hello, World!" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">richString.applyFont( 0, 6, font1 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">richString.applyFont( 6, 13, font2 );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hssfCell.setCellValue( richString );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// XSSF Example</span>
      </div>
      <div class="codeline" lg_zh="t_7307c0ea87dc4b2c8644a86bb1b2773c">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// XSSF示例
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFCell cell = row.createCell(1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFRichTextString rt = new XSSFRichTextString("The quick brown fox");</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font1 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font1.setBold(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font1.setColor(new XSSFColor(new java.awt.Color(255, 0, 0)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.applyFont(0, 10, font1);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font2 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setItalic(true);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setUnderline(XSSFFont.U_DOUBLE);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font2.setColor(new XSSFColor(new java.awt.Color(0, 255, 0)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.applyFont(10, 19, font2);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">XSSFFont font3 = wb.createFont();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">font3.setColor(new XSSFColor(new java.awt.Color(0, 0, 255)));</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">rt.append(" Jumped over the lazy dog", font3);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">cell.setCellValue(rt);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_fd75dd0cc8ee4e52b99bfd07f7fa40a1">To apply different formatting to different parts of a cell, you need to use <a href="../../apidocs/dev/org/apache/poi/ss/usermodel/RichTextString.html">RichTextString</a>, which permits styling of parts of the text within the cell.</span><span class="tscolor" lg_zh="t_fd75dd0cc8ee4e52b99bfd07f7fa40a1"><span lg_kh="1">(</span>要将不同的格式应用于单元格的不同部分，您需要使用 <a href="../../apidocs/org/apache/poi/ss/usermodel/RichTextString.html" style="color:blue" target="_blank">RichTextString</a>，它允许对单元格内的部分文本进行样式设置。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1aa71a69876f4f0c95d5fd0a83ed3d48">There are some slight differences between HSSF and XSSF, especially around font colours (the two formats store colours quite differently internally), refer to the <a href="../../apidocs/dev/org/apache/poi/hssf/usermodel/HSSFRichTextString.html">HSSF Rich Text String</a> and <a href="../../apidocs/dev/org/apache/poi/xssf/usermodel/XSSFRichTextString.html">XSSF Rich Text String</a> javadocs for more details.</span><span class="tscolor" lg_zh="t_1aa71a69876f4f0c95d5fd0a83ed3d48"><span lg_kh="1">(</span>HSSF 和 XSSF 之间存在一些细微差别，尤其是在字体颜色方面（这两种格式在内部存储颜色完全不同），有关详细信息，请参阅 <a href="../../apidocs/org/apache/poi/hssf/usermodel/HSSFRichTextString.html" style="color:blue" target="_blank">HSSF 富文本字符串</a>和 <a href="../../apidocs/org/apache/poi/xssf/usermodel/XSSFRichTextString.html" style="color:blue" target="_blank">XSSF 富文本字符串</a> 的javadocs。<span lg_kh="1">)</span></span></p>
    </div>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/quick-guide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>