<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Developing Formula Evaluation</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_57c114fb048b436e8b101d5076ec6a9d">Developing Formula Evaluation</span><span class="tscolor" lg_zh="t_57c114fb048b436e8b101d5076ec6a9d"><span lg_kh="1">(</span>公式求值开发<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="Introduction"></a>
    <h2 class="boxed"><span lg_en="t_b4e0f4a7e9ed44c48f819a2144557833">Introduction</span><span class="tscolor" lg_zh="t_b4e0f4a7e9ed44c48f819a2144557833"><span lg_kh="1">(</span>介绍<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_da8dbac6652a402aaf0abbdbcd4e71d1">This document is for developers wishing to contribute to the FormulaEvaluator API functionality.</span><span class="tscolor" lg_zh="t_da8dbac6652a402aaf0abbdbcd4e71d1"><span lg_kh="1">(</span>本文档适用于希望为 FormulaEvaluator API 功能做出贡献的开发人员。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e01e6dbeef304f46bfbdbe1bb92f2f04">When evaluating workbooks you may encounter a org.apache.poi.ss.formula.eval.NotImplementedException which indicates that a function is not (yet) supported by POI. Is there a workaround? Yes, the POI framework makes it easy to add implementation of new functions. Prior to POI-3.8 you had to checkout the source code from svn and make a custom build with your function implementation. Since POI-3.8 you can register new functions in run-time.</span><span class="tscolor" lg_zh="t_e01e6dbeef304f46bfbdbe1bb92f2f04"><span lg_kh="1">(</span>在对工作簿进行公式求值时，您可能会遇到org.apache.poi.ss.formula.eval.NotImplementedException，这表示 POI（尚不）支持某个函数。有解决方法吗？是的，POI 框架可以轻松添加新函数的实现。在 POI-3.8 之前，您必须从svn检出源代码并使用您的函数实现进行自定义构建。从 POI-3.8 开始，您可以在运行时注册新函数。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9039705885e6477cbb001928ca54db14">Currently, contribution is desired for implementing the standard MS excel functions. Place holder classes for these have been created, contributors only need to insert implementation for the individual "evaluate()" methods that do the actual evaluation.</span><span class="tscolor" lg_zh="t_9039705885e6477cbb001928ca54db14"><span lg_kh="1">(</span>目前，我们已经为想给实现标准的MS excel函数做出贡献的靓仔创建了占位符类，贡献者只需要提供执行实际求值的各个“evaluate()”方法的实现。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Overview+of+FormulaEvaluator"></a>
    <h2 class="boxed"><span lg_en="t_a5a68e9c57a04a5a8508d3d7e569294e">Overview of FormulaEvaluator</span><span class="tscolor" lg_zh="t_a5a68e9c57a04a5a8508d3d7e569294e"><span lg_kh="1">(</span>FormulaEvaluator 概述<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_64b91300ec084fc49fc60ef99389ccce">Briefly, a formula string (along with the sheet and workbook that form the context in which the formula is evaluated) is first parsed into RPN tokens using the FormulaParser class . (If you don't know what RPN tokens are, now is a good time to read <a href="http://www-stone.ch.cam.ac.uk/documentation/rrf/rpn.html"> this</a>.)</span><span class="tscolor" lg_zh="t_64b91300ec084fc49fc60ef99389ccce"><span lg_kh="1">(</span>简而言之，第一步是使用FormulaParser类将公式字符串（以及构成公式计算环境的工作表和工作簿）解析为 RPN 标记。 （如果您不知道什么是RPN令牌，现在是阅读<a href="http://www-stone.ch.cam.ac.uk/documentation/rrf/rpn.html" style="color:blue;" target="_blank">这篇文章</a>的好时机。）<span lg_kh="1">)</span></span></p>
     <a name="The+big+picture"></a>
     <h3 class="boxed"><span lg_en="t_1b15c98022f442c1806d51ffa88ecb50">The big picture</span><span class="tscolor" lg_zh="t_1b15c98022f442c1806d51ffa88ecb50"><span lg_kh="1">(</span>大图<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_752bdd22865a432681419ddb55a1501f">RPN tokens are mapped to Eval classes. (Class hierarchy for the Evals is best understood if you view the class diagram in a class diagram viewer.) Depending on the type of RPN token (also called as Ptgs henceforth since that is what the FormulaParser calls the classes) a specific type of Eval wrapper is constructed to wrap the RPN token and is pushed on the stack.... UNLESS the Ptg is an OperationPtg. If it is an OperationPtg, an OperationEval instance is created for the specific type of OperationPtg. And depending on how many operands it takes, that many Evals are popped of the stack and passed in an array to the OperationEval instance's evaluate method which returns an Eval of subtype ValueEval.Thus an operation in the formula is evaluated.</span><span class="tscolor" lg_zh="t_752bdd22865a432681419ddb55a1501f"><span lg_kh="1">(</span>RPN 令牌映射到 Eval 类。（如果您在类图查看器中查看类图，则可以更好地理解 Eval 的类层次结构）根据 RPN 标记的类型（此后也称为Ptgs，因为在FormulaParser里是这样命名的），特定类型的 Eval wrapper 用于包装 RPN 令牌并被压入堆栈......除非 Ptg 是 OperationPtg。如果是 OperationPtg，则为特定类型的 OperationPtg 创建一个 OperationEval 实例。并且根据它需要多少个操作数，许多 Eval 会从堆栈中弹出并以数组的形式传递给 OperationEval 实例的求值方法，该方法返回一个Eval的子类型ValueEval。这便是一个公式的求值操作。<span lg_kh="1">)</span></span></p>
     <div class="note">
      <div class="label">
       <span lg_en="t_25d3a61ae9fc431e9b19c75c999c93ce">Note</span><span class="tscolor" lg_zh="t_25d3a61ae9fc431e9b19c75c999c93ce"><span lg_kh="1">(</span>笔记<span lg_kh="1">)</span></span>
      </div>
      <div class="content">
       <span lg_en="t_b4c540d7b9d74114992456d4312780b7">An Eval is of subinterface ValueEval or OperationEval. Operands are always ValueEvals, Operations are always OperationEvals.</span><span class="tscolor" lg_zh="t_b4c540d7b9d74114992456d4312780b7"><span lg_kh="1">(</span>Eval的子接口ValueEval或OperationEval。操作数始终是 ValueEval，操作始终是 OperationEval。<span lg_kh="1">)</span></span>
      </div>
     </div>
     <p><span lg_en="t_53f1a8388aa9490cabdadfef62e7244d"><span class="codefrag">OperationEval.evaluate(Eval[])</span> returns an Eval which is supposed to be of type ValueEval (actually since ValueEval is an interface, the return value is instance of one of the implementations of ValueEval). The valueEval resulting from evaluate() is pushed on the stack and the next RPN token is evaluated.... this continues till eventually there are no more RPN tokens at which point, if the formula string was correctly parsed, there should be just one Eval on the stack - which contains the result of evaluating the formula.</span><span class="tscolor" lg_zh="t_53f1a8388aa9490cabdadfef62e7244d"><span lg_kh="1">(</span>OperationEval.evaluate(Eval[]) 返回一个 Eval，它应该是 ValueEval 类型（实际上，由于ValueEval是一个接口，所以返回值是实现了ValueEval接口的实例）。从 evaluate() 产生的valueEval被推入堆栈并求值下一个RPN令牌......这种情况一直持续到最终不再有RPN标记，如果公式字符串被正确解析，堆栈上应该只有一个的Eval-它包含计算公式的结果。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_aa7cca1e151a44ad82d9130b21922e3c">Of course I glossed over the details of how AreaPtg and ReferencePtg are handled a little differently, but the code should be self explanatory for that. Very briefly, the cells included in AreaPtg and RefPtg are examined and their values are populated in individual ValueEval objects which are set into the AreaEval and RefEval (ok, since AreaEval and RefEval are interfaces, the implementations of AreaEval and RefEval - but you'll figure all that out from the code)</span><span class="tscolor" lg_zh="t_aa7cca1e151a44ad82d9130b21922e3c"><span lg_kh="1">(</span>当然，我对AreaPtg和ReferencePtg的处理方式略有不同的细节略作掩饰，但代码对此应该不言自明。简单地说，检查AreaPtg和RefPtg中包含的单元格，并将它们的值填充到各个ValueEval对象中，这些对象被设置为AreaEval和RefEval（因为 AreaEval 和 RefEval 是接口，所以AreaEval 和 RefEval 的实现 - 你能从代码中弄清楚这些）<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ec5e5b14cabc4b188dc9119b1b4a923c">OperationEvals for the standard operators have been implemented and tested.</span><span class="tscolor" lg_zh="t_ec5e5b14cabc4b188dc9119b1b4a923c"><span lg_kh="1">(</span>标准运算符的 OperationEvals 已经实施和测试。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="What+functions+are+supported%3F"></a>
    <h2 class="boxed"><span lg_en="t_631e8292fcb248c5871d262bc1965c31">What functions are supported?</span><span class="tscolor" lg_zh="t_631e8292fcb248c5871d262bc1965c31"><span lg_kh="1">(</span>支持哪些功能？<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_986fcedd7a9f4e33bc64250ce7255761">As of September 2017, POI supports about 176 built-in functions, see <a href="#appendixA">Appendix A</a> for the full list. You can programmatically list supported / unsupported functions using the following helper methods:</span><span class="tscolor" lg_zh="t_986fcedd7a9f4e33bc64250ce7255761"><span lg_kh="1">(</span>截至2017年9月，POI支持大约176个内置函数，完整列表见<a href="#appendixA" style="color:blue">附录 A</a>。您可以使用以下方法列出支持/不支持的函数：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// list of functions that POI can evaluate</span>
      </div>
      <div class="codeline" lg_zh="t_18af6150db6e47ee8d38db7a08b55b8a">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//兴趣点可以评估的功能列表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Collection&lt;String&gt; supportedFuncs = WorkbookEvaluator.getSupportedFunctionNames();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody">// list of functions that are not supported by POI</span>
      </div>
      <div class="codeline" lg_zh="t_97ca3a2065694aab8061cb09e58f532b">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//不受兴趣点支持的功能列表
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Collection&lt;String&gt; unsupportedFuncs = WorkbookEvaluator.getNotSupportedFunctionNames();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Two+base+interfaces+to+start+your+implementation"></a>
    <h2 class="boxed"><span lg_en="t_1e9443bbae9541a7b0bd5197644aa052">Two base interfaces to start your implementation</span><span class="tscolor" lg_zh="t_1e9443bbae9541a7b0bd5197644aa052"><span lg_kh="1">(</span>两个基本接口来开始你的实现<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_4c106fe399ff46c4b66e123509b90bc8">All Excel formula function classes implement either org.apache.poi.hssf.record.formula.functions.Function or org.apache.poi.hssf.record.formula.functions.FreeRefFunction interface. Function is a common interface for the functions defined in the binary Excel format (BIFF8): these are "classic" Excel functions like SUM, COUNT, LOOKUP, etc. FreeRefFunction is a common interface for the functions from the Excel Analysis Toolpack and for User-Defined Functions. In the future these two interfaces are expected be unified into one, but for now you have to start your implementation from two slightly different roots.</span><span class="tscolor" lg_zh="t_4c106fe399ff46c4b66e123509b90bc8"><span lg_kh="1">(</span>所有 Excel 公式函数类都实现 org.apache.poi.hssf.record.formula.functions.Function 或 org.apache.poi.hssf.record.formula.functions.FreeRefFunction 接口。 Function 是以二进制 Excel 格式 (BIFF8) 定义的函数的通用接口：这些“经典” Excel 函数，如 SUM、COUNT、LOOKUP 等。FreeRefFunction是Excel分析工具包中的函数和用户定义函数的通用接口。将来这两个接口有望统一为一个，但现在您必须从两个稍微不同的根源开始实现。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Which+interface+to+start+from%3F"></a>
    <h2 class="boxed"><span lg_en="t_d9bec27565d4404eabeb77b49d0b961c">Which interface to start from?</span><span class="tscolor" lg_zh="t_d9bec27565d4404eabeb77b49d0b961c"><span lg_kh="1">(</span>从哪个接口开始？<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_1395b3d85755437884be0ad3c4d86f22">You are about to implement a function XXX and don't know which interface to start from: Function or FreeRefFunction. Use the following code to check whether your function is from the excel Analysis Toolpack:</span><span class="tscolor" lg_zh="t_1395b3d85755437884be0ad3c4d86f22"><span lg_kh="1">(</span>你即将实现一个函数 XXX，而不知道从Function 或 FreeRefFunction哪个接口开始。使用以下代码检查您的函数是否来自excel分析工具包：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">if(AnalysisToolPack.isATPFunction(functionName)){</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // the function implements org.apache.poi.hssf.record.formula.functions.Function</span>
      </div>
      <div class="codeline" lg_zh="t_3056ae0c3a1746119e5c55b9a7c1a747">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//该函数实现org.apache.poi.hssf.record.formula.functions. Value
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">} else {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // the function implements org.apache.poi.hssf.record.formula.functions.FreeRefFunction</span>
      </div>
      <div class="codeline" lg_zh="t_9d7603a425de48318294386630107e91">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//该函数实现org.apache.poi.hssf.record.formula.functions. FreeRefUnity
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <a name="Walkthrough+of+an+%22evaluate%28%29%22+implementation."></a>
    <h2 class="boxed"><span lg_en="t_4e3f13207897476e89ef3fdb65ce1966">Walkthrough of an "evaluate()" implementation.</span><span class="tscolor" lg_zh="t_4e3f13207897476e89ef3fdb65ce1966"><span lg_kh="1">(</span>“evaluate()”实现的演练。<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_3e40ac8830c94ed3b0a09e462ffed822">Here is the fun part: lets walk through the implementation of the excel function <strong>SQRT()</strong></span><span class="tscolor" lg_zh="t_3e40ac8830c94ed3b0a09e462ffed822"><span lg_kh="1">(</span>这是有趣的部分：让我们来看看 excel 函数 SQRT() 的实现<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_255441c0be054dbbbb9f406fa6ea630e">AnalysisToolPack.isATPFunction("SQRTPI") returns false so the base interface is Function. There are sub-interfaces that make life easier when implementing numeric functions or functions with fixed number of arguments, 1-arg, 2-arg and 3-arg function:</span><span class="tscolor" lg_zh="t_255441c0be054dbbbb9f406fa6ea630e"><span lg_kh="1">(</span>AnalysisToolPack.isATPFunction(&quot;SQRTPI&quot;) 返回 false，因此基本接口是 Function。在实现数值函数或具有固定参数数的函数、1-arg、2-arg和3-arg函数时，有一些子接口可以简化工作：<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_f9d7f48dd4fb497eaf7d880f8d86acec">org.apache.poi.hssf.record.formula.functions.NumericFunction</span><span class="tscolor" lg_zh="t_f9d7f48dd4fb497eaf7d880f8d86acec"><span lg_kh="1">(</span>org.apache.poi.hssf.record.formula.functions.NumericFunction<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8c1c203d6d0145ee81296219a70a63b9">org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction</span><span class="tscolor" lg_zh="t_8c1c203d6d0145ee81296219a70a63b9"><span lg_kh="1">(</span>org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8709f195032044c28c98e9c7033d3690">org.apache.poi.hssf.record.formula.functions.Fixed2ArgFunction</span><span class="tscolor" lg_zh="t_8709f195032044c28c98e9c7033d3690"><span lg_kh="1">(</span>org.apache.poi.hssf.record.formula.functions.Fixed2ArgFunction<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8783e04cd2c24f05b2c64221bb0df3fd">org.apache.poi.hssf.record.formula.functions.Fixed3ArgFunction</span><span class="tscolor" lg_zh="t_8783e04cd2c24f05b2c64221bb0df3fd"><span lg_kh="1">(</span>org.apache.poi.hssf.record.formula.functions.Fixed3ArgFunction<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_7fd35793054e4b33aee034da21cffb56">org.apache.poi.hssf.record.formula.functions.Fixed4ArgFunction</span><span class="tscolor" lg_zh="t_7fd35793054e4b33aee034da21cffb56"><span lg_kh="1">(</span>org.apache.poi.hssf.record.formula.functions.Fixed4ArgFunction<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_0e65c70020504d54a29d367ccb1ec2ae">Since SQRTPI takes exactly one argument we start our implementation from org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction:</span><span class="tscolor" lg_zh="t_0e65c70020504d54a29d367ccb1ec2ae"><span lg_kh="1">(</span>由于 SQRTPI 只采用一个参数，我们用org.apache.poi.hssf.record.formula.functions.Fixed1ArgFunction开始我们的实现：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Function SQRTPI = new Fixed1ArgFunction() {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> public ValueEval evaluate(int srcRowIndex, int srcColumnIndex, ValueEval arg0) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> try {</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Retrieves a single value from a variety of different argument types according to standard</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel rules. Does not perform any type conversion.</span>
      </div>
      <div class="codeline" lg_zh="t_d6bb2d6a64484d8e8820874b080aee53">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//根据标准从各种不同的参数类型中检索单个值
// Excel规则。不执行任何类型转换。
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> ValueEval ve = OperandResolver.getSingleValue(arg0, srcRowIndex, srcColumnIndex);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Applies some conversion rules if the supplied value is not already a number.</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Throws EvaluationException(#VALUE!) if the supplied parameter is not a number</span>
      </div>
      <div class="codeline" lg_zh="t_d1da8254b00841339bd74803fbbf81af">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//如果提供的值还不是数字，则卸载一些转换规则。
//抛出评估异常（#UTE！）如果提供的参数不是数字
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> double arg = OperandResolver.coerceValueToDouble(ve);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // this where all the heavy-lifting happens</span>
      </div>
      <div class="codeline" lg_zh="t_7b7f55d1299d4eb89bd39bafb7db3e12">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//所有繁重的事情都发生在这里
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> double result = Math.sqrt(arg*Math.PI);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // Excel uses the error code #NUM! instead of IEEE </span>
      </div>
      <div class="codeline" lg_zh="t_ab10778180904718b9bb8efca76d2e54">
       <span class="lineno"></span> <span class="codebody" style="color:green;">// Excel使用错误代码#NUM！而不是IEEE
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">nity</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // so when a numeric function evaluates to Double.NaN or Double.Infinity,</span>
      </div>
      <div class="codeline" lg_en="1">
       <span class="lineno"></span><span class="codebody"> // be sure to translate the result to the appropriate error code</span>
      </div>
      <div class="codeline" lg_zh="t_3b052ee07e7e4504b47415cf4ff931ff">
       <span class="lineno"></span> <span class="codebody" style="color:green;">//所以当数字函数的计算结果为Double.NaN或Double.Infinity时，
//确保将结果翻译为适当的错误代码
</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> if (Double.isNaN(result) || Double.isInfinite(result)) {</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> throw new EvaluationException(ErrorEval.NUM_ERROR);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return new NumberEval(result);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> } catch (EvaluationException e){</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> return e.getErrorEval();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> }</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">}</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_8630686f625c4da3aa56dcf2472633e1">Now when the implementation is ready we need to register it in the formula evaluator:</span><span class="tscolor" lg_zh="t_8630686f625c4da3aa56dcf2472633e1"><span lg_kh="1">(</span>现在，当实现准备就绪时，我们需要在公式求值器中注册它：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WorkbookEvaluator.registerFunction("SQRTPI", SQRTPI);</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_dcdd558f5a304238bfe4c057e0ba7fa1">Voila! The formula evaluator now recognizes SQRTPI!</span><span class="tscolor" lg_zh="t_dcdd558f5a304238bfe4c057e0ba7fa1"><span lg_kh="1">(</span>瞧！公式求值器现在可以识别 SQRTPI！<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Floating-point+Arithmetic+in+Excel"></a>
    <h2 class="boxed"><span lg_en="t_5d9e1264d1f143ae9723181df9ca9834">Floating-point Arithmetic in Excel</span><span class="tscolor" lg_zh="t_5d9e1264d1f143ae9723181df9ca9834"><span lg_kh="1">(</span>Excel中的浮点运算<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_996d905a82304166964f996aa03b454b">Excel uses the IEEE Standard for Double Precision Floating Point numbers except two cases where it does not adhere to IEEE 754:</span><span class="tscolor" lg_zh="t_996d905a82304166964f996aa03b454b"><span lg_kh="1">(</span>Excel对双精度浮点数使用IEEE标准，但有两种情况不符合IEEE 754：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_099749cd507c4a888d8897974a41e962">Positive/Negative Infinities: Infinities occur when you divide by 0. Excel does not support infinities, rather, it gives a #DIV/0! error in these cases.</span><span class="tscolor" lg_zh="t_099749cd507c4a888d8897974a41e962"><span lg_kh="1">(</span>正/负无穷大：除以 0 时出现无穷大。Excel 不支持无穷大，而是给出 #DIV/0！在这种情况下会出现错误。<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_2e42a139b0044dc1a8008d448aa5dcf7">Not-a-Number (NaN): NaN is used to represent invalid operations (such as infinity/infinity, infinity-infinity, or the square root of -1). NaNs allow a program to continue past an invalid operation. Excel instead immediately generates an error such as #NUM! or #DIV/0!.</span><span class="tscolor" lg_zh="t_2e42a139b0044dc1a8008d448aa5dcf7"><span lg_kh="1">(</span>Not-a-Number (NaN)：NaN 用于表示无效运算（如无穷大/无穷大、无穷-无穷大或-1 的平方根）。NAN允许程序继续执行无效操作，相反，Excel 会立即生成错误，例如 #NUM！或#DIV/0！。<span lg_kh="1">)</span></span></li>
     </ol>
     <p><span lg_en="t_fa9d7ff25ba34f89a0c6425c21e727f4">Be aware of these two cases when saving results of your scientific calculations in Excel: “where are my Infinities and NaNs? They are gone!”</span><span class="tscolor" lg_zh="t_fa9d7ff25ba34f89a0c6425c21e727f4"><span lg_kh="1">(</span>在 Excel 中保存科学计算结果时请注意以下两种情况：“我的无穷大和 NaN 在哪里？他们走了！”<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Testing+Framework"></a>
    <h2 class="boxed"><span lg_en="t_c67ea0d468ab45afba415fe2d2ed4ca9">Testing Framework</span><span class="tscolor" lg_zh="t_c67ea0d468ab45afba415fe2d2ed4ca9"><span lg_kh="1">(</span>测试框架<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_a50ff20c7ea34a3b8aab741a14bf08e3">Automated testing of the implemented Function is easy. The source code for this is in the file: o.a.p.h.record.formula.GenericFormulaTestCase.java This class has a reference to the test xls file (not /a/ test xls, /the/ test xls :) which may need to be changed for your environment. Once you do that, in the test xls, locate the entry for the function that you have implemented and enter different tests in a cell in the FORMULA row. Then copy the "value of" the formula that you entered in the cell just below it (this is easily done in excel as: [copy the formula cell] &gt; [go to cell below] &gt; Edit &gt; Paste Special &gt; Values &gt; "ok"). You can enter multiple such formulas and paste their values in the cell below and the test framework will automatically test if the formula evaluation matches the expected value (Again, hard to put in words, so if you will, please take time to quickly look at the code and the currently entered tests in the patch attachment "FormulaEvalTestData.xls" file).</span><span class="tscolor" lg_zh="t_a50ff20c7ea34a3b8aab741a14bf08e3"><span lg_kh="1">(</span>实现函数的自动化测试很容易。源代码在o.a.p.h.record.formula.GenericFormulaTestCase.java文件中。 此类引用了test xls文件（不是 /a/test xls，/the/test xls :)，您可能需要根据您的环境更改该文件。完成此操作后，在test xls 中，找到您已实现的函数的条目，并在公式行的单元格中输入不同的测试。然后复制您在其下方单元格中输入的公式的“值”（这在 excel 中很容易完成，如下所示：[复制公式单元格]&gt;[转到下面的单元格]&gt;编辑&gt;选择性粘贴&gt;值&gt;“确定”）。您可以输入多个这样的公式并将它们的值粘贴到下面的单元格中，测试框架会自动测试公式求值是否与预期值匹配（再次，很难用语言表达，所以如果您愿意，请花点时间快速查看补丁附件“FormulaEvalTestData.xls”文件中的代码和当前输入的测试）。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="appendixA" id="appendixA"></a> <a name="Appendix+A"></a>
    <h2 class="boxed"><span lg_en="t_1a717eda64544952831f67bb2969b85d">Appendix A</span><span class="tscolor" lg_zh="t_1a717eda64544952831f67bb2969b85d"><span lg_kh="1">(</span>附录 A<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_82bcd160b0894102bc5524b3a90f8a18">Functions supported by POI (as of September 2017)</span><span class="tscolor" lg_zh="t_82bcd160b0894102bc5524b3a90f8a18"><span lg_kh="1">(</span>POI支持的函数（截至2017年9月）<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ABS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ACOS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ACOSH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ADDRESS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ASIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ASINH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATAN2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ATANH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AVEDEV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">AVERAGE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BIN2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CEILING</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CHAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CHOOSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CLEAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CODE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COLUMN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COLUMNS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COMBIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COMPLEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CONCATENATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COSH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTBLANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTIF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">COUNTIFS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DAYS360</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEC2BIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEC2HEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEGREES</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DELTA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DEVSQ</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DGET</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DMIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">DOLLAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EDATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EOMONTH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ERROR.TYPE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EVEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EXACT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">EXP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FACT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FACTDOUBLE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FALSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FIND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FIXED</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FLOOR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HEX2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HLOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HOUR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">HYPERLINK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IFERROR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IMAGINARY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IMREAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INDEX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INDIRECT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INTERCEPT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IPMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">IRR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISBLANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISERR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISERROR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISEVEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISLOGICAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNONTEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISNUMBER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISODD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISREF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ISTEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LARGE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LEFT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOG</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOG10</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">LOWER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MATCH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MAX</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MAXA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MDETERM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MEDIAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MID</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINUTE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MINVERSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MIRR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MMULT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MOD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MODE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MONTH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MROUND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NA</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NETWORKDAYS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NOT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NOW</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">NPV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OCT2DEC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ODD</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OFFSET</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">OR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PERCENTILE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PI</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POISSON</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">POWER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PPMT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PRODUCT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PROPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">QUOTIENT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RADIANS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RAND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RANDBETWEEN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RANK</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RATE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">REPLACE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">REPT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">RIGHT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROMAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUNDDOWN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROUNDUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROW</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ROWS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SEARCH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SECOND</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SIGN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SIN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SINH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SLOPE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SMALL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SQRT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STDEV</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUBSTITUTE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUBTOTAL</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMIF</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMIFS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMPRODUCT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMSQ</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMX2MY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMX2PY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SUMXMY2</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">T</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TAN</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TANH</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TEXT</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TIME</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TODAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRANSPOSE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRIM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRUE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TRUNC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">UPPER</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VALUE</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VARP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">VLOOKUP</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WEEKDAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WEEKNUM</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">WORKDAY</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">YEAR</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">YEARFRAC</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
    </div>
    <p align="right"><span lg_en="t_a83059f9e39045f390980cb9722b3214"><font size="-2">by&nbsp;Amol Deshmukh,&nbsp;Yegor Kozlov</font></span><span class="tscolor" lg_zh="t_a83059f9e39045f390980cb9722b3214"><span lg_kh="1">(</span>作者：Amol Deshmukh，叶戈尔·科兹洛夫<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/spreadsheet/eval-devguide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>