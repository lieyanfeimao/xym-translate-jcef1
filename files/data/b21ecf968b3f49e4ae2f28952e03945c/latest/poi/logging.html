<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - Logging Framework</title>
  <link type="text/css" href="../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../skin/profile.css" rel="stylesheet">
  <script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../js/jquery.min.js"></script>
  <link href="../css/xst-ts.css" rel="stylesheet">
  <script src="../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_07be8fc4277947f9abe76af194ece76b">Apache POI - Logging Framework</span><span class="tscolor" lg_zh="t_07be8fc4277947f9abe76af194ece76b"><span lg_kh="1">(</span>Apache POI - 日志框架<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="Introduction"></a>
    <h2 class="boxed"><span lg_en="t_7fa53ffa912346bcb16b150ec7c6a41e">Introduction</span><span class="tscolor" lg_zh="t_7fa53ffa912346bcb16b150ec7c6a41e"><span lg_kh="1">(</span>介绍<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_0f5b623f59ff4455a03bad2a82e3e425">POI uses a custom logging framework which allows to configure where logs are sent to.</span><span class="tscolor" lg_zh="t_0f5b623f59ff4455a03bad2a82e3e425"><span lg_kh="1">(</span>POI 使用自定义日志框架，允许配置日志发送到的位置。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9db22f2d0dc54ecd87dfd811f5531c38">Logging in POI is used only as a debugging mechanism, not a normal runtime logging system. Logging on level debug/info is ONLY for autopsie type debugging, and should NEVER be enabled on a production system.</span><span class="tscolor" lg_zh="t_9db22f2d0dc54ecd87dfd811f5531c38"><span lg_kh="1">(</span>POI 中的日志记录仅用作调试机制，而不是正常的运行时日志记录系统，级别调试/信息日志记录仅用于autopsie类型的调试，绝不应在生产系统上启用。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_40b05e92e6534701b958494f2411ecb1">The framework is extensible so that you can send log messages to any logging framework that your application uses.</span><span class="tscolor" lg_zh="t_40b05e92e6534701b958494f2411ecb1"><span lg_kh="1">(</span>该框架是可扩展的，因此您可以将日志消息发送到您的应用程序使用的任何日志框架中。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_634c1fc3e95940ab850e119426dbd84b">A number of default logging implementations are supported by POI out-of-the-box and can be selected via a system property.</span><span class="tscolor" lg_zh="t_634c1fc3e95940ab850e119426dbd84b"><span lg_kh="1">(</span>POI 开箱即用地支持许多默认日志记录实现，并且可以通过系统属性进行选择。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Enable+logging"></a>
    <h2 class="boxed"><span lg_en="t_6fddca94413d4da6b0ed8584a898d9bf">Enable logging</span><span class="tscolor" lg_zh="t_6fddca94413d4da6b0ed8584a898d9bf"><span lg_kh="1">(</span>启用日志记录<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_4e81bd45b5754fc8ac5246006951be8f">By default, logging is disabled in POI. Sometimes it might be useful to enable logging to see some debug messages printed out which can help in analyzing problems.</span><span class="tscolor" lg_zh="t_4e81bd45b5754fc8ac5246006951be8f"><span lg_kh="1">(</span>默认情况下，在POI 中禁用日志记录。有时，启用日志记录以查看打印出的一些调试消息可能会很有用，这有助于分析问题。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_16993e15c3214ef4b98e1fee05b37e9a">You can select the logging framework by setting the system property <em>org.apache.poi.util.POILogger</em> during application startup or by calling System.setProperty():</span><span class="tscolor" lg_zh="t_16993e15c3214ef4b98e1fee05b37e9a"><span lg_kh="1">(</span>您可以通过在应用程序启动期间设置系统属性 org.apache.poi.util.POILogger 或调用 System.setProperty() 来选择日志记录框架：<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">System.setProperty("org.apache.poi.util.POILogger", "org.apache.poi.util.CommonsLogger" );</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
     </div>
     <p><span lg_en="t_347c33ce30e647dd99abeebad5c400eb">Note: You need to call <em>setProperty()</em> before any POI functionality is invoked as the logger is only initialized during startup.</span><span class="tscolor" lg_zh="t_347c33ce30e647dd99abeebad5c400eb"><span lg_kh="1">(</span>注意：在调用任何 POI 功能之前，您需要调用setProperty（），因为记录器仅在启动期间初始化。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Available+logger+implementations"></a>
    <h2 class="boxed"><span lg_en="t_56dc81e93710411bb449fcc917470715">Available logger implementations</span><span class="tscolor" lg_zh="t_56dc81e93710411bb449fcc917470715"><span lg_kh="1">(</span>可用的记录器实现<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_ac607451b0834590a0f775fc7180e0a0">The following logger implementations are provided by POI:</span><span class="tscolor" lg_zh="t_ac607451b0834590a0f775fc7180e0a0"><span lg_kh="1">(</span>POI 提供了以下记录器实现：<span lg_kh="1">)</span></span></p>
     <table class="ForrestTable" cellspacing="1" cellpadding="4">
      <tbody>
       <tr>
        <th colspan="1" rowspan="1"><span lg_en="t_66d5446cc93c42749c46700871103785">Class</span><span class="tscolor" lg_zh="t_66d5446cc93c42749c46700871103785"><span lg_kh="1">(</span>类<span lg_kh="1">)</span></span></th>
        <th colspan="1" rowspan="1"><span lg_en="t_01d5929a94004180ad97db1da7d14ed3">Type</span><span class="tscolor" lg_zh="t_01d5929a94004180ad97db1da7d14ed3"><span lg_kh="1">(</span>类型<span lg_kh="1">)</span></span></th>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_5210747dff2740028641061203178bb7">org.apache.poi.util.SystemOutLogger</span><span class="tscolor" lg_zh="t_5210747dff2740028641061203178bb7"><span lg_kh="1">(</span>org.apache.poi.util.SystemOutLogger<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_8a3d7a5fdc2544dfb4fb395dd76204cc">Sends log output to the system console</span><span class="tscolor" lg_zh="t_8a3d7a5fdc2544dfb4fb395dd76204cc"><span lg_kh="1">(</span>将日志输出发送到系统控制台<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_80819253e3234af6a0c134b9e61d1eb5">org.apache.poi.util.NullLogger</span><span class="tscolor" lg_zh="t_80819253e3234af6a0c134b9e61d1eb5"><span lg_kh="1">(</span>org.apache.poi.util.NullLogger<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_50e3842a1cc84cb3aa5740f9fd790f2a">Default logger, does not log anything</span><span class="tscolor" lg_zh="t_50e3842a1cc84cb3aa5740f9fd790f2a"><span lg_kh="1">(</span>默认记录器，不记录任何内容<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_e07fa89c5f0f40c2a160d1819fdec507">org.apache.poi.util.CommonsLogger</span><span class="tscolor" lg_zh="t_e07fa89c5f0f40c2a160d1819fdec507"><span lg_kh="1">(</span>org.apache.poi.util.CommonsLogger<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_b5ff0ca066504eb79003863d1ca26caa">Allows to use <a href="https://commons.apache.org/proper/commons-logging/">Apache Commons Logging</a> for logging. This can use JDK1.4 logging, log4j, logkit, etc. The log4j dependency was removed in POI 5.0.0, so you will need to include this dependency yourself if you need it.</span><span class="tscolor" lg_zh="t_b5ff0ca066504eb79003863d1ca26caa"><span lg_kh="1">(</span>允许使用 Apache Commons Logging 进行日志记录。这可以使用 JDK1.4 日志记录、log4j、logkit 等。在 POI 5.0.0 中删除了 log4j 依赖项，因此如果需要，您需要自己包含此依赖项。<span lg_kh="1">)</span></span></td>
       </tr>
       <tr>
        <td colspan="1" rowspan="1"><span lg_en="t_3d1d6c24e89949109e98e3f5f8e030bb">org.apache.poi.util.DummyPOILogger</span><span class="tscolor" lg_zh="t_3d1d6c24e89949109e98e3f5f8e030bb"><span lg_kh="1">(</span>org.apache.poi.util.DummyPOILogger<span lg_kh="1">)</span></span></td>
        <td colspan="1" rowspan="1"><span lg_en="t_d517f9b2cc8a4cabb3676cef6b2adc3f">Simple logger which will keep all log-lines in memory for later analysis (this class is not in the jar, just in the test source). Used primarily for testing. Note: this may cause a memory leak if used in production application!</span><span class="tscolor" lg_zh="t_d517f9b2cc8a4cabb3676cef6b2adc3f"><span lg_kh="1">(</span>简单的记录器，它将所有日志行保存在内存中以供以后分析（这个类不在 jar 中，只是在测试源中）。主要用于测试。注意：如果在生产应用程序中使用，这可能会导致内存泄漏！<span lg_kh="1">)</span></span></td>
       </tr>
      </tbody>
     </table>
    </div>
    <a name="Sending+logs+to+a+different+log+framework"></a>
    <h2 class="boxed"><span lg_en="t_01e6ff0f054b4ed1b43a65cd5812c0e4">Sending logs to a different log framework</span><span class="tscolor" lg_zh="t_01e6ff0f054b4ed1b43a65cd5812c0e4"><span lg_kh="1">(</span>将日志发送到不同的日志框架<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_9b7c334be2d545e58d2184e6356da6ed">You can send logs to other logging frameworks by implementing the interface <em>org.apache.poi.util.POILogger</em>.</span><span class="tscolor" lg_zh="t_9b7c334be2d545e58d2184e6356da6ed"><span lg_kh="1">(</span>您可以通过实现接口 org.apache.poi.util.POILogger 将日志发送到其他日志框架。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Implementation+details"></a>
    <h2 class="boxed"><span lg_en="t_2f4bf3da74284c13b256d5ccd1ecaf79">Implementation details</span><span class="tscolor" lg_zh="t_2f4bf3da74284c13b256d5ccd1ecaf79"><span lg_kh="1">(</span>实施细节<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_89a230d2ced6476bb55ebd3b147c4345">Every class uses a <span class="codefrag">POILogger</span> to log, and gets it using a static method of the <span class="codefrag">POILogFactory</span> .</span><span class="tscolor" lg_zh="t_89a230d2ced6476bb55ebd3b147c4345"><span lg_kh="1">(</span>每个类都使用 POILogger 进行日志记录，并使用 POILogFactory 的静态方法获取它。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e51ab9d045114aa9bd2db3a611fc92a3">Each class in POI can log using a <span class="codefrag">POILogger</span>, which is an abstract class. We decided to make our own logging facade because:</span><span class="tscolor" lg_zh="t_e51ab9d045114aa9bd2db3a611fc92a3"><span lg_kh="1">(</span>POI 中的每个类都可以使用 POILogger 进行记录，这是一个抽象类。我们决定制作自己的日志外观，因为：<span lg_kh="1">)</span></span></p>
     <ol>
      <li><span lg_en="t_39c375a4e9c5401696f9e08f13f19127">we need to log many values and we put many methods in this class to facilitate the programmer, without having him write string concatenations;</span><span class="tscolor" lg_zh="t_39c375a4e9c5401696f9e08f13f19127"><span lg_kh="1">(</span>我们需要记录很多值，我们在这个类中提供了很多方法来给程序员提供方便，而不需要他编写字符串连接；<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9707dbca1cd0401691d3cba5b55894a9">we need to be able to use POI without any logger package present.</span><span class="tscolor" lg_zh="t_9707dbca1cd0401691d3cba5b55894a9"><span lg_kh="1">(</span>我们需要能够在没有任何记录器包的情况下使用 POI。<span lg_kh="1">)</span></span></li>
     </ol>
    </div>
    <p align="right"><span lg_en="t_c436b62e6e574113ba76013d789fdb92"><font size="-2">by&nbsp;Dominik Stadler</font></span><span class="tscolor" lg_zh="t_c436b62e6e574113ba76013d789fdb92"><span lg_kh="1">(</span>多米尼克·斯塔德勒<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/logging.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>