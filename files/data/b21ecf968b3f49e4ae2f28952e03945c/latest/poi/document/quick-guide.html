<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-HWPF - A Quick Guide</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_768a9c7273514928be21e4c05065e301">POI-HWPF - A Quick Guide</span><span class="tscolor" lg_zh="t_768a9c7273514928be21e4c05065e301"><span lg_kh="1">(</span>POI-HWPF - 快速指南<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_48843926d4bd48f693002481a78c3b78">Overview</span><span class="tscolor" lg_zh="t_48843926d4bd48f693002481a78c3b78"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <p><span lg_en="t_1340d80ca25e4aa480fc0641ff598db5">HWPF is still in early development. It is in the <a href="http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/"> scratchpad section of the SVN.</a> You will need to ensure you either have a recent SVN checkout, or a recent SVN nightly build (including the scratchpad jar!)</span><span class="tscolor" lg_zh="t_1340d80ca25e4aa480fc0641ff598db5"><span lg_kh="1">(</span>HWPF 仍处于早期开发阶段。它位于 SVN 的暂存器部分。您需要确保您有最近的 SVN 结帐，或最近的 SVN nightly build（包括暂存器 jar！）<span lg_kh="1">)</span></span></p>
    <a name="Basic+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_753801cac11d4498b55e7421a410edaf">Basic Text Extraction</span><span class="tscolor" lg_zh="t_753801cac11d4498b55e7421a410edaf"><span lg_kh="1">(</span>基本文本提取<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_d40a9bbbf685421a83d17043dc1a683d">For basic text extraction, make use of <span class="codefrag">org.apache.poi.hwpf.extractor.WordExtractor</span>. It accepts an input stream or a <span class="codefrag">HWPFDocument</span>. The <span class="codefrag">getText()</span> method can be used to get the text from all the paragraphs, or <span class="codefrag">getParagraphText()</span> can be used to fetch the text from each paragraph in turn. The other option is <span class="codefrag">getTextFromPieces()</span>, which is very fast, but tends to return things that aren't text from the page. YMMV.</span><span class="tscolor" lg_zh="t_d40a9bbbf685421a83d17043dc1a683d"><span lg_kh="1">(</span>对于基本的文本提取，请使用 org.apache.poi.hwpf.extractor.WordExtractor。它接受输入流或 HWPFDocument。 getText() 方法可用于从所有段落中获取文本，或者 getParagraphText() 可用于依次从每个段落中获取文本。另一个选项是 getTextFromPieces()，它非常快，但往往会从页面返回非文本内容。 YMMV。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Specific+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_ed3fb41758ff4b3c9f5e72b338b21515">Specific Text Extraction</span><span class="tscolor" lg_zh="t_ed3fb41758ff4b3c9f5e72b338b21515"><span lg_kh="1">(</span>特定文本提取<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_40f9c9533b8947f3bc72b680ff4fb07e">To get specific bits of text, first create a <span class="codefrag">org.apache.poi.hwpf.HWPFDocument</span>. Fetch the range with <span class="codefrag">getRange()</span>, then get paragraphs from that. You can then get text and other properties.</span><span class="tscolor" lg_zh="t_40f9c9533b8947f3bc72b680ff4fb07e"><span lg_kh="1">(</span>要获取特定的文本位，首先创建一个 org.apache.poi.hwpf.HWPFDocument。使用 getRange() 获取范围，然后从中获取段落。然后，您可以获得文本和其他属性。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Headers+and+Footers"></a>
    <h2 class="boxed"><span lg_en="t_0a98e3ecfdba47128fe0e69ebb162c4e">Headers and Footers</span><span class="tscolor" lg_zh="t_0a98e3ecfdba47128fe0e69ebb162c4e"><span lg_kh="1">(</span><a href="#HeaderFooter" style="color:blue;">页眉和页脚</a><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_7de969c43cfe44f3b2c7049b158c19a2">To get at the headers and footers of a word document, first create a <span class="codefrag">org.apache.poi.hwpf.HWPFDocument</span>. Next, you need to create a <span class="codefrag">org.apache.poi.hwpf.usermodel.HeaderStores</span>, passing it your HWPFDocument. Finally, the HeaderStores gives you access to the headers and footers, including first / even / odd page ones if defined in your document. Additionally, HeaderStores provides a method for removing any macros in the text, which is helpful as many headers and footers do end up with macros in them.</span><span class="tscolor" lg_zh="t_7de969c43cfe44f3b2c7049b158c19a2"><span lg_kh="1">(</span>要获取 word 文档的页眉和页脚，首先创建一个 org.apache.poi.hwpf.HWPFDocument。然后，您需要创建一个 org.apache.poi.hwpf.usermodel.HeaderStores，将您的 HWPFDocument 传给它。最后，HeaderStores 让您有权访问页眉和页脚，包括第一页/偶数/奇数页（如果在文档中定义）。此外，HeaderStores 提供了一种删除文本中任何宏的方法，这很有帮助，因为许多页眉和页脚最终都包含宏。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Changing+Text"></a>
    <h2 class="boxed"><span lg_en="t_c69e55cde29f486e986ba5ff361c0faf">Changing Text</span><span class="tscolor" lg_zh="t_c69e55cde29f486e986ba5ff361c0faf"><span lg_kh="1">(</span>更改文本<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_3ac0f97342c941fab41705d68960dc55">It is possible to change the text via <span class="codefrag">insertBefore()</span> and <span class="codefrag">insertAfter()</span> on a <span class="codefrag">Range</span> object (either a <span class="codefrag">Range</span>, <span class="codefrag">Paragraph</span> or <span class="codefrag">CharacterRun</span>). It is also possible to delete a <span class="codefrag">Range</span>. This code will work in many, but not all cases, and patches to improve it are gratefully received!</span><span class="tscolor" lg_zh="t_3ac0f97342c941fab41705d68960dc55"><span lg_kh="1">(</span>可以通过 Range 对象（Range、Paragraph 或 CharacterRun）上的 insertBefore() 和 insertAfter() 更改文本。也可以删除范围。这段代码在很多情况下但不是所有情况下都能工作，我们非常感激能够改进改进它的补丁！<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Further+Examples"></a>
    <h2 class="boxed"><span lg_en="t_13250d762f3946d288f93c2ffe4862fa">Further Examples</span><span class="tscolor" lg_zh="t_13250d762f3946d288f93c2ffe4862fa"><span lg_kh="1">(</span>更多例子<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_b5df0f945e324021905d8b3ac695faa8">For now, the best source of additional examples is in the unit tests. <a href="http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/testcases/org/apache/poi/hwpf/"> Browse the HWPF unit tests.</a></span><span class="tscolor" lg_zh="t_b5df0f945e324021905d8b3ac695faa8"><span lg_kh="1">(</span>目前，其他示例的最佳来源是单元测试。浏览 HWPF 单元测试。<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_144137e3da544c4c8c222352a664f9aa"><font size="-2">by&nbsp;Nick Burch</font></span><span class="tscolor" lg_zh="t_144137e3da544c4c8c222352a664f9aa"><span lg_kh="1">(</span>作者：尼克伯奇<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/document/quick-guide.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>