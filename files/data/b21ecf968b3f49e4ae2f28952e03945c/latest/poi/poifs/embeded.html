<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - POIFS - Documents embedded in other documents</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_a5c258628506412a8fff557a805216c5">Apache POI - POIFS - Documents embedded in other documents</span><span class="tscolor" lg_zh="t_a5c258628506412a8fff557a805216c5"><span lg_kh="1">(</span>Apache POI - POIFS - 嵌入在其他文档中的文档<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_42754901b5d04382b7b47f4612ac31ce">Overview</span><span class="tscolor" lg_zh="t_42754901b5d04382b7b47f4612ac31ce"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Overview"></a>
    <h2 class="boxed"><span lg_en="t_bdc9f967766e4ada896fbfe3fdc50a00">Overview</span><span class="tscolor" lg_zh="t_bdc9f967766e4ada896fbfe3fdc50a00"><span lg_kh="1">(</span><span style="color:black;">概述</span><span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_283828db86814853a4d272cb46407af9">It is possible for one OLE 2 based document to have other OLE 2 documents embedded in it. For example, an Excel file may have a Word document and a PowerPoint slideshow embedded as part of it.</span><span class="tscolor" lg_zh="t_283828db86814853a4d272cb46407af9"><span lg_kh="1">(</span>一个基于 OLE 2 的文档可以嵌入其他 OLE 2 文档。例如，Excel 文件中可能嵌入了 Word 文档和 PowerPoint 幻灯片。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_887bbb58987e41ff8ea8c8cc4bdf9673">Normally, these other documents are stored in subdirectories of the OLE 2 (POIFS) filesystem. The exact location of the embedded documents will vary depending on the type of the master document, and the exact directory names will differ each time. To figure out exactly which directory to look in, you will either need to process the appropriate OLE 2 linking entry in the master document, or simple iterate over all the directories in the filesystem.</span><span class="tscolor" lg_zh="t_887bbb58987e41ff8ea8c8cc4bdf9673"><span lg_kh="1">(</span>通常，这些其他文档存储在 OLE 2 (POIFS) 文件系统的子目录中。嵌入文档的确切位置将根据主文档的类型而有所不同，并且每次的确切目录名称都会有所不同。要准确确定要查看的目录，您需要在主文档中处理适当的 OLE 2 链接条目，或者简单地遍历文件系统中的所有目录。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_469d20359ce4497681e96449c2342b49">As a general rule, you will find the same OLE 2 entries in the subdirectories, as you would've found at the root of the filesystem were a document to not be embedded.</span><span class="tscolor" lg_zh="t_469d20359ce4497681e96449c2342b49"><span lg_kh="1">(</span>作为一般规则，您会在子目录中找到相同的 OLE 2 条目，就像您在文件系统的根目录中发现的那样是不嵌入的文档。<span lg_kh="1">)</span></span></p>
     <a name="Files+embedded+in+Excel"></a>
     <h3 class="boxed"><span lg_en="t_3f42a4df65a84133be2abc311ec8abf2">Files embedded in Excel</span><span class="tscolor" lg_zh="t_3f42a4df65a84133be2abc311ec8abf2"><span lg_kh="1">(</span>Excel 中嵌入的文件<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_64b23b39a60b463a8cc3da50ddac2781">Excel normally stores embedded files in subdirectories of the filesystem root. Typically these subdirectories are named starting with MBD, with 8 hex characters following.</span><span class="tscolor" lg_zh="t_64b23b39a60b463a8cc3da50ddac2781"><span lg_kh="1">(</span>Excel 通常将嵌入文件存储在文件系统根目录的子目录中。通常这些子目录以 MBD 开头，后跟 8 个十六进制字符。<span lg_kh="1">)</span></span></p>
     <a name="Files+embedded+in+Word"></a>
     <h3 class="boxed"><span lg_en="t_5bc97753457c4d7281391523f4630e70">Files embedded in Word</span><span class="tscolor" lg_zh="t_5bc97753457c4d7281391523f4630e70"><span lg_kh="1">(</span>Word 中嵌入的文件<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_026770207a2b441a92befa5f946e0a30">Word normally stores embedded files in subdirectories of the ObjectPool directory, itself a subdirectory of the filesystem root. Typically these subdirectories and named starting with an underscore, followed by 10 numbers.</span><span class="tscolor" lg_zh="t_026770207a2b441a92befa5f946e0a30"><span lg_kh="1">(</span>Word 通常将嵌入文件存储在 ObjectPool 目录的子目录中，该目录本身是文件系统根目录的子目录。通常这些子目录的命名以下划线开头，后跟 10 个数字。<span lg_kh="1">)</span></span></p>
     <a name="Files+embedded+in+PowerPoint"></a>
     <h3 class="boxed"><span lg_en="t_4ddc5ccdcbbe4168a19f8cb822883350">Files embedded in PowerPoint</span><span class="tscolor" lg_zh="t_4ddc5ccdcbbe4168a19f8cb822883350"><span lg_kh="1">(</span>嵌入在 PowerPoint 中的文件<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_8370b4822c4a4382ac1857efcd9cefa4">PowerPoint does not normally store embedded files in the OLE2 layer. Instead, they are held within records of the main PowerPoint file. 
       <br> See the <a href="./../slideshow/how-to-shapes.html#OLE">HSLF Tutorial</a> for how to retrieve embedded OLE objects from a presentation</span><span class="tscolor" lg_zh="t_8370b4822c4a4382ac1857efcd9cefa4"><span lg_kh="1">(</span>PowerPoint 通常不在 OLE2 层中存储嵌入文件。相反，它们保存在主 PowerPoint 文件的记录中。有关如何从演示文稿中检索嵌入的 OLE 对象的信息，请参阅 HSLF 教程<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Listing+POIFS+contents"></a>
    <h2 class="boxed"><span lg_en="t_64483c5ad2544854937875f41661bb7e">Listing POIFS contents</span><span class="tscolor" lg_zh="t_64483c5ad2544854937875f41661bb7e"><span lg_kh="1">(</span>列出 POIFS 内容<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_cc4890b5811c4f6fb08eb30d77002e09">POIFS provides a simple tool for listing the contents of OLE2 files. This can allow you to see what your POIFS file contents, and hence if it has any embedded documents in it, and where.</span><span class="tscolor" lg_zh="t_cc4890b5811c4f6fb08eb30d77002e09"><span lg_kh="1">(</span>POIFS 提供了一个简单的工具来列出 OLE2 文件的内容。这可以让您查看您的 POIFS 文件的内容，因此它是否有任何嵌入的文档，以及在哪里。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_97146a4a68b44754ade784a96949bd1a">The tool to use is <em>org.apache.poi.poifs.dev.POIFSLister</em>. This tool may be run from the command line, and takes a filename as its parameter. It will print out all the directories and files contained within the POIFS file.</span><span class="tscolor" lg_zh="t_97146a4a68b44754ade784a96949bd1a"><span lg_kh="1">(</span>使用的工具是 org.apache.poi.poifs.dev.POIFSLister。该工具可以从命令行运行，并将文件名作为其参数。它将打印出 POIFS 文件中包含的所有目录和文件。<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Opening+embedded+files"></a>
    <h2 class="boxed"><span lg_en="t_29fe91447ec344fdaa60169ec99bfd93">Opening embedded files</span><span class="tscolor" lg_zh="t_29fe91447ec344fdaa60169ec99bfd93"><span lg_kh="1">(</span>打开嵌入文件<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_fbf309b65c874b6eb3122d7c785839b5">All of the POIDocument classes (HSSFWorkbook, HSLFSlideShow, HWPFDocument and HDGFDiagram) can either be opened from a POIFSFileSystem, or from a specific directory within a POIFSFileSystem. So, to open embedded files, simply locate the appropriate DirectoryNode that represents the subdirectory of interest, and pass this + the overall POIFSFileSystem to the constructor.</span><span class="tscolor" lg_zh="t_fbf309b65c874b6eb3122d7c785839b5"><span lg_kh="1">(</span>所有 POIDocument 类（HSSFWorkbook、HSLFSlideShow、HWPFDocument 和 HDGFDiagram）都可以从 POIFSFileSystem 或 POIFSFileSystem 中的特定目录打开。因此，要打开嵌入文件，只需找到表示感兴趣的子目录的适当 DirectoryNode，并将 this + 整个 POIFSFileSystem 传递给构造函数。<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_509da77a58bc4b1bac1af91c079bafea">I you want to extract the textual contents of the embedded file, then open the appropriate POIDocument, and then pass this to the extractor class, instead of simply passing the POIFSFilesystem to the extractor.</span><span class="tscolor" lg_zh="t_509da77a58bc4b1bac1af91c079bafea"><span lg_kh="1">(</span>我要提取嵌入文件的文本内容，然后打开相应的 POIDocument，然后将其传递给提取器类，而不是简单地将 POIFSFilesystem 传递给提取器。<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_ae657e72cc9f438e86a9d1459f81b6f1"><font size="-2">by&nbsp;Nick Burch,&nbsp;Yegor Kozlov</font></span><span class="tscolor" lg_zh="t_ae657e72cc9f438e86a9d1459f81b6f1"><span lg_kh="1">(</span>尼克·伯奇、叶戈尔·科兹洛夫<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright © 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/poifs/embeded.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>