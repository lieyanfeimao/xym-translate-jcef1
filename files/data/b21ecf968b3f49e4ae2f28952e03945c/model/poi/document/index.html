<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>Apache POI - HWPF and XWPF - Java API to Handle Microsoft Word Files</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_c3c7e3d1a0e442dbbef6080b2863e1ce">Apache POI - HWPF and XWPF - Java API to Handle Microsoft Word Files</span><span class="tscolor" lg_zh="t_c3c7e3d1a0e442dbbef6080b2863e1ce"><span lg_kh="1">(</span>${t_c3c7e3d1a0e442dbbef6080b2863e1ce}<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_417dbe10821f4be2a3070ef1d28ccb0b">Overview</span><span class="tscolor" lg_zh="t_417dbe10821f4be2a3070ef1d28ccb0b"><span lg_kh="1">(</span>${t_417dbe10821f4be2a3070ef1d28ccb0b}<span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Overview"></a>
    <h2 class="boxed"><span lg_en="t_6e0553ca2c0b4dceb2abebe008866562">Overview</span><span class="tscolor" lg_zh="t_6e0553ca2c0b4dceb2abebe008866562"><span lg_kh="1">(</span>${t_6e0553ca2c0b4dceb2abebe008866562}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_6ab56961e5844bfe861329cbbc0b7b84">HWPF is the name of our port of the Microsoft Word 97(-2007) file format to pure Java. It also provides limited read only support for the older Word 6 and Word 95 file formats.</span><span class="tscolor" lg_zh="t_6ab56961e5844bfe861329cbbc0b7b84"><span lg_kh="1">(</span>${t_6ab56961e5844bfe861329cbbc0b7b84}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_79abed137eec4c9d8766d59263055d86">The partner to HWPF for the new Word 2007 .docx format is <em>XWPF</em>. Whilst HWPF and XWPF provide similar features, there is not a common interface across the two of them at this time.</span><span class="tscolor" lg_zh="t_79abed137eec4c9d8766d59263055d86"><span lg_kh="1">(</span>${t_79abed137eec4c9d8766d59263055d86}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_b97105935b8741a78ad72928abe92878">Both HWPF and XWPF could be described as "moderately functional". For some use cases, especially around text extraction, support is very strong. For others, support may be limited or incomplete, and it may be necessary to dig down into low-level code. Error checking may be missing in places, so it may be possible to accidentally generate invalid files. Enhancements to fix such things are generally very well received!</span><span class="tscolor" lg_zh="t_b97105935b8741a78ad72928abe92878"><span lg_kh="1">(</span>${t_b97105935b8741a78ad72928abe92878}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4967e7dd28844853b4be02523dc47a01">As detailed in the <a href="../../components/">Components Page</a>, HWPF is contained within the poi-scratchpad-XXX.jar, while XWPF is in the poi-ooxml-XXX.jar. You will need to ensure you include the appropriate jars (and their dependencies!) in your classpath to use HWPF or XWPF.</span><span class="tscolor" lg_zh="t_4967e7dd28844853b4be02523dc47a01"><span lg_kh="1">(</span>${t_4967e7dd28844853b4be02523dc47a01}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e0eaef0904004848a6403a57500ade17">Please note that in version 3.12, due to a bug, you might need to include poi-scratchpad-XXX.jar when using XWPF. This has been fixed again for the next release as there should not be such a dependency.</span><span class="tscolor" lg_zh="t_e0eaef0904004848a6403a57500ade17"><span lg_kh="1">(</span>${t_e0eaef0904004848a6403a57500ade17}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="An+overview+of+the+code"></a>
    <h2 class="boxed"><span lg_en="t_a59a6637cd1542ef8b5c0a17667ad9d0">An overview of the code</span><span class="tscolor" lg_zh="t_a59a6637cd1542ef8b5c0a17667ad9d0"><span lg_kh="1">(</span>${t_a59a6637cd1542ef8b5c0a17667ad9d0}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_615d96915f1f44dc86bee20113e3f87f">Source in the <em>org.apache.poi.hwpf.model</em> tree is the Java representation of internal Word format structure. This code is "internal", it shall not be used by your code. Code from <em>org.apache.poi.hwpf.usermodel</em> package is actual public and user-friendly (as much as possible) API to access document parts. Source code in the <em>org.apache.poi.hwpf.extractor</em> tree is a wrapper of this to facilitate easy extraction of interesting things (eg the Text), and <em>org.apache.poi.hwpf.converter</em> package contains Word-to-HTML and Word-to-FO converters (latest can be used to generate PDF from Word files when using with <a href="http://xmlgraphics.apache.org/fop/">Apache FOP</a> ). Also there is a small file-structure-dumping utility in <em>org.apache.poi.hwpf.dev</em> package, primally for developing purposes.</span><span class="tscolor" lg_zh="t_615d96915f1f44dc86bee20113e3f87f"><span lg_kh="1">(</span>${t_615d96915f1f44dc86bee20113e3f87f}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5b87b054a9a1415b9b4401b7ba6186eb">The main entry point to HWPF is HWPFDocument. Currently it has a lot of references both to internal interfaces ( <em>org.apache.poi.hwpf.model</em> package) and public API ( <em>org.apache.poi.hwpf.usermodel</em> ) package. It is possible that it will be split into two different interfaces (like WordFile and WordDocument) in later versions.</span><span class="tscolor" lg_zh="t_5b87b054a9a1415b9b4401b7ba6186eb"><span lg_kh="1">(</span>${t_5b87b054a9a1415b9b4401b7ba6186eb}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a2e5a1d3aa054312ba96d702dc55396a">The main entry point to XWPF is XWPFDocument. From there, you can get the paragraphs, pictures, tables, sections, headers etc.</span><span class="tscolor" lg_zh="t_a2e5a1d3aa054312ba96d702dc55396a"><span lg_kh="1">(</span>${t_a2e5a1d3aa054312ba96d702dc55396a}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a800630c3f61477eb681ee4688fcf584">Currently, there are only a handful of example programs using HWPF and XWPF available. They can be found in svn in the examples section, under <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/hwpf">HWPF</a> and <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xwpf">XWPF</a>. Both HWPF and XWPF have fairly high levels of unit test coverage, which provides examples of using the various areas of functionality of both modules. These can be found in svn, under <a href="http://svn.apache.org/repos/asf/poi/trunk/src/scratchpad/testcases/org/apache/poi/hwpf">HWPF</a> and <a href="http://svn.apache.org/repos/asf/poi/trunk/src/ooxml/testcases/org/apache/poi/xwpf">XWPF</a>. Contributions of more examples, whether inspired by the unit tests or not, would be most welcomed!</span><span class="tscolor" lg_zh="t_a800630c3f61477eb681ee4688fcf584"><span lg_kh="1">(</span>${t_a800630c3f61477eb681ee4688fcf584}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="HWPF+Notes"></a>
    <h2 class="boxed"><span lg_en="t_ea3a329a471349269407d6d4dfc22389">HWPF Notes</span><span class="tscolor" lg_zh="t_ea3a329a471349269407d6d4dfc22389"><span lg_kh="1">(</span>${t_ea3a329a471349269407d6d4dfc22389}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_e78a98e781ee45c38be84758be3b2482">A .doc Word document, as handled by HWPF, can be considered as very long single text buffer. The HWPF API provides "pointers" to document parts, like sections, paragraphs and character runs. Usually user will iterates over main document part sections, paragraphs from sections and character runs from paragraph. Each such interface is a pointer to document text subrange along with additional properties (and they all extends same Range parent class). There is additional Range implementations like Table, TableRow, TableCell, etc. Some structures like Bookmark or Field can also provide subranges pointers.</span><span class="tscolor" lg_zh="t_e78a98e781ee45c38be84758be3b2482"><span lg_kh="1">(</span>${t_e78a98e781ee45c38be84758be3b2482}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_4a72af164e2c4fa39b4ff07515b7b8bb">Changing file content usually requires a lot of synchronized changes in those structures like updating property boundaries, position handlers, etc. Because of that HWPF API shall be considered as not thread safe. In addition, there is a "one pointer" rule for changing content. It means you should not use two different Range instances at one time. More precisely, if you are changing file content using some range pointer, all other range pointers except parents' ones become invalid. For example if you obtain overall range (1), paragraph range (2) from overall range and character run range (3) from paragraph range and change text of paragraph, character run range is now invalid and should not be used, but overall range pointer still valid. Each time you obtaining range (pointer) new instance is created. It means if you obtained two range pointers and changed document text using first range pointer, second one became invalid.</span><span class="tscolor" lg_zh="t_4a72af164e2c4fa39b4ff07515b7b8bb"><span lg_kh="1">(</span>${t_4a72af164e2c4fa39b4ff07515b7b8bb}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="XWPF+Patches+Required%21"></a>
    <h2 class="boxed"><span lg_en="t_4f83d696a56d452f8b4622d274b209ed">XWPF Patches Required!</span><span class="tscolor" lg_zh="t_4f83d696a56d452f8b4622d274b209ed"><span lg_kh="1">(</span>${t_4f83d696a56d452f8b4622d274b209ed}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_b2042eac9e8544f9875a4d3254cbfbbb">At the moment, XWPF covers many common use cases for reading and writing .docx files. Whilst this is a great thing, it does mean that XWPF does everything that the current POI committers need it to do, and so none of the committers are actively adding new features.</span><span class="tscolor" lg_zh="t_b2042eac9e8544f9875a4d3254cbfbbb"><span lg_kh="1">(</span>${t_b2042eac9e8544f9875a4d3254cbfbbb}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_192ffca728654a4db80b3f7d09a4da12">If you come across a feature in XWPF that you need, and isn't currently there, please do send in a patch to add the extra functionality! More details on contributing patches are available on the <a href="../../devel/guidelines.html">"Contribution to POI" page</a>.</span><span class="tscolor" lg_zh="t_192ffca728654a4db80b3f7d09a4da12"><span lg_kh="1">(</span>${t_192ffca728654a4db80b3f7d09a4da12}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="HWPF+Patches+Required%21"></a>
    <h2 class="boxed"><span lg_en="t_263f50dcde8c4340a6a4401949175e9a">HWPF Patches Required!</span><span class="tscolor" lg_zh="t_263f50dcde8c4340a6a4401949175e9a"><span lg_kh="1">(</span>${t_263f50dcde8c4340a6a4401949175e9a}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_85bdd1f1fd3a4477937ece6356ab16ab">At the moment we unfortunately do not have someone taking care for HWPF and fostering its development. What we need is someone to stand up, take this thing under his hood as his baby and push it forward. Ryan Ackley, who put a lot of effort into HWPF, is no longer on board, so HWPF is an orphan child waiting to be adopted.</span><span class="tscolor" lg_zh="t_85bdd1f1fd3a4477937ece6356ab16ab"><span lg_kh="1">(</span>${t_85bdd1f1fd3a4477937ece6356ab16ab}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ed4401f0c35d405893de70e83dc0a7ef">If <strong>you</strong> are interested in becoming the new HWPF pointman, you should look into the Microsoft Word internals. A good starting point seems to be Ryan Ackley's <a href="../../components/document/docoverview.html">overview</a>. An introduction to the binary file formats is <a href="https://msdn.microsoft.com/en-us/library/cc998577%28v=office.12%29.aspx">available from Microsoft</a>, which has some good references and links. After that, the full details on the word format are available from <a href="https://msdn.microsoft.com/en-us/library/cc313153%28v=office.12%29.aspx">Microsoft</a>, but the documentation can be a little hard to get into at first... Try reading the <a href="../../components/document/docoverview.html">overview</a> first, and looking at the existing code, then finally look up the documentation for specific missing features.</span><span class="tscolor" lg_zh="t_ed4401f0c35d405893de70e83dc0a7ef"><span lg_kh="1">(</span>${t_ed4401f0c35d405893de70e83dc0a7ef}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_18a9b938642040ada037e3069ddf8019">As a first step you should familiarize yourself with the source code, examples, test cases, and the HWPF patches available at <a href="http://issues.apache.org/">Bugzilla</a> (if any). Then you should compile an overview of</span><span class="tscolor" lg_zh="t_18a9b938642040ada037e3069ddf8019"><span lg_kh="1">(</span>${t_18a9b938642040ada037e3069ddf8019}<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_cf3a761535124719b04f703eba4f0b18">the current HWPF status,</span><span class="tscolor" lg_zh="t_cf3a761535124719b04f703eba4f0b18"><span lg_kh="1">(</span>${t_cf3a761535124719b04f703eba4f0b18}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_9c702b852ded47b394a62f2a5c6b75c2">the patches in <a href="http://issues.apache.org/bugzilla/">Bugzilla</a> to be checked in (and those that should better be ditched),</span><span class="tscolor" lg_zh="t_9c702b852ded47b394a62f2a5c6b75c2"><span lg_kh="1">(</span>${t_9c702b852ded47b394a62f2a5c6b75c2}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_d062358eebd14f16845e4eafe87ff4f8">the available test cases and the test cases still to be written,</span><span class="tscolor" lg_zh="t_d062358eebd14f16845e4eafe87ff4f8"><span lg_kh="1">(</span>${t_d062358eebd14f16845e4eafe87ff4f8}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_b26c9b321a164cabb3df52869e50fa8c">the available documentation and the docs to be written,</span><span class="tscolor" lg_zh="t_b26c9b321a164cabb3df52869e50fa8c"><span lg_kh="1">(</span>${t_b26c9b321a164cabb3df52869e50fa8c}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_5428881bf1224ae2be43fb2b88fc8c78">anything else that seems reasonable</span><span class="tscolor" lg_zh="t_5428881bf1224ae2be43fb2b88fc8c78"><span lg_kh="1">(</span>${t_5428881bf1224ae2be43fb2b88fc8c78}<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_9a8de661e3c747bbb0e8afc19120ea94">When you start coding, you will not yet have write access to the SVN repository. Please submit your patches to <a href="http://issues.apache.org/">Bugzilla</a> and nag <a href="mailto:dev.at.poi.apache.org">the dev list</a> until someone commits them. Besides the actual checking in of HWPF patches, current POI committers will also do some minor reviews now and then of your source code patches, test cases and documentation to help ensure software quality. But most of the time you will be on your own. However, anyone offering useful contributions over a period of time will be offered committership!</span><span class="tscolor" lg_zh="t_9a8de661e3c747bbb0e8afc19120ea94"><span lg_kh="1">(</span>${t_9a8de661e3c747bbb0e8afc19120ea94}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_1151c5667c964ad2b02122697080b031">Please do not forget to write <a href="http://www.junit.org/">JUnit</a> test cases and documentation! We won't accept code that doesn't come with test cases. And please consider that other contributors should be able to understand your source code easily. If you need any help getting started with JUnit test cases for HWPF, please ask on the developers' mailing list! If you show that you are prepared to stick at it you will most likely be given SVN commit access. See <a href="../../devel/guidelines.html">"Contribution to POI" page</a> for more details and help getting started.</span><span class="tscolor" lg_zh="t_1151c5667c964ad2b02122697080b031"><span lg_kh="1">(</span>${t_1151c5667c964ad2b02122697080b031}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_0a9051e37ed7418588a09a78b94e9828">Of course we will help you as best as we can. However, presently there is no committer who is really familiar with the Word format, so you'll be mostly on your own. We are looking forward for you and your contributions! Honor and glory of becoming a POI committer are waiting!</span><span class="tscolor" lg_zh="t_0a9051e37ed7418588a09a78b94e9828"><span lg_kh="1">(</span>${t_0a9051e37ed7418588a09a78b94e9828}<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_a8b0d70605b246fbb6c77c1bc42f427a"><font size="-2">by&nbsp;Nicola Ken Barozzi,&nbsp;Andrew C. Oliver,&nbsp;Ryan Ackley,&nbsp;Rainer Klute</font></span><span class="tscolor" lg_zh="t_a8b0d70605b246fbb6c77c1bc42f427a"><span lg_kh="1">(</span>${t_a8b0d70605b246fbb6c77c1bc42f427a}<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="logos">
    <a href="http://validator.w3.org/check/referer"><img style="height: 31px; width: 88px;" title="Valid HTML 4.01!" alt="Valid HTML 4.01!" src="../../skin/images/valid-html401.png" class="logoImage"></a><a href="http://jigsaw.w3.org/css-validator/check/referer"><img style="height: 31px; width: 88px;" title="Valid CSS!" alt="Valid CSS!" src="../../skin/images/vcss.png" class="logoImage"></a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/document/index.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>