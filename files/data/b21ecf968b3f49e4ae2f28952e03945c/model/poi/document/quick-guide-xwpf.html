<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-XWPF - A Quick Guide</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_d9004f7a56bf40baab8c489827828946">POI-XWPF - A Quick Guide</span><span class="tscolor" lg_zh="t_d9004f7a56bf40baab8c489827828946"><span lg_kh="1">(</span>${t_d9004f7a56bf40baab8c489827828946}<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_14d11dd828134ec2b1f1c00821cb9d04">Overview</span><span class="tscolor" lg_zh="t_14d11dd828134ec2b1f1c00821cb9d04"><span lg_kh="1">(</span>${t_14d11dd828134ec2b1f1c00821cb9d04}<span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <p><span lg_en="t_7f1a43a5c5424100bb5cb50b6093522e">XWPF has a fairly stable core API, providing read and write access to the main parts of a Word .docx file, but it isn't complete. For some things, it may be necessary to dive down into the low level XMLBeans objects to manipulate the ooxml structure. If you find yourself having to do this, please consider sending in a patch to enhance that, see the <a href="../../devel/guidelines.html">"Contribution to POI" page</a>.</span><span class="tscolor" lg_zh="t_7f1a43a5c5424100bb5cb50b6093522e"><span lg_kh="1">(</span>${t_7f1a43a5c5424100bb5cb50b6093522e}<span lg_kh="1">)</span></span></p>
    <a name="Basic+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_f98d025b31154576a8664b6947e069fb">Basic Text Extraction</span><span class="tscolor" lg_zh="t_f98d025b31154576a8664b6947e069fb"><span lg_kh="1">(</span>${t_f98d025b31154576a8664b6947e069fb}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_68f4057736bb46b5850ccdf7a5777b44">For basic text extraction, make use of <span class="codefrag">org.apache.poi.xwpf.extractor.XWPFWordExtractor</span>. It accepts an input stream or a <span class="codefrag">XWPFDocument</span>. The <span class="codefrag">getText()</span> method can be used to get the text from all the paragraphs, along with tables, headers etc.</span><span class="tscolor" lg_zh="t_68f4057736bb46b5850ccdf7a5777b44"><span lg_kh="1">(</span>${t_68f4057736bb46b5850ccdf7a5777b44}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Specific+Text+Extraction"></a>
    <h2 class="boxed"><span lg_en="t_36716d1ec42c4a8585e268052d3284fd">Specific Text Extraction</span><span class="tscolor" lg_zh="t_36716d1ec42c4a8585e268052d3284fd"><span lg_kh="1">(</span>${t_36716d1ec42c4a8585e268052d3284fd}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_611f60a54c88477eb4db375ea44621df">To get specific bits of text, first create a <span class="codefrag">org.apache.poi.xwpf.XWPFDocument</span>. Select the <span class="codefrag">IBodyElement</span> of interest (Table, Paragraph etc), and from there get a <span class="codefrag">XWPFRun</span>. Finally fetch the text and properties from that.</span><span class="tscolor" lg_zh="t_611f60a54c88477eb4db375ea44621df"><span lg_kh="1">(</span>${t_611f60a54c88477eb4db375ea44621df}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Headers+and+Footers"></a>
    <h2 class="boxed"><span lg_en="t_665d4d6b968d498caf1082c830b5a634">Headers and Footers</span><span class="tscolor" lg_zh="t_665d4d6b968d498caf1082c830b5a634"><span lg_kh="1">(</span>${t_665d4d6b968d498caf1082c830b5a634}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_0f876e4dfe9b41f5894f55dfe24b3bf0">To get at the headers and footers of a word document, first create a <span class="codefrag">org.apache.poi.xwpf.XWPFDocument</span>. Next, you need to create a <span class="codefrag">org.apache.poi.xwpf.usermodel.XWPFHeaderFooter</span>, passing it your XWPFDocument. Finally, the XWPFHeaderFooter gives you access to the headers and footers, including first / even / odd page ones if defined in your document.</span><span class="tscolor" lg_zh="t_0f876e4dfe9b41f5894f55dfe24b3bf0"><span lg_kh="1">(</span>${t_0f876e4dfe9b41f5894f55dfe24b3bf0}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Changing+Text"></a>
    <h2 class="boxed"><span lg_en="t_c73b649bfa7a47dc9225338517038d09">Changing Text</span><span class="tscolor" lg_zh="t_c73b649bfa7a47dc9225338517038d09"><span lg_kh="1">(</span>${t_c73b649bfa7a47dc9225338517038d09}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_2603a561a95f408887606262b9030371">From a <span class="codefrag">XWPFParagraph</span>, it is possible to fetch the existing <span class="codefrag">XWPFRun</span> elements that make up the text. To add new text, the <span class="codefrag">createRun()</span> method will add a new <span class="codefrag">XWPFRun</span> to the end of the list. <span class="codefrag">insertNewRun(int)</span> can instead be used to add a new <span class="codefrag">XWPFRun</span> at a specific point in the paragraph.</span><span class="tscolor" lg_zh="t_2603a561a95f408887606262b9030371"><span lg_kh="1">(</span>${t_2603a561a95f408887606262b9030371}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_23c5aecb43444eb9bb79889cce5734e3">Once you have a <span class="codefrag">XWPFRun</span>, you can use the <span class="codefrag">setText(String)</span> method to make changes to the text. To add whitespace elements such as tabs and line breaks, it is necessary to use methods like <span class="codefrag">addTab()</span> and <span class="codefrag">addCarriageReturn()</span>.</span><span class="tscolor" lg_zh="t_23c5aecb43444eb9bb79889cce5734e3"><span lg_kh="1">(</span>${t_23c5aecb43444eb9bb79889cce5734e3}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Further+Examples"></a>
    <h2 class="boxed"><span lg_en="t_41caa8ec6b6d4416ab553da758567145">Further Examples</span><span class="tscolor" lg_zh="t_41caa8ec6b6d4416ab553da758567145"><span lg_kh="1">(</span>${t_41caa8ec6b6d4416ab553da758567145}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_927048263e624d31994ba86e5ded824b">For now, there are a limited number of XWPF examples in the <a href="http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/examples/xwpf">Examples Package</a>. Beyond those, the best source of additional examples is in the unit tests. <a href="http://svn.apache.org/viewvc/poi/trunk/src/ooxml/testcases/org/apache/poi/xwpf/"> Browse the XWPF unit tests.</a></span><span class="tscolor" lg_zh="t_927048263e624d31994ba86e5ded824b"><span lg_kh="1">(</span>${t_927048263e624d31994ba86e5ded824b}<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_843805ca581d47aca99cadca46ac1c23"><font size="-2">by&nbsp;Nick Burch</font></span><span class="tscolor" lg_zh="t_843805ca581d47aca99cadca46ac1c23"><span lg_kh="1">(</span>${t_843805ca581d47aca99cadca46ac1c23}<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/document/quick-guide-xwpf.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>