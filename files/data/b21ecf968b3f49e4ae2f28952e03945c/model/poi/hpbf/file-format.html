<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-HPBF - A Guide to the Publisher File Format</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_4e1b6524eb6b4f1686a7f2605c446546">POI-HPBF - A Guide to the Publisher File Format</span><span class="tscolor" lg_zh="t_4e1b6524eb6b4f1686a7f2605c446546"><span lg_kh="1">(</span>${t_4e1b6524eb6b4f1686a7f2605c446546}<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_62ea53a5e479402d90897a1b87a0e2c2">Overview</span><span class="tscolor" lg_zh="t_62ea53a5e479402d90897a1b87a0e2c2"><span lg_kh="1">(</span>${t_62ea53a5e479402d90897a1b87a0e2c2}<span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Document+Streams"></a>
    <h2 class="boxed"><span lg_en="t_fe6fc859cbb14106808480b7d2231aae">Document Streams</span><span class="tscolor" lg_zh="t_fe6fc859cbb14106808480b7d2231aae"><span lg_kh="1">(</span>${t_fe6fc859cbb14106808480b7d2231aae}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_7b031e88e0de4f308670a16d4bd12f30">The file is made up of a number of POIFS streams. A typical file will be made up as follows:</span><span class="tscolor" lg_zh="t_7b031e88e0de4f308670a16d4bd12f30"><span lg_kh="1">(</span>${t_7b031e88e0de4f308670a16d4bd12f30}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">Root Entry -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Objects -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (no children)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> SummaryInformation &lt;(0x05)SummaryInformation&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> DocumentSummaryInformation &lt;(0x05)DocumentSummaryInformation&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Escher -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> EscherStm</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> EscherDelayStm</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Quill -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> QuillSub -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CONTENTS</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CompObj &lt;(0x01)CompObj&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Envelope</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Contents</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Internal &lt;(0x03)Internal&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> CompObj &lt;(0x01)CompObj&gt;</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> VBA -</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (no children)</span>
      </div>
     </div>
    </div>
    <a name="Changing+Text"></a>
    <h2 class="boxed"><span lg_en="t_db5926b3a1784801a65607308ab2f96f">Changing Text</span><span class="tscolor" lg_zh="t_db5926b3a1784801a65607308ab2f96f"><span lg_kh="1">(</span>${t_db5926b3a1784801a65607308ab2f96f}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_95b53a0710744b5685a32884d1d7c26c">If you make a change to the text of a file, but not change how much text there is, then the <em>CONTENTS</em> stream will undergo a small change, and the <em>Contents</em> stream will undergo a large change.</span><span class="tscolor" lg_zh="t_95b53a0710744b5685a32884d1d7c26c"><span lg_kh="1">(</span>${t_95b53a0710744b5685a32884d1d7c26c}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_a90d581209dd4d5a8422aed22ed9314c">If you make a change to the text of a file, and change the amount of text there is, then both the <em>Contents</em> and the <em>CONTENTS</em> streams change.</span><span class="tscolor" lg_zh="t_a90d581209dd4d5a8422aed22ed9314c"><span lg_kh="1">(</span>${t_a90d581209dd4d5a8422aed22ed9314c}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Changing+Shapes"></a>
    <h2 class="boxed"><span lg_en="t_9fee616940d74021bd6ed0dfb9ae15fb">Changing Shapes</span><span class="tscolor" lg_zh="t_9fee616940d74021bd6ed0dfb9ae15fb"><span lg_kh="1">(</span>${t_9fee616940d74021bd6ed0dfb9ae15fb}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_2d4046a541eb4a62b12a29e8db710dcf">If you alter the size of a textbox, but make no text changes, then both <em>Contents</em> and <em>CONTENTS</em> streams change. There are no changes to the Escher streams.</span><span class="tscolor" lg_zh="t_2d4046a541eb4a62b12a29e8db710dcf"><span lg_kh="1">(</span>${t_2d4046a541eb4a62b12a29e8db710dcf}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_ead74f4ba1434b77b5ce8ce98961ca4f">If you set the background colour of a textbox, but make no changes to the text, (to finish off)</span><span class="tscolor" lg_zh="t_ead74f4ba1434b77b5ce8ce98961ca4f"><span lg_kh="1">(</span>${t_ead74f4ba1434b77b5ce8ce98961ca4f}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Structure+of+CONTENTS"></a>
    <h2 class="boxed"><span lg_en="t_55d5771ab2514b4ca6aa862af816a440">Structure of CONTENTS</span><span class="tscolor" lg_zh="t_55d5771ab2514b4ca6aa862af816a440"><span lg_kh="1">(</span>${t_55d5771ab2514b4ca6aa862af816a440}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_b0f8cfaebc9342afacc9e52fb5a66237">First we have "CHNKINK ", followed by 24 bytes.</span><span class="tscolor" lg_zh="t_b0f8cfaebc9342afacc9e52fb5a66237"><span lg_kh="1">(</span>${t_b0f8cfaebc9342afacc9e52fb5a66237}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_31273ab4e6684b2887905ddc78155dbf">Next we have 20 sequences of 24 bytes each. If the first two bytes at 0x1800, then that sequence entry exists, but if it's 0x0000 then the entry doesn't exist. If it does exist, we then have 4 bytes of upper case ASCII text, followed by three little endian shorts. The first of these seems to be the count of that type, the second is usually 1, the third is usually zero. The we have another 4 bytes of upper case ASCII text, normally but not always the same as the first text. Finally, we have an unsigned little endian 32 bit offset to the start of the data for this, then an unsigned little endian 32 bit offset of the length of this section.</span><span class="tscolor" lg_zh="t_31273ab4e6684b2887905ddc78155dbf"><span lg_kh="1">(</span>${t_31273ab4e6684b2887905ddc78155dbf}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_87d9d05e38a44eba967d13b448a55a73">Normally, the first sequence entry is for TEXT, and the text data will start at 0x200. After that is normally two or three STSH entries (so the first short has values 0, then 1, then 2). After that it seems to vary.</span><span class="tscolor" lg_zh="t_87d9d05e38a44eba967d13b448a55a73"><span lg_kh="1">(</span>${t_87d9d05e38a44eba967d13b448a55a73}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d16c603d0fcc41a1af56ea359b188648">At 0x200 we have the text, stored as little endian 16 bit unicode.</span><span class="tscolor" lg_zh="t_d16c603d0fcc41a1af56ea359b188648"><span lg_kh="1">(</span>${t_d16c603d0fcc41a1af56ea359b188648}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_86c7709af59b49638a93cdb7fd5e9c34">After the text comes all sorts of other stuff, presumably as described by the sequences.</span><span class="tscolor" lg_zh="t_86c7709af59b49638a93cdb7fd5e9c34"><span lg_kh="1">(</span>${t_86c7709af59b49638a93cdb7fd5e9c34}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_11f13e893aed4cf3a3fc765b5626aea9">For a contents stream of length 7168 / 0x1c00 bytes, the start looks something like:</span><span class="tscolor" lg_zh="t_11f13e893aed4cf3a3fc765b5626aea9"><span lg_kh="1">(</span>${t_11f13e893aed4cf3a3fc765b5626aea9}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">CHNKINK //<span><span lg_en="t_907a4f00372343288dd9feceb3469d24">"CHNKINK "</span><span class="tscolor" lg_zh="t_907a4f00372343288dd9feceb3469d24"><span lg_kh="1">(</span>${t_907a4f00372343288dd9feceb3469d24}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">04 00 07 00 //<span><span lg_en="t_d712546108a84f3e954210b58dc7573c">Normally 04 00 07 00</span><span class="tscolor" lg_zh="t_d712546108a84f3e954210b58dc7573c"><span lg_kh="1">(</span>${t_d712546108a84f3e954210b58dc7573c}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">13 00 00 03 //<span><span lg_en="t_e49c1ae5349548f9bd1e2c34d3ed1002">Normally ## 00 00 03</span><span class="tscolor" lg_zh="t_e49c1ae5349548f9bd1e2c34d3ed1002"><span lg_kh="1">(</span>${t_e49c1ae5349548f9bd1e2c34d3ed1002}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 02 00 00 //<span><span lg_en="t_0656460070ef43daa06f4afc6ee4b38f">Normally 00 ## 00 00</span><span class="tscolor" lg_zh="t_0656460070ef43daa06f4afc6ee4b38f"><span lg_kh="1">(</span>${t_0656460070ef43daa06f4afc6ee4b38f}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 1c 00 00 //<span><span lg_en="t_dc1dbd61544a4f7299c57c439bf6090a">Normally length of the stream</span><span class="tscolor" lg_zh="t_dc1dbd61544a4f7299c57c439bf6090a"><span lg_kh="1">(</span>${t_dc1dbd61544a4f7299c57c439bf6090a}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">f8 01 13 00 //<span><span lg_en="t_61385a5956514514a7c79463e5783fe0">Normally f8 01 11/13 00</span><span class="tscolor" lg_zh="t_61385a5956514514a7c79463e5783fe0"><span lg_kh="1">(</span>${t_61385a5956514514a7c79463e5783fe0}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">ff ff ff ff //<span><span lg_en="t_ab6929d4cb1d4df9837986a43204e368">Normally seems to be ffffffff</span><span class="tscolor" lg_zh="t_ab6929d4cb1d4df9837986a43204e368"><span lg_kh="1">(</span>${t_ab6929d4cb1d4df9837986a43204e368}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TEXT 00 00 01 00 00 00 //<span><span lg_en="t_61f6f447f15f48a6a6e2ad25496d895b">TEXT 0 1 0</span><span class="tscolor" lg_zh="t_61f6f447f15f48a6a6e2ad25496d895b"><span lg_kh="1">(</span>${t_61f6f447f15f48a6a6e2ad25496d895b}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TEXT 00 02 00 00 d0 03 00 00 //<span><span lg_en="t_f48f22c650c94d8092c2059a31dafac2">TEXT from: 200 (512), len: 3d0 (976)</span><span class="tscolor" lg_zh="t_f48f22c650c94d8092c2059a31dafac2"><span lg_kh="1">(</span>${t_f48f22c650c94d8092c2059a31dafac2}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH 00 00 01 00 00 00 //<span><span lg_en="t_150238ad536540d0bd13fb8c1a63c495">STSH 0 1 0</span><span class="tscolor" lg_zh="t_150238ad536540d0bd13fb8c1a63c495"><span lg_kh="1">(</span>${t_150238ad536540d0bd13fb8c1a63c495}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH d0 05 00 00 1e 00 00 00 //<span><span lg_en="t_3fa30600a0194028a3d545f75f134971">STSH from: 5d0 (1488), len: 1e (30)</span><span class="tscolor" lg_zh="t_3fa30600a0194028a3d545f75f134971"><span lg_kh="1">(</span>${t_3fa30600a0194028a3d545f75f134971}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH 01 00 01 00 00 00 //<span><span lg_en="t_3eba98d784cf47d1b1ad68abe15ab6eb">STSH 1 1 0</span><span class="tscolor" lg_zh="t_3eba98d784cf47d1b1ad68abe15ab6eb"><span lg_kh="1">(</span>${t_3eba98d784cf47d1b1ad68abe15ab6eb}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH ee 05 00 00 b8 01 00 00 //<span><span lg_en="t_1a3d98777bd2464a9e4bf7f44562589d">STSH from: 5ee (1518), len: 1b8 (440)</span><span class="tscolor" lg_zh="t_1a3d98777bd2464a9e4bf7f44562589d"><span lg_kh="1">(</span>${t_1a3d98777bd2464a9e4bf7f44562589d}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH 02 00 01 00 00 00 //<span><span lg_en="t_90140f6e286347eea9015825a9c600e4">STSH 2 1 0</span><span class="tscolor" lg_zh="t_90140f6e286347eea9015825a9c600e4"><span lg_kh="1">(</span>${t_90140f6e286347eea9015825a9c600e4}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STSH a6 07 00 00 3c 00 00 00 //<span><span lg_en="t_5f5b3a3b9b0b4cedbe98f2cd222a738c">STSH from: 7a6 (1958), len: 3c (60)</span><span class="tscolor" lg_zh="t_5f5b3a3b9b0b4cedbe98f2cd222a738c"><span lg_kh="1">(</span>${t_5f5b3a3b9b0b4cedbe98f2cd222a738c}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPP 00 00 01 00 00 00 //<span><span lg_en="t_11627ed4c4d84589b60854caf58436b3">FDPP 0 1 0</span><span class="tscolor" lg_zh="t_11627ed4c4d84589b60854caf58436b3"><span lg_kh="1">(</span>${t_11627ed4c4d84589b60854caf58436b3}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPP 00 08 00 00 00 02 00 00 //<span><span lg_en="t_271b64fe9e6f45bab0d6a4b8674ab24e">FDPP from: 800 (2048), len: 200 (512)</span><span class="tscolor" lg_zh="t_271b64fe9e6f45bab0d6a4b8674ab24e"><span lg_kh="1">(</span>${t_271b64fe9e6f45bab0d6a4b8674ab24e}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPC 00 00 01 00 00 00 //<span><span lg_en="t_9006788c48784efa98f51b6b1fa22520">FDPC 0 1 0</span><span class="tscolor" lg_zh="t_9006788c48784efa98f51b6b1fa22520"><span lg_kh="1">(</span>${t_9006788c48784efa98f51b6b1fa22520}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPC 00 0a 00 00 00 02 00 00 //<span><span lg_en="t_128762db770946caa4dc6bd2ca535253">FDPC from: a00 (2560), len: 200 (512)</span><span class="tscolor" lg_zh="t_128762db770946caa4dc6bd2ca535253"><span lg_kh="1">(</span>${t_128762db770946caa4dc6bd2ca535253}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPC 01 00 01 00 00 00 //<span><span lg_en="t_e11bcf4f49b24e6f8591689eeb57ffbd">FDPC 1 1 0</span><span class="tscolor" lg_zh="t_e11bcf4f49b24e6f8591689eeb57ffbd"><span lg_kh="1">(</span>${t_e11bcf4f49b24e6f8591689eeb57ffbd}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FDPC 00 0c 00 00 00 02 00 00 //<span><span lg_en="t_7bf209d8eb83469caa4a43cf83132417">FDPC from: c00 (3072), len: 200 (512)</span><span class="tscolor" lg_zh="t_7bf209d8eb83469caa4a43cf83132417"><span lg_kh="1">(</span>${t_7bf209d8eb83469caa4a43cf83132417}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SYID 00 00 01 00 00 00 //<span><span lg_en="t_5f54445d31194c7c92e2e844dd405e5e">SYID 0 1 0</span><span class="tscolor" lg_zh="t_5f54445d31194c7c92e2e844dd405e5e"><span lg_kh="1">(</span>${t_5f54445d31194c7c92e2e844dd405e5e}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SYID 00 0e 00 00 20 00 00 00 //<span><span lg_en="t_726b9e4261b54b4ba30b7a04fa54129a">SYID from: e00 (3584), len: 20 (32)</span><span class="tscolor" lg_zh="t_726b9e4261b54b4ba30b7a04fa54129a"><span lg_kh="1">(</span>${t_726b9e4261b54b4ba30b7a04fa54129a}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SGP 00 00 01 00 00 00 //<span><span lg_en="t_8b50e6a6a4d6487a9db7c234085a3e6c">SGP 0 1 0</span><span class="tscolor" lg_zh="t_8b50e6a6a4d6487a9db7c234085a3e6c"><span lg_kh="1">(</span>${t_8b50e6a6a4d6487a9db7c234085a3e6c}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">SGP 20 0e 00 00 0a 00 00 00 //<span><span lg_en="t_f51047957c77402e9658338313d633b4">SGP from: e20 (3616), len: a (10)</span><span class="tscolor" lg_zh="t_f51047957c77402e9658338313d633b4"><span lg_kh="1">(</span>${t_f51047957c77402e9658338313d633b4}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INK 00 00 01 00 00 00 //<span><span lg_en="t_c2b225030dc74c0ea28df3336b28a480">INK 0 1 0</span><span class="tscolor" lg_zh="t_c2b225030dc74c0ea28df3336b28a480"><span lg_kh="1">(</span>${t_c2b225030dc74c0ea28df3336b28a480}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">INK 2a 0e 00 00 04 00 00 00 //<span><span lg_en="t_ada0d086068845409b6c2a1b9680605f">INK from: e2a (3626), len: 4 (4)</span><span class="tscolor" lg_zh="t_ada0d086068845409b6c2a1b9680605f"><span lg_kh="1">(</span>${t_ada0d086068845409b6c2a1b9680605f}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BTEP 00 00 01 00 00 00 //<span><span lg_en="t_16e9b54e0a1148afa95135a75b233cf0">BTEP 0 1 0</span><span class="tscolor" lg_zh="t_16e9b54e0a1148afa95135a75b233cf0"><span lg_kh="1">(</span>${t_16e9b54e0a1148afa95135a75b233cf0}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC 2e 0e 00 00 18 00 00 00 //<span><span lg_en="t_05221be9c95a408cb8da52d499a231a5">PLC from: e2e (3630), len: 18 (24)</span><span class="tscolor" lg_zh="t_05221be9c95a408cb8da52d499a231a5"><span lg_kh="1">(</span>${t_05221be9c95a408cb8da52d499a231a5}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BTEC 00 00 01 00 00 00 //<span><span lg_en="t_29c4831304e2466fafdffee687555d66">BTEC 0 1 0</span><span class="tscolor" lg_zh="t_29c4831304e2466fafdffee687555d66"><span lg_kh="1">(</span>${t_29c4831304e2466fafdffee687555d66}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC 46 0e 00 00 20 00 00 00 //<span><span lg_en="t_858ba0db96034f60a9ba498d3a6e467b">PLC from: e46 (3654), len: 20 (32)</span><span class="tscolor" lg_zh="t_858ba0db96034f60a9ba498d3a6e467b"><span lg_kh="1">(</span>${t_858ba0db96034f60a9ba498d3a6e467b}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FONT 00 00 01 00 00 00 //<span><span lg_en="t_95b8cccb9e4b4f4e9f8f7e91cd759769">FONT 0 1 0</span><span class="tscolor" lg_zh="t_95b8cccb9e4b4f4e9f8f7e91cd759769"><span lg_kh="1">(</span>${t_95b8cccb9e4b4f4e9f8f7e91cd759769}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FONT 66 0e 00 00 48 03 00 00 //<span><span lg_en="t_7ce3aa25fee243b2ab2c9d8f916811df">FONT from: e66 (3686), len: 348 (840)</span><span class="tscolor" lg_zh="t_7ce3aa25fee243b2ab2c9d8f916811df"><span lg_kh="1">(</span>${t_7ce3aa25fee243b2ab2c9d8f916811df}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TCD 03 00 01 00 00 00 //<span><span lg_en="t_0d022d43e6c548e6be0fbcea372e434f">TCD 3 1 0</span><span class="tscolor" lg_zh="t_0d022d43e6c548e6be0fbcea372e434f"><span lg_kh="1">(</span>${t_0d022d43e6c548e6be0fbcea372e434f}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC ae 11 00 00 24 00 00 00 //<span><span lg_en="t_6bc66be93efd4fad82ca1aeaefd94061">PLC from: 11ae (4526), len: 24 (36)</span><span class="tscolor" lg_zh="t_6bc66be93efd4fad82ca1aeaefd94061"><span lg_kh="1">(</span>${t_6bc66be93efd4fad82ca1aeaefd94061}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TOKN 04 00 01 00 00 00 //<span><span lg_en="t_95047e972d4445e6a128dd661725fec5">TOKN 4 1 0</span><span class="tscolor" lg_zh="t_95047e972d4445e6a128dd661725fec5"><span lg_kh="1">(</span>${t_95047e972d4445e6a128dd661725fec5}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC d2 11 00 00 0a 01 00 00 //<span><span lg_en="t_22bba1617a7a40dcb6d20f7ec251c1a5">PLC from: 11d2 (4562), len: 10a (266)</span><span class="tscolor" lg_zh="t_22bba1617a7a40dcb6d20f7ec251c1a5"><span lg_kh="1">(</span>${t_22bba1617a7a40dcb6d20f7ec251c1a5}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">TOKN 05 00 01 00 00 00 //<span><span lg_en="t_4afb064cfc0a42a6af25dcb3985def77">TOKN 5 1 0</span><span class="tscolor" lg_zh="t_4afb064cfc0a42a6af25dcb3985def77"><span lg_kh="1">(</span>${t_4afb064cfc0a42a6af25dcb3985def77}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC dc 12 00 00 2a 01 00 00 //<span><span lg_en="t_60c5982669b14b04b38f2c6c24539546">PLC from: 12dc (4828), len: 12a (298)</span><span class="tscolor" lg_zh="t_60c5982669b14b04b38f2c6c24539546"><span lg_kh="1">(</span>${t_60c5982669b14b04b38f2c6c24539546}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">STRS 00 00 01 00 00 00 //<span><span lg_en="t_011396e0620e4f328af3a50fe0bbab62">STRS 0 1 0</span><span class="tscolor" lg_zh="t_011396e0620e4f328af3a50fe0bbab62"><span lg_kh="1">(</span>${t_011396e0620e4f328af3a50fe0bbab62}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PLC 06 14 00 00 46 00 00 00 //<span><span lg_en="t_75b5695116be44a091d77826bf485767">PLC from: 1406 (5126), len: 46 (70)</span><span class="tscolor" lg_zh="t_75b5695116be44a091d77826bf485767"><span lg_kh="1">(</span>${t_75b5695116be44a091d77826bf485767}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MCLD 00 00 01 00 00 00 //<span><span lg_en="t_a85d47b40a164378b24c2191978b40a6">MCLD 0 1 0</span><span class="tscolor" lg_zh="t_a85d47b40a164378b24c2191978b40a6"><span lg_kh="1">(</span>${t_a85d47b40a164378b24c2191978b40a6}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">MCLD 4c 14 00 00 16 06 00 00 //<span><span lg_en="t_0009a9f40dcf48a7821c6de3bb2b6b49">MCLD from: 144c (5196), len: 616 (1558)</span><span class="tscolor" lg_zh="t_0009a9f40dcf48a7821c6de3bb2b6b49"><span lg_kh="1">(</span>${t_0009a9f40dcf48a7821c6de3bb2b6b49}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">18 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PL 00 00 01 00 00 00 //<span><span lg_en="t_790c23f8c22541189a2d88e3eccb5211">PL 0 1 0</span><span class="tscolor" lg_zh="t_790c23f8c22541189a2d88e3eccb5211"><span lg_kh="1">(</span>${t_790c23f8c22541189a2d88e3eccb5211}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">PL 62 1a 00 00 48 00 00 00 //<span><span lg_en="t_1b710d0ea50c4d7fb86a853963c1861b">PL from: 1a62 (6754), len: 48 (72)</span><span class="tscolor" lg_zh="t_1b710d0ea50c4d7fb86a853963c1861b"><span lg_kh="1">(</span>${t_1b710d0ea50c4d7fb86a853963c1861b}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 00 //<span><span lg_en="t_de0a94cef14d40eeb51b90a6f6c4a333">Blank entry follows</span><span class="tscolor" lg_zh="t_de0a94cef14d40eeb51b90a6f6c4a333"><span lg_kh="1">(</span>${t_de0a94cef14d40eeb51b90a6f6c4a333}<span lg_kh="1">)</span></span></span></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 00 00 00 00 00</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 00 00 00 00 00 00 00 </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">00 00 00 00 00 00 00 00</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">(the text will then start)</span>
      </div>
     </div>
     <p><span lg_en="t_ed387f0f3f384a0493f7405509a5e162">We think that the first 4 bytes of text describes the the function of the data at the offset. The first short is then the count of that type, eg the 2nd will have 1. We think that the second 4 bytes of text describes the format of data block at the offset. The format of the text block is easy, but we're still trying to figure out the others.</span><span class="tscolor" lg_zh="t_ed387f0f3f384a0493f7405509a5e162"><span lg_kh="1">(</span>${t_ed387f0f3f384a0493f7405509a5e162}<span lg_kh="1">)</span></span></p>
     <a name="Structure+of+TEXT+bit"></a>
     <h3 class="boxed"><span lg_en="t_e2274b16d4d24e41a8a789302acc047f">Structure of TEXT bit</span><span class="tscolor" lg_zh="t_e2274b16d4d24e41a8a789302acc047f"><span lg_kh="1">(</span>${t_e2274b16d4d24e41a8a789302acc047f}<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_cb89e3f41cfd43e99ae379fd8693edbe">This is very simple. All the text for the document is stored in a single bit of the Quill CONTENTS. The text is stored as little endian 16 bit unicode strings.</span><span class="tscolor" lg_zh="t_cb89e3f41cfd43e99ae379fd8693edbe"><span lg_kh="1">(</span>${t_cb89e3f41cfd43e99ae379fd8693edbe}<span lg_kh="1">)</span></span></p>
     <a name="Structure+of+PLC+bit"></a>
     <h3 class="boxed"><span lg_en="t_992b76942f394d3c8b55765ff7e86e22">Structure of PLC bit</span><span class="tscolor" lg_zh="t_992b76942f394d3c8b55765ff7e86e22"><span lg_kh="1">(</span>${t_992b76942f394d3c8b55765ff7e86e22}<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_25cbc60d9e514da88a56e9a2127fb7da">The first four bytes seem to hold the count of the entries in the bit, and the second four bytes seem to hold the type. There is then some pre-data, and then data for each of the entries, the exact format dependant on the type.</span><span class="tscolor" lg_zh="t_25cbc60d9e514da88a56e9a2127fb7da"><span lg_kh="1">(</span>${t_25cbc60d9e514da88a56e9a2127fb7da}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_58f9b4b6f050451785c6e45a78236439">Type 0 has 4 2 byte unsigned ints, then a pair of 2 byte unsigned ints for each entry.</span><span class="tscolor" lg_zh="t_58f9b4b6f050451785c6e45a78236439"><span lg_kh="1">(</span>${t_58f9b4b6f050451785c6e45a78236439}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7c88da031c1d4f52840164ca1705f47b">Type 4 has 4 2 byte unsigned ints, then a pair of 4 byte unsigned ints for each entry.</span><span class="tscolor" lg_zh="t_7c88da031c1d4f52840164ca1705f47b"><span lg_kh="1">(</span>${t_7c88da031c1d4f52840164ca1705f47b}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_754274fe9604449faeccdb031abc1438">Type 8 has 7 2 byte unsigned ints, then a pair of 4 byte unsigned ints for each entry.</span><span class="tscolor" lg_zh="t_754274fe9604449faeccdb031abc1438"><span lg_kh="1">(</span>${t_754274fe9604449faeccdb031abc1438}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_199e0923accb4103a0474cf8a1547ad4">Type 12 holds hyperlinks, and is very much more complex. See <a href="https://svn.apache.org/viewvc/poi/trunk/src/scratchpad/src/org/apache/poi/hpbf/model/qcbits/QCPLCBit.java?view=markup"><span class="codefrag">org.apache.poi.hpbf.model.qcbits.QCPLCBit</span></a> for our best guess as to how the contents match up.</span><span class="tscolor" lg_zh="t_199e0923accb4103a0474cf8a1547ad4"><span lg_kh="1">(</span>${t_199e0923accb4103a0474cf8a1547ad4}<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_3fa423290a6245e9aaa1150c697b2191"><font size="-2">by&nbsp;Nick Burch</font></span><span class="tscolor" lg_zh="t_3fa423290a6245e9aaa1150c697b2191"><span lg_kh="1">(</span>${t_3fa423290a6245e9aaa1150c697b2191}<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/hpbf/file-format.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>