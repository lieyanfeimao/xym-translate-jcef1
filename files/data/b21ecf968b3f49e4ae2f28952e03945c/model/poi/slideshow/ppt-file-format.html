<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI-HSLF - A Guide to the PowerPoint File Format</title>
  <link type="text/css" href="../../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../../skin/profile.css" rel="stylesheet">
  <script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../../js/jquery.min.js"></script>
  <link href="../../css/xst-ts.css" rel="stylesheet">
  <script src="../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_aae7b2e77a8b4f01a8798a743b3053ff">POI-HSLF - A Guide to the PowerPoint File Format</span><span class="tscolor" lg_zh="t_aae7b2e77a8b4f01a8798a743b3053ff"><span lg_kh="1">(</span>${t_aae7b2e77a8b4f01a8798a743b3053ff}<span lg_kh="1">)</span></span></h1>
    <h3><span lg_en="t_da968fa9cbba453f9e7129d5fe2bde90">Overview</span><span class="tscolor" lg_zh="t_da968fa9cbba453f9e7129d5fe2bde90"><span lg_kh="1">(</span>${t_da968fa9cbba453f9e7129d5fe2bde90}<span lg_kh="1">)</span></span></h3>
    <div id="front-matter"></div>
    <a name="Records%2C+Containers+and+Atoms"></a>
    <h2 class="boxed"><span lg_en="t_8a8bf76e1d40404799484c20e75f712e">Records, Containers and Atoms</span><span class="tscolor" lg_zh="t_8a8bf76e1d40404799484c20e75f712e"><span lg_kh="1">(</span>${t_8a8bf76e1d40404799484c20e75f712e}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_d8262f78a2a5445396de900ce0c1fe7a">PowerPoint documents are made up of a tree of records. A record may contain either other records (in which case it is a Container), or data (in which case it's an Atom). A record can't hold both.</span><span class="tscolor" lg_zh="t_d8262f78a2a5445396de900ce0c1fe7a"><span lg_kh="1">(</span>${t_d8262f78a2a5445396de900ce0c1fe7a}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_9ee4549f603844278cc1c112e6d64519">PowerPoint documents don't have one overall container record. Instead, there are a number of different container records to be found at the top level.</span><span class="tscolor" lg_zh="t_9ee4549f603844278cc1c112e6d64519"><span lg_kh="1">(</span>${t_9ee4549f603844278cc1c112e6d64519}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d3d5da123649475a8ddc5d276d14863f">Any numbers or strings stored in the records are always stored in Little Endian format (least important bytes first). This is the case no matter what platform the file was written on - be that a Little Endian or a Big Endian system.</span><span class="tscolor" lg_zh="t_d3d5da123649475a8ddc5d276d14863f"><span lg_kh="1">(</span>${t_d3d5da123649475a8ddc5d276d14863f}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_2b91662921ae4a2c8027c689146a22b4">PowerPoint may have Escher (DDF) records embedded in it. These are always held as the children of a PPDrawing record (record type 1036). Escher records have the same format as PowerPoint records.</span><span class="tscolor" lg_zh="t_2b91662921ae4a2c8027c689146a22b4"><span lg_kh="1">(</span>${t_2b91662921ae4a2c8027c689146a22b4}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Record+Headers"></a>
    <h2 class="boxed"><span lg_en="t_5e3bc366c9e746f594c3015370cccd5b">Record Headers</span><span class="tscolor" lg_zh="t_5e3bc366c9e746f594c3015370cccd5b"><span lg_kh="1">(</span>${t_5e3bc366c9e746f594c3015370cccd5b}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_8585355f169a413189502e7f7bee1d4e">All records, be they containers or atoms, have the same standard 8 byte header. It is:</span><span class="tscolor" lg_zh="t_8585355f169a413189502e7f7bee1d4e"><span lg_kh="1">(</span>${t_8585355f169a413189502e7f7bee1d4e}<span lg_kh="1">)</span></span></p>
     <ul>
      <li><span lg_en="t_ea56d4b4b4c64f61b424be41b8b758e9">1/2 byte container flag</span><span class="tscolor" lg_zh="t_ea56d4b4b4c64f61b424be41b8b758e9"><span lg_kh="1">(</span>${t_ea56d4b4b4c64f61b424be41b8b758e9}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_8d0a910f88894ffd93ac73dda7074a26">1.5 byte option field</span><span class="tscolor" lg_zh="t_8d0a910f88894ffd93ac73dda7074a26"><span lg_kh="1">(</span>${t_8d0a910f88894ffd93ac73dda7074a26}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1f0496b9efc84a959bd5980ab7c83651">2 byte record type</span><span class="tscolor" lg_zh="t_1f0496b9efc84a959bd5980ab7c83651"><span lg_kh="1">(</span>${t_1f0496b9efc84a959bd5980ab7c83651}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_87b2fd8656c14223beb95cf7421117c7">4 byte record length</span><span class="tscolor" lg_zh="t_87b2fd8656c14223beb95cf7421117c7"><span lg_kh="1">(</span>${t_87b2fd8656c14223beb95cf7421117c7}<span lg_kh="1">)</span></span></li>
     </ul>
     <p><span lg_en="t_9cf988b2dfa348bca8cf49cbde33b357">If the first byte of the header, BINARY_AND with 0x0f, is 0x0f, then the record is a container. Otherwise, it's an atom. The rest of the first two bytes are used to store the "options" for the record. Most commonly, this is used to indicate the version of the record, but the exact usage is record specific.</span><span class="tscolor" lg_zh="t_9cf988b2dfa348bca8cf49cbde33b357"><span lg_kh="1">(</span>${t_9cf988b2dfa348bca8cf49cbde33b357}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5cdbd529ed6944eeac07d0f35de921d1">The record type is a little endian number, which tells you what kind of record you're dealing with. Each different kind of record has it's own value that gets stored here. PowerPoint records have a type that's normally less than 6000 (decimal). Escher records normally have a type between 0xF000 and 0xF1FF.</span><span class="tscolor" lg_zh="t_5cdbd529ed6944eeac07d0f35de921d1"><span lg_kh="1">(</span>${t_5cdbd529ed6944eeac07d0f35de921d1}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7e3adfa5464747c786a158048d029251">The record length is another little endian number. For an atom, it's the size of the data part of the record, i.e. the length of the record <em>less</em> its 8 byte record header. For a container, it's the size of all the records that are children of this record. That means that the size of a container record is the length, plus 8 bytes for its record header.</span><span class="tscolor" lg_zh="t_7e3adfa5464747c786a158048d029251"><span lg_kh="1">(</span>${t_7e3adfa5464747c786a158048d029251}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="CurrentUserAtom%2C+UserEditAtom+and+PersistPtrIncrementalBlock"></a>
    <h2 class="boxed"><span lg_en="t_83799f0541e04355a0de3ddf16502162">CurrentUserAtom, UserEditAtom and PersistPtrIncrementalBlock</span><span class="tscolor" lg_zh="t_83799f0541e04355a0de3ddf16502162"><span lg_kh="1">(</span>${t_83799f0541e04355a0de3ddf16502162}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_52d39d4783ec448fbf344f163beb867a"><strong>aka Records that care about the byte level position of other records</strong></span><span class="tscolor" lg_zh="t_52d39d4783ec448fbf344f163beb867a"><span lg_kh="1">(</span>${t_52d39d4783ec448fbf344f163beb867a}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d36ae42190cc412182726959876d8246">A small number of records contain byte level position offsets to other records. If you change the position of any records in the file, then there's a good chance that you will need to update some of these special records.</span><span class="tscolor" lg_zh="t_d36ae42190cc412182726959876d8246"><span lg_kh="1">(</span>${t_d36ae42190cc412182726959876d8246}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_323ff4c913af4deab0e1a11bb7585b16">First up, CurrentUserAtom. This is actually stored in a different OLE2 (POIFS) stream to the main PowerPoint document. It contains a few bits of information on who lasted edited the file. Most importantly, at byte 8 of its contents, it stores (as a 32 bit little endian number) the offset in the main stream to the most recent UserEditAtom.</span><span class="tscolor" lg_zh="t_323ff4c913af4deab0e1a11bb7585b16"><span lg_kh="1">(</span>${t_323ff4c913af4deab0e1a11bb7585b16}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_26fb0d551ec847daa7e30b4b280caf27">The UserEditAtom contains two byte level offsets (again as 32 bit little endian numbers). At byte 12 is the offset to the PersistPtrIncrementalBlock associated with this UserEditAtom (each UserEditAtom has one and only one PersistPtrIncrementalBlock). At byte 8, there's the offset to the previous UserEditAtom. If this is 0, then you're at the first one.</span><span class="tscolor" lg_zh="t_26fb0d551ec847daa7e30b4b280caf27"><span lg_kh="1">(</span>${t_26fb0d551ec847daa7e30b4b280caf27}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d07219e4fab948fcbe90ca0cd97f6824">Every time you do a non full save in PowerPoint, it tacks on another UserEditAtom and another PersistPtrIncrementalBlock. The CurrentUserAtom is updated to point to this new UserEditAtom, and the new UserEditAtom points back to the previous UserEditAtom. You then end up with a chain, starting from the CurrentUserAtom, linking back through all the UserEditAtoms, until you reach the first one from a full save.</span><span class="tscolor" lg_zh="t_d07219e4fab948fcbe90ca0cd97f6824"><span lg_kh="1">(</span>${t_d07219e4fab948fcbe90ca0cd97f6824}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/-------------------------------\</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| CurrentUserAtom (own stream) |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| OffsetToCurrentEdit = 10562 |==\</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">\-------------------------------/ |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">/==================================/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| /-----------------------------------\</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | PersistPtrIncrementalBlock @ 6144 |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| \-----------------------------------/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| /---------------------------------\ |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | UserEditAtom @ 6176 | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | LastUserEditAtomOffset = 0 | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | PersistPointersOffset = 6144 |==================/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| \---------------------------------/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | /-----------------------------------\</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| \====================\ | PersistPtrIncrementalBlock @ 8646 |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | \-----------------------------------/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| /---------------------------------\ | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | UserEditAtom @ 8674 | | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | LastUserEditAtomOffset = 6176 |=/ |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | PersistPointersOffset = 8646 |==================/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| \---------------------------------/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | /------------------------------------\</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| \====================\ | PersistPtrIncrementalBlock @ 10538 |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| | \------------------------------------/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">| /---------------------------------\ | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">\==| UserEditAtom @ 10562 | | |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> | LastUserEditAtomOffset = 8674 |=/ |</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> | PersistPointersOffset = 10538 |==================/</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> \---------------------------------/</span>
      </div>
     </div>
     <p><span lg_en="t_d35a30bb592946beaf4758de19621c42">The PersistPtrIncrementalBlock contains byte offsets to all the Slides, Notes, Documents and MasterSlides in the file. The first PersistPtrIncrementalBlock will point to all the ones that were present the first time the file was saved. Subsequent PersistPtrIncrementalBlocks will contain pointers to all the ones that were changed in that edit. To find the offset to a given sheet in the latest version, then start with the most recent PersistPtrIncrementalBlock. If this knows about the sheet, use the offset it has. If it doesn't, then work back through older PersistPtrIncrementalBlocks until you find one which does, and use that.</span><span class="tscolor" lg_zh="t_d35a30bb592946beaf4758de19621c42"><span lg_kh="1">(</span>${t_d35a30bb592946beaf4758de19621c42}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d4e219e26aa247abb310659a8ee5e872">Each PersistPtrIncrementalBlock can contain a number of entries blocks. Each block holds information on a sequence of sheets. Each block starts with a 32 bit little endian integer. Once read into memory, the lower 20 bits contain the starting number for the sequence of sheets to be described. The higher 12 bits contain the count of the number of sheets described. Following that is one 32 bit little endian integer for each sheet in the sequence, the value being the offset to that sheet. If there is any data left after parsing a block, then it corresponds to the next block.</span><span class="tscolor" lg_zh="t_d4e219e26aa247abb310659a8ee5e872"><span lg_kh="1">(</span>${t_d4e219e26aa247abb310659a8ee5e872}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hex on disk decimal description</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">----------- ------- -----------</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 No options</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">7217 6002 Record type is 6002</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">2000 0000 32 Length of data is 32 bytes</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0100 5000 5242881 Count is 5 (12 highest bits)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Starting number is 1 (20 lowest bits)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0000 0 Sheet (1+0)=1 starts at offset 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">900D 0000 3472 Sheet (1+1)=2 starts at offset 3472</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">E403 0000 996 Sheet (1+2)=3 starts at offset 996</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">9213 0000 5010 Sheet (1+3)=4 starts at offset 5010</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">BE15 0000 5566 Sheet (1+4)=5 starts at offset 5566</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0900 1000 1048585 Count is 1 (12 highest bits)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> Starting number is 9 (20 lowest bits)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">4418 0000 6212 Sheet (9+0)=9 starts at offset 9212</span>
      </div>
     </div>
    </div>
    <a name="Paragraph+and+Text+Styling"></a>
    <h2 class="boxed"><span lg_en="t_b563f30c3be448b3ae6833b1843f590c">Paragraph and Text Styling</span><span class="tscolor" lg_zh="t_b563f30c3be448b3ae6833b1843f590c"><span lg_kh="1">(</span>${t_b563f30c3be448b3ae6833b1843f590c}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_3ff38520a1754b95b30d8182ecf8bda5">There are quite a number of records that affect the styling of text, and a smaller number that are responsible for the styling of paragraphs.</span><span class="tscolor" lg_zh="t_3ff38520a1754b95b30d8182ecf8bda5"><span lg_kh="1">(</span>${t_3ff38520a1754b95b30d8182ecf8bda5}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_30dbc21cfa13420db177b14056235a73">By default, a given set of text will inherit paragraph and text stylings from the appropriate master sheet. If anything differs from the master sheet, then appropriate styling records will follow the text record.</span><span class="tscolor" lg_zh="t_30dbc21cfa13420db177b14056235a73"><span lg_kh="1">(</span>${t_30dbc21cfa13420db177b14056235a73}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_203170b52073494e9972d2c16fa0fbe2"><em>(We don't currently know enough about master sheet styling to write about it)</em></span><span class="tscolor" lg_zh="t_203170b52073494e9972d2c16fa0fbe2"><span lg_kh="1">(</span>${t_203170b52073494e9972d2c16fa0fbe2}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_c0a6c3af69664b5f90a235d702846511">Normally, powerpoint will have one text record (TextBytesAtom or TextCharsAtom) for every paragraph, with a preceding TextHeaderAtom to describe what sort of paragraph it is. If any of the stylings differ from the master's, then a StyleTextPropAtom will follow the text record. This contains the paragraph style information, and the styling information for each section of the text which has a different style. (More on StyleTextPropAtom later)</span><span class="tscolor" lg_zh="t_c0a6c3af69664b5f90a235d702846511"><span lg_kh="1">(</span>${t_c0a6c3af69664b5f90a235d702846511}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_31f3c08c89f14158bcdb16d58dec9a5c">For every font used, a FontEntityAtom must exist for that font. The FontEntityAtoms live inside a FontCollection record, and there's one of those inside Environment record inside the Document record. <em>(More on Fonts to be discovered)</em></span><span class="tscolor" lg_zh="t_31f3c08c89f14158bcdb16d58dec9a5c"><span lg_kh="1">(</span>${t_31f3c08c89f14158bcdb16d58dec9a5c}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="StyleTextPropAtom"></a>
    <h2 class="boxed"><span lg_en="t_8bf18a9940174aa1848fbbc8efe0eb3c">StyleTextPropAtom</span><span class="tscolor" lg_zh="t_8bf18a9940174aa1848fbbc8efe0eb3c"><span lg_kh="1">(</span>${t_8bf18a9940174aa1848fbbc8efe0eb3c}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_467a2209c4874a5e84700683d015cc7c">If the text or paragraph stylings for a given text record differ from those of the appropriate master, then there will be one of these records.</span><span class="tscolor" lg_zh="t_467a2209c4874a5e84700683d015cc7c"><span lg_kh="1">(</span>${t_467a2209c4874a5e84700683d015cc7c}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_45cabd119e754ff3ab2f4680652d8575">This record is made up of two lists of lists. Firstly, there's a list of paragraph stylings - each made up of the number of characters it applies two, followed by the matching styling elements. Following that is the equivalent for character stylings.</span><span class="tscolor" lg_zh="t_45cabd119e754ff3ab2f4680652d8575"><span lg_kh="1">(</span>${t_45cabd119e754ff3ab2f4680652d8575}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_d01a59e3c66b4fb0a9915ba3916a6d55">Each styling list (in either list) starts with the number of characters it applies to, stored in a 2 byte little endian number. If it is a paragraph styling, it will be followed by a 2 byte number (of unknown use). After this is a four byte number, which is a mask indicating which stylings will follow. You then have an entry for each of the stylings indicated in the mask. Finally, you move onto the next set of stylings.</span><span class="tscolor" lg_zh="t_d01a59e3c66b4fb0a9915ba3916a6d55"><span lg_kh="1">(</span>${t_d01a59e3c66b4fb0a9915ba3916a6d55}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_e0cde6ecd3bc4ff1819d69572d5d1349">Each styling has a specific mask flag to indicate its presence. (The list may be found towards the top of org.apache.poi.hslf.record.StyleTextPropAtom.java, and is too long to sensibly include here). For each styling entry will occur in the order of its mask value (so one with mask 1 will come first, followed by the next highest mask value). Depending on the styling, it is either made up of a 2 byte or 4 byte numeric value. The meaning of the value will depend on the styling (eg for font.size, it is the font size in points).</span><span class="tscolor" lg_zh="t_e0cde6ecd3bc4ff1819d69572d5d1349"><span lg_kh="1">(</span>${t_e0cde6ecd3bc4ff1819d69572d5d1349}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_484188f99cd248ec8f625a4b26bd74cf">Some stylings are actually mask stylings. For these, the value will be a 4 byte number. This is then processed as mask, to indicate a number of different sub-stylings. The styling for bold/italic/underline is one such example.</span><span class="tscolor" lg_zh="t_484188f99cd248ec8f625a4b26bd74cf"><span lg_kh="1">(</span>${t_484188f99cd248ec8f625a4b26bd74cf}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">hex on disk decimal description</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">----------- ------- -----------</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 No options</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">A10F 4001 Record type is 4001</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">8000 0000 128 Length of data is 128 bytes</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1E00 0000 30 The paragraph styling applies to 30 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Paragraph options are 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0018 0000 6144 0x0800=Text Alignment, 0x1000=Line Spacing</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Text Alignment = Left</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">5000 80 Line Spacing = 80</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1C00 0000 28 The paragraph styling applies to 28 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Paragraph options are 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0010 0000 4096 0x1000=Line Spacing</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">5000 80 Line Spacing = 80</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1900 0000 25 The paragraph styling applies to 25 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Paragraph options are 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0018 0000 6144 0x0800=Text Alignment, 0x1000=Line Spacing</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0200 0 Text Alignment = Right</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">5000 80 Line Spacing = 80</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">6100 0000 61 The paragraph styling applies to 61 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> (includes final CR)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Paragraph options are 0</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0018 0000 6144 0x0800=Text Alignment, 0x1000=Line Spacing</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0 Text Alignment = Left</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">5000 80 Line Spacing = 80</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1E00 0000 30 The character styling applies to 30 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0100 0200 131073 0x0001=Char Props Mask, 0x20000=Font Size</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0100 1 Char Props 0x0001=Bold</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1400 20 Font Size = 20</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1C00 0000 28 The character styling applies to 28 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0200 0600 393218 0x0002=Char Props Mask, 0x20000=Font Size, 0x40000=Font Color</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0200 2 Char Props 0x0002=Italic</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1400 20 Font Size = 20</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0005 83886080 Blue</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1900 0000 25 The character styling applies to 25 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0000 0600 393216 0x20000=Font Size, 0x40000=Font Color</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1400 20 Font Size = 20</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">FF33 00FE 4261426175 Red</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">6000 0000 96 The character styling applies to 96 characters</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0400 0300 196612 0x0004=Char Props Mask, 0x10000=Font Index, 0x20000=Font Size</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0400 4 Char Props 0x0004=Underlined</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">0100 1 Font Index = 1 (2nd Font in table)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">1800 24 Font Size = 24</span>
      </div>
     </div>
    </div>
    <a name="Fonts+in+PowerPoint"></a>
    <h2 class="boxed"><span lg_en="t_01b1b4e25e514c709a2eeff3bd642b0a">Fonts in PowerPoint</span><span class="tscolor" lg_zh="t_01b1b4e25e514c709a2eeff3bd642b0a"><span lg_kh="1">(</span>${t_01b1b4e25e514c709a2eeff3bd642b0a}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_b2243560ffa746758a7abe787bca7315">PowerPoint stores information about the fonts used in FontEntityAtoms, which live inside Document.Environment.FontCollection. For every different font used, a FontEntityAtom must exist for that font. There is always at least one FontEntityAtom in Document.Environment.FontCollection, which describes the default font.</span><span class="tscolor" lg_zh="t_b2243560ffa746758a7abe787bca7315"><span lg_kh="1">(</span>${t_b2243560ffa746758a7abe787bca7315}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="FontEntityAtom"></a>
    <h2 class="boxed"><span lg_en="t_0cbb5171471e48288aade02d1f8a3ba2">FontEntityAtom</span><span class="tscolor" lg_zh="t_0cbb5171471e48288aade02d1f8a3ba2"><span lg_kh="1">(</span>${t_0cbb5171471e48288aade02d1f8a3ba2}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_c9b22e28f47e427e86a58035c486731e">The instance field of the record header contains the zero based index of the font. Font index entries in StyleTextPropAtoms will refer to their required font via this index.</span><span class="tscolor" lg_zh="t_c9b22e28f47e427e86a58035c486731e"><span lg_kh="1">(</span>${t_c9b22e28f47e427e86a58035c486731e}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_7f00f59d70c64ac08d7eb033011182c0">The length of FontEntityAtoms is always 68 bytes. The first 64 bytes of it hold the typeface name of the font to be used. This is stored as a null-terminated string, and encoded as little endian unicode. (The length of the string must not exceed 32 characters including the null termination, so the typeface name cannot exceed 31 characters).</span><span class="tscolor" lg_zh="t_7f00f59d70c64ac08d7eb033011182c0"><span lg_kh="1">(</span>${t_7f00f59d70c64ac08d7eb033011182c0}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_5c76470179f741dd92c6de9a0ee7e816">After the typeface name there are 4 bytes of bitmask flags. The details of these can be found in the Windows API, under the LOGFONT structure. The 65th byte is the output precision, which defines how closely the system chosen font must match the requested font, in terms of height, width, pitch etc. The 66th byte is the clipping precision, which defines how to clip characters that occur partly outside the clipping region. The 67th byte is the output quality, which defines how closely the system must match the logical font's attributes to those of the physical font used. The 68th (and final) byte is the pitch and family, which is used by the system when matching fonts.</span><span class="tscolor" lg_zh="t_5c76470179f741dd92c6de9a0ee7e816"><span lg_kh="1">(</span>${t_5c76470179f741dd92c6de9a0ee7e816}<span lg_kh="1">)</span></span></p>
    </div>
    <p align="right"><span lg_en="t_84a13167105e4342b5ee4921e657ab7f"><font size="-2">by&nbsp;Nick Burch,&nbsp;Yegor Kozlov</font></span><span class="tscolor" lg_zh="t_84a13167105e4342b5ee4921e657ab7f"><span lg_kh="1">(</span>${t_84a13167105e4342b5ee4921e657ab7f}<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/slideshow/ppt-file-format.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>