<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta content="Apache Forrest" name="Generator">
  <meta name="Forrest-version" content="0.9">
  <meta name="Forrest-skin-name" content="pelt">
  <title>POI Ruby Bindings</title>
  <link type="text/css" href="../skin/basic.css" rel="stylesheet">
  <link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
  <link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
  <link type="text/css" href="../skin/profile.css" rel="stylesheet">
  <script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script>
  <script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
  <link rel="shortcut icon" href="../images/favicon.ico">
  <meta charset="UTF-8">
  <script src="../js/jquery.min.js"></script>
  <link href="../css/xst-ts.css" rel="stylesheet">
  <script src="../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript">ndeSetTextSize();</script>
  <div id="main">
   <!--+
    |breadtrail
    +-->
   <!--+
    |start Menu, mainarea
    +-->
   <!--+
    |start Menu
    +-->
   <!--+
    |end Menu
    +-->
   <!--+
    |start content
    +-->
   <div id="content">
    <h1><span lg_en="t_f870bb12637547bf82aa80543f2c3382">POI Ruby Bindings</span><span class="tscolor" lg_zh="t_f870bb12637547bf82aa80543f2c3382"><span lg_kh="1">(</span>${t_f870bb12637547bf82aa80543f2c3382}<span lg_kh="1">)</span></span></h1>
    <div id="front-matter"></div>
    <a name="Intro"></a>
    <h2 class="boxed"><span lg_en="t_7a14798227524ebe8da67d57e554ccb1">Intro</span><span class="tscolor" lg_zh="t_7a14798227524ebe8da67d57e554ccb1"><span lg_kh="1">(</span>${t_7a14798227524ebe8da67d57e554ccb1}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_2aeda75e4db346678a29cea016dd9e1f">The POI library can now be compiled as a Ruby extension, allowing the API to be called from Ruby language programs. Ruby users can therefore read and write OLE2 documents, such as Excel files with ease</span><span class="tscolor" lg_zh="t_2aeda75e4db346678a29cea016dd9e1f"><span lg_kh="1">(</span>${t_2aeda75e4db346678a29cea016dd9e1f}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_8c1bd133a079470d9ef0a90938f331ee">The bindings are generated by compiling POI with <a href="https://gcc.gnu.org/java/">gcj</a>, and generating the Ruby wrapper using <a href="http://www.swig.org">SWIG</a>. The aim is the keep the POI api as-is. However, where java standard library objects are used, an effort is made to transform them smoothly into Ruby objects. Therefore, where the POI API takes an OutputStream, you can pass an IO object. Where the POI works java.util.Date or java.util.Calendar object, you can work with a Ruby Time object.</span><span class="tscolor" lg_zh="t_8c1bd133a079470d9ef0a90938f331ee"><span lg_kh="1">(</span>${t_8c1bd133a079470d9ef0a90938f331ee}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Getting+Started"></a>
    <h2 class="boxed"><span lg_en="t_4e764bfc1be04fbfb85cafe97467acdd">Getting Started</span><span class="tscolor" lg_zh="t_4e764bfc1be04fbfb85cafe97467acdd"><span lg_kh="1">(</span>${t_4e764bfc1be04fbfb85cafe97467acdd}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="Pre-Requisites"></a>
     <h3 class="boxed"><span lg_en="t_9b4b90bd4573491f88f869a8f6a73109">Pre-Requisites</span><span class="tscolor" lg_zh="t_9b4b90bd4573491f88f869a8f6a73109"><span lg_kh="1">(</span>${t_9b4b90bd4573491f88f869a8f6a73109}<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_3b151ce8c1b447cb9c1fe995dc1f0c10">The bindings have been developed with GCC 3.4.3 and Ruby 1.8.2. You are unlikely to get correct results with versions of GCC prior to 3.4 or versions of Ruby prior to 1.8. To compile the Ruby extension, you must have GCC (compiled with java language support), Ruby development headers, and SWIG. To run, you will need Ruby (obviously!) and <em>libgcj </em>, presumably from the same version of GCC with which you compiled.</span><span class="tscolor" lg_zh="t_3b151ce8c1b447cb9c1fe995dc1f0c10"><span lg_kh="1">(</span>${t_3b151ce8c1b447cb9c1fe995dc1f0c10}<span lg_kh="1">)</span></span></p>
     <a name="Subversion"></a>
     <h3 class="boxed"><span lg_en="t_a378c2e8c71e4c3ca17401150ff4b420">Subversion</span><span class="tscolor" lg_zh="t_a378c2e8c71e4c3ca17401150ff4b420"><span lg_kh="1">(</span>${t_a378c2e8c71e4c3ca17401150ff4b420}<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_fe2faeafcdb44fbaa7f2f49feee42177">The POI-Ruby module sits under the POI <a href="https://svn.apache.org/repos/asf/poi/trunk/src/contrib/poi-ruby/">Subversion</a> <a href="https://svn.apache.org/viewvc/poi/trunk/src/contrib/poi-ruby/">(viewvc)</a>. Running <em>make</em> inside that directory will create a loadable ruby extension <em>poi4r.so</em> in the release subdirectory. Tests are in the <em>tests/</em> subdirectory, and should be run from the <em>poi-ruby</em> directory. Please read the tests to figure out the usage.</span><span class="tscolor" lg_zh="t_fe2faeafcdb44fbaa7f2f49feee42177"><span lg_kh="1">(</span>${t_fe2faeafcdb44fbaa7f2f49feee42177}<span lg_kh="1">)</span></span></p>
     <p><span lg_en="t_00ac256d2f214006a1f51f57e725d86a">Note that the makefile, though designed to work across Linux/OS X/Cygwin, has been tested only on linux. There are likely to be issues on other platform; fixes gratefully accepted!</span><span class="tscolor" lg_zh="t_00ac256d2f214006a1f51f57e725d86a"><span lg_kh="1">(</span>${t_00ac256d2f214006a1f51f57e725d86a}<span lg_kh="1">)</span></span></p>
     <a name="Binary"></a>
     <h3 class="boxed"><span lg_en="t_681e38148eb34875a6fe24cda3bbdfce">Binary</span><span class="tscolor" lg_zh="t_681e38148eb34875a6fe24cda3bbdfce"><span lg_kh="1">(</span>${t_681e38148eb34875a6fe24cda3bbdfce}<span lg_kh="1">)</span></span></h3>
     <p><span lg_en="t_26bbc6bf6e7b48098ae37c6814fcb8f9">A version of poi4r.so is available <a href="https://www.apache.org/~avik/dist/poi4r.so">here</a> (broken link). Its been compiled on a linux box with GCC 3.4.3 and Ruby 1.8.2. It dynamically links to libgcj. No guarantees about working on any other box.</span><span class="tscolor" lg_zh="t_26bbc6bf6e7b48098ae37c6814fcb8f9"><span lg_kh="1">(</span>${t_26bbc6bf6e7b48098ae37c6814fcb8f9}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Usage"></a>
    <h2 class="boxed"><span lg_en="t_0680772c96454b09903ec6c8c626fff5">Usage</span><span class="tscolor" lg_zh="t_0680772c96454b09903ec6c8c626fff5"><span lg_kh="1">(</span>${t_0680772c96454b09903ec6c8c626fff5}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <p><span lg_en="t_50fa9f9ce3c243428739ee319e6f78cf">The following ruby code shows some of the things you can do with POI in Ruby</span><span class="tscolor" lg_zh="t_50fa9f9ce3c243428739ee319e6f78cf"><span lg_kh="1">(</span>${t_50fa9f9ce3c243428739ee319e6f78cf}<span lg_kh="1">)</span></span></p>
     <div class="code">
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">h=Poi4r::HSSFWorkbook.new</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Test Sheet Creation</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s=h.createSheet("Sheet1")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Test setting cell values</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">s=h.getSheetAt(0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">r=s.createRow(0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c=r.createCell(0)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellValue(1.5)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c=r.createCell(1)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellValue("Ruby")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Test styles</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">st = h.createCellStyle()</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c=r.createCell(2)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">st.setAlignment(Poi4r::HSSFCellStyle.ALIGN_CENTER)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellStyle(st)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellValue("centr'd")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Date handling</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c=r.createCell(3)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">t1=Time.now</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellValue(Time.now)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">t2= c.getDateCellValue().gmtime</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">st=h.createCellStyle();</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">st.setDataFormat(Poi4r::HSSFDataFormat.getBuiltinFormat("m/d/yy h:mm"))</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellStyle(st)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Formulas</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c=r.createCell(4)</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.setCellFormula("A1*2")</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">c.getCellFormula()</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"></span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">#Writing</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody">h.write(File.new("test.xls","w"))</span>
      </div>
      <div class="codeline">
       <span class="lineno"></span><span class="codebody"> </span>
      </div>
     </div>
     <p><span lg_en="t_4bdf55df9b0748fe952f10a3b498aae7">The <em>tc_base_tests.rb</em> file in the <em>tests</em> sub directory of the source distribution contains examples of simple uses of the API. The <a href="spreadsheet/quick-guide.html">quick guide </a> is the best place to learn HSSF API use. (Note however that none of the Drawing features are implemented in the Ruby binding.) See also the <a href="../apidocs/index.html">POI API documentation</a> for more details.</span><span class="tscolor" lg_zh="t_4bdf55df9b0748fe952f10a3b498aae7"><span lg_kh="1">(</span>${t_4bdf55df9b0748fe952f10a3b498aae7}<span lg_kh="1">)</span></span></p>
    </div>
    <a name="Future+Directions"></a>
    <h2 class="boxed"><span lg_en="t_b3238e81035e4ddfa832f04d95766942">Future Directions</span><span class="tscolor" lg_zh="t_b3238e81035e4ddfa832f04d95766942"><span lg_kh="1">(</span>${t_b3238e81035e4ddfa832f04d95766942}<span lg_kh="1">)</span></span></h2>
    <div class="section">
     <a name="TODO%27s"></a>
     <h3 class="boxed"><span lg_en="t_5140f66dc51d4634922077120bcd0b33">TODO's</span><span class="tscolor" lg_zh="t_5140f66dc51d4634922077120bcd0b33"><span lg_kh="1">(</span>${t_5140f66dc51d4634922077120bcd0b33}<span lg_kh="1">)</span></span></h3>
     <ul>
      <li><span lg_en="t_1d13f3bda6664d3e8b9b8758deb0b0ad">Implement support for reading Excel files (easy)</span><span class="tscolor" lg_zh="t_1d13f3bda6664d3e8b9b8758deb0b0ad"><span lg_kh="1">(</span>${t_1d13f3bda6664d3e8b9b8758deb0b0ad}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_3f98ba5c57c444c5809fef8d77352cb2">Expose POIFS API to read raw OLE2 files from Ruby</span><span class="tscolor" lg_zh="t_3f98ba5c57c444c5809fef8d77352cb2"><span lg_kh="1">(</span>${t_3f98ba5c57c444c5809fef8d77352cb2}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_1139d8f4e8474fc69b48b310add6ff6b">Expose HPSF API to read property streams</span><span class="tscolor" lg_zh="t_1139d8f4e8474fc69b48b310add6ff6b"><span lg_kh="1">(</span>${t_1139d8f4e8474fc69b48b310add6ff6b}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_ce429de16fd74c4b9b42442954aafe43">Tests... Tests... Tests...</span><span class="tscolor" lg_zh="t_ce429de16fd74c4b9b42442954aafe43"><span lg_kh="1">(</span>${t_ce429de16fd74c4b9b42442954aafe43}<span lg_kh="1">)</span></span></li>
     </ul>
     <a name="Limitations"></a>
     <h3 class="boxed"><span lg_en="t_2e987029e6c343d7b0e268945653c765">Limitations</span><span class="tscolor" lg_zh="t_2e987029e6c343d7b0e268945653c765"><span lg_kh="1">(</span>${t_2e987029e6c343d7b0e268945653c765}<span lg_kh="1">)</span></span></h3>
     <ul>
      <li><span lg_en="t_f85a9767ec0643f5a2eabe5141596c5d">Check operations in 64bit machines - Java primitive types are fixed irrespective of machine type, unlike C/C++ types. The wrapping code that converts C/C++ primitive types to/from Java types is making assumptions on type sizes that MAY be incorrect on wide architectures.</span><span class="tscolor" lg_zh="t_f85a9767ec0643f5a2eabe5141596c5d"><span lg_kh="1">(</span>${t_f85a9767ec0643f5a2eabe5141596c5d}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_a7daf3d4b6604fbda93c3addd510a82a">The current implementation is with the POI 2.0 release. The 2.5 release adds support for Excel drawing primitives, and thus has a dependency on java AWT. Since AWT is not very mature in gcj, leaving it out seemed to be the safer option.</span><span class="tscolor" lg_zh="t_a7daf3d4b6604fbda93c3addd510a82a"><span lg_kh="1">(</span>${t_a7daf3d4b6604fbda93c3addd510a82a}<span lg_kh="1">)</span></span></li>
      <li><span lg_en="t_cfb21a41879640e4aa88d4431dd01df3">Packaging - The current make file makes no effort to install the extension into the standard ruby directories. This should probably be packaged as a <a href="http://www.rubygems.org">gem</a>.</span><span class="tscolor" lg_zh="t_cfb21a41879640e4aa88d4431dd01df3"><span lg_kh="1">(</span>${t_cfb21a41879640e4aa88d4431dd01df3}<span lg_kh="1">)</span></span></li>
     </ul>
    </div>
    <p align="right"><span lg_en="t_a6e37cd8c9a6440d8e1d9f74bc8b44e1"><font size="-2">by&nbsp;Avik Sengupta</font></span><span class="tscolor" lg_zh="t_a6e37cd8c9a6440d8e1d9f74bc8b44e1"><span lg_kh="1">(</span>${t_a6e37cd8c9a6440d8e1d9f74bc8b44e1}<span lg_kh="1">)</span></span></p>
   </div>
   <!--+
    |end content
    +-->
   <div class="clearboth">&nbsp;</div>
  </div>
  <div id="footer">
   <!--+
    |start bottomstrip
    +-->
   <div class="lastmodified">
    <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
   </div>
   <div class="copyright">
    Copyright Â© 2001-2021 <a href="https://www.apache.org/">The Apache Software Foundation</a>
   </div>
   <div id="feedback">
    Send feedback about the website to: <a id="feedbackto" href="mailto:dev@poi.apache.org?subject=Feedback%C2%A0components/poi-ruby.html">dev@poi.apache.org</a>
   </div>
   <!--+
    |end bottomstrip
    +-->
  </div>
 </body>
</html>