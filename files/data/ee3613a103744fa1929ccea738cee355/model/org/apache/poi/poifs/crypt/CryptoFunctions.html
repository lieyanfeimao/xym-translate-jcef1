<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
 <head>
  <!-- Generated by javadoc -->
  <title>CryptoFunctions (POI API Documentation)</title>
  <link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
  <script type="text/javascript" src="../../../../../script.js"></script>
  <meta charset="UTF-8">
  <script src="../../../../../js/jquery.min.js"></script>
  <link href="../../../../../css/xst-ts.css" rel="stylesheet">
  <script src="../../../../../js/xst-lg.js"></script>
 </head>
 <body>
  <script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CryptoFunctions (POI API Documentation)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9,"i12":9,"i13":9,"i14":9,"i15":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
  <noscript>
   <div>JavaScript is disabled on your browser.</div>
  </noscript>
  <!-- ========= START OF TOP NAVBAR ======= -->
  <div class="topNav">
   <a name="navbar.top"> <!--   --> </a>
   <div class="skipNav">
    <a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a>
   </div>
   <a name="navbar.top.firstrow"> <!--   --> </a>
   <ul class="navList" title="Navigation">
    <li><a href="../../../../../overview-summary.html">Overview</a></li>
    <li><a href="package-summary.html">Package</a></li>
    <li class="navBarCell1Rev">Class</li>
    <li><a href="class-use/CryptoFunctions.html">Use</a></li>
    <li><a href="package-tree.html">Tree</a></li>
    <li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
    <li><a href="../../../../../index-all.html">Index</a></li>
    <li><a href="../../../../../help-doc.html">Help</a></li>
   </ul>
  </div>
  <div class="subNav">
   <ul class="navList">
    <li><a href="../../../../../org/apache/poi/poifs/crypt/CipherProvider.html" title="enum in org.apache.poi.poifs.crypt"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
    <li><a href="../../../../../org/apache/poi/poifs/crypt/DataSpaceMapUtils.html" title="class in org.apache.poi.poifs.crypt"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
   </ul>
   <ul class="navList">
    <li><a href="../../../../../index.html?org/apache/poi/poifs/crypt/CryptoFunctions.html" target="_top">Frames</a></li>
    <li><a href="CryptoFunctions.html" target="_top">No&nbsp;Frames</a></li>
   </ul>
   <ul class="navList" id="allclasses_navbar_top">
    <li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
   </ul>
   <div>
    <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
   </div>
   <div>
    <ul class="subNavList">
     <li>Summary:&nbsp;</li>
     <li>Nested&nbsp;|&nbsp;</li>
     <li>Field&nbsp;|&nbsp;</li>
     <li>Constr&nbsp;|&nbsp;</li>
     <li><a href="#method.summary">Method</a></li>
    </ul>
    <ul class="subNavList">
     <li>Detail:&nbsp;</li>
     <li>Field&nbsp;|&nbsp;</li>
     <li>Constr&nbsp;|&nbsp;</li>
     <li><a href="#method.detail">Method</a></li>
    </ul>
   </div>
   <a name="skip.navbar.top"> <!--   --> </a>
  </div>
  <!-- ========= END OF TOP NAVBAR ========= -->
  <!-- ======== START OF CLASS DATA ======== -->
  <div class="header">
   <div class="subTitle">org.apache.poi.poifs.crypt</div>
   <h2 title="Class CryptoFunctions" class="title">Class CryptoFunctions</h2>
  </div>
  <div class="contentContainer">
   <ul class="inheritance">
    <li>java.lang.Object</li>
    <li>
     <ul class="inheritance">
      <li>org.apache.poi.poifs.crypt.CryptoFunctions</li>
     </ul>
    </li>
   </ul>
   <div class="description">
    <ul class="blockList">
     <li class="blockList">
      <hr>
      <br>
      <pre><a href="../../../../../org/apache/poi/util/Internal.html" title="annotation in org.apache.poi.util">@Internal</a>
public final class <span class="typeNameLabel">CryptoFunctions</span>
extends java.lang.Object</pre>
      <div class="block">
       <span lg_en="t_0da0acca586e4d10a0cd0c1a05b000c5">Helper functions used for standard and agile encryption</span><span class="tscolor" lg_zh="t_0da0acca586e4d10a0cd0c1a05b000c5"><span lg_kh="1">(</span>${t_0da0acca586e4d10a0cd0c1a05b000c5}<span lg_kh="1">)</span></span>
      </div>
     </li>
    </ul>
   </div>
   <div class="summary">
    <ul class="blockList">
     <li class="blockList"><!-- ========== METHOD SUMMARY =========== -->
      <ul class="blockList">
       <li class="blockList"><a name="method.summary"> <!--   --> </a>
        <h3>Method Summary</h3>
        <table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
         <caption>
          <span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span>
         </caption>
         <tbody>
          <tr>
           <th class="colFirst" scope="col">Modifier and Type</th>
           <th class="colLast" scope="col">Method and Description</th>
          </tr>
          <tr id="i0" class="altColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#createXorArray1-java.lang.String-">createXorArray1</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_7e45e7fbac6d4e7b949eb13fb9d58786">Creates an byte array for xor obfuscation (method 1)</span><span class="tscolor" lg_zh="t_7e45e7fbac6d4e7b949eb13fb9d58786"><span lg_kh="1">(</span>${t_7e45e7fbac6d4e7b949eb13fb9d58786}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i1" class="rowColor">
           <td class="colFirst"><code>static int</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#createXorKey1-java.lang.String-">createXorKey1</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_eeccd4cc49e346538a3677ae68260ac7">Create the xor key for xor obfuscation, which is used to create the xor array (method 1)</span><span class="tscolor" lg_zh="t_eeccd4cc49e346538a3677ae68260ac7"><span lg_kh="1">(</span>${t_eeccd4cc49e346538a3677ae68260ac7}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i2" class="altColor">
           <td class="colFirst"><code>static int</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#createXorVerifier1-java.lang.String-">createXorVerifier1</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_a1a94c5633e44f43b8e811504d3d1928">Create the verifier for xor obfuscation (method 1)</span><span class="tscolor" lg_zh="t_a1a94c5633e44f43b8e811504d3d1928"><span lg_kh="1">(</span>${t_a1a94c5633e44f43b8e811504d3d1928}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i3" class="rowColor">
           <td class="colFirst"><code>static int</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#createXorVerifier2-java.lang.String-">createXorVerifier2</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_29e6fafb81244751b51329f09dbe0e6f">This method generates the xor verifier for word documents &lt; 2007 (method 2).</span><span class="tscolor" lg_zh="t_29e6fafb81244751b51329f09dbe0e6f"><span lg_kh="1">(</span>${t_29e6fafb81244751b51329f09dbe0e6f}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i4" class="altColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#generateIv-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-byte:A-int-">generateIv</a></span>(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm, byte[]&nbsp;salt, byte[]&nbsp;blockKey, int&nbsp;blockSize)</code>
            <div class="block">
             <span lg_en="t_9d586486c2324cbf940b278a97a0ac22"><cite>2.3.4.12 Initialization Vector Generation (Agile Encryption)</cite></span><span class="tscolor" lg_zh="t_9d586486c2324cbf940b278a97a0ac22"><span lg_kh="1">(</span>${t_9d586486c2324cbf940b278a97a0ac22}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i5" class="rowColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#generateKey-byte:A-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-">generateKey</a></span>(byte[]&nbsp;passwordHash, <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm, byte[]&nbsp;blockKey, int&nbsp;keySize)</code>
            <div class="block">
             <span lg_en="t_947bff816b9247049b1cf83ae71984ba"><cite>2.3.4.11 Encryption Key Generation (Agile Encryption)</cite></span><span class="tscolor" lg_zh="t_947bff816b9247049b1cf83ae71984ba"><span lg_kh="1">(</span>${t_947bff816b9247049b1cf83ae71984ba}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i6" class="altColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#getBlock0-byte:A-int-">getBlock0</a></span>(byte[]&nbsp;hash, int&nbsp;size)</code>
            <div class="block">
             <span lg_en="t_40a3271d5e56498bbae1d6696e95f2e0">Returns a new byte array with a truncated to the given size.</span><span class="tscolor" lg_zh="t_40a3271d5e56498bbae1d6696e95f2e0"><span lg_kh="1">(</span>${t_40a3271d5e56498bbae1d6696e95f2e0}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i7" class="rowColor">
           <td class="colFirst"><code>static javax.crypto.Cipher</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#getCipher-java.security.Key-org.apache.poi.poifs.crypt.CipherAlgorithm-org.apache.poi.poifs.crypt.ChainingMode-byte:A-int-java.lang.String-">getCipher</a></span>(java.security.Key&nbsp;key, <a href="../../../../../org/apache/poi/poifs/crypt/CipherAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">CipherAlgorithm</a>&nbsp;cipherAlgorithm, <a href="../../../../../org/apache/poi/poifs/crypt/ChainingMode.html" title="enum in org.apache.poi.poifs.crypt">ChainingMode</a>&nbsp;chain, byte[]&nbsp;vec, int&nbsp;cipherMode, java.lang.String&nbsp;padding)</code>
            <div class="block">
             <span lg_en="t_fdd8f5e7245b46d9be6bd2f150f19453">Initialize a new cipher object with the given cipher properties If the given algorithm is not implemented in the JCE, it will try to load it from the bouncy castle provider.</span><span class="tscolor" lg_zh="t_fdd8f5e7245b46d9be6bd2f150f19453"><span lg_kh="1">(</span>${t_fdd8f5e7245b46d9be6bd2f150f19453}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i8" class="altColor">
           <td class="colFirst"><code>static javax.crypto.Cipher</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#getCipher-javax.crypto.SecretKey-org.apache.poi.poifs.crypt.CipherAlgorithm-org.apache.poi.poifs.crypt.ChainingMode-byte:A-int-">getCipher</a></span>(javax.crypto.SecretKey&nbsp;key, <a href="../../../../../org/apache/poi/poifs/crypt/CipherAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">CipherAlgorithm</a>&nbsp;cipherAlgorithm, <a href="../../../../../org/apache/poi/poifs/crypt/ChainingMode.html" title="enum in org.apache.poi.poifs.crypt">ChainingMode</a>&nbsp;chain, byte[]&nbsp;vec, int&nbsp;cipherMode)</code>
            <div class="block">
             <span lg_en="t_bb7b806905f04c8ba4e4550c77041020">Initialize a new cipher object with the given cipher properties and no padding If the given algorithm is not implemented in the JCE, it will try to load it from the bouncy castle provider.</span><span class="tscolor" lg_zh="t_bb7b806905f04c8ba4e4550c77041020"><span lg_kh="1">(</span>${t_bb7b806905f04c8ba4e4550c77041020}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i9" class="rowColor">
           <td class="colFirst"><code>static javax.crypto.Mac</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#getMac-org.apache.poi.poifs.crypt.HashAlgorithm-">getMac</a></span>(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm)</code>&nbsp;</td>
          </tr>
          <tr id="i10" class="altColor">
           <td class="colFirst"><code>static java.security.MessageDigest</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#getMessageDigest-org.apache.poi.poifs.crypt.HashAlgorithm-">getMessageDigest</a></span>(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm)</code>&nbsp;</td>
          </tr>
          <tr id="i11" class="rowColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#hashPassword-java.lang.String-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-">hashPassword</a></span>(java.lang.String&nbsp;password, <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm, byte[]&nbsp;salt, int&nbsp;spinCount)</code>
            <div class="block">
             <span lg_en="t_2649a8ac603e4cdc9bdacd60a963f986"><cite>2.3.4.7 ECMA-376 Document Encryption Key Generation (Standard Encryption) 
               <br> 2.3.4.11 Encryption Key Generation (Agile Encryption)</cite></span><span class="tscolor" lg_zh="t_2649a8ac603e4cdc9bdacd60a963f986"><span lg_kh="1">(</span>${t_2649a8ac603e4cdc9bdacd60a963f986}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i12" class="altColor">
           <td class="colFirst"><code>static byte[]</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#hashPassword-java.lang.String-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-boolean-">hashPassword</a></span>(java.lang.String&nbsp;password, <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm, byte[]&nbsp;salt, int&nbsp;spinCount, boolean&nbsp;iteratorFirst)</code>
            <div class="block">
             <span lg_en="t_46375337aa3544278751a03f9fb9e700">Generalized method for read and write protection hash generation.</span><span class="tscolor" lg_zh="t_46375337aa3544278751a03f9fb9e700"><span lg_kh="1">(</span>${t_46375337aa3544278751a03f9fb9e700}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i13" class="rowColor">
           <td class="colFirst"><code>static void</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#registerBouncyCastle--">registerBouncyCastle</a></span>()</code>&nbsp;</td>
          </tr>
          <tr id="i14" class="altColor">
           <td class="colFirst"><code>static java.lang.String</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#xorHashPassword-java.lang.String-">xorHashPassword</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_eddb581446994c2184b36112ed2245c9">This method generates the xored-hashed password for word documents &lt; 2007.</span><span class="tscolor" lg_zh="t_eddb581446994c2184b36112ed2245c9"><span lg_kh="1">(</span>${t_eddb581446994c2184b36112ed2245c9}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
          <tr id="i15" class="rowColor">
           <td class="colFirst"><code>static java.lang.String</code></td>
           <td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#xorHashPasswordReversed-java.lang.String-">xorHashPasswordReversed</a></span>(java.lang.String&nbsp;password)</code>
            <div class="block">
             <span lg_en="t_b19ff38fa4e64431acbb33b32fff2e74">Convenience function which returns the reversed xored-hashed password for further processing in word documents 2007 and newer, which utilize a real hashing algorithm like sha1.</span><span class="tscolor" lg_zh="t_b19ff38fa4e64431acbb33b32fff2e74"><span lg_kh="1">(</span>${t_b19ff38fa4e64431acbb33b32fff2e74}<span lg_kh="1">)</span></span>
            </div></td>
          </tr>
         </tbody>
        </table>
        <ul class="blockList">
         <li class="blockList"><a name="methods.inherited.from.class.java.lang.Object"> <!--   --> </a>
          <h3>Methods inherited from class&nbsp;java.lang.Object</h3>
          <code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
        </ul></li>
      </ul></li>
    </ul>
   </div>
   <div class="details">
    <ul class="blockList">
     <li class="blockList"><!-- ============ METHOD DETAIL ========== -->
      <ul class="blockList">
       <li class="blockList"><a name="method.detail"> <!--   --> </a>
        <h3>Method Detail</h3>
        <a name="hashPassword-java.lang.String-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>hashPassword</h4>
          <pre>public static&nbsp;byte[]&nbsp;hashPassword(java.lang.String&nbsp;password,
                                  <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm,
                                  byte[]&nbsp;salt,
                                  int&nbsp;spinCount)</pre>
          <div class="block">
           <span lg_en="t_a043438d6f2c4cbea2f61ffbddeec35b">
            <p><cite>2.3.4.7 ECMA-376 Document Encryption Key Generation (Standard Encryption) 
              <br> 2.3.4.11 Encryption Key Generation (Agile Encryption)</cite></p> 
            <p>The encryption key for ECMA-376 document encryption [ECMA-376] using agile encryption MUST be generated by using the following method, which is derived from PKCS #5: <a href="https://www.ietf.org/rfc/rfc2898.txt">Password-Based Cryptography Version 2.0 [RFC2898]</a>.</p> 
            <p>Let H() be a hashing algorithm as determined by the PasswordKeyEncryptor.hashAlgorithm element, H_n be the hash data of the n-th iteration, and a plus sign (+) represent concatenation. The password MUST be provided as an array of Unicode characters. Limitations on the length of the password and the characters used by the password are implementation-dependent. The initial password hash is generated as follows:</p> 
            <pre>H_0 = H(salt + password)</pre> 
            <p>The salt used MUST be generated randomly. The salt MUST be stored in the PasswordKeyEncryptor.saltValue element contained within the \EncryptionInfo stream as specified in section 2.3.4.10. The hash is then iterated by using the following approach:</p> 
            <pre>H_n = H(iterator + H_n-1)</pre> 
            <p>where iterator is an unsigned 32-bit value that is initially set to 0x00000000 and then incremented monotonically on each iteration until PasswordKey.spinCount iterations have been performed. The value of iterator on the last iteration MUST be one less than PasswordKey.spinCount.</p> 
            <p>For POI, H_final will be calculated by <a href="../../../../../org/apache/poi/poifs/crypt/CryptoFunctions.html#generateKey-byte:A-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-"><code>generateKey(byte[],HashAlgorithm,byte[],int)</code></a></p>
           </span><span class="tscolor" lg_zh="t_a043438d6f2c4cbea2f61ffbddeec35b"><span lg_kh="1">(</span>${t_a043438d6f2c4cbea2f61ffbddeec35b}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_054ef39ae8f14b6b87e4ac362e6002cf"><code>password</code> - the password</span><span class="tscolor" lg_zh="t_054ef39ae8f14b6b87e4ac362e6002cf"><span lg_kh="1">(</span>${t_054ef39ae8f14b6b87e4ac362e6002cf}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_c38a67db8e69428d844cd990aa35f6f0"><code>hashAlgorithm</code> - the hash algorithm</span><span class="tscolor" lg_zh="t_c38a67db8e69428d844cd990aa35f6f0"><span lg_kh="1">(</span>${t_c38a67db8e69428d844cd990aa35f6f0}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_9d91b6fb15f648bca47a7a2680d1f711"><code>salt</code> - the initial salt value</span><span class="tscolor" lg_zh="t_9d91b6fb15f648bca47a7a2680d1f711"><span lg_kh="1">(</span>${t_9d91b6fb15f648bca47a7a2680d1f711}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_f7eaa11cef2849129198854229b3dd21"><code>spinCount</code> - the repetition count</span><span class="tscolor" lg_zh="t_f7eaa11cef2849129198854229b3dd21"><span lg_kh="1">(</span>${t_f7eaa11cef2849129198854229b3dd21}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_ec60e2cce91d4894822510882ebabd9f">the hashed password</span><span class="tscolor" lg_zh="t_ec60e2cce91d4894822510882ebabd9f"><span lg_kh="1">(</span>${t_ec60e2cce91d4894822510882ebabd9f}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="hashPassword-java.lang.String-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-boolean-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>hashPassword</h4>
          <pre>public static&nbsp;byte[]&nbsp;hashPassword(java.lang.String&nbsp;password,
                                  <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm,
                                  byte[]&nbsp;salt,
                                  int&nbsp;spinCount,
                                  boolean&nbsp;iteratorFirst)</pre>
          <div class="block">
           <span lg_en="t_f6535092f00f4ae886afa0eff4a70d34">Generalized method for read and write protection hash generation. The difference is, read protection uses the order iterator then hash in the hash loop, whereas write protection uses first the last hash value and then the current iterator value</span><span class="tscolor" lg_zh="t_f6535092f00f4ae886afa0eff4a70d34"><span lg_kh="1">(</span>${t_f6535092f00f4ae886afa0eff4a70d34}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_d34658b7467d4f07b5779594ba098ab4"><code>password</code> - the pasword</span><span class="tscolor" lg_zh="t_d34658b7467d4f07b5779594ba098ab4"><span lg_kh="1">(</span>${t_d34658b7467d4f07b5779594ba098ab4}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_4939b12c2046412c955b5b19e7f7ec55"><code>hashAlgorithm</code> - the hash algorighm</span><span class="tscolor" lg_zh="t_4939b12c2046412c955b5b19e7f7ec55"><span lg_kh="1">(</span>${t_4939b12c2046412c955b5b19e7f7ec55}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_d1edeb6ce5f3491f99142e70b6bee38d"><code>salt</code> - the initial salt value</span><span class="tscolor" lg_zh="t_d1edeb6ce5f3491f99142e70b6bee38d"><span lg_kh="1">(</span>${t_d1edeb6ce5f3491f99142e70b6bee38d}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_e4f2c589eda3440c8fab4e358f6c1d12"><code>spinCount</code> - the repetition count</span><span class="tscolor" lg_zh="t_e4f2c589eda3440c8fab4e358f6c1d12"><span lg_kh="1">(</span>${t_e4f2c589eda3440c8fab4e358f6c1d12}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_9d9b1bc0a9ac4da5832f3ee262ed65c0"><code>iteratorFirst</code> - if true, the iterator is hashed before the n-1 hash value, if false the n-1 hash value is applied first</span><span class="tscolor" lg_zh="t_9d9b1bc0a9ac4da5832f3ee262ed65c0"><span lg_kh="1">(</span>${t_9d9b1bc0a9ac4da5832f3ee262ed65c0}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_d839cc129c5d4fa6bb28cc84ad42b7de">the hashed password</span><span class="tscolor" lg_zh="t_d839cc129c5d4fa6bb28cc84ad42b7de"><span lg_kh="1">(</span>${t_d839cc129c5d4fa6bb28cc84ad42b7de}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="generateIv-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-byte:A-int-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>generateIv</h4>
          <pre>public static&nbsp;byte[]&nbsp;generateIv(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm,
                                byte[]&nbsp;salt,
                                byte[]&nbsp;blockKey,
                                int&nbsp;blockSize)</pre>
          <div class="block">
           <span lg_en="t_bf8133974b364b7cbd3d9a68157ca0f6">
            <p><cite>2.3.4.12 Initialization Vector Generation (Agile Encryption)</cite></p> 
            <p>Initialization vectors are used in all cases for agile encryption. An initialization vector MUST be generated by using the following method, where H() is a hash function that MUST be the same as specified in section 2.3.4.11 and a plus sign (+) represents concatenation:</p> 
            <ul>
             <li>If a blockKey is provided, let IV be a hash of the KeySalt and the following value:
              <br>
              <code>blockKey: IV = H(KeySalt + blockKey)</code></li>
             <li>If a blockKey is not provided, let IV be equal to the following value:
              <br>
              <code>KeySalt:IV = KeySalt</code></li>
             <li>If the number of bytes in the value of IV is less than the the value of the blockSize attribute corresponding to the cipherAlgorithm attribute, pad the array of bytes by appending 0x36 until the array is blockSize bytes. If the array of bytes is larger than blockSize bytes, truncate the array to blockSize bytes.</li>
            </ul>
           </span><span class="tscolor" lg_zh="t_bf8133974b364b7cbd3d9a68157ca0f6"><span lg_kh="1">(</span>${t_bf8133974b364b7cbd3d9a68157ca0f6}<span lg_kh="1">)</span></span>
          </div>
         </li>
        </ul>
        <a name="generateKey-byte:A-org.apache.poi.poifs.crypt.HashAlgorithm-byte:A-int-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>generateKey</h4>
          <pre>public static&nbsp;byte[]&nbsp;generateKey(byte[]&nbsp;passwordHash,
                                 <a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm,
                                 byte[]&nbsp;blockKey,
                                 int&nbsp;keySize)</pre>
          <div class="block">
           <span lg_en="t_4e5c175509644d10835742a2d5a0b392">
            <p><cite>2.3.4.11 Encryption Key Generation (Agile Encryption)</cite></p> 
            <p>The final hash data that is used for an encryption key is then generated by using the following method:</p> 
            <pre>H_final = H(H_n + blockKey)</pre> 
            <p>where blockKey represents an array of bytes used to prevent two different blocks from encrypting to the same cipher text.</p> 
            <p>If the size of the resulting H_final is smaller than that of PasswordKeyEncryptor.keyBits, the key MUST be padded by appending bytes with a value of 0x36. If the hash value is larger in size than PasswordKeyEncryptor.keyBits, the key is obtained by truncating the hash value.</p>
           </span><span class="tscolor" lg_zh="t_4e5c175509644d10835742a2d5a0b392"><span lg_kh="1">(</span>${t_4e5c175509644d10835742a2d5a0b392}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_0a591acd47854de1a830eb0294f5f8f2"><code>passwordHash</code> - the hashed password byte</span><span class="tscolor" lg_zh="t_0a591acd47854de1a830eb0294f5f8f2"><span lg_kh="1">(</span>${t_0a591acd47854de1a830eb0294f5f8f2}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_a624a05355574fc8a5c04caa06a13206"><code>hashAlgorithm</code> - the hash algorithm</span><span class="tscolor" lg_zh="t_a624a05355574fc8a5c04caa06a13206"><span lg_kh="1">(</span>${t_a624a05355574fc8a5c04caa06a13206}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_c03d0821402c4eb3a293c1b24af8043a"><code>blockKey</code> - the block key</span><span class="tscolor" lg_zh="t_c03d0821402c4eb3a293c1b24af8043a"><span lg_kh="1">(</span>${t_c03d0821402c4eb3a293c1b24af8043a}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_2e593eb6652745b7aa557bb8a614ce73"><code>keySize</code> - the key size</span><span class="tscolor" lg_zh="t_2e593eb6652745b7aa557bb8a614ce73"><span lg_kh="1">(</span>${t_2e593eb6652745b7aa557bb8a614ce73}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_68f274dfce014a0da0aa338f2308143e">intermediate key</span><span class="tscolor" lg_zh="t_68f274dfce014a0da0aa338f2308143e"><span lg_kh="1">(</span>${t_68f274dfce014a0da0aa338f2308143e}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="getCipher-javax.crypto.SecretKey-org.apache.poi.poifs.crypt.CipherAlgorithm-org.apache.poi.poifs.crypt.ChainingMode-byte:A-int-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>getCipher</h4>
          <pre>public static&nbsp;javax.crypto.Cipher&nbsp;getCipher(javax.crypto.SecretKey&nbsp;key,
                                            <a href="../../../../../org/apache/poi/poifs/crypt/CipherAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">CipherAlgorithm</a>&nbsp;cipherAlgorithm,
                                            <a href="../../../../../org/apache/poi/poifs/crypt/ChainingMode.html" title="enum in org.apache.poi.poifs.crypt">ChainingMode</a>&nbsp;chain,
                                            byte[]&nbsp;vec,
                                            int&nbsp;cipherMode)</pre>
          <div class="block">
           <span lg_en="t_e39b5c49563345fa8b42cbf965d31b64">Initialize a new cipher object with the given cipher properties and no padding If the given algorithm is not implemented in the JCE, it will try to load it from the bouncy castle provider.</span><span class="tscolor" lg_zh="t_e39b5c49563345fa8b42cbf965d31b64"><span lg_kh="1">(</span>${t_e39b5c49563345fa8b42cbf965d31b64}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_0a3bfb5cbc6745aa982c6a788aaffd86"><code>key</code> - the secret key</span><span class="tscolor" lg_zh="t_0a3bfb5cbc6745aa982c6a788aaffd86"><span lg_kh="1">(</span>${t_0a3bfb5cbc6745aa982c6a788aaffd86}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_8e96a017613048bda44d13bcc6372031"><code>cipherAlgorithm</code> - the cipher algorithm</span><span class="tscolor" lg_zh="t_8e96a017613048bda44d13bcc6372031"><span lg_kh="1">(</span>${t_8e96a017613048bda44d13bcc6372031}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_8c99b4e4e1e74b0a889a3ab4d9d0a024"><code>chain</code> - the chaining mode</span><span class="tscolor" lg_zh="t_8c99b4e4e1e74b0a889a3ab4d9d0a024"><span lg_kh="1">(</span>${t_8c99b4e4e1e74b0a889a3ab4d9d0a024}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_067c4c6a2c934bcfb882b5472d0f700f"><code>vec</code> - the initialization vector (IV), can be null</span><span class="tscolor" lg_zh="t_067c4c6a2c934bcfb882b5472d0f700f"><span lg_kh="1">(</span>${t_067c4c6a2c934bcfb882b5472d0f700f}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_24e5e1e9178b4559af1ed4cff93c0efa"><code>cipherMode</code> - Cipher.DECRYPT_MODE or Cipher.ENCRYPT_MODE</span><span class="tscolor" lg_zh="t_24e5e1e9178b4559af1ed4cff93c0efa"><span lg_kh="1">(</span>${t_24e5e1e9178b4559af1ed4cff93c0efa}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_52d127f73c8e474d8fd29498cfc3b1dc">the requested cipher</span><span class="tscolor" lg_zh="t_52d127f73c8e474d8fd29498cfc3b1dc"><span lg_kh="1">(</span>${t_52d127f73c8e474d8fd29498cfc3b1dc}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="throwsLabel">Throws:</span>
           </dt>
           <dd>
            <span lg_en="t_c85b635a5fbd4406beeeb55c640f571d"><code><a href="../../../../../org/apache/poi/EncryptedDocumentException.html" title="class in org.apache.poi">EncryptedDocumentException</a></code> - if the initialization failed or if an algorithm was specified, which depends on a missing bouncy castle provider</span><span class="tscolor" lg_zh="t_c85b635a5fbd4406beeeb55c640f571d"><span lg_kh="1">(</span>${t_c85b635a5fbd4406beeeb55c640f571d}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="getCipher-java.security.Key-org.apache.poi.poifs.crypt.CipherAlgorithm-org.apache.poi.poifs.crypt.ChainingMode-byte:A-int-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>getCipher</h4>
          <pre>public static&nbsp;javax.crypto.Cipher&nbsp;getCipher(java.security.Key&nbsp;key,
                                            <a href="../../../../../org/apache/poi/poifs/crypt/CipherAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">CipherAlgorithm</a>&nbsp;cipherAlgorithm,
                                            <a href="../../../../../org/apache/poi/poifs/crypt/ChainingMode.html" title="enum in org.apache.poi.poifs.crypt">ChainingMode</a>&nbsp;chain,
                                            byte[]&nbsp;vec,
                                            int&nbsp;cipherMode,
                                            java.lang.String&nbsp;padding)</pre>
          <div class="block">
           <span lg_en="t_8f4b777c1fef4677a04be8637d266b4b">Initialize a new cipher object with the given cipher properties If the given algorithm is not implemented in the JCE, it will try to load it from the bouncy castle provider.</span><span class="tscolor" lg_zh="t_8f4b777c1fef4677a04be8637d266b4b"><span lg_kh="1">(</span>${t_8f4b777c1fef4677a04be8637d266b4b}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_17df6ffb7bff4e53b7cd2de827f54680"><code>key</code> - the secret key</span><span class="tscolor" lg_zh="t_17df6ffb7bff4e53b7cd2de827f54680"><span lg_kh="1">(</span>${t_17df6ffb7bff4e53b7cd2de827f54680}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_81638ecdd34c46588673607d92acb761"><code>cipherAlgorithm</code> - the cipher algorithm</span><span class="tscolor" lg_zh="t_81638ecdd34c46588673607d92acb761"><span lg_kh="1">(</span>${t_81638ecdd34c46588673607d92acb761}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_1107723cb30e4e5a99693e0f3c53f4aa"><code>chain</code> - the chaining mode</span><span class="tscolor" lg_zh="t_1107723cb30e4e5a99693e0f3c53f4aa"><span lg_kh="1">(</span>${t_1107723cb30e4e5a99693e0f3c53f4aa}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_8ecf09cd28794966a3975d956e60c9cb"><code>vec</code> - the initialization vector (IV), can be null</span><span class="tscolor" lg_zh="t_8ecf09cd28794966a3975d956e60c9cb"><span lg_kh="1">(</span>${t_8ecf09cd28794966a3975d956e60c9cb}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_4b16a590b3bb4cd98612d1f6062cf09e"><code>cipherMode</code> - Cipher.DECRYPT_MODE or Cipher.ENCRYPT_MODE</span><span class="tscolor" lg_zh="t_4b16a590b3bb4cd98612d1f6062cf09e"><span lg_kh="1">(</span>${t_4b16a590b3bb4cd98612d1f6062cf09e}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_12c5ed1050334746972b016a8c86c7b3"><code>padding</code> - the padding (null = NOPADDING, ANSIX923Padding, PKCS5Padding, PKCS7Padding, ISO10126Padding, ...)</span><span class="tscolor" lg_zh="t_12c5ed1050334746972b016a8c86c7b3"><span lg_kh="1">(</span>${t_12c5ed1050334746972b016a8c86c7b3}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_fb404523ecfa4c4db192104872b34836">the requested cipher</span><span class="tscolor" lg_zh="t_fb404523ecfa4c4db192104872b34836"><span lg_kh="1">(</span>${t_fb404523ecfa4c4db192104872b34836}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="throwsLabel">Throws:</span>
           </dt>
           <dd>
            <span lg_en="t_245588ada2d24dff9b3604762eb41de1"><code><a href="../../../../../org/apache/poi/EncryptedDocumentException.html" title="class in org.apache.poi">EncryptedDocumentException</a></code> - if the initialization failed or if an algorithm was specified, which depends on a missing bouncy castle provider</span><span class="tscolor" lg_zh="t_245588ada2d24dff9b3604762eb41de1"><span lg_kh="1">(</span>${t_245588ada2d24dff9b3604762eb41de1}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="getBlock0-byte:A-int-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>getBlock0</h4>
          <pre>public static&nbsp;byte[]&nbsp;getBlock0(byte[]&nbsp;hash,
                               int&nbsp;size)</pre>
          <div class="block">
           <span lg_en="t_2b72fc59f1444ea08304de4057ac0d74">Returns a new byte array with a truncated to the given size. If the hash has less then size bytes, it will be filled with 0-bytes</span><span class="tscolor" lg_zh="t_2b72fc59f1444ea08304de4057ac0d74"><span lg_kh="1">(</span>${t_2b72fc59f1444ea08304de4057ac0d74}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_a5d779e7d3414fb4b608736f5e22d957"><code>hash</code> - the to be truncated/filled hash byte array</span><span class="tscolor" lg_zh="t_a5d779e7d3414fb4b608736f5e22d957"><span lg_kh="1">(</span>${t_a5d779e7d3414fb4b608736f5e22d957}<span lg_kh="1">)</span></span>
           </dd>
           <dd>
            <span lg_en="t_621f2152da654bd08b76cb86cf38b86c"><code>size</code> - the size of the returned byte array</span><span class="tscolor" lg_zh="t_621f2152da654bd08b76cb86cf38b86c"><span lg_kh="1">(</span>${t_621f2152da654bd08b76cb86cf38b86c}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_a928c1d6369a440f9b5b78fb9d7c7e70">the padded hash</span><span class="tscolor" lg_zh="t_a928c1d6369a440f9b5b78fb9d7c7e70"><span lg_kh="1">(</span>${t_a928c1d6369a440f9b5b78fb9d7c7e70}<span lg_kh="1">)</span></span>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="getMessageDigest-org.apache.poi.poifs.crypt.HashAlgorithm-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>getMessageDigest</h4>
          <pre>public static&nbsp;java.security.MessageDigest&nbsp;getMessageDigest(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm)</pre>
         </li>
        </ul>
        <a name="getMac-org.apache.poi.poifs.crypt.HashAlgorithm-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>getMac</h4>
          <pre>public static&nbsp;javax.crypto.Mac&nbsp;getMac(<a href="../../../../../org/apache/poi/poifs/crypt/HashAlgorithm.html" title="enum in org.apache.poi.poifs.crypt">HashAlgorithm</a>&nbsp;hashAlgorithm)</pre>
         </li>
        </ul>
        <a name="registerBouncyCastle--"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>registerBouncyCastle</h4>
          <pre>public static&nbsp;void&nbsp;registerBouncyCastle()</pre>
         </li>
        </ul>
        <a name="createXorVerifier1-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>createXorVerifier1</h4>
          <pre>public static&nbsp;int&nbsp;createXorVerifier1(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_e522eaaebcc64224ab35315da5f20e63">Create the verifier for xor obfuscation (method 1)</span><span class="tscolor" lg_zh="t_e522eaaebcc64224ab35315da5f20e63"><span lg_kh="1">(</span>${t_e522eaaebcc64224ab35315da5f20e63}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_1455682b91014a119dab83773effcbe5"><code>password</code> - the password</span><span class="tscolor" lg_zh="t_1455682b91014a119dab83773effcbe5"><span lg_kh="1">(</span>${t_1455682b91014a119dab83773effcbe5}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_cb70a8af36ce452d8bb85ea578d2df97">the verifier (actually a short value)</span><span class="tscolor" lg_zh="t_cb70a8af36ce452d8bb85ea578d2df97"><span lg_kh="1">(</span>${t_cb70a8af36ce452d8bb85ea578d2df97}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="seeLabel">See Also:</span>
           </dt>
           <dd>
            <a href="http://msdn.microsoft.com/en-us/library/dd926947.aspx">2.3.7.1 Binary Document Password Verifier Derivation Method 1</a>, <a href="http://msdn.microsoft.com/en-us/library/dd905229.aspx">2.3.7.4 Binary Document Password Verifier Derivation Method 2</a>, <a href="http://www.ecma-international.org/news/TC45_current_work/Office Open XML Part 4 - Markup Language Reference.pdf">Part 4 - Markup Language Reference - Ecma International - 3.2.12 fileSharing</a>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="createXorVerifier2-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>createXorVerifier2</h4>
          <pre>public static&nbsp;int&nbsp;createXorVerifier2(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_8048c2db1bcb4fa4b207ce7a1b2bc947">This method generates the xor verifier for word documents &lt; 2007 (method 2). Its output will be used as password input for the newer word generations which utilize a real hashing algorithm like sha1.</span><span class="tscolor" lg_zh="t_8048c2db1bcb4fa4b207ce7a1b2bc947"><span lg_kh="1">(</span>${t_8048c2db1bcb4fa4b207ce7a1b2bc947}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_b8279fe9771c4ba68f77dd89ce458658"><code>password</code> - the password</span><span class="tscolor" lg_zh="t_b8279fe9771c4ba68f77dd89ce458658"><span lg_kh="1">(</span>${t_b8279fe9771c4ba68f77dd89ce458658}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_ce1c76707ec3482db0b54d6c669d5db6">the hashed password</span><span class="tscolor" lg_zh="t_ce1c76707ec3482db0b54d6c669d5db6"><span lg_kh="1">(</span>${t_ce1c76707ec3482db0b54d6c669d5db6}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="seeLabel">See Also:</span>
           </dt>
           <dd>
            <a href="http://msdn.microsoft.com/en-us/library/dd905229.aspx">2.3.7.4 Binary Document Password Verifier Derivation Method 2</a>, <a href="http://blogs.msdn.com/b/vsod/archive/2010/04/05/how-to-set-the-editing-restrictions-in-word-using-open-xml-sdk-2-0.aspx">How to set the editing restrictions in Word using Open XML SDK 2.0</a>, <a href="http://www.aspose.com/blogs/aspose-blogs/vladimir-averkin/archive/2007/08/20/funny-how-the-new-powerful-cryptography-implemented-in-word-2007-turns-it-into-a-perfect-tool-for-document-password-removal.html">Funny: How the new powerful cryptography implemented in Word 2007 turns it into a perfect tool for document password removal.</a>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="xorHashPassword-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>xorHashPassword</h4>
          <pre>public static&nbsp;java.lang.String&nbsp;xorHashPassword(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_425a06bd49704325ba1b26ac2eeff7b6">This method generates the xored-hashed password for word documents &lt; 2007.</span><span class="tscolor" lg_zh="t_425a06bd49704325ba1b26ac2eeff7b6"><span lg_kh="1">(</span>${t_425a06bd49704325ba1b26ac2eeff7b6}<span lg_kh="1">)</span></span>
          </div>
         </li>
        </ul>
        <a name="xorHashPasswordReversed-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>xorHashPasswordReversed</h4>
          <pre>public static&nbsp;java.lang.String&nbsp;xorHashPasswordReversed(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_72dac4fb573e4f5ca427b38d6e0f98e4">Convenience function which returns the reversed xored-hashed password for further processing in word documents 2007 and newer, which utilize a real hashing algorithm like sha1.</span><span class="tscolor" lg_zh="t_72dac4fb573e4f5ca427b38d6e0f98e4"><span lg_kh="1">(</span>${t_72dac4fb573e4f5ca427b38d6e0f98e4}<span lg_kh="1">)</span></span>
          </div>
         </li>
        </ul>
        <a name="createXorKey1-java.lang.String-"> <!--   --> </a>
        <ul class="blockList">
         <li class="blockList">
          <h4>createXorKey1</h4>
          <pre>public static&nbsp;int&nbsp;createXorKey1(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_70fa0ea0d97c499a89ad97ab958550df">Create the xor key for xor obfuscation, which is used to create the xor array (method 1)</span><span class="tscolor" lg_zh="t_70fa0ea0d97c499a89ad97ab958550df"><span lg_kh="1">(</span>${t_70fa0ea0d97c499a89ad97ab958550df}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_9cb2fda272a445a89f14dd8105cc7e33"><code>password</code> - the password</span><span class="tscolor" lg_zh="t_9cb2fda272a445a89f14dd8105cc7e33"><span lg_kh="1">(</span>${t_9cb2fda272a445a89f14dd8105cc7e33}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_6ccc37aa60d0403eb638c9b399d971c2">the xor key</span><span class="tscolor" lg_zh="t_6ccc37aa60d0403eb638c9b399d971c2"><span lg_kh="1">(</span>${t_6ccc37aa60d0403eb638c9b399d971c2}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="seeLabel">See Also:</span>
           </dt>
           <dd>
            <a href="http://msdn.microsoft.com/en-us/library/dd924704.aspx">2.3.7.2 Binary Document XOR Array Initialization Method 1</a>, <a href="http://msdn.microsoft.com/en-us/library/dd905229.aspx">2.3.7.4 Binary Document Password Verifier Derivation Method 2</a>
           </dd>
          </dl>
         </li>
        </ul>
        <a name="createXorArray1-java.lang.String-"> <!--   --> </a>
        <ul class="blockListLast">
         <li class="blockList">
          <h4>createXorArray1</h4>
          <pre>public static&nbsp;byte[]&nbsp;createXorArray1(java.lang.String&nbsp;password)</pre>
          <div class="block">
           <span lg_en="t_b0c2ab11692f4a5b8a539339d4287287">Creates an byte array for xor obfuscation (method 1)</span><span class="tscolor" lg_zh="t_b0c2ab11692f4a5b8a539339d4287287"><span lg_kh="1">(</span>${t_b0c2ab11692f4a5b8a539339d4287287}<span lg_kh="1">)</span></span>
          </div>
          <dl>
           <dt>
            <span class="paramLabel">Parameters:</span>
           </dt>
           <dd>
            <span lg_en="t_49bbc3e1be224e9f970d5c8faad7e15b"><code>password</code> - the password</span><span class="tscolor" lg_zh="t_49bbc3e1be224e9f970d5c8faad7e15b"><span lg_kh="1">(</span>${t_49bbc3e1be224e9f970d5c8faad7e15b}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="returnLabel">Returns:</span>
           </dt>
           <dd>
            <span lg_en="t_3eb576acdeb140f085f50f44eedab74f">the byte array for xor obfuscation</span><span class="tscolor" lg_zh="t_3eb576acdeb140f085f50f44eedab74f"><span lg_kh="1">(</span>${t_3eb576acdeb140f085f50f44eedab74f}<span lg_kh="1">)</span></span>
           </dd>
           <dt>
            <span class="seeLabel">See Also:</span>
           </dt>
           <dd>
            <a href="http://msdn.microsoft.com/en-us/library/dd924704.aspx">2.3.7.2 Binary Document XOR Array Initialization Method 1</a>, <a href="http://docs.libreoffice.org/oox/html/binarycodec_8cxx_source.html">Libre Office implementation</a>
           </dd>
          </dl>
         </li>
        </ul></li>
      </ul></li>
    </ul>
   </div>
  </div>
  <!-- ========= END OF CLASS DATA ========= -->
  <!-- ======= START OF BOTTOM NAVBAR ====== -->
  <div class="bottomNav">
   <a name="navbar.bottom"> <!--   --> </a>
   <div class="skipNav">
    <a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a>
   </div>
   <a name="navbar.bottom.firstrow"> <!--   --> </a>
   <ul class="navList" title="Navigation">
    <li><a href="../../../../../overview-summary.html">Overview</a></li>
    <li><a href="package-summary.html">Package</a></li>
    <li class="navBarCell1Rev">Class</li>
    <li><a href="class-use/CryptoFunctions.html">Use</a></li>
    <li><a href="package-tree.html">Tree</a></li>
    <li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
    <li><a href="../../../../../index-all.html">Index</a></li>
    <li><a href="../../../../../help-doc.html">Help</a></li>
   </ul>
  </div>
  <div class="subNav">
   <ul class="navList">
    <li><a href="../../../../../org/apache/poi/poifs/crypt/CipherProvider.html" title="enum in org.apache.poi.poifs.crypt"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
    <li><a href="../../../../../org/apache/poi/poifs/crypt/DataSpaceMapUtils.html" title="class in org.apache.poi.poifs.crypt"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
   </ul>
   <ul class="navList">
    <li><a href="../../../../../index.html?org/apache/poi/poifs/crypt/CryptoFunctions.html" target="_top">Frames</a></li>
    <li><a href="CryptoFunctions.html" target="_top">No&nbsp;Frames</a></li>
   </ul>
   <ul class="navList" id="allclasses_navbar_bottom">
    <li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
   </ul>
   <div>
    <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
   </div>
   <div>
    <ul class="subNavList">
     <li>Summary:&nbsp;</li>
     <li>Nested&nbsp;|&nbsp;</li>
     <li>Field&nbsp;|&nbsp;</li>
     <li>Constr&nbsp;|&nbsp;</li>
     <li><a href="#method.summary">Method</a></li>
    </ul>
    <ul class="subNavList">
     <li>Detail:&nbsp;</li>
     <li>Field&nbsp;|&nbsp;</li>
     <li>Constr&nbsp;|&nbsp;</li>
     <li><a href="#method.detail">Method</a></li>
    </ul>
   </div>
   <a name="skip.navbar.bottom"> <!--   --> </a>
  </div>
  <!-- ======== END OF BOTTOM NAVBAR ======= -->
  <p class="legalCopy"><small> <i>Copyright 2021 The Apache Software Foundation or its licensors, as applicable.</i> </small></p>
 </body>
</html>