[{"id":"t_5a7c092e1b3844eb955b0e6a684d5fff","oldText":"This class is the default entry point for XML signatures and can be used for validating an existing signed office document and signing a office document. Validating a signed office document  OPCPackage pkg \u003d OPCPackage.open(..., PackageAccess.READ);\n SignatureConfig sic \u003d new SignatureConfig();\n sic.setOpcPackage(pkg);\n SignatureInfo si \u003d new SignatureInfo();\n si.setSignatureConfig(sic);\n boolean isValid \u003d si.validate();\n ...\n Signing an office document  // loading the keystore - pkcs12 is used here, but of course jks \u0026 co are also valid\n // the keystore needs to contain a private key and it\u0027s certificate having a\n // \u0027digitalSignature\u0027 key usage\n char password[] \u003d \"test\".toCharArray();\n File file \u003d new File(\"test.pfx\");\n KeyStore keystore \u003d KeyStore.getInstance(\"PKCS12\");\n FileInputStream fis \u003d new FileInputStream(file);\n keystore.load(fis, password);\n fis.close();\n\n // extracting private key and certificate\n String alias \u003d \"xyz\"; // alias of the keystore entry\n Key key \u003d keystore.getKey(alias, password);\n X509Certificate x509 \u003d (X509Certificate)keystore.getCertificate(alias);\n\n // filling the SignatureConfig entries (minimum fields, more options are available ...)\n SignatureConfig signatureConfig \u003d new SignatureConfig();\n signatureConfig.setKey(keyPair.getPrivate());\n signatureConfig.setSigningCertificateChain(Collections.singletonList(x509));\n OPCPackage pkg \u003d OPCPackage.open(..., PackageAccess.READ_WRITE);\n signatureConfig.setOpcPackage(pkg);\n\n // adding the signature document to the package\n SignatureInfo si \u003d new SignatureInfo();\n si.setSignatureConfig(signatureConfig);\n si.confirmSignature();\n // optionally verify the generated signature\n boolean b \u003d si.verifySignature();\n assert (b);\n // write the changes back to disc\n pkg.close();\n Implementation notes: Although there\u0027s a XML signature implementation in the Oracle JDKs 6 and higher, compatibility with IBM JDKs is also in focus (... but maybe not thoroughly tested ...). Therefore we are using the Apache Santuario libs (xmlsec) instead of the built-in classes, as the compatibility seems to be provided there. To use SignatureInfo and its sibling classes, you\u0027ll need to have the following libs in the classpath: BouncyCastle bcpkix and bcprov (tested against 1.67) Apache Santuario \"xmlsec\" (tested against 2.2.0) and slf4j-api (tested against 1.7.30)","tlText":"此类是ML签名的默认入口点，可用于验证现有签名的办公文档和签名办公文档。验证已签署的办公室文件OPCPack pkg \u003d OPCPackage.open（.，PackageAccess.Read）;\n SignatureSwitch sic \u003d new SignatureSwitch（）;\n sic. setOpcPack（pkg）;\n SignatureInfo si \u003d new SignatureInfo（）;\n si. setSignatureProtect（sic）;\n 布尔值isValid \u003d si. valid（）;\n ...\n 签署办公文档//加载密钥库-pkcs 12在这里使用，但当然jks \u0026 co也有效\n //密钥库需要包含一个私有密钥，并且它的证书具有\n //“digitalSignature”密钥使用\n char口令[] \u003d“Test”.toCharArray（）;\n 文件文件\u003d新文件（“test.pfx”）;\n KeyStore密钥库\u003d KeyStore.getInstance（“PKCS 12”）;\n FileNputStream fis \u003d new FileNputStream（文件）;\n keystore. add（fis，口令）;\n fis.close（）;\n\n //提取私有密钥和证书\n 字符串别名\u003d“xyz”; //密钥库条目的别名\n Key key \u003d keystore.getKey（别名，密码）;\n X509证书x509 \u003d（X509证书）keystore. get证书（别名）;\n\n //填充SignatureSwitch条目（最少字段，有更多选项可用.）\n SignatureSwitch SignatureSwitch \u003d new SignatureSwitch（）;\n SignatureSwitch.setKey（keyPair.getPrivate（））;\n SignatureSwitch. setSigningCericateChain（Collections.singletonList（x509））;\n OPCPack pkg \u003d OPCPackage.open（.，PackageAccess.Read_WRITE）;\n SignatureSwitch. setOpcPack（pkg）;\n\n //将签名文档添加到包\n SignatureInfo si \u003d new SignatureInfo（）;\n si. setSignatureSwitch（SignatureSwitch）;\n si.确认Signature（）;\n //可选地验证生成的签名\n 布尔b \u003d si.verifySignature（）;\n assert（b）;\n //将更改写回磁盘\n pkg.close（）;\n 实施说明：尽管Oracle JK 6及更高版本中有一个ML签名实现，但与IBM JK的兼容性也是焦点（.但可能没有彻底测试.）。因此，我们使用ApachSantuario库（xmlSec）而不是内置类，因为那里似乎提供了兼容性。要使用SignatureInfo及其兄弟类，您需要在类路径中具有以下库：BouncyCastle bcpkix和bcprov（针对1.67测试）Apache Santuario“xmlSec”（针对2.2.0测试）和slf 4j-api（针对1.7.30测试）","version":0},{"id":"t_396937c22e69465f9f9f75e43f7bf181","oldText":"add the xml signature to the document","tlText":"将html签名添加到文档","version":0},{"id":"t_57de1a30a91644728800d67288842b39","oldText":"Convenience method for creating the signature context","tlText":"创建签名上下文的便捷方法","version":0},{"id":"t_10297bbe51054d91b60faca691b7c3b8","oldText":"Initialize the xml signing environment and the bouncycastle provider","tlText":"初始化html签名环境和bouncyccastle提供者","version":0},{"id":"t_22c29239e6b34c4d812fbb18c3b92a78","oldText":"Helper method for adding informations after the signing.","tlText":"签名后添加信息的助手方法。","version":0},{"id":"t_783dbd3a09b648798e352423218d3457","oldText":"Helper method for adding informations before the signing.","tlText":"在签名前添加信息的帮助方法。","version":0},{"id":"t_28b93f97a35a4d308b0ca94484545f94","oldText":"Sign (encrypt) the digest with the private key.","tlText":"使用私人密钥对摘要进行签名（加密）。","version":0},{"id":"t_1ee20f0d6318426ca3917d51bd74b9e1","oldText":"Write XML signature into the OPC package","tlText":"将HTML签名写入到OPC包中","version":0},{"id":"t_03330fc240f74ef1aef94450fe3203d5","oldText":"the signature config","tlText":"签名配置","version":0},{"id":"t_fb82dd880a524bf280cbce6bfabad23e","oldText":"signatureConfig - the signature config, needs to be set before a SignatureInfo object is used","tlText":"SignatureSwitch-签名配置，需要在使用SignatureInfo对象之前设置","version":0},{"id":"t_967b2303e21944f39e53fad29c05d9f0","oldText":"true, if first signature part is valid","tlText":"如果第一个签名部分有效，则为真","version":0},{"id":"t_20890ed668e84a81a0c65f8b9e43f756","oldText":"add the xml signature to the document","tlText":"将html签名添加到文档","version":0},{"id":"t_c1700945ff06412892192425c487be41","oldText":"javax.xml.crypto.dsig.XMLSignatureException - if the signature can\u0027t be calculated","tlText":"javax. html.Crypto.dsig. MQLSignature例外-如果无法计算签名","version":0},{"id":"t_fbefdfcca11347b892d4256d4cce490c","oldText":"javax.xml.crypto.MarshalException - if the document can\u0027t be serialized","tlText":"javax.xml.Crypto. Marshal异常-如果文档无法序列化","version":0},{"id":"t_7f62eb186f0641f58a972efc6c1e9584","oldText":"Convenience method for creating the signature context","tlText":"创建签名上下文的便捷方法","version":0},{"id":"t_1b13139b93db4c57829b70b851e2a7c2","oldText":"document - the document the signature is based on","tlText":"文档-签名所基于的文档","version":0},{"id":"t_d89f1b7f8d204b849faa75e05519ff89","oldText":"the initialized signature context","tlText":"初始化的签名上下文","version":0},{"id":"t_9a20219d0fff4aafb54673fdc3c786dd","oldText":"Sign (encrypt) the digest with the private key. Currently only rsa is supported.","tlText":"使用私人密钥对摘要进行签名（加密）。目前仅支持RSA。","version":0},{"id":"t_fe5585de532a4578bc536e55a8c9194b","oldText":"the encrypted hash","tlText":"加密的散列","version":0},{"id":"t_4f9eb753ce2b4ad8b63a74a625b3962f","oldText":"a signature part for each signature document. the parts can be validated independently.","tlText":"每个签名文件的签名部分。这些部件可以独立验证。","version":0},{"id":"t_bb39a0c4293a46f5a9defc70c2fef84c","oldText":"Helper method for adding informations before the signing. Normally confirmSignature() is sufficient to be used.","tlText":"在签名前添加信息的帮助方法。通常，confirmSignature（）就足够了。","version":0},{"id":"t_5ec067d3de884cbc942d4cedbea2fe6b","oldText":"javax.xml.crypto.dsig.XMLSignatureException","tlText":"javax.xml.crypto.dsig.XMLSignatureException","version":0},{"id":"t_6fa234a54e094d25aed6d267c7747656","oldText":"javax.xml.crypto.MarshalException","tlText":"javax.xml.crypto.MarshalException","version":0},{"id":"t_7d928c44ae744df79083f7d627623838","oldText":"Helper method for adding informations after the signing. Normally confirmSignature() is sufficient to be used.","tlText":"签名后添加信息的助手方法。通常，confirmSignature（）就足够了。","version":0},{"id":"t_63e63533861c41838d276f4c752c28d7","oldText":"javax.xml.crypto.MarshalException","tlText":"javax.xml.crypto.MarshalException","version":0},{"id":"t_51baad35c5a749b196de9a8074a7a325","oldText":"Write XML signature into the OPC package","tlText":"将HTML签名写入到OPC包中","version":0},{"id":"t_8eae219d9cb64aa7b3135328fd4d969c","oldText":"document - the xml signature document","tlText":"document -xml签名文档","version":0},{"id":"t_95c5f87d050941ba9c97fec57c6e545f","oldText":"javax.xml.crypto.MarshalException - if the document can\u0027t be serialized","tlText":"javax.xml.Crypto. Marshal异常-如果文档无法序列化","version":0},{"id":"t_b63ffde0033d496aa7d9fb0434f90a5d","oldText":"Initialize the xml signing environment and the bouncycastle provider","tlText":"初始化html签名环境和bouncyccastle提供者","version":0}]